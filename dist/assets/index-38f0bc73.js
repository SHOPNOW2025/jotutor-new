(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function TS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var IS={exports:{}},Rh={},SS={exports:{}},oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ru=Symbol.for("react.element"),eP=Symbol.for("react.portal"),tP=Symbol.for("react.fragment"),nP=Symbol.for("react.strict_mode"),rP=Symbol.for("react.profiler"),iP=Symbol.for("react.provider"),sP=Symbol.for("react.context"),oP=Symbol.for("react.forward_ref"),aP=Symbol.for("react.suspense"),lP=Symbol.for("react.memo"),uP=Symbol.for("react.lazy"),Ix=Symbol.iterator;function cP(t){return t===null||typeof t!="object"?null:(t=Ix&&t[Ix]||t["@@iterator"],typeof t=="function"?t:null)}var bS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ES=Object.assign,CS={};function va(t,e,n){this.props=t,this.context=e,this.refs=CS,this.updater=n||bS}va.prototype.isReactComponent={};va.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};va.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function NS(){}NS.prototype=va.prototype;function gy(t,e,n){this.props=t,this.context=e,this.refs=CS,this.updater=n||bS}var yy=gy.prototype=new NS;yy.constructor=gy;ES(yy,va.prototype);yy.isPureReactComponent=!0;var Sx=Array.isArray,AS=Object.prototype.hasOwnProperty,vy={current:null},kS={key:!0,ref:!0,__self:!0,__source:!0};function RS(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)AS.call(e,r)&&!kS.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Ru,type:t,key:s,ref:o,props:i,_owner:vy.current}}function dP(t,e){return{$$typeof:Ru,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function xy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ru}function hP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var bx=/\/+/g;function Zf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?hP(""+t.key):e.toString(36)}function Qc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ru:case eP:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Zf(o,0):r,Sx(i)?(n="",t!=null&&(n=t.replace(bx,"$&/")+"/"),Qc(i,e,n,"",function(u){return u})):i!=null&&(xy(i)&&(i=dP(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(bx,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Sx(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Zf(s,a);o+=Qc(s,e,n,l,i)}else if(l=cP(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Zf(s,a++),o+=Qc(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function pc(t,e,n){if(t==null)return t;var r=[],i=0;return Qc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function fP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Qt={current:null},Xc={transition:null},pP={ReactCurrentDispatcher:Qt,ReactCurrentBatchConfig:Xc,ReactCurrentOwner:vy};function PS(){throw Error("act(...) is not supported in production builds of React.")}oe.Children={map:pc,forEach:function(t,e,n){pc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return pc(t,function(){e++}),e},toArray:function(t){return pc(t,function(e){return e})||[]},only:function(t){if(!xy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};oe.Component=va;oe.Fragment=tP;oe.Profiler=rP;oe.PureComponent=gy;oe.StrictMode=nP;oe.Suspense=aP;oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pP;oe.act=PS;oe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ES({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=vy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)AS.call(e,l)&&!kS.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Ru,type:t.type,key:i,ref:s,props:r,_owner:o}};oe.createContext=function(t){return t={$$typeof:sP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:iP,_context:t},t.Consumer=t};oe.createElement=RS;oe.createFactory=function(t){var e=RS.bind(null,t);return e.type=t,e};oe.createRef=function(){return{current:null}};oe.forwardRef=function(t){return{$$typeof:oP,render:t}};oe.isValidElement=xy;oe.lazy=function(t){return{$$typeof:uP,_payload:{_status:-1,_result:t},_init:fP}};oe.memo=function(t,e){return{$$typeof:lP,type:t,compare:e===void 0?null:e}};oe.startTransition=function(t){var e=Xc.transition;Xc.transition={};try{t()}finally{Xc.transition=e}};oe.unstable_act=PS;oe.useCallback=function(t,e){return Qt.current.useCallback(t,e)};oe.useContext=function(t){return Qt.current.useContext(t)};oe.useDebugValue=function(){};oe.useDeferredValue=function(t){return Qt.current.useDeferredValue(t)};oe.useEffect=function(t,e){return Qt.current.useEffect(t,e)};oe.useId=function(){return Qt.current.useId()};oe.useImperativeHandle=function(t,e,n){return Qt.current.useImperativeHandle(t,e,n)};oe.useInsertionEffect=function(t,e){return Qt.current.useInsertionEffect(t,e)};oe.useLayoutEffect=function(t,e){return Qt.current.useLayoutEffect(t,e)};oe.useMemo=function(t,e){return Qt.current.useMemo(t,e)};oe.useReducer=function(t,e,n){return Qt.current.useReducer(t,e,n)};oe.useRef=function(t){return Qt.current.useRef(t)};oe.useState=function(t){return Qt.current.useState(t)};oe.useSyncExternalStore=function(t,e,n){return Qt.current.useSyncExternalStore(t,e,n)};oe.useTransition=function(){return Qt.current.useTransition()};oe.version="18.3.1";SS.exports=oe;var N=SS.exports;const DS=TS(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mP=N,gP=Symbol.for("react.element"),yP=Symbol.for("react.fragment"),vP=Object.prototype.hasOwnProperty,xP=mP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wP={key:!0,ref:!0,__self:!0,__source:!0};function MS(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)vP.call(e,r)&&!wP.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:gP,type:t,key:s,ref:o,props:i,_owner:xP.current}}Rh.Fragment=yP;Rh.jsx=MS;Rh.jsxs=MS;IS.exports=Rh;var c=IS.exports,lm={},LS={exports:{}},Nn={},US={exports:{}},FS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,Y){var X=O.length;O.push(Y);e:for(;0<X;){var ge=X-1>>>1,ye=O[ge];if(0<i(ye,Y))O[ge]=Y,O[X]=ye,X=ge;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var Y=O[0],X=O.pop();if(X!==Y){O[0]=X;e:for(var ge=0,ye=O.length,yn=ye>>>1;ge<yn;){var ze=2*(ge+1)-1,_e=O[ze],ue=ze+1,Ie=O[ue];if(0>i(_e,X))ue<ye&&0>i(Ie,_e)?(O[ge]=Ie,O[ue]=X,ge=ue):(O[ge]=_e,O[ze]=X,ge=ze);else if(ue<ye&&0>i(Ie,X))O[ge]=Ie,O[ue]=X,ge=ue;else break e}}return Y}function i(O,Y){var X=O.sortIndex-Y.sortIndex;return X!==0?X:O.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,p=null,m=3,g=!1,y=!1,w=!1,T=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(O){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=O)r(u),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=n(u)}}function b(O){if(w=!1,_(O),!y)if(n(l)!==null)y=!0,Ee(S);else{var Y=n(u);Y!==null&&$t(b,Y.startTime-O)}}function S(O,Y){y=!1,w&&(w=!1,x(R),R=-1),g=!0;var X=m;try{for(_(Y),p=n(l);p!==null&&(!(p.expirationTime>Y)||O&&!Q());){var ge=p.callback;if(typeof ge=="function"){p.callback=null,m=p.priorityLevel;var ye=ge(p.expirationTime<=Y);Y=t.unstable_now(),typeof ye=="function"?p.callback=ye:p===n(l)&&r(l),_(Y)}else r(l);p=n(l)}if(p!==null)var yn=!0;else{var ze=n(u);ze!==null&&$t(b,ze.startTime-Y),yn=!1}return yn}finally{p=null,m=X,g=!1}}var I=!1,E=null,R=-1,F=5,M=-1;function Q(){return!(t.unstable_now()-M<F)}function ne(){if(E!==null){var O=t.unstable_now();M=O;var Y=!0;try{Y=E(!0,O)}finally{Y?se():(I=!1,E=null)}}else I=!1}var se;if(typeof v=="function")se=function(){v(ne)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,Te=ae.port2;ae.port1.onmessage=ne,se=function(){Te.postMessage(null)}}else se=function(){T(ne,0)};function Ee(O){E=O,I||(I=!0,se())}function $t(O,Y){R=T(function(){O(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,Ee(S))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var X=m;m=Y;try{return O()}finally{m=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,Y){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var X=m;m=O;try{return Y()}finally{m=X}},t.unstable_scheduleCallback=function(O,Y,X){var ge=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ge+X:ge):X=ge,O){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=X+ye,O={id:h++,callback:Y,priorityLevel:O,startTime:X,expirationTime:ye,sortIndex:-1},X>ge?(O.sortIndex=X,e(u,O),n(l)===null&&O===n(u)&&(w?(x(R),R=-1):w=!0,$t(b,X-ge))):(O.sortIndex=ye,e(l,O),y||g||(y=!0,Ee(S))),O},t.unstable_shouldYield=Q,t.unstable_wrapCallback=function(O){var Y=m;return function(){var X=m;m=Y;try{return O.apply(this,arguments)}finally{m=X}}}})(FS);US.exports=FS;var _P=US.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TP=N,bn=_P;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var OS=new Set,jl={};function Qs(t,e){Yo(t,e),Yo(t+"Capture",e)}function Yo(t,e){for(jl[t]=e,t=0;t<e.length;t++)OS.add(e[t])}var Or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),um=Object.prototype.hasOwnProperty,IP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ex={},Cx={};function SP(t){return um.call(Cx,t)?!0:um.call(Ex,t)?!1:IP.test(t)?Cx[t]=!0:(Ex[t]=!0,!1)}function bP(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function EP(t,e,n,r){if(e===null||typeof e>"u"||bP(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Xt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Nt[t]=new Xt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Nt[e]=new Xt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Nt[t]=new Xt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Nt[t]=new Xt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Nt[t]=new Xt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Nt[t]=new Xt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Nt[t]=new Xt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Nt[t]=new Xt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Nt[t]=new Xt(t,5,!1,t.toLowerCase(),null,!1,!1)});var wy=/[\-:]([a-z])/g;function _y(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wy,_y);Nt[e]=new Xt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wy,_y);Nt[e]=new Xt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wy,_y);Nt[e]=new Xt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Nt[t]=new Xt(t,1,!1,t.toLowerCase(),null,!1,!1)});Nt.xlinkHref=new Xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Nt[t]=new Xt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ty(t,e,n,r){var i=Nt.hasOwnProperty(e)?Nt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(EP(e,n,i,r)&&(n=null),r||i===null?SP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var zr=TP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mc=Symbol.for("react.element"),vo=Symbol.for("react.portal"),xo=Symbol.for("react.fragment"),Iy=Symbol.for("react.strict_mode"),cm=Symbol.for("react.profiler"),jS=Symbol.for("react.provider"),$S=Symbol.for("react.context"),Sy=Symbol.for("react.forward_ref"),dm=Symbol.for("react.suspense"),hm=Symbol.for("react.suspense_list"),by=Symbol.for("react.memo"),li=Symbol.for("react.lazy"),VS=Symbol.for("react.offscreen"),Nx=Symbol.iterator;function ja(t){return t===null||typeof t!="object"?null:(t=Nx&&t[Nx]||t["@@iterator"],typeof t=="function"?t:null)}var $e=Object.assign,ep;function ll(t){if(ep===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ep=e&&e[1]||""}return`
`+ep+t}var tp=!1;function np(t,e){if(!t||tp)return"";tp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{tp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ll(t):""}function CP(t){switch(t.tag){case 5:return ll(t.type);case 16:return ll("Lazy");case 13:return ll("Suspense");case 19:return ll("SuspenseList");case 0:case 2:case 15:return t=np(t.type,!1),t;case 11:return t=np(t.type.render,!1),t;case 1:return t=np(t.type,!0),t;default:return""}}function fm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case xo:return"Fragment";case vo:return"Portal";case cm:return"Profiler";case Iy:return"StrictMode";case dm:return"Suspense";case hm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case $S:return(t.displayName||"Context")+".Consumer";case jS:return(t._context.displayName||"Context")+".Provider";case Sy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case by:return e=t.displayName||null,e!==null?e:fm(t.type)||"Memo";case li:e=t._payload,t=t._init;try{return fm(t(e))}catch{}}return null}function NP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fm(e);case 8:return e===Iy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ai(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function BS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function AP(t){var e=BS(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function gc(t){t._valueTracker||(t._valueTracker=AP(t))}function qS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=BS(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Sd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function pm(t,e){var n=e.checked;return $e({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ax(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ai(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function GS(t,e){e=e.checked,e!=null&&Ty(t,"checked",e,!1)}function mm(t,e){GS(t,e);var n=Ai(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?gm(t,e.type,n):e.hasOwnProperty("defaultValue")&&gm(t,e.type,Ai(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function kx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function gm(t,e,n){(e!=="number"||Sd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ul=Array.isArray;function Mo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ai(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ym(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return $e({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Rx(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(ul(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ai(n)}}function HS(t,e){var n=Ai(e.value),r=Ai(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Px(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var yc,WS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(yc=yc||document.createElement("div"),yc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=yc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $l(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var wl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kP=["Webkit","ms","Moz","O"];Object.keys(wl).forEach(function(t){kP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),wl[e]=wl[t]})});function KS(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||wl.hasOwnProperty(t)&&wl[t]?(""+e).trim():e+"px"}function JS(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=KS(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var RP=$e({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xm(t,e){if(e){if(RP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function wm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _m=null;function Ey(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Tm=null,Lo=null,Uo=null;function Dx(t){if(t=Mu(t)){if(typeof Tm!="function")throw Error(L(280));var e=t.stateNode;e&&(e=Uh(e),Tm(t.stateNode,t.type,e))}}function YS(t){Lo?Uo?Uo.push(t):Uo=[t]:Lo=t}function QS(){if(Lo){var t=Lo,e=Uo;if(Uo=Lo=null,Dx(t),e)for(t=0;t<e.length;t++)Dx(e[t])}}function XS(t,e){return t(e)}function ZS(){}var rp=!1;function eb(t,e,n){if(rp)return t(e,n);rp=!0;try{return XS(t,e,n)}finally{rp=!1,(Lo!==null||Uo!==null)&&(ZS(),QS())}}function Vl(t,e){var n=t.stateNode;if(n===null)return null;var r=Uh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var Im=!1;if(Or)try{var $a={};Object.defineProperty($a,"passive",{get:function(){Im=!0}}),window.addEventListener("test",$a,$a),window.removeEventListener("test",$a,$a)}catch{Im=!1}function PP(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var _l=!1,bd=null,Ed=!1,Sm=null,DP={onError:function(t){_l=!0,bd=t}};function MP(t,e,n,r,i,s,o,a,l){_l=!1,bd=null,PP.apply(DP,arguments)}function LP(t,e,n,r,i,s,o,a,l){if(MP.apply(this,arguments),_l){if(_l){var u=bd;_l=!1,bd=null}else throw Error(L(198));Ed||(Ed=!0,Sm=u)}}function Xs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function tb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Mx(t){if(Xs(t)!==t)throw Error(L(188))}function UP(t){var e=t.alternate;if(!e){if(e=Xs(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Mx(i),t;if(s===r)return Mx(i),e;s=s.sibling}throw Error(L(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function nb(t){return t=UP(t),t!==null?rb(t):null}function rb(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=rb(t);if(e!==null)return e;t=t.sibling}return null}var ib=bn.unstable_scheduleCallback,Lx=bn.unstable_cancelCallback,FP=bn.unstable_shouldYield,OP=bn.unstable_requestPaint,We=bn.unstable_now,jP=bn.unstable_getCurrentPriorityLevel,Cy=bn.unstable_ImmediatePriority,sb=bn.unstable_UserBlockingPriority,Cd=bn.unstable_NormalPriority,$P=bn.unstable_LowPriority,ob=bn.unstable_IdlePriority,Ph=null,gr=null;function VP(t){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(Ph,t,void 0,(t.current.flags&128)===128)}catch{}}var Wn=Math.clz32?Math.clz32:GP,BP=Math.log,qP=Math.LN2;function GP(t){return t>>>=0,t===0?32:31-(BP(t)/qP|0)|0}var vc=64,xc=4194304;function cl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=cl(a):(s&=o,s!==0&&(r=cl(s)))}else o=n&~i,o!==0?r=cl(o):s!==0&&(r=cl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Wn(e),i=1<<n,r|=t[n],e&=~i;return r}function HP(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Wn(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=HP(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function bm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ab(){var t=vc;return vc<<=1,!(vc&4194240)&&(vc=64),t}function ip(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Pu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Wn(e),t[e]=n}function WP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Wn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Ny(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Wn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var xe=0;function lb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ub,Ay,cb,db,hb,Em=!1,wc=[],xi=null,wi=null,_i=null,Bl=new Map,ql=new Map,ci=[],KP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ux(t,e){switch(t){case"focusin":case"focusout":xi=null;break;case"dragenter":case"dragleave":wi=null;break;case"mouseover":case"mouseout":_i=null;break;case"pointerover":case"pointerout":Bl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ql.delete(e.pointerId)}}function Va(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Mu(e),e!==null&&Ay(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function JP(t,e,n,r,i){switch(e){case"focusin":return xi=Va(xi,t,e,n,r,i),!0;case"dragenter":return wi=Va(wi,t,e,n,r,i),!0;case"mouseover":return _i=Va(_i,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Bl.set(s,Va(Bl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ql.set(s,Va(ql.get(s)||null,t,e,n,r,i)),!0}return!1}function fb(t){var e=ps(t.target);if(e!==null){var n=Xs(e);if(n!==null){if(e=n.tag,e===13){if(e=tb(n),e!==null){t.blockedOn=e,hb(t.priority,function(){cb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);_m=r,n.target.dispatchEvent(r),_m=null}else return e=Mu(n),e!==null&&Ay(e),t.blockedOn=n,!1;e.shift()}return!0}function Fx(t,e,n){Zc(t)&&n.delete(e)}function YP(){Em=!1,xi!==null&&Zc(xi)&&(xi=null),wi!==null&&Zc(wi)&&(wi=null),_i!==null&&Zc(_i)&&(_i=null),Bl.forEach(Fx),ql.forEach(Fx)}function Ba(t,e){t.blockedOn===e&&(t.blockedOn=null,Em||(Em=!0,bn.unstable_scheduleCallback(bn.unstable_NormalPriority,YP)))}function Gl(t){function e(i){return Ba(i,t)}if(0<wc.length){Ba(wc[0],t);for(var n=1;n<wc.length;n++){var r=wc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(xi!==null&&Ba(xi,t),wi!==null&&Ba(wi,t),_i!==null&&Ba(_i,t),Bl.forEach(e),ql.forEach(e),n=0;n<ci.length;n++)r=ci[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ci.length&&(n=ci[0],n.blockedOn===null);)fb(n),n.blockedOn===null&&ci.shift()}var Fo=zr.ReactCurrentBatchConfig,Ad=!0;function QP(t,e,n,r){var i=xe,s=Fo.transition;Fo.transition=null;try{xe=1,ky(t,e,n,r)}finally{xe=i,Fo.transition=s}}function XP(t,e,n,r){var i=xe,s=Fo.transition;Fo.transition=null;try{xe=4,ky(t,e,n,r)}finally{xe=i,Fo.transition=s}}function ky(t,e,n,r){if(Ad){var i=Cm(t,e,n,r);if(i===null)pp(t,e,r,kd,n),Ux(t,r);else if(JP(i,t,e,n,r))r.stopPropagation();else if(Ux(t,r),e&4&&-1<KP.indexOf(t)){for(;i!==null;){var s=Mu(i);if(s!==null&&ub(s),s=Cm(t,e,n,r),s===null&&pp(t,e,r,kd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else pp(t,e,r,null,n)}}var kd=null;function Cm(t,e,n,r){if(kd=null,t=Ey(r),t=ps(t),t!==null)if(e=Xs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=tb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return kd=t,null}function pb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jP()){case Cy:return 1;case sb:return 4;case Cd:case $P:return 16;case ob:return 536870912;default:return 16}default:return 16}}var pi=null,Ry=null,ed=null;function mb(){if(ed)return ed;var t,e=Ry,n=e.length,r,i="value"in pi?pi.value:pi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ed=i.slice(t,1<r?1-r:void 0)}function td(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _c(){return!0}function Ox(){return!1}function An(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?_c:Ox,this.isPropagationStopped=Ox,this}return $e(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_c)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_c)},persist:function(){},isPersistent:_c}),e}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Py=An(xa),Du=$e({},xa,{view:0,detail:0}),ZP=An(Du),sp,op,qa,Dh=$e({},Du,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==qa&&(qa&&t.type==="mousemove"?(sp=t.screenX-qa.screenX,op=t.screenY-qa.screenY):op=sp=0,qa=t),sp)},movementY:function(t){return"movementY"in t?t.movementY:op}}),jx=An(Dh),eD=$e({},Dh,{dataTransfer:0}),tD=An(eD),nD=$e({},Du,{relatedTarget:0}),ap=An(nD),rD=$e({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),iD=An(rD),sD=$e({},xa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),oD=An(sD),aD=$e({},xa,{data:0}),$x=An(aD),lD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dD(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=cD[t])?!!e[t]:!1}function Dy(){return dD}var hD=$e({},Du,{key:function(t){if(t.key){var e=lD[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=td(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uD[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dy,charCode:function(t){return t.type==="keypress"?td(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?td(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fD=An(hD),pD=$e({},Dh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vx=An(pD),mD=$e({},Du,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dy}),gD=An(mD),yD=$e({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),vD=An(yD),xD=$e({},Dh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wD=An(xD),_D=[9,13,27,32],My=Or&&"CompositionEvent"in window,Tl=null;Or&&"documentMode"in document&&(Tl=document.documentMode);var TD=Or&&"TextEvent"in window&&!Tl,gb=Or&&(!My||Tl&&8<Tl&&11>=Tl),Bx=String.fromCharCode(32),qx=!1;function yb(t,e){switch(t){case"keyup":return _D.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var wo=!1;function ID(t,e){switch(t){case"compositionend":return vb(e);case"keypress":return e.which!==32?null:(qx=!0,Bx);case"textInput":return t=e.data,t===Bx&&qx?null:t;default:return null}}function SD(t,e){if(wo)return t==="compositionend"||!My&&yb(t,e)?(t=mb(),ed=Ry=pi=null,wo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gb&&e.locale!=="ko"?null:e.data;default:return null}}var bD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bD[t.type]:e==="textarea"}function xb(t,e,n,r){YS(r),e=Rd(e,"onChange"),0<e.length&&(n=new Py("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Il=null,Hl=null;function ED(t){kb(t,0)}function Mh(t){var e=Io(t);if(qS(e))return t}function CD(t,e){if(t==="change")return e}var wb=!1;if(Or){var lp;if(Or){var up="oninput"in document;if(!up){var Hx=document.createElement("div");Hx.setAttribute("oninput","return;"),up=typeof Hx.oninput=="function"}lp=up}else lp=!1;wb=lp&&(!document.documentMode||9<document.documentMode)}function zx(){Il&&(Il.detachEvent("onpropertychange",_b),Hl=Il=null)}function _b(t){if(t.propertyName==="value"&&Mh(Hl)){var e=[];xb(e,Hl,t,Ey(t)),eb(ED,e)}}function ND(t,e,n){t==="focusin"?(zx(),Il=e,Hl=n,Il.attachEvent("onpropertychange",_b)):t==="focusout"&&zx()}function AD(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Mh(Hl)}function kD(t,e){if(t==="click")return Mh(e)}function RD(t,e){if(t==="input"||t==="change")return Mh(e)}function PD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qn=typeof Object.is=="function"?Object.is:PD;function zl(t,e){if(Qn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!um.call(e,i)||!Qn(t[i],e[i]))return!1}return!0}function Wx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Kx(t,e){var n=Wx(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Wx(n)}}function Tb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Tb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ib(){for(var t=window,e=Sd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Sd(t.document)}return e}function Ly(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function DD(t){var e=Ib(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Tb(n.ownerDocument.documentElement,n)){if(r!==null&&Ly(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Kx(n,s);var o=Kx(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var MD=Or&&"documentMode"in document&&11>=document.documentMode,_o=null,Nm=null,Sl=null,Am=!1;function Jx(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Am||_o==null||_o!==Sd(r)||(r=_o,"selectionStart"in r&&Ly(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Sl&&zl(Sl,r)||(Sl=r,r=Rd(Nm,"onSelect"),0<r.length&&(e=new Py("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_o)))}function Tc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var To={animationend:Tc("Animation","AnimationEnd"),animationiteration:Tc("Animation","AnimationIteration"),animationstart:Tc("Animation","AnimationStart"),transitionend:Tc("Transition","TransitionEnd")},cp={},Sb={};Or&&(Sb=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function Lh(t){if(cp[t])return cp[t];if(!To[t])return t;var e=To[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Sb)return cp[t]=e[n];return t}var bb=Lh("animationend"),Eb=Lh("animationiteration"),Cb=Lh("animationstart"),Nb=Lh("transitionend"),Ab=new Map,Yx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qi(t,e){Ab.set(t,e),Qs(e,[t])}for(var dp=0;dp<Yx.length;dp++){var hp=Yx[dp],LD=hp.toLowerCase(),UD=hp[0].toUpperCase()+hp.slice(1);qi(LD,"on"+UD)}qi(bb,"onAnimationEnd");qi(Eb,"onAnimationIteration");qi(Cb,"onAnimationStart");qi("dblclick","onDoubleClick");qi("focusin","onFocus");qi("focusout","onBlur");qi(Nb,"onTransitionEnd");Yo("onMouseEnter",["mouseout","mouseover"]);Yo("onMouseLeave",["mouseout","mouseover"]);Yo("onPointerEnter",["pointerout","pointerover"]);Yo("onPointerLeave",["pointerout","pointerover"]);Qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FD=new Set("cancel close invalid load scroll toggle".split(" ").concat(dl));function Qx(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,LP(r,e,void 0,t),t.currentTarget=null}function kb(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Qx(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Qx(i,a,u),s=l}}}if(Ed)throw t=Sm,Ed=!1,Sm=null,t}function Ce(t,e){var n=e[Mm];n===void 0&&(n=e[Mm]=new Set);var r=t+"__bubble";n.has(r)||(Rb(e,t,2,!1),n.add(r))}function fp(t,e,n){var r=0;e&&(r|=4),Rb(n,t,r,e)}var Ic="_reactListening"+Math.random().toString(36).slice(2);function Wl(t){if(!t[Ic]){t[Ic]=!0,OS.forEach(function(n){n!=="selectionchange"&&(FD.has(n)||fp(n,!1,t),fp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ic]||(e[Ic]=!0,fp("selectionchange",!1,e))}}function Rb(t,e,n,r){switch(pb(e)){case 1:var i=QP;break;case 4:i=XP;break;default:i=ky}n=i.bind(null,e,n,t),i=void 0,!Im||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function pp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ps(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}eb(function(){var u=s,h=Ey(n),p=[];e:{var m=Ab.get(t);if(m!==void 0){var g=Py,y=t;switch(t){case"keypress":if(td(n)===0)break e;case"keydown":case"keyup":g=fD;break;case"focusin":y="focus",g=ap;break;case"focusout":y="blur",g=ap;break;case"beforeblur":case"afterblur":g=ap;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=jx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=tD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=gD;break;case bb:case Eb:case Cb:g=iD;break;case Nb:g=vD;break;case"scroll":g=ZP;break;case"wheel":g=wD;break;case"copy":case"cut":case"paste":g=oD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Vx}var w=(e&4)!==0,T=!w&&t==="scroll",x=w?m!==null?m+"Capture":null:m;w=[];for(var v=u,_;v!==null;){_=v;var b=_.stateNode;if(_.tag===5&&b!==null&&(_=b,x!==null&&(b=Vl(v,x),b!=null&&w.push(Kl(v,b,_)))),T)break;v=v.return}0<w.length&&(m=new g(m,y,null,n,h),p.push({event:m,listeners:w}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",m&&n!==_m&&(y=n.relatedTarget||n.fromElement)&&(ps(y)||y[jr]))break e;if((g||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,g?(y=n.relatedTarget||n.toElement,g=u,y=y?ps(y):null,y!==null&&(T=Xs(y),y!==T||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=u),g!==y)){if(w=jx,b="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(w=Vx,b="onPointerLeave",x="onPointerEnter",v="pointer"),T=g==null?m:Io(g),_=y==null?m:Io(y),m=new w(b,v+"leave",g,n,h),m.target=T,m.relatedTarget=_,b=null,ps(h)===u&&(w=new w(x,v+"enter",y,n,h),w.target=_,w.relatedTarget=T,b=w),T=b,g&&y)t:{for(w=g,x=y,v=0,_=w;_;_=lo(_))v++;for(_=0,b=x;b;b=lo(b))_++;for(;0<v-_;)w=lo(w),v--;for(;0<_-v;)x=lo(x),_--;for(;v--;){if(w===x||x!==null&&w===x.alternate)break t;w=lo(w),x=lo(x)}w=null}else w=null;g!==null&&Xx(p,m,g,w,!1),y!==null&&T!==null&&Xx(p,T,y,w,!0)}}e:{if(m=u?Io(u):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var S=CD;else if(Gx(m))if(wb)S=RD;else{S=AD;var I=ND}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(S=kD);if(S&&(S=S(t,u))){xb(p,S,n,h);break e}I&&I(t,m,u),t==="focusout"&&(I=m._wrapperState)&&I.controlled&&m.type==="number"&&gm(m,"number",m.value)}switch(I=u?Io(u):window,t){case"focusin":(Gx(I)||I.contentEditable==="true")&&(_o=I,Nm=u,Sl=null);break;case"focusout":Sl=Nm=_o=null;break;case"mousedown":Am=!0;break;case"contextmenu":case"mouseup":case"dragend":Am=!1,Jx(p,n,h);break;case"selectionchange":if(MD)break;case"keydown":case"keyup":Jx(p,n,h)}var E;if(My)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else wo?yb(t,n)&&(R="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(gb&&n.locale!=="ko"&&(wo||R!=="onCompositionStart"?R==="onCompositionEnd"&&wo&&(E=mb()):(pi=h,Ry="value"in pi?pi.value:pi.textContent,wo=!0)),I=Rd(u,R),0<I.length&&(R=new $x(R,t,null,n,h),p.push({event:R,listeners:I}),E?R.data=E:(E=vb(n),E!==null&&(R.data=E)))),(E=TD?ID(t,n):SD(t,n))&&(u=Rd(u,"onBeforeInput"),0<u.length&&(h=new $x("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:u}),h.data=E))}kb(p,e)})}function Kl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Rd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Vl(t,n),s!=null&&r.unshift(Kl(t,s,i)),s=Vl(t,e),s!=null&&r.push(Kl(t,s,i))),t=t.return}return r}function lo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xx(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Vl(n,s),l!=null&&o.unshift(Kl(n,l,a))):i||(l=Vl(n,s),l!=null&&o.push(Kl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var OD=/\r\n?/g,jD=/\u0000|\uFFFD/g;function Zx(t){return(typeof t=="string"?t:""+t).replace(OD,`
`).replace(jD,"")}function Sc(t,e,n){if(e=Zx(e),Zx(t)!==e&&n)throw Error(L(425))}function Pd(){}var km=null,Rm=null;function Pm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Dm=typeof setTimeout=="function"?setTimeout:void 0,$D=typeof clearTimeout=="function"?clearTimeout:void 0,ew=typeof Promise=="function"?Promise:void 0,VD=typeof queueMicrotask=="function"?queueMicrotask:typeof ew<"u"?function(t){return ew.resolve(null).then(t).catch(BD)}:Dm;function BD(t){setTimeout(function(){throw t})}function mp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Gl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Gl(e)}function Ti(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function tw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var wa=Math.random().toString(36).slice(2),sr="__reactFiber$"+wa,Jl="__reactProps$"+wa,jr="__reactContainer$"+wa,Mm="__reactEvents$"+wa,qD="__reactListeners$"+wa,GD="__reactHandles$"+wa;function ps(t){var e=t[sr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[jr]||n[sr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=tw(t);t!==null;){if(n=t[sr])return n;t=tw(t)}return e}t=n,n=t.parentNode}return null}function Mu(t){return t=t[sr]||t[jr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Io(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function Uh(t){return t[Jl]||null}var Lm=[],So=-1;function Gi(t){return{current:t}}function ke(t){0>So||(t.current=Lm[So],Lm[So]=null,So--)}function Se(t,e){So++,Lm[So]=t.current,t.current=e}var ki={},jt=Gi(ki),dn=Gi(!1),ks=ki;function Qo(t,e){var n=t.type.contextTypes;if(!n)return ki;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function hn(t){return t=t.childContextTypes,t!=null}function Dd(){ke(dn),ke(jt)}function nw(t,e,n){if(jt.current!==ki)throw Error(L(168));Se(jt,e),Se(dn,n)}function Pb(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(L(108,NP(t)||"Unknown",i));return $e({},n,r)}function Md(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ki,ks=jt.current,Se(jt,t),Se(dn,dn.current),!0}function rw(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=Pb(t,e,ks),r.__reactInternalMemoizedMergedChildContext=t,ke(dn),ke(jt),Se(jt,t)):ke(dn),Se(dn,n)}var Cr=null,Fh=!1,gp=!1;function Db(t){Cr===null?Cr=[t]:Cr.push(t)}function HD(t){Fh=!0,Db(t)}function Hi(){if(!gp&&Cr!==null){gp=!0;var t=0,e=xe;try{var n=Cr;for(xe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Cr=null,Fh=!1}catch(i){throw Cr!==null&&(Cr=Cr.slice(t+1)),ib(Cy,Hi),i}finally{xe=e,gp=!1}}return null}var bo=[],Eo=0,Ld=null,Ud=0,kn=[],Rn=0,Rs=null,Nr=1,Ar="";function is(t,e){bo[Eo++]=Ud,bo[Eo++]=Ld,Ld=t,Ud=e}function Mb(t,e,n){kn[Rn++]=Nr,kn[Rn++]=Ar,kn[Rn++]=Rs,Rs=t;var r=Nr;t=Ar;var i=32-Wn(r)-1;r&=~(1<<i),n+=1;var s=32-Wn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Nr=1<<32-Wn(e)+i|n<<i|r,Ar=s+t}else Nr=1<<s|n<<i|r,Ar=t}function Uy(t){t.return!==null&&(is(t,1),Mb(t,1,0))}function Fy(t){for(;t===Ld;)Ld=bo[--Eo],bo[Eo]=null,Ud=bo[--Eo],bo[Eo]=null;for(;t===Rs;)Rs=kn[--Rn],kn[Rn]=null,Ar=kn[--Rn],kn[Rn]=null,Nr=kn[--Rn],kn[Rn]=null}var In=null,wn=null,Me=!1,Hn=null;function Lb(t,e){var n=Dn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function iw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,In=t,wn=Ti(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,In=t,wn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Rs!==null?{id:Nr,overflow:Ar}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Dn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,In=t,wn=null,!0):!1;default:return!1}}function Um(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fm(t){if(Me){var e=wn;if(e){var n=e;if(!iw(t,e)){if(Um(t))throw Error(L(418));e=Ti(n.nextSibling);var r=In;e&&iw(t,e)?Lb(r,n):(t.flags=t.flags&-4097|2,Me=!1,In=t)}}else{if(Um(t))throw Error(L(418));t.flags=t.flags&-4097|2,Me=!1,In=t}}}function sw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;In=t}function bc(t){if(t!==In)return!1;if(!Me)return sw(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Pm(t.type,t.memoizedProps)),e&&(e=wn)){if(Um(t))throw Ub(),Error(L(418));for(;e;)Lb(t,e),e=Ti(e.nextSibling)}if(sw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){wn=Ti(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}wn=null}}else wn=In?Ti(t.stateNode.nextSibling):null;return!0}function Ub(){for(var t=wn;t;)t=Ti(t.nextSibling)}function Xo(){wn=In=null,Me=!1}function Oy(t){Hn===null?Hn=[t]:Hn.push(t)}var zD=zr.ReactCurrentBatchConfig;function Ga(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function Ec(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ow(t){var e=t._init;return e(t._payload)}function Fb(t){function e(x,v){if(t){var _=x.deletions;_===null?(x.deletions=[v],x.flags|=16):_.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function i(x,v){return x=Ei(x,v),x.index=0,x.sibling=null,x}function s(x,v,_){return x.index=_,t?(_=x.alternate,_!==null?(_=_.index,_<v?(x.flags|=2,v):_):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,v,_,b){return v===null||v.tag!==6?(v=Ip(_,x.mode,b),v.return=x,v):(v=i(v,_),v.return=x,v)}function l(x,v,_,b){var S=_.type;return S===xo?h(x,v,_.props.children,b,_.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===li&&ow(S)===v.type)?(b=i(v,_.props),b.ref=Ga(x,v,_),b.return=x,b):(b=ld(_.type,_.key,_.props,null,x.mode,b),b.ref=Ga(x,v,_),b.return=x,b)}function u(x,v,_,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==_.containerInfo||v.stateNode.implementation!==_.implementation?(v=Sp(_,x.mode,b),v.return=x,v):(v=i(v,_.children||[]),v.return=x,v)}function h(x,v,_,b,S){return v===null||v.tag!==7?(v=Ss(_,x.mode,b,S),v.return=x,v):(v=i(v,_),v.return=x,v)}function p(x,v,_){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Ip(""+v,x.mode,_),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case mc:return _=ld(v.type,v.key,v.props,null,x.mode,_),_.ref=Ga(x,null,v),_.return=x,_;case vo:return v=Sp(v,x.mode,_),v.return=x,v;case li:var b=v._init;return p(x,b(v._payload),_)}if(ul(v)||ja(v))return v=Ss(v,x.mode,_,null),v.return=x,v;Ec(x,v)}return null}function m(x,v,_,b){var S=v!==null?v.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return S!==null?null:a(x,v,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case mc:return _.key===S?l(x,v,_,b):null;case vo:return _.key===S?u(x,v,_,b):null;case li:return S=_._init,m(x,v,S(_._payload),b)}if(ul(_)||ja(_))return S!==null?null:h(x,v,_,b,null);Ec(x,_)}return null}function g(x,v,_,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return x=x.get(_)||null,a(v,x,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case mc:return x=x.get(b.key===null?_:b.key)||null,l(v,x,b,S);case vo:return x=x.get(b.key===null?_:b.key)||null,u(v,x,b,S);case li:var I=b._init;return g(x,v,_,I(b._payload),S)}if(ul(b)||ja(b))return x=x.get(_)||null,h(v,x,b,S,null);Ec(v,b)}return null}function y(x,v,_,b){for(var S=null,I=null,E=v,R=v=0,F=null;E!==null&&R<_.length;R++){E.index>R?(F=E,E=null):F=E.sibling;var M=m(x,E,_[R],b);if(M===null){E===null&&(E=F);break}t&&E&&M.alternate===null&&e(x,E),v=s(M,v,R),I===null?S=M:I.sibling=M,I=M,E=F}if(R===_.length)return n(x,E),Me&&is(x,R),S;if(E===null){for(;R<_.length;R++)E=p(x,_[R],b),E!==null&&(v=s(E,v,R),I===null?S=E:I.sibling=E,I=E);return Me&&is(x,R),S}for(E=r(x,E);R<_.length;R++)F=g(E,x,R,_[R],b),F!==null&&(t&&F.alternate!==null&&E.delete(F.key===null?R:F.key),v=s(F,v,R),I===null?S=F:I.sibling=F,I=F);return t&&E.forEach(function(Q){return e(x,Q)}),Me&&is(x,R),S}function w(x,v,_,b){var S=ja(_);if(typeof S!="function")throw Error(L(150));if(_=S.call(_),_==null)throw Error(L(151));for(var I=S=null,E=v,R=v=0,F=null,M=_.next();E!==null&&!M.done;R++,M=_.next()){E.index>R?(F=E,E=null):F=E.sibling;var Q=m(x,E,M.value,b);if(Q===null){E===null&&(E=F);break}t&&E&&Q.alternate===null&&e(x,E),v=s(Q,v,R),I===null?S=Q:I.sibling=Q,I=Q,E=F}if(M.done)return n(x,E),Me&&is(x,R),S;if(E===null){for(;!M.done;R++,M=_.next())M=p(x,M.value,b),M!==null&&(v=s(M,v,R),I===null?S=M:I.sibling=M,I=M);return Me&&is(x,R),S}for(E=r(x,E);!M.done;R++,M=_.next())M=g(E,x,R,M.value,b),M!==null&&(t&&M.alternate!==null&&E.delete(M.key===null?R:M.key),v=s(M,v,R),I===null?S=M:I.sibling=M,I=M);return t&&E.forEach(function(ne){return e(x,ne)}),Me&&is(x,R),S}function T(x,v,_,b){if(typeof _=="object"&&_!==null&&_.type===xo&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case mc:e:{for(var S=_.key,I=v;I!==null;){if(I.key===S){if(S=_.type,S===xo){if(I.tag===7){n(x,I.sibling),v=i(I,_.props.children),v.return=x,x=v;break e}}else if(I.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===li&&ow(S)===I.type){n(x,I.sibling),v=i(I,_.props),v.ref=Ga(x,I,_),v.return=x,x=v;break e}n(x,I);break}else e(x,I);I=I.sibling}_.type===xo?(v=Ss(_.props.children,x.mode,b,_.key),v.return=x,x=v):(b=ld(_.type,_.key,_.props,null,x.mode,b),b.ref=Ga(x,v,_),b.return=x,x=b)}return o(x);case vo:e:{for(I=_.key;v!==null;){if(v.key===I)if(v.tag===4&&v.stateNode.containerInfo===_.containerInfo&&v.stateNode.implementation===_.implementation){n(x,v.sibling),v=i(v,_.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=Sp(_,x.mode,b),v.return=x,x=v}return o(x);case li:return I=_._init,T(x,v,I(_._payload),b)}if(ul(_))return y(x,v,_,b);if(ja(_))return w(x,v,_,b);Ec(x,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,v!==null&&v.tag===6?(n(x,v.sibling),v=i(v,_),v.return=x,x=v):(n(x,v),v=Ip(_,x.mode,b),v.return=x,x=v),o(x)):n(x,v)}return T}var Zo=Fb(!0),Ob=Fb(!1),Fd=Gi(null),Od=null,Co=null,jy=null;function $y(){jy=Co=Od=null}function Vy(t){var e=Fd.current;ke(Fd),t._currentValue=e}function Om(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Oo(t,e){Od=t,jy=Co=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(an=!0),t.firstContext=null)}function Un(t){var e=t._currentValue;if(jy!==t)if(t={context:t,memoizedValue:e,next:null},Co===null){if(Od===null)throw Error(L(308));Co=t,Od.dependencies={lanes:0,firstContext:t}}else Co=Co.next=t;return e}var ms=null;function By(t){ms===null?ms=[t]:ms.push(t)}function jb(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,By(e)):(n.next=i.next,i.next=n),e.interleaved=n,$r(t,r)}function $r(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ui=!1;function qy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $b(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ii(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,$r(t,n)}return i=r.interleaved,i===null?(e.next=e,By(r)):(e.next=i.next,i.next=e),r.interleaved=e,$r(t,n)}function nd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ny(t,n)}}function aw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function jd(t,e,n,r){var i=t.updateQueue;ui=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,h=u=l=null,a=s;do{var m=a.lane,g=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=t,w=a;switch(m=e,g=n,w.tag){case 1:if(y=w.payload,typeof y=="function"){p=y.call(g,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,m=typeof y=="function"?y.call(g,p,m):y,m==null)break e;p=$e({},p,m);break e;case 2:ui=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else g={eventTime:g,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=g,l=p):h=h.next=g,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);if(h===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ds|=o,t.lanes=o,t.memoizedState=p}}function lw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(L(191,i));i.call(r)}}}var Lu={},yr=Gi(Lu),Yl=Gi(Lu),Ql=Gi(Lu);function gs(t){if(t===Lu)throw Error(L(174));return t}function Gy(t,e){switch(Se(Ql,e),Se(Yl,t),Se(yr,Lu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:vm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=vm(e,t)}ke(yr),Se(yr,e)}function ea(){ke(yr),ke(Yl),ke(Ql)}function Vb(t){gs(Ql.current);var e=gs(yr.current),n=vm(e,t.type);e!==n&&(Se(Yl,t),Se(yr,n))}function Hy(t){Yl.current===t&&(ke(yr),ke(Yl))}var Oe=Gi(0);function $d(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var yp=[];function zy(){for(var t=0;t<yp.length;t++)yp[t]._workInProgressVersionPrimary=null;yp.length=0}var rd=zr.ReactCurrentDispatcher,vp=zr.ReactCurrentBatchConfig,Ps=0,je=null,nt=null,lt=null,Vd=!1,bl=!1,Xl=0,WD=0;function Pt(){throw Error(L(321))}function Wy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Qn(t[n],e[n]))return!1;return!0}function Ky(t,e,n,r,i,s){if(Ps=s,je=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rd.current=t===null||t.memoizedState===null?QD:XD,t=n(r,i),bl){s=0;do{if(bl=!1,Xl=0,25<=s)throw Error(L(301));s+=1,lt=nt=null,e.updateQueue=null,rd.current=ZD,t=n(r,i)}while(bl)}if(rd.current=Bd,e=nt!==null&&nt.next!==null,Ps=0,lt=nt=je=null,Vd=!1,e)throw Error(L(300));return t}function Jy(){var t=Xl!==0;return Xl=0,t}function ir(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?je.memoizedState=lt=t:lt=lt.next=t,lt}function Fn(){if(nt===null){var t=je.alternate;t=t!==null?t.memoizedState:null}else t=nt.next;var e=lt===null?je.memoizedState:lt.next;if(e!==null)lt=e,nt=t;else{if(t===null)throw Error(L(310));nt=t,t={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},lt===null?je.memoizedState=lt=t:lt=lt.next=t}return lt}function Zl(t,e){return typeof e=="function"?e(t):e}function xp(t){var e=Fn(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=nt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var h=u.lane;if((Ps&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,je.lanes|=h,Ds|=h}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Qn(r,e.memoizedState)||(an=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,je.lanes|=s,Ds|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function wp(t){var e=Fn(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Qn(s,e.memoizedState)||(an=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Bb(){}function qb(t,e){var n=je,r=Fn(),i=e(),s=!Qn(r.memoizedState,i);if(s&&(r.memoizedState=i,an=!0),r=r.queue,Yy(zb.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||lt!==null&&lt.memoizedState.tag&1){if(n.flags|=2048,eu(9,Hb.bind(null,n,r,i,e),void 0,null),dt===null)throw Error(L(349));Ps&30||Gb(n,e,i)}return i}function Gb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=je.updateQueue,e===null?(e={lastEffect:null,stores:null},je.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Hb(t,e,n,r){e.value=n,e.getSnapshot=r,Wb(e)&&Kb(t)}function zb(t,e,n){return n(function(){Wb(e)&&Kb(t)})}function Wb(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Qn(t,n)}catch{return!0}}function Kb(t){var e=$r(t,1);e!==null&&Kn(e,t,1,-1)}function uw(t){var e=ir();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zl,lastRenderedState:t},e.queue=t,t=t.dispatch=YD.bind(null,je,t),[e.memoizedState,t]}function eu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=je.updateQueue,e===null?(e={lastEffect:null,stores:null},je.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Jb(){return Fn().memoizedState}function id(t,e,n,r){var i=ir();je.flags|=t,i.memoizedState=eu(1|e,n,void 0,r===void 0?null:r)}function Oh(t,e,n,r){var i=Fn();r=r===void 0?null:r;var s=void 0;if(nt!==null){var o=nt.memoizedState;if(s=o.destroy,r!==null&&Wy(r,o.deps)){i.memoizedState=eu(e,n,s,r);return}}je.flags|=t,i.memoizedState=eu(1|e,n,s,r)}function cw(t,e){return id(8390656,8,t,e)}function Yy(t,e){return Oh(2048,8,t,e)}function Yb(t,e){return Oh(4,2,t,e)}function Qb(t,e){return Oh(4,4,t,e)}function Xb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Zb(t,e,n){return n=n!=null?n.concat([t]):null,Oh(4,4,Xb.bind(null,e,t),n)}function Qy(){}function eE(t,e){var n=Fn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function tE(t,e){var n=Fn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function nE(t,e,n){return Ps&21?(Qn(n,e)||(n=ab(),je.lanes|=n,Ds|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,an=!0),t.memoizedState=n)}function KD(t,e){var n=xe;xe=n!==0&&4>n?n:4,t(!0);var r=vp.transition;vp.transition={};try{t(!1),e()}finally{xe=n,vp.transition=r}}function rE(){return Fn().memoizedState}function JD(t,e,n){var r=bi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},iE(t))sE(e,n);else if(n=jb(t,e,n,r),n!==null){var i=Wt();Kn(n,t,r,i),oE(n,e,r)}}function YD(t,e,n){var r=bi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(iE(t))sE(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Qn(a,o)){var l=e.interleaved;l===null?(i.next=i,By(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=jb(t,e,i,r),n!==null&&(i=Wt(),Kn(n,t,r,i),oE(n,e,r))}}function iE(t){var e=t.alternate;return t===je||e!==null&&e===je}function sE(t,e){bl=Vd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function oE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ny(t,n)}}var Bd={readContext:Un,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},QD={readContext:Un,useCallback:function(t,e){return ir().memoizedState=[t,e===void 0?null:e],t},useContext:Un,useEffect:cw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,id(4194308,4,Xb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return id(4194308,4,t,e)},useInsertionEffect:function(t,e){return id(4,2,t,e)},useMemo:function(t,e){var n=ir();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ir();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=JD.bind(null,je,t),[r.memoizedState,t]},useRef:function(t){var e=ir();return t={current:t},e.memoizedState=t},useState:uw,useDebugValue:Qy,useDeferredValue:function(t){return ir().memoizedState=t},useTransition:function(){var t=uw(!1),e=t[0];return t=KD.bind(null,t[1]),ir().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=je,i=ir();if(Me){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),dt===null)throw Error(L(349));Ps&30||Gb(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,cw(zb.bind(null,r,s,t),[t]),r.flags|=2048,eu(9,Hb.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=ir(),e=dt.identifierPrefix;if(Me){var n=Ar,r=Nr;n=(r&~(1<<32-Wn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Xl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=WD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},XD={readContext:Un,useCallback:eE,useContext:Un,useEffect:Yy,useImperativeHandle:Zb,useInsertionEffect:Yb,useLayoutEffect:Qb,useMemo:tE,useReducer:xp,useRef:Jb,useState:function(){return xp(Zl)},useDebugValue:Qy,useDeferredValue:function(t){var e=Fn();return nE(e,nt.memoizedState,t)},useTransition:function(){var t=xp(Zl)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:Bb,useSyncExternalStore:qb,useId:rE,unstable_isNewReconciler:!1},ZD={readContext:Un,useCallback:eE,useContext:Un,useEffect:Yy,useImperativeHandle:Zb,useInsertionEffect:Yb,useLayoutEffect:Qb,useMemo:tE,useReducer:wp,useRef:Jb,useState:function(){return wp(Zl)},useDebugValue:Qy,useDeferredValue:function(t){var e=Fn();return nt===null?e.memoizedState=t:nE(e,nt.memoizedState,t)},useTransition:function(){var t=wp(Zl)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:Bb,useSyncExternalStore:qb,useId:rE,unstable_isNewReconciler:!1};function qn(t,e){if(t&&t.defaultProps){e=$e({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function jm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:$e({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var jh={isMounted:function(t){return(t=t._reactInternals)?Xs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Wt(),i=bi(t),s=Mr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ii(t,s,i),e!==null&&(Kn(e,t,i,r),nd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Wt(),i=bi(t),s=Mr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ii(t,s,i),e!==null&&(Kn(e,t,i,r),nd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Wt(),r=bi(t),i=Mr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ii(t,i,r),e!==null&&(Kn(e,t,r,n),nd(e,t,r))}};function dw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!zl(n,r)||!zl(i,s):!0}function aE(t,e,n){var r=!1,i=ki,s=e.contextType;return typeof s=="object"&&s!==null?s=Un(s):(i=hn(e)?ks:jt.current,r=e.contextTypes,s=(r=r!=null)?Qo(t,i):ki),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=jh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function hw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&jh.enqueueReplaceState(e,e.state,null)}function $m(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},qy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Un(s):(s=hn(e)?ks:jt.current,i.context=Qo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(jm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&jh.enqueueReplaceState(i,i.state,null),jd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ta(t,e){try{var n="",r=e;do n+=CP(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function _p(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Vm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var e2=typeof WeakMap=="function"?WeakMap:Map;function lE(t,e,n){n=Mr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Gd||(Gd=!0,Qm=r),Vm(t,e)},n}function uE(t,e,n){n=Mr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Vm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Vm(t,e),typeof r!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function fw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new e2;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=p2.bind(null,t,e,n),e.then(t,t))}function pw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function mw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mr(-1,1),e.tag=2,Ii(n,e,1))),n.lanes|=1),t)}var t2=zr.ReactCurrentOwner,an=!1;function qt(t,e,n,r){e.child=t===null?Ob(e,null,n,r):Zo(e,t.child,n,r)}function gw(t,e,n,r,i){n=n.render;var s=e.ref;return Oo(e,i),r=Ky(t,e,n,r,s,i),n=Jy(),t!==null&&!an?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Vr(t,e,i)):(Me&&n&&Uy(e),e.flags|=1,qt(t,e,r,i),e.child)}function yw(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!sv(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,cE(t,e,s,r,i)):(t=ld(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:zl,n(o,r)&&t.ref===e.ref)return Vr(t,e,i)}return e.flags|=1,t=Ei(s,r),t.ref=e.ref,t.return=e,e.child=t}function cE(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(zl(s,r)&&t.ref===e.ref)if(an=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(an=!0);else return e.lanes=t.lanes,Vr(t,e,i)}return Bm(t,e,n,r,i)}function dE(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(Ao,vn),vn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Se(Ao,vn),vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Se(Ao,vn),vn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Se(Ao,vn),vn|=r;return qt(t,e,i,n),e.child}function hE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Bm(t,e,n,r,i){var s=hn(n)?ks:jt.current;return s=Qo(e,s),Oo(e,i),n=Ky(t,e,n,r,s,i),r=Jy(),t!==null&&!an?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Vr(t,e,i)):(Me&&r&&Uy(e),e.flags|=1,qt(t,e,n,i),e.child)}function vw(t,e,n,r,i){if(hn(n)){var s=!0;Md(e)}else s=!1;if(Oo(e,i),e.stateNode===null)sd(t,e),aE(e,n,r),$m(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Un(u):(u=hn(n)?ks:jt.current,u=Qo(e,u));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&hw(e,o,r,u),ui=!1;var m=e.memoizedState;o.state=m,jd(e,r,o,i),l=e.memoizedState,a!==r||m!==l||dn.current||ui?(typeof h=="function"&&(jm(e,n,h,r),l=e.memoizedState),(a=ui||dw(e,n,a,r,m,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,$b(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:qn(e.type,a),o.props=u,p=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Un(l):(l=hn(n)?ks:jt.current,l=Qo(e,l));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&hw(e,o,r,l),ui=!1,m=e.memoizedState,o.state=m,jd(e,r,o,i);var y=e.memoizedState;a!==p||m!==y||dn.current||ui?(typeof g=="function"&&(jm(e,n,g,r),y=e.memoizedState),(u=ui||dw(e,n,u,r,m,y,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return qm(t,e,n,r,s,i)}function qm(t,e,n,r,i,s){hE(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&rw(e,n,!1),Vr(t,e,s);r=e.stateNode,t2.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Zo(e,t.child,null,s),e.child=Zo(e,null,a,s)):qt(t,e,a,s),e.memoizedState=r.state,i&&rw(e,n,!0),e.child}function fE(t){var e=t.stateNode;e.pendingContext?nw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&nw(t,e.context,!1),Gy(t,e.containerInfo)}function xw(t,e,n,r,i){return Xo(),Oy(i),e.flags|=256,qt(t,e,n,r),e.child}var Gm={dehydrated:null,treeContext:null,retryLane:0};function Hm(t){return{baseLanes:t,cachePool:null,transitions:null}}function pE(t,e,n){var r=e.pendingProps,i=Oe.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Se(Oe,i&1),t===null)return Fm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Bh(o,r,0,null),t=Ss(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Hm(n),e.memoizedState=Gm,t):Xy(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return n2(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ei(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ei(a,s):(s=Ss(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Hm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Gm,r}return s=t.child,t=s.sibling,r=Ei(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Xy(t,e){return e=Bh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Cc(t,e,n,r){return r!==null&&Oy(r),Zo(e,t.child,null,n),t=Xy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function n2(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=_p(Error(L(422))),Cc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Bh({mode:"visible",children:r.children},i,0,null),s=Ss(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Zo(e,t.child,null,o),e.child.memoizedState=Hm(o),e.memoizedState=Gm,s);if(!(e.mode&1))return Cc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(L(419)),r=_p(s,r,void 0),Cc(t,e,o,r)}if(a=(o&t.childLanes)!==0,an||a){if(r=dt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,$r(t,i),Kn(r,t,i,-1))}return iv(),r=_p(Error(L(421))),Cc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=m2.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,wn=Ti(i.nextSibling),In=e,Me=!0,Hn=null,t!==null&&(kn[Rn++]=Nr,kn[Rn++]=Ar,kn[Rn++]=Rs,Nr=t.id,Ar=t.overflow,Rs=e),e=Xy(e,r.children),e.flags|=4096,e)}function ww(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Om(t.return,e,n)}function Tp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function mE(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(qt(t,e,r.children,n),r=Oe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ww(t,n,e);else if(t.tag===19)ww(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Se(Oe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&$d(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Tp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&$d(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Tp(e,!0,n,null,s);break;case"together":Tp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Vr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ds|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=Ei(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ei(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function r2(t,e,n){switch(e.tag){case 3:fE(e),Xo();break;case 5:Vb(e);break;case 1:hn(e.type)&&Md(e);break;case 4:Gy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Se(Fd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Se(Oe,Oe.current&1),e.flags|=128,null):n&e.child.childLanes?pE(t,e,n):(Se(Oe,Oe.current&1),t=Vr(t,e,n),t!==null?t.sibling:null);Se(Oe,Oe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return mE(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Se(Oe,Oe.current),r)break;return null;case 22:case 23:return e.lanes=0,dE(t,e,n)}return Vr(t,e,n)}var gE,zm,yE,vE;gE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zm=function(){};yE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,gs(yr.current);var s=null;switch(n){case"input":i=pm(t,i),r=pm(t,r),s=[];break;case"select":i=$e({},i,{value:void 0}),r=$e({},r,{value:void 0}),s=[];break;case"textarea":i=ym(t,i),r=ym(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Pd)}xm(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(jl.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(jl.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ce("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};vE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ha(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Dt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function i2(t,e,n){var r=e.pendingProps;switch(Fy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(e),null;case 1:return hn(e.type)&&Dd(),Dt(e),null;case 3:return r=e.stateNode,ea(),ke(dn),ke(jt),zy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(bc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Hn!==null&&(eg(Hn),Hn=null))),zm(t,e),Dt(e),null;case 5:Hy(e);var i=gs(Ql.current);if(n=e.type,t!==null&&e.stateNode!=null)yE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return Dt(e),null}if(t=gs(yr.current),bc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[sr]=e,r[Jl]=s,t=(e.mode&1)!==0,n){case"dialog":Ce("cancel",r),Ce("close",r);break;case"iframe":case"object":case"embed":Ce("load",r);break;case"video":case"audio":for(i=0;i<dl.length;i++)Ce(dl[i],r);break;case"source":Ce("error",r);break;case"img":case"image":case"link":Ce("error",r),Ce("load",r);break;case"details":Ce("toggle",r);break;case"input":Ax(r,s),Ce("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ce("invalid",r);break;case"textarea":Rx(r,s),Ce("invalid",r)}xm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Sc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Sc(r.textContent,a,t),i=["children",""+a]):jl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ce("scroll",r)}switch(n){case"input":gc(r),kx(r,s,!0);break;case"textarea":gc(r),Px(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Pd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zS(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[sr]=e,t[Jl]=r,gE(t,e,!1,!1),e.stateNode=t;e:{switch(o=wm(n,r),n){case"dialog":Ce("cancel",t),Ce("close",t),i=r;break;case"iframe":case"object":case"embed":Ce("load",t),i=r;break;case"video":case"audio":for(i=0;i<dl.length;i++)Ce(dl[i],t);i=r;break;case"source":Ce("error",t),i=r;break;case"img":case"image":case"link":Ce("error",t),Ce("load",t),i=r;break;case"details":Ce("toggle",t),i=r;break;case"input":Ax(t,r),i=pm(t,r),Ce("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=$e({},r,{value:void 0}),Ce("invalid",t);break;case"textarea":Rx(t,r),i=ym(t,r),Ce("invalid",t);break;default:i=r}xm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?JS(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&WS(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&$l(t,l):typeof l=="number"&&$l(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ce("scroll",t):l!=null&&Ty(t,s,l,o))}switch(n){case"input":gc(t),kx(t,r,!1);break;case"textarea":gc(t),Px(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ai(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Mo(t,!!r.multiple,s,!1):r.defaultValue!=null&&Mo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Pd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Dt(e),null;case 6:if(t&&e.stateNode!=null)vE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=gs(Ql.current),gs(yr.current),bc(e)){if(r=e.stateNode,n=e.memoizedProps,r[sr]=e,(s=r.nodeValue!==n)&&(t=In,t!==null))switch(t.tag){case 3:Sc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[sr]=e,e.stateNode=r}return Dt(e),null;case 13:if(ke(Oe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&wn!==null&&e.mode&1&&!(e.flags&128))Ub(),Xo(),e.flags|=98560,s=!1;else if(s=bc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(L(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(L(317));s[sr]=e}else Xo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Dt(e),s=!1}else Hn!==null&&(eg(Hn),Hn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Oe.current&1?rt===0&&(rt=3):iv())),e.updateQueue!==null&&(e.flags|=4),Dt(e),null);case 4:return ea(),zm(t,e),t===null&&Wl(e.stateNode.containerInfo),Dt(e),null;case 10:return Vy(e.type._context),Dt(e),null;case 17:return hn(e.type)&&Dd(),Dt(e),null;case 19:if(ke(Oe),s=e.memoizedState,s===null)return Dt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ha(s,!1);else{if(rt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=$d(t),o!==null){for(e.flags|=128,Ha(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Se(Oe,Oe.current&1|2),e.child}t=t.sibling}s.tail!==null&&We()>na&&(e.flags|=128,r=!0,Ha(s,!1),e.lanes=4194304)}else{if(!r)if(t=$d(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ha(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Me)return Dt(e),null}else 2*We()-s.renderingStartTime>na&&n!==1073741824&&(e.flags|=128,r=!0,Ha(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=We(),e.sibling=null,n=Oe.current,Se(Oe,r?n&1|2:n&1),e):(Dt(e),null);case 22:case 23:return rv(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?vn&1073741824&&(Dt(e),e.subtreeFlags&6&&(e.flags|=8192)):Dt(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function s2(t,e){switch(Fy(e),e.tag){case 1:return hn(e.type)&&Dd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ea(),ke(dn),ke(jt),zy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Hy(e),null;case 13:if(ke(Oe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));Xo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ke(Oe),null;case 4:return ea(),null;case 10:return Vy(e.type._context),null;case 22:case 23:return rv(),null;case 24:return null;default:return null}}var Nc=!1,Lt=!1,o2=typeof WeakSet=="function"?WeakSet:Set,H=null;function No(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Be(t,e,r)}else n.current=null}function Wm(t,e,n){try{n()}catch(r){Be(t,e,r)}}var _w=!1;function a2(t,e){if(km=Ad,t=Ib(),Ly(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,h=0,p=t,m=null;t:for(;;){for(var g;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(g=p.firstChild)!==null;)m=p,p=g;for(;;){if(p===t)break t;if(m===n&&++u===i&&(a=o),m===s&&++h===r&&(l=o),(g=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Rm={focusedElem:t,selectionRange:n},Ad=!1,H=e;H!==null;)if(e=H,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,H=t;else for(;H!==null;){e=H;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,T=y.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?w:qn(e.type,w),T);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(b){Be(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}return y=_w,_w=!1,y}function El(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Wm(e,n,s)}i=i.next}while(i!==r)}}function $h(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Km(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function xE(t){var e=t.alternate;e!==null&&(t.alternate=null,xE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[sr],delete e[Jl],delete e[Mm],delete e[qD],delete e[GD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function wE(t){return t.tag===5||t.tag===3||t.tag===4}function Tw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||wE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Jm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Pd));else if(r!==4&&(t=t.child,t!==null))for(Jm(t,e,n),t=t.sibling;t!==null;)Jm(t,e,n),t=t.sibling}function Ym(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Ym(t,e,n),t=t.sibling;t!==null;)Ym(t,e,n),t=t.sibling}var wt=null,Gn=!1;function ni(t,e,n){for(n=n.child;n!==null;)_E(t,e,n),n=n.sibling}function _E(t,e,n){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(Ph,n)}catch{}switch(n.tag){case 5:Lt||No(n,e);case 6:var r=wt,i=Gn;wt=null,ni(t,e,n),wt=r,Gn=i,wt!==null&&(Gn?(t=wt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):wt.removeChild(n.stateNode));break;case 18:wt!==null&&(Gn?(t=wt,n=n.stateNode,t.nodeType===8?mp(t.parentNode,n):t.nodeType===1&&mp(t,n),Gl(t)):mp(wt,n.stateNode));break;case 4:r=wt,i=Gn,wt=n.stateNode.containerInfo,Gn=!0,ni(t,e,n),wt=r,Gn=i;break;case 0:case 11:case 14:case 15:if(!Lt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Wm(n,e,o),i=i.next}while(i!==r)}ni(t,e,n);break;case 1:if(!Lt&&(No(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Be(n,e,a)}ni(t,e,n);break;case 21:ni(t,e,n);break;case 22:n.mode&1?(Lt=(r=Lt)||n.memoizedState!==null,ni(t,e,n),Lt=r):ni(t,e,n);break;default:ni(t,e,n)}}function Iw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new o2),e.forEach(function(r){var i=g2.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Bn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:wt=a.stateNode,Gn=!1;break e;case 3:wt=a.stateNode.containerInfo,Gn=!0;break e;case 4:wt=a.stateNode.containerInfo,Gn=!0;break e}a=a.return}if(wt===null)throw Error(L(160));_E(s,o,i),wt=null,Gn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Be(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)TE(e,t),e=e.sibling}function TE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Bn(e,t),nr(t),r&4){try{El(3,t,t.return),$h(3,t)}catch(w){Be(t,t.return,w)}try{El(5,t,t.return)}catch(w){Be(t,t.return,w)}}break;case 1:Bn(e,t),nr(t),r&512&&n!==null&&No(n,n.return);break;case 5:if(Bn(e,t),nr(t),r&512&&n!==null&&No(n,n.return),t.flags&32){var i=t.stateNode;try{$l(i,"")}catch(w){Be(t,t.return,w)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&GS(i,s),wm(a,o);var u=wm(a,s);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?JS(i,p):h==="dangerouslySetInnerHTML"?WS(i,p):h==="children"?$l(i,p):Ty(i,h,p,u)}switch(a){case"input":mm(i,s);break;case"textarea":HS(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Mo(i,!!s.multiple,g,!1):m!==!!s.multiple&&(s.defaultValue!=null?Mo(i,!!s.multiple,s.defaultValue,!0):Mo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Jl]=s}catch(w){Be(t,t.return,w)}}break;case 6:if(Bn(e,t),nr(t),r&4){if(t.stateNode===null)throw Error(L(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(w){Be(t,t.return,w)}}break;case 3:if(Bn(e,t),nr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Gl(e.containerInfo)}catch(w){Be(t,t.return,w)}break;case 4:Bn(e,t),nr(t);break;case 13:Bn(e,t),nr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(tv=We())),r&4&&Iw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Lt=(u=Lt)||h,Bn(e,t),Lt=u):Bn(e,t),nr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(H=t,h=t.child;h!==null;){for(p=H=h;H!==null;){switch(m=H,g=m.child,m.tag){case 0:case 11:case 14:case 15:El(4,m,m.return);break;case 1:No(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(w){Be(r,n,w)}}break;case 5:No(m,m.return);break;case 22:if(m.memoizedState!==null){bw(p);continue}}g!==null?(g.return=m,H=g):bw(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=KS("display",o))}catch(w){Be(t,t.return,w)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(w){Be(t,t.return,w)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Bn(e,t),nr(t),r&4&&Iw(t);break;case 21:break;default:Bn(e,t),nr(t)}}function nr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(wE(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&($l(i,""),r.flags&=-33);var s=Tw(t);Ym(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Tw(t);Jm(t,a,o);break;default:throw Error(L(161))}}catch(l){Be(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function l2(t,e,n){H=t,IE(t)}function IE(t,e,n){for(var r=(t.mode&1)!==0;H!==null;){var i=H,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Nc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Lt;a=Nc;var u=Lt;if(Nc=o,(Lt=l)&&!u)for(H=i;H!==null;)o=H,l=o.child,o.tag===22&&o.memoizedState!==null?Ew(i):l!==null?(l.return=o,H=l):Ew(i);for(;s!==null;)H=s,IE(s),s=s.sibling;H=i,Nc=a,Lt=u}Sw(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,H=s):Sw(t)}}function Sw(t){for(;H!==null;){var e=H;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Lt||$h(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Lt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:qn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&lw(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}lw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Gl(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}Lt||e.flags&512&&Km(e)}catch(m){Be(e,e.return,m)}}if(e===t){H=null;break}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}}function bw(t){for(;H!==null;){var e=H;if(e===t){H=null;break}var n=e.sibling;if(n!==null){n.return=e.return,H=n;break}H=e.return}}function Ew(t){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{$h(4,e)}catch(l){Be(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Be(e,i,l)}}var s=e.return;try{Km(e)}catch(l){Be(e,s,l)}break;case 5:var o=e.return;try{Km(e)}catch(l){Be(e,o,l)}}}catch(l){Be(e,e.return,l)}if(e===t){H=null;break}var a=e.sibling;if(a!==null){a.return=e.return,H=a;break}H=e.return}}var u2=Math.ceil,qd=zr.ReactCurrentDispatcher,Zy=zr.ReactCurrentOwner,Ln=zr.ReactCurrentBatchConfig,fe=0,dt=null,et=null,St=0,vn=0,Ao=Gi(0),rt=0,tu=null,Ds=0,Vh=0,ev=0,Cl=null,on=null,tv=0,na=1/0,Er=null,Gd=!1,Qm=null,Si=null,Ac=!1,mi=null,Hd=0,Nl=0,Xm=null,od=-1,ad=0;function Wt(){return fe&6?We():od!==-1?od:od=We()}function bi(t){return t.mode&1?fe&2&&St!==0?St&-St:zD.transition!==null?(ad===0&&(ad=ab()),ad):(t=xe,t!==0||(t=window.event,t=t===void 0?16:pb(t.type)),t):1}function Kn(t,e,n,r){if(50<Nl)throw Nl=0,Xm=null,Error(L(185));Pu(t,n,r),(!(fe&2)||t!==dt)&&(t===dt&&(!(fe&2)&&(Vh|=n),rt===4&&di(t,St)),fn(t,r),n===1&&fe===0&&!(e.mode&1)&&(na=We()+500,Fh&&Hi()))}function fn(t,e){var n=t.callbackNode;zP(t,e);var r=Nd(t,t===dt?St:0);if(r===0)n!==null&&Lx(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Lx(n),e===1)t.tag===0?HD(Cw.bind(null,t)):Db(Cw.bind(null,t)),VD(function(){!(fe&6)&&Hi()}),n=null;else{switch(lb(r)){case 1:n=Cy;break;case 4:n=sb;break;case 16:n=Cd;break;case 536870912:n=ob;break;default:n=Cd}n=RE(n,SE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function SE(t,e){if(od=-1,ad=0,fe&6)throw Error(L(327));var n=t.callbackNode;if(jo()&&t.callbackNode!==n)return null;var r=Nd(t,t===dt?St:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=zd(t,r);else{e=r;var i=fe;fe|=2;var s=EE();(dt!==t||St!==e)&&(Er=null,na=We()+500,Is(t,e));do try{h2();break}catch(a){bE(t,a)}while(1);$y(),qd.current=s,fe=i,et!==null?e=0:(dt=null,St=0,e=rt)}if(e!==0){if(e===2&&(i=bm(t),i!==0&&(r=i,e=Zm(t,i))),e===1)throw n=tu,Is(t,0),di(t,r),fn(t,We()),n;if(e===6)di(t,r);else{if(i=t.current.alternate,!(r&30)&&!c2(i)&&(e=zd(t,r),e===2&&(s=bm(t),s!==0&&(r=s,e=Zm(t,s))),e===1))throw n=tu,Is(t,0),di(t,r),fn(t,We()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:ss(t,on,Er);break;case 3:if(di(t,r),(r&130023424)===r&&(e=tv+500-We(),10<e)){if(Nd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Wt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Dm(ss.bind(null,t,on,Er),e);break}ss(t,on,Er);break;case 4:if(di(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Wn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=We()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*u2(r/1960))-r,10<r){t.timeoutHandle=Dm(ss.bind(null,t,on,Er),r);break}ss(t,on,Er);break;case 5:ss(t,on,Er);break;default:throw Error(L(329))}}}return fn(t,We()),t.callbackNode===n?SE.bind(null,t):null}function Zm(t,e){var n=Cl;return t.current.memoizedState.isDehydrated&&(Is(t,e).flags|=256),t=zd(t,e),t!==2&&(e=on,on=n,e!==null&&eg(e)),t}function eg(t){on===null?on=t:on.push.apply(on,t)}function c2(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Qn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function di(t,e){for(e&=~ev,e&=~Vh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Wn(e),r=1<<n;t[n]=-1,e&=~r}}function Cw(t){if(fe&6)throw Error(L(327));jo();var e=Nd(t,0);if(!(e&1))return fn(t,We()),null;var n=zd(t,e);if(t.tag!==0&&n===2){var r=bm(t);r!==0&&(e=r,n=Zm(t,r))}if(n===1)throw n=tu,Is(t,0),di(t,e),fn(t,We()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ss(t,on,Er),fn(t,We()),null}function nv(t,e){var n=fe;fe|=1;try{return t(e)}finally{fe=n,fe===0&&(na=We()+500,Fh&&Hi())}}function Ms(t){mi!==null&&mi.tag===0&&!(fe&6)&&jo();var e=fe;fe|=1;var n=Ln.transition,r=xe;try{if(Ln.transition=null,xe=1,t)return t()}finally{xe=r,Ln.transition=n,fe=e,!(fe&6)&&Hi()}}function rv(){vn=Ao.current,ke(Ao)}function Is(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$D(n)),et!==null)for(n=et.return;n!==null;){var r=n;switch(Fy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Dd();break;case 3:ea(),ke(dn),ke(jt),zy();break;case 5:Hy(r);break;case 4:ea();break;case 13:ke(Oe);break;case 19:ke(Oe);break;case 10:Vy(r.type._context);break;case 22:case 23:rv()}n=n.return}if(dt=t,et=t=Ei(t.current,null),St=vn=e,rt=0,tu=null,ev=Vh=Ds=0,on=Cl=null,ms!==null){for(e=0;e<ms.length;e++)if(n=ms[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ms=null}return t}function bE(t,e){do{var n=et;try{if($y(),rd.current=Bd,Vd){for(var r=je.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Vd=!1}if(Ps=0,lt=nt=je=null,bl=!1,Xl=0,Zy.current=null,n===null||n.return===null){rt=1,tu=e,et=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=St,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=pw(o);if(g!==null){g.flags&=-257,mw(g,o,a,s,e),g.mode&1&&fw(s,u,e),e=g,l=u;var y=e.updateQueue;if(y===null){var w=new Set;w.add(l),e.updateQueue=w}else y.add(l);break e}else{if(!(e&1)){fw(s,u,e),iv();break e}l=Error(L(426))}}else if(Me&&a.mode&1){var T=pw(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),mw(T,o,a,s,e),Oy(ta(l,a));break e}}s=l=ta(l,a),rt!==4&&(rt=2),Cl===null?Cl=[s]:Cl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=lE(s,l,e);aw(s,x);break e;case 1:a=l;var v=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Si===null||!Si.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=uE(s,a,e);aw(s,b);break e}}s=s.return}while(s!==null)}NE(n)}catch(S){e=S,et===n&&n!==null&&(et=n=n.return);continue}break}while(1)}function EE(){var t=qd.current;return qd.current=Bd,t===null?Bd:t}function iv(){(rt===0||rt===3||rt===2)&&(rt=4),dt===null||!(Ds&268435455)&&!(Vh&268435455)||di(dt,St)}function zd(t,e){var n=fe;fe|=2;var r=EE();(dt!==t||St!==e)&&(Er=null,Is(t,e));do try{d2();break}catch(i){bE(t,i)}while(1);if($y(),fe=n,qd.current=r,et!==null)throw Error(L(261));return dt=null,St=0,rt}function d2(){for(;et!==null;)CE(et)}function h2(){for(;et!==null&&!FP();)CE(et)}function CE(t){var e=kE(t.alternate,t,vn);t.memoizedProps=t.pendingProps,e===null?NE(t):et=e,Zy.current=null}function NE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=s2(n,e),n!==null){n.flags&=32767,et=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rt=6,et=null;return}}else if(n=i2(n,e,vn),n!==null){et=n;return}if(e=e.sibling,e!==null){et=e;return}et=e=t}while(e!==null);rt===0&&(rt=5)}function ss(t,e,n){var r=xe,i=Ln.transition;try{Ln.transition=null,xe=1,f2(t,e,n,r)}finally{Ln.transition=i,xe=r}return null}function f2(t,e,n,r){do jo();while(mi!==null);if(fe&6)throw Error(L(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(WP(t,s),t===dt&&(et=dt=null,St=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ac||(Ac=!0,RE(Cd,function(){return jo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ln.transition,Ln.transition=null;var o=xe;xe=1;var a=fe;fe|=4,Zy.current=null,a2(t,n),TE(n,t),DD(Rm),Ad=!!km,Rm=km=null,t.current=n,l2(n),OP(),fe=a,xe=o,Ln.transition=s}else t.current=n;if(Ac&&(Ac=!1,mi=t,Hd=i),s=t.pendingLanes,s===0&&(Si=null),VP(n.stateNode),fn(t,We()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Gd)throw Gd=!1,t=Qm,Qm=null,t;return Hd&1&&t.tag!==0&&jo(),s=t.pendingLanes,s&1?t===Xm?Nl++:(Nl=0,Xm=t):Nl=0,Hi(),null}function jo(){if(mi!==null){var t=lb(Hd),e=Ln.transition,n=xe;try{if(Ln.transition=null,xe=16>t?16:t,mi===null)var r=!1;else{if(t=mi,mi=null,Hd=0,fe&6)throw Error(L(331));var i=fe;for(fe|=4,H=t.current;H!==null;){var s=H,o=s.child;if(H.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(H=u;H!==null;){var h=H;switch(h.tag){case 0:case 11:case 15:El(8,h,s)}var p=h.child;if(p!==null)p.return=h,H=p;else for(;H!==null;){h=H;var m=h.sibling,g=h.return;if(xE(h),h===u){H=null;break}if(m!==null){m.return=g,H=m;break}H=g}}}var y=s.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var T=w.sibling;w.sibling=null,w=T}while(w!==null)}}H=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,H=o;else e:for(;H!==null;){if(s=H,s.flags&2048)switch(s.tag){case 0:case 11:case 15:El(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,H=x;break e}H=s.return}}var v=t.current;for(H=v;H!==null;){o=H;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,H=_;else e:for(o=v;H!==null;){if(a=H,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:$h(9,a)}}catch(S){Be(a,a.return,S)}if(a===o){H=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,H=b;break e}H=a.return}}if(fe=i,Hi(),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(Ph,t)}catch{}r=!0}return r}finally{xe=n,Ln.transition=e}}return!1}function Nw(t,e,n){e=ta(n,e),e=lE(t,e,1),t=Ii(t,e,1),e=Wt(),t!==null&&(Pu(t,1,e),fn(t,e))}function Be(t,e,n){if(t.tag===3)Nw(t,t,n);else for(;e!==null;){if(e.tag===3){Nw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Si===null||!Si.has(r))){t=ta(n,t),t=uE(e,t,1),e=Ii(e,t,1),t=Wt(),e!==null&&(Pu(e,1,t),fn(e,t));break}}e=e.return}}function p2(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Wt(),t.pingedLanes|=t.suspendedLanes&n,dt===t&&(St&n)===n&&(rt===4||rt===3&&(St&130023424)===St&&500>We()-tv?Is(t,0):ev|=n),fn(t,e)}function AE(t,e){e===0&&(t.mode&1?(e=xc,xc<<=1,!(xc&130023424)&&(xc=4194304)):e=1);var n=Wt();t=$r(t,e),t!==null&&(Pu(t,e,n),fn(t,n))}function m2(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),AE(t,n)}function g2(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),AE(t,n)}var kE;kE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||dn.current)an=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return an=!1,r2(t,e,n);an=!!(t.flags&131072)}else an=!1,Me&&e.flags&1048576&&Mb(e,Ud,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;sd(t,e),t=e.pendingProps;var i=Qo(e,jt.current);Oo(e,n),i=Ky(null,e,r,t,i,n);var s=Jy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hn(r)?(s=!0,Md(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,qy(e),i.updater=jh,e.stateNode=i,i._reactInternals=e,$m(e,r,t,n),e=qm(null,e,r,!0,s,n)):(e.tag=0,Me&&s&&Uy(e),qt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(sd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=v2(r),t=qn(r,t),i){case 0:e=Bm(null,e,r,t,n);break e;case 1:e=vw(null,e,r,t,n);break e;case 11:e=gw(null,e,r,t,n);break e;case 14:e=yw(null,e,r,qn(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:qn(r,i),Bm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:qn(r,i),vw(t,e,r,i,n);case 3:e:{if(fE(e),t===null)throw Error(L(387));r=e.pendingProps,s=e.memoizedState,i=s.element,$b(t,e),jd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ta(Error(L(423)),e),e=xw(t,e,r,n,i);break e}else if(r!==i){i=ta(Error(L(424)),e),e=xw(t,e,r,n,i);break e}else for(wn=Ti(e.stateNode.containerInfo.firstChild),In=e,Me=!0,Hn=null,n=Ob(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xo(),r===i){e=Vr(t,e,n);break e}qt(t,e,r,n)}e=e.child}return e;case 5:return Vb(e),t===null&&Fm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Pm(r,i)?o=null:s!==null&&Pm(r,s)&&(e.flags|=32),hE(t,e),qt(t,e,o,n),e.child;case 6:return t===null&&Fm(e),null;case 13:return pE(t,e,n);case 4:return Gy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Zo(e,null,r,n):qt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:qn(r,i),gw(t,e,r,i,n);case 7:return qt(t,e,e.pendingProps,n),e.child;case 8:return qt(t,e,e.pendingProps.children,n),e.child;case 12:return qt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Se(Fd,r._currentValue),r._currentValue=o,s!==null)if(Qn(s.value,o)){if(s.children===i.children&&!dn.current){e=Vr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Mr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Om(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(L(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Om(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}qt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Oo(e,n),i=Un(i),r=r(i),e.flags|=1,qt(t,e,r,n),e.child;case 14:return r=e.type,i=qn(r,e.pendingProps),i=qn(r.type,i),yw(t,e,r,i,n);case 15:return cE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:qn(r,i),sd(t,e),e.tag=1,hn(r)?(t=!0,Md(e)):t=!1,Oo(e,n),aE(e,r,i),$m(e,r,i,n),qm(null,e,r,!0,t,n);case 19:return mE(t,e,n);case 22:return dE(t,e,n)}throw Error(L(156,e.tag))};function RE(t,e){return ib(t,e)}function y2(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(t,e,n,r){return new y2(t,e,n,r)}function sv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function v2(t){if(typeof t=="function")return sv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Sy)return 11;if(t===by)return 14}return 2}function Ei(t,e){var n=t.alternate;return n===null?(n=Dn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ld(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")sv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case xo:return Ss(n.children,i,s,e);case Iy:o=8,i|=8;break;case cm:return t=Dn(12,n,e,i|2),t.elementType=cm,t.lanes=s,t;case dm:return t=Dn(13,n,e,i),t.elementType=dm,t.lanes=s,t;case hm:return t=Dn(19,n,e,i),t.elementType=hm,t.lanes=s,t;case VS:return Bh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case jS:o=10;break e;case $S:o=9;break e;case Sy:o=11;break e;case by:o=14;break e;case li:o=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=Dn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ss(t,e,n,r){return t=Dn(7,t,r,e),t.lanes=n,t}function Bh(t,e,n,r){return t=Dn(22,t,r,e),t.elementType=VS,t.lanes=n,t.stateNode={isHidden:!1},t}function Ip(t,e,n){return t=Dn(6,t,null,e),t.lanes=n,t}function Sp(t,e,n){return e=Dn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function x2(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ip(0),this.expirationTimes=ip(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ip(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ov(t,e,n,r,i,s,o,a,l){return t=new x2(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Dn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qy(s),t}function w2(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function PE(t){if(!t)return ki;t=t._reactInternals;e:{if(Xs(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(hn(n))return Pb(t,n,e)}return e}function DE(t,e,n,r,i,s,o,a,l){return t=ov(n,r,!0,t,i,s,o,a,l),t.context=PE(null),n=t.current,r=Wt(),i=bi(n),s=Mr(r,i),s.callback=e??null,Ii(n,s,i),t.current.lanes=i,Pu(t,i,r),fn(t,r),t}function qh(t,e,n,r){var i=e.current,s=Wt(),o=bi(i);return n=PE(n),e.context===null?e.context=n:e.pendingContext=n,e=Mr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ii(i,e,o),t!==null&&(Kn(t,i,o,s),nd(t,i,o)),o}function Wd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Aw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function av(t,e){Aw(t,e),(t=t.alternate)&&Aw(t,e)}function _2(){return null}var ME=typeof reportError=="function"?reportError:function(t){console.error(t)};function lv(t){this._internalRoot=t}Gh.prototype.render=lv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));qh(t,e,null,null)};Gh.prototype.unmount=lv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ms(function(){qh(null,t,null,null)}),e[jr]=null}};function Gh(t){this._internalRoot=t}Gh.prototype.unstable_scheduleHydration=function(t){if(t){var e=db();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ci.length&&e!==0&&e<ci[n].priority;n++);ci.splice(n,0,t),n===0&&fb(t)}};function uv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function kw(){}function T2(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Wd(o);s.call(u)}}var o=DE(e,r,t,0,null,!1,!1,"",kw);return t._reactRootContainer=o,t[jr]=o.current,Wl(t.nodeType===8?t.parentNode:t),Ms(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Wd(l);a.call(u)}}var l=ov(t,0,!1,null,null,!1,!1,"",kw);return t._reactRootContainer=l,t[jr]=l.current,Wl(t.nodeType===8?t.parentNode:t),Ms(function(){qh(e,l,n,r)}),l}function zh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Wd(o);a.call(l)}}qh(e,o,t,i)}else o=T2(n,e,t,i,r);return Wd(o)}ub=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=cl(e.pendingLanes);n!==0&&(Ny(e,n|1),fn(e,We()),!(fe&6)&&(na=We()+500,Hi()))}break;case 13:Ms(function(){var r=$r(t,1);if(r!==null){var i=Wt();Kn(r,t,1,i)}}),av(t,1)}};Ay=function(t){if(t.tag===13){var e=$r(t,134217728);if(e!==null){var n=Wt();Kn(e,t,134217728,n)}av(t,134217728)}};cb=function(t){if(t.tag===13){var e=bi(t),n=$r(t,e);if(n!==null){var r=Wt();Kn(n,t,e,r)}av(t,e)}};db=function(){return xe};hb=function(t,e){var n=xe;try{return xe=t,e()}finally{xe=n}};Tm=function(t,e,n){switch(e){case"input":if(mm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Uh(r);if(!i)throw Error(L(90));qS(r),mm(r,i)}}}break;case"textarea":HS(t,n);break;case"select":e=n.value,e!=null&&Mo(t,!!n.multiple,e,!1)}};XS=nv;ZS=Ms;var I2={usingClientEntryPoint:!1,Events:[Mu,Io,Uh,YS,QS,nv]},za={findFiberByHostInstance:ps,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},S2={bundleType:za.bundleType,version:za.version,rendererPackageName:za.rendererPackageName,rendererConfig:za.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nb(t),t===null?null:t.stateNode},findFiberByHostInstance:za.findFiberByHostInstance||_2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kc.isDisabled&&kc.supportsFiber)try{Ph=kc.inject(S2),gr=kc}catch{}}Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I2;Nn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uv(e))throw Error(L(200));return w2(t,e,null,n)};Nn.createRoot=function(t,e){if(!uv(t))throw Error(L(299));var n=!1,r="",i=ME;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=ov(t,1,!1,null,null,n,!1,r,i),t[jr]=e.current,Wl(t.nodeType===8?t.parentNode:t),new lv(e)};Nn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=nb(e),t=t===null?null:t.stateNode,t};Nn.flushSync=function(t){return Ms(t)};Nn.hydrate=function(t,e,n){if(!Hh(e))throw Error(L(200));return zh(null,t,e,!0,n)};Nn.hydrateRoot=function(t,e,n){if(!uv(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=ME;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=DE(e,null,t,1,n??null,i,!1,s,o),t[jr]=e.current,Wl(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Gh(e)};Nn.render=function(t,e,n){if(!Hh(e))throw Error(L(200));return zh(null,t,e,!1,n)};Nn.unmountComponentAtNode=function(t){if(!Hh(t))throw Error(L(40));return t._reactRootContainer?(Ms(function(){zh(null,null,t,!1,function(){t._reactRootContainer=null,t[jr]=null})}),!0):!1};Nn.unstable_batchedUpdates=nv;Nn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hh(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return zh(t,e,n,!1,r)};Nn.version="18.3.1-next-f1338f8080-20240426";function LE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(LE)}catch(t){console.error(t)}}LE(),LS.exports=Nn;var b2=LS.exports,Rw=b2;lm.createRoot=Rw.createRoot,lm.hydrateRoot=Rw.hydrateRoot;const bp={navHome:"",navTeachers:"",navCourses:"",navVideos:"",navBlog:"",navAbout:" JoTutor",navContact:" ",login:" ",signup:" ",welcome:"",dashboard:" ",logout:" ",back:"",langConfirmTitle:" ",langConfirmMessage:"                .      ",langConfirmYes:"  ",langConfirmNo:"    ",heroButton:"  ",featuresTitle:"  JoTutor",featuresSubtitle:"        .",feature1Title:" ",feature1Desc:"        .",feature2Title:" ",feature2Desc:"      .",feature3Title:"  ",feature3Desc:"       .",howItWorksTitle:" ",howItWorksSubtitle:"      .",step1Title:"  ",step1Desc:"     .",step2Title:" ",step2Desc:"        .",step3Title:" ",step3Desc:"       .",teacherSearchTitle:"   ",teacherSearchSubtitle:"      .",searchByName:" ...",allSubjects:" ",discoverMoreTeachers:"   ",yearsExperience:" ",viewProfile:"  ",testimonialsTitle:"  ",testimonialsSubtitle:"      .",footerDescription:" JoTutor               .",footerQuickLinks:" ",footerLegal:"",footerJoinTeacher:" ",footerFAQ:" ",footerRights:"JoTutor.   .",aiPlannerTitle:"  ",aiPlannerSubtitle:"        .",subject:"",level:"",topic:" ",topicPlaceholder:":   ",generatePlan:" ",generating:" ",suggestedPlan:" ",errorEnterTopic:"   .",errorFailedPlan:"    .    .",loginWelcome:" !",email:" ",password:" ",signupTitle:"   JoTutor",signupDesc:"    .",signupNewStudent:"  ",signupJoinTeacher:" ",onboardingStep1Title:"  ",onboardingStep1Desc:"  .",userTypeStudent:"",userTypeParent:" ",onboardingStep2Title:"     ",onboardingStep2Desc:"    .",serviceType1Desc:"      .",serviceType2Desc:"     .",serviceType3Desc:"      .",serviceType4Desc:"    .",serviceType5Desc:"      .",onboardingStep3Title:"   ",onboardingStep3Desc:"   .",educationStage1Desc:"     .",educationStage2Desc:"     .",educationStage3Desc:"      .",educationStage4Desc:"   SAT IG.",educationStage5Desc:"     .",onboardingStep4Title:"   ",onboardingStep4Desc:"   .",gradePlaceholder:":     ",onboardingStep5Title:"   ",onboardingStep5Desc:"   .",onboardingStep6Title:"       ",onboardingStep6Desc:"    .",onboardingStep6Title_languages:"     ",onboardingStep6Desc_languages:"   .",onboardingStep7Title:" ",onboardingStep7Desc:"    .",fullName:" ",age:"",phone:" ",onboardingStep8Title:" !",onboardingStep8Desc:"     ",verificationMessage:"         24 .",agreeToTerms:"     .",next:"",finishSignup:" ",errorGradeRequired:"   .",errorSubjectsRequired:"     .",errorFullNameRequired:"   .",errorAgeRequired:"  .",errorPhoneRequired:"   .",errorEmailInvalid:"    .",errorPasswordInvalid:"      6   .",errorAgreeToTerms:"    .",errorEmailInUse:"        .",errorSignupGeneric:"     .    .",errorInvalidCredentials:"      .",myCourses:"",enrolledCoursesTitle:"  ",noEnrolledCourses:"      .",suggestedCoursesTitle:"  ",suggestedCoursesDesc:"     .",noSuggestedCourses:"    .",noSuggestedCoursesDesc:"       .",dashboardProfile:" ",dashboardWallet:"",dashboardAI:" ",privacyTitle:" ",termsTitle:" ",paymentRefundTitle:"  ",contactTitle:" ",contactInfo:" ",contactFormTitle:"  ",yourName:" ",yourEmail:" ",yourMessage:"",sendMessage:" ",aboutTitle:" JoTutor",aboutVisionTitle:"",aboutMissionTitle:"",aboutTeacherCommunityTitle:"  ",aboutWhyJoTutorTitle:" JoTutor",joinTeacherTitle:"     ",joinTeacherDesc:"          .",applyNow:" ",faqTitle:" ",blogTitle:" JoTutor",by:"  ",sessions:"",hours:"/ ",readMore:" ",backToBlog:"  ",videosTitle:"  ",backToVideos:"  ",coursesPreviewTitle:" ",coursesPreviewSubtitle:"      .",discoverMoreCourses:"   ",coursesTitle:" ",coursesSubtitle:"       .",category:"",allCategories:" ",allLevels:" ",sortBy:" ",sortDefault:"",sortPriceAsc:":    ",sortPriceDesc:":    ",noCoursesFound:"    .",noCoursesFoundDesc:"        .",bookCourse:"  ",courseTeacher:"",courseDuration:"",courseLevel:"",jod:".",usd:"$",sar:".",paymentTitle:"  ",courseSummary:" ",totalAmount:" ",paymentMethod:" ",cardHolder:"  ",cardNumber:" ",expiryDate:" ",cvv:"CVV",confirmPayment:" ",paymentSuccess:"  !",chatbotTooltip:"!  Mr.Pincel.    ",chatbotWelcome:" !  Mr.Pincel   .    ",chatbotTitle:"Mr.Pincel -  ",chatbotRecommendedCourses:"  :",chatbotTyping:"Mr.Pincel ...",chatbotPlaceholder:" Mr.Pincel...",chatbotSend:"",adminPanelTitle:"  ",adminNavContent:" ",adminNavHero:"  ",adminNavOnboarding:" ",adminNavUsers:" ",adminNavStaff:" ",adminNavPayments:" ",adminNavTeachers:" ",adminNavCourses:" ",adminNavTestimonials:" ",adminNavBlog:" ",adminNavWhatsapp:"  "},Ep={navHome:"Home",navTeachers:"Teachers",navCourses:"Courses",navVideos:"Videos",navBlog:"Blog",navAbout:"About Us",navContact:"Contact Us",login:"Login",signup:"Sign Up",welcome:"Welcome",dashboard:"Dashboard",logout:"Logout",back:"Back",langConfirmTitle:"Change Language",langConfirmMessage:"When changing the language, you may notice a change in content to ensure access to the best knowledge based on the language. Are you sure you want to change the language?",langConfirmYes:"Yes, change language",langConfirmNo:"No, keep current language",heroButton:"Start Your Learning Journey",featuresTitle:"Why Choose JoTutor?",featuresSubtitle:"We offer a unique learning experience tailored to your needs.",feature1Title:"Expert Tutors",feature1Desc:"A selection of the best teachers to help you excel academically.",feature2Title:"Integrated Curricula",feature2Desc:"Comprehensive coverage of all local and international curricula.",feature3Title:"Flexible Scheduling",feature3Desc:"Choose the times that suit you for your online private lessons.",howItWorksTitle:"How It Works",howItWorksSubtitle:"Start your educational journey in three simple steps.",step1Title:"Find a Tutor",step1Desc:"Browse our list of tutors and choose the best one for your needs.",step2Title:"Book a Session",step2Desc:"Select a suitable time and easily book your study session.",step3Title:"Start Learning",step3Desc:"Join your online session and begin your journey to excellence.",teacherSearchTitle:"Find Your Perfect Tutor",teacherSearchSubtitle:"Connect with the best private tutors in Jordan.",searchByName:"Search by name...",allSubjects:"All Subjects",discoverMoreTeachers:"Discover More Teachers",yearsExperience:"years of experience",viewProfile:"View Profile",testimonialsTitle:"What They Say About Us",testimonialsSubtitle:"The opinions of our students and their parents are our most valuable testimony.",footerDescription:"JoTutor is your gateway to excellent education, providing you with the best private tutors to help you achieve your academic goals.",footerQuickLinks:"Quick Links",footerLegal:"Legal",footerJoinTeacher:"Join as a Teacher",footerFAQ:"FAQ",footerRights:"JoTutor. All rights reserved.",aiPlannerTitle:"AI Lesson Planner",aiPlannerSubtitle:"Use AI to create comprehensive lesson plans in seconds.",subject:"Subject",level:"Level",topic:"Lesson Topic",topicPlaceholder:"e.g., Introduction to Algebra",generatePlan:"Generate Plan",generating:"Generating",suggestedPlan:"Suggested Plan",errorEnterTopic:"Please enter a lesson topic.",errorFailedPlan:"Failed to generate plan. Please try again.",loginWelcome:"Welcome Back!",email:"Email",password:"Password",signupTitle:"Join the JoTutor Community",signupDesc:"Choose the account type that suits you.",signupNewStudent:"Register as a New Student",signupJoinTeacher:"Join as a Teacher",onboardingStep1Title:"Who will be using the account?",onboardingStep1Desc:"Select the user type.",userTypeStudent:"Student",userTypeParent:"Parent",onboardingStep2Title:"What service are you looking for?",onboardingStep2Desc:"This will help us personalize your experience.",serviceType1Desc:"To strengthen basic skills in reading, writing, and math.",serviceType2Desc:"For help with homework and exam preparation.",serviceType3Desc:"To get extra support in specific subjects.",serviceType4Desc:"To prepare for international and university entrance exams.",serviceType5Desc:"To learn new languages or improve your language skills.",onboardingStep3Title:"What is the academic stage?",onboardingStep3Desc:"Choose the current educational stage.",educationStage1Desc:"From kindergarten to 3rd grade.",educationStage2Desc:"From 4th to 6th grade.",educationStage3Desc:"From 7th to 12th grade.",educationStage4Desc:"Preparation for IB, SAT, IG.",educationStage5Desc:"For university students or lifelong learners.",onboardingStep4Title:"What is the grade level?",onboardingStep4Desc:"Enter the current grade level.",gradePlaceholder:"e.g., 10th Grade, 1st Year University",onboardingStep5Title:"What curriculum are you following?",onboardingStep5Desc:"Choose the curriculum you are studying.",onboardingStep6Title:"Which subjects do you need help with?",onboardingStep6Desc:"You can choose more than one subject.",onboardingStep6Title_languages:"What languages would you like to learn?",onboardingStep6Desc_languages:"Choose the languages that interest you.",onboardingStep7Title:"Your Personal Information",onboardingStep7Desc:"It will only take a minute.",fullName:"Full Name",age:"Age",phone:"Phone Number",onboardingStep8Title:"Final Step!",onboardingStep8Desc:"Are you ready to start your learning journey?",verificationMessage:"We will review your application and one of our educational consultants will contact you within 24 hours.",agreeToTerms:"I agree to the Terms & Conditions and Privacy Policy.",next:"Next",finishSignup:"Finish Signup",errorGradeRequired:"Please enter your grade.",errorSubjectsRequired:"Please select at least one subject.",errorFullNameRequired:"Please enter your full name.",errorAgeRequired:"Please enter your age.",errorPhoneRequired:"Please enter your phone number.",errorEmailInvalid:"Please enter a valid email.",errorPasswordInvalid:"Password must be at least 6 characters.",errorAgreeToTerms:"You must agree to the terms and conditions.",errorEmailInUse:"This email address is already in use by another account.",errorSignupGeneric:"An unexpected error occurred during signup. Please try again.",errorInvalidCredentials:"Invalid email or password.",myCourses:"My Courses",enrolledCoursesTitle:"Enrolled Courses",noEnrolledCourses:"You are not currently enrolled in any courses.",suggestedCoursesTitle:"Suggested Courses",suggestedCoursesDesc:"Courses suggested for you based on your interests.",noSuggestedCourses:"No suggested courses at the moment.",noSuggestedCoursesDesc:"Explore our course library to find what suits you.",dashboardProfile:"Profile",dashboardWallet:"Wallet",dashboardAI:"AI Assistant",privacyTitle:"Privacy Policy",termsTitle:"Terms of Service",paymentRefundTitle:"Payment & Refund Policy",contactTitle:"Contact Us",contactInfo:"Contact Information",contactFormTitle:"Send Us a Message",yourName:"Your Name",yourEmail:"Your Email",yourMessage:"Your Message",sendMessage:"Send Message",aboutTitle:"About JoTutor",aboutVisionTitle:"Our Vision",aboutMissionTitle:"Our Mission",aboutTeacherCommunityTitle:"Our Teacher Community",aboutWhyJoTutorTitle:"Why JoTutor?",joinTeacherTitle:"Join Our Team of Excellent Teachers",joinTeacherDesc:"If you are a passionate and experienced teacher, we would love to hear from you.",applyNow:"Apply Now",faqTitle:"Frequently Asked Questions",blogTitle:"JoTutor Blog",by:"By",sessions:"Sessions",hours:"Hrs/Session",readMore:"Read More",backToBlog:"Back to Blog",videosTitle:"Short Educational Videos",backToVideos:"Back to Videos",coursesPreviewTitle:"Latest Courses",coursesPreviewSubtitle:"Browse the latest courses added in various fields.",discoverMoreCourses:"Discover More Courses",coursesTitle:"Explore Our Courses",coursesSubtitle:"Find the perfect course that fits your educational goals.",category:"Category",allCategories:"All Categories",allLevels:"All Levels",sortBy:"Sort By",sortDefault:"Default",sortPriceAsc:"Price: Low to High",sortPriceDesc:"Price: High to Low",noCoursesFound:"No courses found.",noCoursesFoundDesc:"Try adjusting your search filters to find what you are looking for.",bookCourse:"Book Course Now",courseTeacher:"Teacher",courseDuration:"Duration",courseLevel:"Level",jod:"JOD",usd:"USD",sar:"SAR",paymentTitle:"Complete Your Payment",courseSummary:"Course Summary",totalAmount:"Total Amount",paymentMethod:"Payment Method",cardHolder:"Cardholder Name",cardNumber:"Card Number",expiryDate:"Expiry Date",cvv:"CVV",confirmPayment:"Confirm Payment",paymentSuccess:"Payment successful!",chatbotTooltip:"Hi! Need help finding a course? I'm here to assist!",chatbotWelcome:"Welcome to the JoTutor Assistant! How can I help you find the perfect course today?",chatbotTitle:"JoTutor Assistant",chatbotRecommendedCourses:"Recommended courses for you:",chatbotTyping:"Typing...",chatbotPlaceholder:"Ask about a course...",chatbotSend:"Send",adminPanelTitle:"Admin Control Panel",adminNavContent:"Content Management",adminNavHero:"Home Banner",adminNavOnboarding:"Onboarding Steps",adminNavUsers:"User Management",adminNavStaff:"Staff Management",adminNavPayments:"Payments",adminNavTeachers:"Teacher Management",adminNavCourses:"Course Management",adminNavTestimonials:"Testimonials",adminNavBlog:"Blog Management",adminNavWhatsapp:"WhatsApp Courses"},Wa=.71,E2=({onNavigate:t,onLoginClick:e,onSignupClick:n,isLoggedIn:r,isAdmin:i,username:s,onLogout:o,currency:a,onCurrencyChange:l,language:u,onLanguageChange:h,isTranslating:p,onBack:m,canGoBack:g,strings:y})=>{const w=[...u==="en"?[{label:y.navHome,page:"home"}]:[],{label:y.navTeachers,page:"teachers"},{label:y.navCourses,page:"courses"},{label:y.navVideos,page:"videos"},{label:y.navBlog,page:"blog"},{label:y.navAbout,page:"about"},{label:y.navContact,page:"contact"}];return c.jsx("header",{className:"bg-white shadow-md sticky top-0 z-40",children:c.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-2 sm:py-3",children:[c.jsxs("div",{className:"flex justify-between items-center gap-2",children:[c.jsx("button",{onClick:()=>t("home"),className:"flex items-center shrink-0",children:c.jsx("img",{src:"https://i.ibb.co/XxGsLR3D/15.png",alt:"JoTutor Logo",className:"h-10 sm:h-12 w-auto"})}),c.jsx("nav",{className:"hidden lg:flex items-center gap-6 xl:gap-10",children:w.map(T=>c.jsx("button",{onClick:()=>t(T.page),className:"text-gray-600 hover:text-green-500 font-bold transition-colors text-sm whitespace-nowrap",children:T.label},T.page))}),c.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[g&&m&&c.jsxs("button",{onClick:m,className:"flex items-center justify-center bg-gray-100 text-gray-700 hover:bg-gray-200 w-8 h-8 sm:w-auto sm:px-3 sm:py-1.5 rounded-full transition-colors font-bold text-xs shrink-0",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transform rtl:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{className:"hidden sm:inline mr-1",children:y.back})]}),c.jsx("button",{onClick:h,disabled:p,className:"border border-gray-300 rounded-full w-8 h-8 sm:w-10 sm:h-10 text-[10px] sm:text-xs font-black text-gray-700 hover:bg-gray-100 transition-colors flex items-center justify-center shrink-0",children:u==="ar"?"EN":"AR"}),c.jsxs("button",{onClick:l,className:"border border-gray-300 rounded-full px-2 sm:px-3 py-1 sm:py-1.5 text-[10px] sm:text-xs font-bold text-gray-700 hover:bg-gray-100 transition-colors flex items-center gap-1 shrink-0",children:[c.jsx("span",{className:"text-green-500 hidden sm:inline",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-4 sm:w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),c.jsx("span",{children:a})]}),c.jsx("div",{className:"flex items-center gap-2 border-r pr-2 rtl:border-r-0 rtl:border-l rtl:pl-2 border-gray-200",children:r?c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[c.jsx("button",{onClick:()=>t(i?"admin-dashboard":"dashboard"),className:"bg-blue-900 text-white font-bold py-1.5 px-3 sm:px-5 rounded-full text-[10px] sm:text-xs whitespace-nowrap",children:y.dashboard}),c.jsx("button",{onClick:o,className:"bg-red-500 text-white font-bold py-1.5 px-3 sm:px-5 rounded-full text-[10px] sm:text-xs whitespace-nowrap hidden sm:block",children:y.logout})]}):c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:e,className:"text-green-600 font-black text-xs sm:text-sm whitespace-nowrap px-1",children:y.login}),c.jsx("button",{onClick:n,className:"bg-green-500 text-white font-black py-1.5 px-3 sm:py-2 sm:px-6 rounded-full text-xs sm:text-sm whitespace-nowrap shadow-sm",children:y.signup})]})})]})]}),c.jsx("div",{className:"lg:hidden flex overflow-x-auto py-2 gap-4 text-[10px] font-bold text-gray-500 scrollbar-hide no-scrollbar",children:w.map(T=>c.jsx("button",{onClick:()=>t(T.page),className:"whitespace-nowrap px-1",children:T.label},T.page))})]})})},C2=({onSignupClick:t,heroSlides:e=[],content:n,strings:r,language:i})=>{const[s,o]=N.useState(0),a=i==="en";N.useEffect(()=>{if(e.length<=1)return;const p=setInterval(()=>{o(m=>(m+1)%e.length)},5e3);return()=>clearInterval(p)},[e]);const l=e[s],u=({text:p})=>{if(!p)return null;const m=p.split(" "),g=m.pop(),y=m.join(" ");return c.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-6xl font-extrabold text-white leading-tight px-2",style:{textShadow:"0 2px 4px rgba(0,0,0,0.5)"},children:[y," ",c.jsx("span",{className:"text-green-400",children:g})]})},h=[{value:(a?n==null?void 0:n.statsTeacherCount_en:n==null?void 0:n.statsTeacherCount)||"+750",label:(a?n==null?void 0:n.statsTeacherLabel_en:n==null?void 0:n.statsTeacherLabel)||(a?"Tutors":" "),icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 sm:h-8 sm:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{value:(a?n==null?void 0:n.statsAcceptanceRate_en:n==null?void 0:n.statsAcceptanceRate)||"25%",label:(a?n==null?void 0:n.statsAcceptanceLabel_en:n==null?void 0:n.statsAcceptanceLabel)||(a?"Acceptance Rate":" "),icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 sm:h-8 sm:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138z"})})},{value:(a?n==null?void 0:n.statsStudentCount_en:n==null?void 0:n.statsStudentCount)||"+5000",label:(a?n==null?void 0:n.statsStudentLabel_en:n==null?void 0:n.statsStudentLabel)||(a?"Students":" "),icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 sm:h-8 sm:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})},{value:(a?n==null?void 0:n.statsSatisfactionRate_en:n==null?void 0:n.statsSatisfactionRate)||"95%",label:(a?n==null?void 0:n.statsSatisfactionLabel_en:n==null?void 0:n.statsSatisfactionLabel)||(a?"Satisfaction":"  "),icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 sm:h-8 sm:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})}];return c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("section",{className:"relative text-white min-h-[450px] sm:min-h-[500px]",children:[c.jsxs("div",{className:"absolute inset-0 z-0",children:[e.map((p,m)=>c.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-opacity duration-1000 ease-in-out",style:{backgroundImage:`url(${a&&p.imageUrl_en?p.imageUrl_en:p.imageUrl})`,opacity:m===s?1:0}},m)),c.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),c.jsx("div",{className:"container mx-auto px-4 py-16 sm:py-20 lg:py-32 flex flex-col items-center justify-center relative z-10",children:c.jsxs("div",{className:"w-full max-w-4xl text-center",children:[l&&c.jsx(u,{text:a&&l.title_en?l.title_en:l.title}),l&&c.jsx("p",{className:"mt-4 sm:mt-6 text-sm sm:text-lg text-gray-200 max-w-2xl mx-auto px-4",style:{textShadow:"0 1px 3px rgba(0,0,0,0.5)"},children:a&&l.description_en?l.description_en:l.description}),c.jsx("div",{className:"mt-6 sm:mt-8 flex justify-center",children:c.jsxs("button",{onClick:t,className:"bg-green-500 text-white font-bold text-base sm:text-lg py-2.5 px-6 sm:py-3 sm:px-8 rounded-full hover:bg-green-600 transition-transform duration-300 transform hover:scale-105 shadow-xl flex items-center space-x-2 space-x-reverse",children:[c.jsx("span",{children:r.heroButton}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l-5 5 5 5m-5-5h12"})})]})})]})})]}),c.jsx("div",{className:"bg-gray-50 py-10 sm:py-16 border-b border-gray-200 relative z-20",children:c.jsx("div",{className:"container mx-auto px-4 sm:px-6",children:c.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-8 md:gap-12",children:h.map((p,m)=>c.jsxs("div",{className:"aspect-square rounded-full border-2 sm:border-4 border-green-500 bg-white flex flex-col items-center justify-center shadow-lg transform hover:scale-105 transition-transform duration-300 group text-center p-2 mx-auto w-full max-w-[140px] sm:max-w-[180px]",children:[c.jsx("div",{className:"text-green-500 mb-1 sm:mb-2 group-hover:scale-110 transition-transform",children:p.icon}),c.jsx("h3",{className:"text-lg sm:text-2xl md:text-3xl font-extrabold text-blue-900 leading-tight",children:p.value}),c.jsx("p",{className:"text-[8px] sm:text-xs md:text-sm text-gray-600 font-bold mt-0.5 sm:mt-1",children:p.label})]},m))})})})]})},N2=({icon:t,title:e,description:n})=>c.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 transform hover:-translate-y-2",children:[c.jsx("div",{className:"flex items-center justify-center h-16 w-16 rounded-full bg-green-100 text-green-500 mb-6",children:t}),c.jsx("h3",{className:"text-2xl font-bold text-blue-900 mb-3",children:e}),c.jsx("p",{className:"text-gray-600",children:n})]}),A2=({content:t,strings:e})=>{const n=[{icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),title:(t==null?void 0:t.feature1Title)||e.feature1Title,description:(t==null?void 0:t.feature1Desc)||e.feature1Desc},{icon:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{d:"M12 14l9-5-9-5-9 5 9 5z"}),c.jsx("path",{d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l9-5-9-5-9 5 9 5zm0 0v6"})]}),title:(t==null?void 0:t.feature2Title)||e.feature2Title,description:(t==null?void 0:t.feature2Desc)||e.feature2Desc},{icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),title:(t==null?void 0:t.feature3Title)||e.feature3Title,description:(t==null?void 0:t.feature3Desc)||e.feature3Desc}];return c.jsx("section",{id:"features",className:"py-20 bg-gray-50",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h2",{className:"text-4xl font-extrabold text-blue-900",children:(t==null?void 0:t.featuresTitle)||e.featuresTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:(t==null?void 0:t.featuresSubtitle)||e.featuresSubtitle})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:n.map((r,i)=>c.jsx(N2,{...r},i))})]})})},k2=({content:t,strings:e})=>{const n=[{number:"01",title:(t==null?void 0:t.step1Title)||e.step1Title,description:(t==null?void 0:t.step1Desc)||e.step1Desc},{number:"02",title:(t==null?void 0:t.step2Title)||e.step2Title,description:(t==null?void 0:t.step2Desc)||e.step2Desc},{number:"03",title:(t==null?void 0:t.step3Title)||e.step3Title,description:(t==null?void 0:t.step3Desc)||e.step3Desc}];return c.jsx("section",{className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h2",{className:"text-4xl font-extrabold text-blue-900",children:(t==null?void 0:t.howItWorksTitle)||e.howItWorksTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:(t==null?void 0:t.howItWorksSubtitle)||e.howItWorksSubtitle})]}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"hidden md:block absolute top-1/2 left-0 w-full h-0.5 bg-green-200",style:{transform:"translateY(-50%)"}}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12 relative",children:n.map(r=>c.jsxs("div",{className:"text-center p-6 bg-gray-50 rounded-lg shadow-md",children:[c.jsx("div",{className:"flex items-center justify-center mx-auto h-20 w-20 rounded-full bg-green-500 text-white font-extrabold text-3xl border-4 border-white shadow-lg mb-6",children:r.number}),c.jsx("h3",{className:"text-2xl font-bold text-blue-900 mb-3",children:r.title}),c.jsx("p",{className:"text-gray-600",children:r.description})]},r.number))})]})]})})},R2=({teacher:t,onSelect:e,strings:n,language:r,isHomePageVersion:i})=>{const s=()=>{i||e(t.id)},o="bg-white rounded-xl shadow-lg overflow-hidden transform hover:-translate-y-2 transition-transform duration-300",a=i?"":"cursor-pointer";return c.jsxs("div",{className:`${o} ${a}`,onClick:s,children:[c.jsx("div",{className:"h-64 w-full overflow-hidden bg-gray-50 flex items-center justify-center",children:c.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-full h-full object-contain"})}),c.jsxs("div",{className:"p-6",children:[c.jsx("h3",{className:"text-2xl font-bold text-blue-900 mb-2",children:t.name}),c.jsxs("p",{className:"text-gray-600 mb-4",children:[t.level,"  ",t.experience," ",n.yearsExperience]}),c.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:t.specialties.slice(0,2).map(l=>c.jsx("span",{className:"bg-green-100 text-green-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:l},l))}),c.jsx("div",{className:"flex justify-center items-center mb-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-yellow-400",children:""}),c.jsx("span",{className:"font-bold ml-1",children:t.rating}),c.jsxs("span",{className:"text-gray-500 text-sm ml-1",children:["(",t.reviews,")"]})]})}),i&&c.jsx("button",{onClick:()=>e(t.id),className:"w-full bg-blue-900 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-800 transition-colors",children:n.viewProfile})]})]})},Pw=({teachers:t,subjects:e,onSelectTeacher:n,isHomePageVersion:r,content:i,strings:s,language:o})=>{const[a,l]=N.useState(""),[u,h]=N.useState(""),p=t.filter(g=>{const y=g.name.toLowerCase().includes(a.toLowerCase()),w=u===""||g.specialties.includes(u);return y&&w}),m=r?p.slice(0,4):p;return c.jsx("section",{id:"teachers",className:"py-20 bg-gray-50",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h2",{className:"text-4xl font-extrabold text-blue-900",children:(i==null?void 0:i.teacherSearchTitle)||s.teacherSearchTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:(i==null?void 0:i.teacherSearchSubtitle)||s.teacherSearchSubtitle})]}),!r&&c.jsxs("div",{className:"max-w-3xl mx-auto mb-12 grid grid-cols-1 md:grid-cols-2 gap-4 bg-white p-4 rounded-lg shadow-md",children:[c.jsx("input",{type:"text",placeholder:s.searchByName,value:a,onChange:g=>l(g.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500"}),c.jsxs("select",{value:u,onChange:g=>h(g.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",children:[c.jsx("option",{value:"",children:s.allSubjects}),e.map(g=>c.jsx("option",{value:g,children:g},g))]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:m.map(g=>c.jsx(R2,{teacher:g,onSelect:n,strings:s,language:o,isHomePageVersion:r},g.id))}),r&&c.jsx("div",{className:"text-center mt-12",children:c.jsx("button",{onClick:()=>alert("Navigate to all teachers page!"),className:"bg-green-500 text-white font-bold text-lg py-3 px-8 rounded-full hover:bg-green-600 transition-transform duration-300 transform hover:scale-105 shadow-xl",children:(i==null?void 0:i.discoverMoreTeachers)||s.discoverMoreTeachers})})]})})},P2=({testimonials:t,content:e,strings:n})=>c.jsx("section",{className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h2",{className:"text-4xl font-extrabold text-blue-900",children:(e==null?void 0:e.testimonialsTitle)||n.testimonialsTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:(e==null?void 0:e.testimonialsSubtitle)||n.testimonialsSubtitle})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map(r=>c.jsxs("div",{className:"bg-blue-800 p-8 rounded-xl shadow-lg flex flex-col items-center text-center relative group",children:[c.jsx("div",{className:"relative",children:c.jsx("img",{src:r.avatarUrl,alt:r.name,className:"w-24 h-24 rounded-full border-4 border-green-400 object-cover mb-6 transition-all duration-500 ease-[cubic-bezier(0.68,-0.55,0.27,1.55)] transform hover:scale-[3.5] hover:rounded-lg hover:border-white hover:shadow-2xl hover:z-50 cursor-pointer relative"})}),c.jsxs("p",{className:"text-blue-200 italic mb-6 flex-grow",children:['"',r.quote,'"']}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-bold text-xl text-white",children:r.name}),c.jsx("p",{className:"text-green-400",children:r.role})]})]},r.id))})]})}),Kd=({course:t,onSelect:e,currency:n,strings:r})=>{if(!t)return null;const i=document.documentElement.lang==="en";let s=0,o="";n==="USD"?(s=t.priceUsd??(t.price?t.price*1.41:0),o=r.usd||"$"):n==="SAR"?(s=t.priceSar??(t.price?t.price*5.3:0),o=r.sar||"."):(s=t.priceJod??t.price??0,o=r.jod||".");const l=(typeof s=="number"&&!isNaN(s)?s:0).toFixed(2),u=i&&t.imageUrl_en?t.imageUrl_en:t.imageUrl;return c.jsxs("div",{onClick:e,className:"bg-white rounded-xl shadow-lg overflow-hidden transform hover:-translate-y-2 transition-transform duration-300 cursor-pointer h-full flex flex-col",children:[c.jsx("img",{src:u||"https://via.placeholder.com/400x225?text=No+Image",alt:i?t.title_en:t.title,className:"w-full h-48 object-cover"}),c.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[c.jsx("div",{className:"mb-2",children:c.jsx("span",{className:"text-sm font-semibold text-green-600 bg-green-100 px-2 py-1 rounded-full",children:i&&t.category_en||t.category})}),c.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-2 line-clamp-2 h-14",children:i&&t.title_en||t.title}),c.jsxs("p",{className:"text-gray-500 text-sm mb-2",children:[c.jsxs("span",{className:"font-semibold",children:[r.by||"",": "]}),i?t.includedSubjects_en||t.category_en||t.category:t.includedSubjects||t.category]}),c.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[t.sessionCount?c.jsxs("span",{className:"bg-green-50 text-green-700 border border-green-200 px-2 py-1 rounded text-sm font-bold shadow-sm",children:[t.sessionCount," ",r.sessions||""]}):null,t.totalHours?c.jsxs("span",{className:"bg-green-50 text-green-700 border border-green-200 px-2 py-1 rounded text-sm font-bold shadow-sm",children:[t.totalHours," ",r.hours||""]}):null]}),c.jsxs("div",{className:"mt-auto flex justify-between items-center border-t pt-3",children:[c.jsxs("span",{className:"text-xl font-bold text-blue-900",children:[o,l]}),c.jsx("span",{className:"text-sm text-gray-600",children:i&&t.duration_en||t.duration})]})]})]})},D2=({courses:t,onSelectCourse:e,onNavigate:n,currency:r,exchangeRate:i,content:s,strings:o})=>{const a=t.filter(u=>u.isFeatured),l=a.length>0?a.slice(0,4):t.slice(0,4);return c.jsx("section",{id:"courses-preview",className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h2",{className:"text-4xl font-extrabold text-blue-900",children:(s==null?void 0:s.coursesPreviewTitle)||o.coursesPreviewTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:(s==null?void 0:s.coursesPreviewSubtitle)||o.coursesPreviewSubtitle})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:l.map(u=>c.jsx(Kd,{course:u,onSelect:()=>e(u.id),currency:r,exchangeRate:i,strings:o},u.id))}),c.jsx("div",{className:"text-center mt-12",children:c.jsx("button",{onClick:()=>n("courses"),className:"bg-green-500 text-white font-bold text-lg py-3 px-10 rounded-full hover:bg-green-600 transition-all shadow-xl transform hover:-translate-y-1",children:(s==null?void 0:s.discoverMoreCourses)||o.discoverMoreCourses})})]})})};var Wh={exports:{}},UE={};function On(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var M2=On;On.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};On.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};On.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},n),this._options.unref&&this._timer.unref(),!0};On.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};On.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};On.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};On.prototype.start=On.prototype.try;On.prototype.errors=function(){return this._errors};On.prototype.attempts=function(){return this._attempts};On.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,n=0,r=0;r<this._errors.length;r++){var i=this._errors[r],s=i.message,o=(t[s]||0)+1;t[s]=o,o>=n&&(e=i,n=o)}return e};(function(t){var e=M2;t.operation=function(n){var r=t.timeouts(n);return new e(r,{forever:n&&(n.forever||n.retries===1/0),unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},t.timeouts=function(n){if(n instanceof Array)return[].concat(n);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in n)r[i]=n[i];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],o=0;o<r.retries;o++)s.push(this.createTimeout(o,r));return n&&n.forever&&!s.length&&s.push(this.createTimeout(o,r)),s.sort(function(a,l){return a-l}),s},t.createTimeout=function(n,r){var i=r.randomize?Math.random()+1:1,s=Math.round(i*Math.max(r.minTimeout,1)*Math.pow(r.factor,n));return s=Math.min(s,r.maxTimeout),s},t.wrap=function(n,r,i){if(r instanceof Array&&(i=r,r=null),!i){i=[];for(var s in n)typeof n[s]=="function"&&i.push(s)}for(var o=0;o<i.length;o++){var a=i[o],l=n[a];n[a]=(function(h){var p=t.operation(r),m=Array.prototype.slice.call(arguments,1),g=m.pop();m.push(function(y){p.retry(y)||(y&&(arguments[0]=p.mainError()),g.apply(this,arguments))}),p.attempt(function(){h.apply(n,m)})}).bind(n,l),n[a].options=r}}})(UE);var L2=UE;const U2=L2,F2=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class FE extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const O2=(t,e,n)=>{const r=n.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=r,t},j2=t=>F2.includes(t),OE=(t,e)=>new Promise((n,r)=>{e={onFailedAttempt:()=>{},retries:10,...e};const i=U2.operation(e);i.attempt(async s=>{try{n(await t(s))}catch(o){if(!(o instanceof Error)){r(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof FE)i.stop(),r(o.originalError);else if(o instanceof TypeError&&!j2(o.message))i.stop(),r(o);else{O2(o,s,e);try{await e.onFailedAttempt(o)}catch(a){r(a);return}i.retry(o)||r(i.mainError())}}})});Wh.exports=OE;Wh.exports.default=OE;var $2=Wh.exports.AbortError=FE,V2=Wh.exports;const B2=TS(V2);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let q2,G2;function H2(){return{geminiUrl:q2,vertexUrl:G2}}function z2(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=H2();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wr{}function B(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function f(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const h=l[u];f(h,e.slice(s+1),n[u])}else for(const u of l)f(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];f(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function d(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>d(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function W2(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}tg(t,i,s,0,o)}}function tg(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])tg(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,h]of Object.entries(l)){const p=[];for(const m of n.slice(r))m==="*"?p.push(u):p.push(m);f(o,p,h)}for(const u of a)delete o[u]}}else{const o=t;s in o&&tg(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cv(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K2(t){const e={},n=d(t,["operationName"]);n!=null&&f(e,["operationName"],n);const r=d(t,["resourceName"]);return r!=null&&f(e,["_url","resourceName"],r),e}function J2(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],Q2(o)),e}function Y2(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response"]);return o!=null&&f(e,["response"],X2(o)),e}function Q2(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Z2(o))),f(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function X2(t){const e={},n=d(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>eM(o))),f(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function Z2(t){const e={},n=d(t,["video"]);return n!=null&&f(e,["video"],oM(n)),e}function eM(t){const e={},n=d(t,["_self"]);return n!=null&&f(e,["video"],aM(n)),e}function tM(t){const e={},n=d(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function nM(t){const e={},n=d(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function rM(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response"]);return o!=null&&f(e,["response"],iM(o)),e}function iM(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const i=d(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function jE(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response"]);return o!=null&&f(e,["response"],sM(o)),e}function sM(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const i=d(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function oM(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],cv(r));const i=d(t,["encoding"]);return i!=null&&f(e,["mimeType"],i),e}function aM(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],cv(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Dw;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Dw||(Dw={}));var Mw;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Mw||(Mw={}));var Lw;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Lw||(Lw={}));var gi;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(gi||(gi={}));var Uw;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Uw||(Uw={}));var Fw;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Fw||(Fw={}));var Ow;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Ow||(Ow={}));var jw;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(jw||(jw={}));var $w;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})($w||($w={}));var Vw;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Vw||(Vw={}));var Bw;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Bw||(Bw={}));var qw;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(qw||(qw={}));var Gw;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Gw||(Gw={}));var Hw;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Hw||(Hw={}));var zw;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(zw||(zw={}));var Ww;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(Ww||(Ww={}));var Kw;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Kw||(Kw={}));var Jw;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Jw||(Jw={}));var Yw;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Yw||(Yw={}));var Qw;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Qw||(Qw={}));var Xw;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Xw||(Xw={}));var Jd;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Jd||(Jd={}));var Zw;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Zw||(Zw={}));var e_;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(e_||(e_={}));var t_;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(t_||(t_={}));var ng;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(ng||(ng={}));var n_;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(n_||(n_={}));var r_;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(r_||(r_={}));var rg;(function(t){t.COLLECTION="COLLECTION"})(rg||(rg={}));var i_;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(i_||(i_={}));var s_;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(s_||(s_={}));var Yd;(function(t){t.PREDICT="PREDICT",t.EMBED_CONTENT="EMBED_CONTENT"})(Yd||(Yd={}));var o_;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(o_||(o_={}));var a_;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(a_||(a_={}));var l_;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(l_||(l_={}));var u_;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(u_||(u_={}));var c_;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(c_||(c_={}));var d_;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(d_||(d_={}));var h_;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(h_||(h_={}));var f_;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(f_||(f_={}));var p_;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(p_||(p_={}));var m_;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(m_||(m_={}));var g_;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(g_||(g_={}));var y_;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING",t.DISTILLATION="DISTILLATION"})(y_||(y_={}));var v_;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(v_||(v_={}));var x_;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(x_||(x_={}));var w_;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(w_||(w_={}));var __;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(__||(__={}));var T_;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(T_||(T_={}));var I_;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(I_||(I_={}));var S_;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.ACTIVITY_START="ACTIVITY_START",t.ACTIVITY_END="ACTIVITY_END"})(S_||(S_={}));var b_;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(b_||(b_={}));var E_;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(E_||(E_={}));var C_;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(C_||(C_={}));var N_;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(N_||(N_={}));var A_;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(A_||(A_={}));var k_;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(k_||(k_={}));var ko;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(ko||(ko={}));class ig{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ka{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",h=!1;const p=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,y]of Object.entries(m))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(y!==null||y!==void 0)&&p.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;h=!0,u+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const h=[];for(const p of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,g]of Object.entries(p))m!=="inlineData"&&(g!==null||g!==void 0)&&h.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.output}}class R_{}class P_{}class lM{}class uM{}class cM{}class dM{}class D_{}class M_{}class L_{}class hM{}class Qd{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Qd;let i;const s=e;return n?i=Y2(s):i=J2(s),Object.assign(r,i),r}}class U_{}class F_{}class O_{}class j_{}class fM{}class pM{}class mM{}class dv{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new dv,s=rM(e);return Object.assign(r,s),r}}class gM{}class yM{}class vM{}class xM{}class $_{}class wM{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class _M{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class hv{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new hv,s=jE(e);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function me(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function $E(t,e){const n=me(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function VE(t){return Array.isArray(t)?t.map(e=>Xd(e)):[Xd(t)]}function Xd(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function BE(t){const e=Xd(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function qE(t){const e=Xd(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function V_(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function GE(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>V_(e)):[V_(t)]}function sg(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function B_(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function q_(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ct(t){if(t==null)throw new Error("ContentUnion is required");return sg(t)?t:{role:"user",parts:GE(t)}}function fv(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=ct(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=ct(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ct(n)):[ct(e)]}function _n(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(B_(t)||q_(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ct(t)]}const e=[],n=[],r=sg(t[0]);for(const i of t){const s=sg(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(B_(i)||q_(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:GE(n)}),e}function TM(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(gi).includes(n[0].toUpperCase())?n[0].toUpperCase():gi.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(gi).includes(r.toUpperCase())?r.toUpperCase():gi.TYPE_UNSPECIFIED})}}function $o(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&TM(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(gi).includes(a.toUpperCase())?a.toUpperCase():gi.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=$o(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push($o(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,h]of Object.entries(a))l[u]=$o(h);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function pv(t){return $o(t)}function mv(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function gv(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function _a(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=$o(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=$o(e.response));return t}function Ta(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function IM(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function Kr(t,e){if(typeof e!="string")throw new Error("name must be a string");return IM(t,e,"cachedContents")}function HE(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function zi(t){return cv(t)}function SM(t){return t!=null&&typeof t=="object"&&"name"in t}function bM(t){return t!=null&&typeof t=="object"&&"video"in t}function EM(t){return t!=null&&typeof t=="object"&&"uri"in t}function zE(t){var e;let n;if(SM(t)&&(n=t.name),!(EM(t)&&(n=t.uri,n===void 0))&&!(bM(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function WE(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function KE(t){for(const e of["models","tunedModels","publisherModels"])if(CM(t,e))return t[e];return[]}function CM(t,e){return t!==null&&typeof t=="object"&&e in t}function NM(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function AM(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=NM(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function JE(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function kM(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function YE(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Ia(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function QE(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function RM(t){return t.includes("gemini")&&t!=="gemini-embedding-001"||t.includes("maas")}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PM(t){const e={},n=d(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const r=d(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>hL(o))),f(e,["inlinedResponses"],s)}const i=d(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["inlinedEmbedContentResponses"],s)}return e}function DM(t){const e={},n=d(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const r=d(t,["gcsDestination","outputUriPrefix"]);r!=null&&f(e,["gcsUri"],r);const i=d(t,["bigqueryDestination","outputUri"]);return i!=null&&f(e,["bigqueryUri"],i),e}function MM(t){const e={},n=d(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const r=d(t,["gcsUri"]);r!=null&&f(e,["gcsDestination","outputUriPrefix"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&f(e,["bigqueryDestination","outputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ud(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata","displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["metadata","state"]);i!=null&&f(e,["state"],QE(i));const s=d(t,["metadata","createTime"]);s!=null&&f(e,["createTime"],s);const o=d(t,["metadata","endTime"]);o!=null&&f(e,["endTime"],o);const a=d(t,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const l=d(t,["metadata","model"]);l!=null&&f(e,["model"],l);const u=d(t,["metadata","output"]);return u!=null&&f(e,["dest"],PM(YE(u))),e}function og(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["state"]);i!=null&&f(e,["state"],QE(i));const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["createTime"]);o!=null&&f(e,["createTime"],o);const a=d(t,["startTime"]);a!=null&&f(e,["startTime"],a);const l=d(t,["endTime"]);l!=null&&f(e,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&f(e,["updateTime"],u);const h=d(t,["model"]);h!=null&&f(e,["model"],h);const p=d(t,["inputConfig"]);p!=null&&f(e,["src"],LM(p));const m=d(t,["outputConfig"]);m!=null&&f(e,["dest"],DM(YE(m)));const g=d(t,["completionStats"]);return g!=null&&f(e,["completionStats"],g),e}function LM(t){const e={},n=d(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const r=d(t,["gcsSource","uris"]);r!=null&&f(e,["gcsUri"],r);const i=d(t,["bigquerySource","inputUri"]);return i!=null&&f(e,["bigqueryUri"],i),e}function UM(t,e){const n={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=d(e,["fileName"]);r!=null&&f(n,["fileName"],r);const i=d(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>dL(t,o))),f(n,["requests","requests"],s)}return n}function FM(t){const e={},n=d(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const r=d(t,["gcsUri"]);r!=null&&f(e,["gcsSource","uris"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&f(e,["bigquerySource","inputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function OM(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function jM(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ia(t,r)),n}function $M(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ia(t,r)),n}function VM(t){const e={},n=d(t,["content"]);n!=null&&f(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],BM(r));const i=d(t,["tokenCount"]);i!=null&&f(e,["tokenCount"],i);const s=d(t,["finishReason"]);s!=null&&f(e,["finishReason"],s);const o=d(t,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=d(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=d(t,["index"]);l!=null&&f(e,["index"],l);const u=d(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const h=d(t,["safetyRatings"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["safetyRatings"],m)}const p=d(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function BM(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["citations"],r)}return e}function XE(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>xL(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function qM(t,e){const n={},r=d(t,["displayName"]);if(e!==void 0&&r!=null&&f(e,["batch","displayName"],r),d(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function GM(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=d(t,["dest"]);return e!==void 0&&i!=null&&f(e,["outputConfig"],MM(kM(i))),n}function G_(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const i=d(e,["src"]);i!=null&&f(n,["batch","inputConfig"],UM(t,JE(t,i)));const s=d(e,["config"]);return s!=null&&qM(s,n),n}function HM(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],me(t,r));const i=d(e,["src"]);i!=null&&f(n,["inputConfig"],FM(JE(t,i)));const s=d(e,["config"]);return s!=null&&GM(s,n),n}function zM(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["batch","displayName"],r),n}function WM(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const i=d(e,["src"]);i!=null&&f(n,["batch","inputConfig"],eL(t,i));const s=d(e,["config"]);return s!=null&&zM(s,n),n}function KM(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ia(t,r)),n}function JM(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ia(t,r)),n}function YM(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);return s!=null&&f(e,["error"],s),e}function QM(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);return s!=null&&f(e,["error"],s),e}function XM(t,e){const n={},r=d(e,["contents"]);if(r!=null){let s=fv(t,r);Array.isArray(s)&&(s=s.map(o=>o)),f(n,["requests[]","request","content"],s)}const i=d(e,["config"]);return i!=null&&(f(n,["_self"],ZM(i,n)),W2(n,{"requests[].*":"requests[].request.*"})),n}function ZM(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&f(e,["requests[]","title"],i);const s=d(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&f(e,["requests[]","outputDimensionality"],s),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function eL(t,e){const n={},r=d(e,["fileName"]);r!=null&&f(n,["file_name"],r);const i=d(e,["inlinedRequests"]);return i!=null&&f(n,["requests"],XM(t,i)),n}function tL(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function nL(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function rL(t){const e={},n=d(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=d(t,["mode"]);if(r!=null&&f(e,["mode"],r),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function iL(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],XE(ct(i)));const s=d(e,["temperature"]);s!=null&&f(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&f(r,["topP"],o);const a=d(e,["topK"]);a!=null&&f(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=d(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=d(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const y=d(e,["frequencyPenalty"]);y!=null&&f(r,["frequencyPenalty"],y);const w=d(e,["seed"]);w!=null&&f(r,["seed"],w);const T=d(e,["responseMimeType"]);T!=null&&f(r,["responseMimeType"],T);const x=d(e,["responseSchema"]);x!=null&&f(r,["responseSchema"],pv(x));const v=d(e,["responseJsonSchema"]);if(v!=null&&f(r,["responseJsonSchema"],v),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=d(e,["safetySettings"]);if(n!==void 0&&_!=null){let se=_;Array.isArray(se)&&(se=se.map(ae=>wL(ae))),f(n,["safetySettings"],se)}const b=d(e,["tools"]);if(n!==void 0&&b!=null){let se=Ta(b);Array.isArray(se)&&(se=se.map(ae=>TL(_a(ae)))),f(n,["tools"],se)}const S=d(e,["toolConfig"]);if(n!==void 0&&S!=null&&f(n,["toolConfig"],_L(S)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=d(e,["cachedContent"]);n!==void 0&&I!=null&&f(n,["cachedContent"],Kr(t,I));const E=d(e,["responseModalities"]);E!=null&&f(r,["responseModalities"],E);const R=d(e,["mediaResolution"]);R!=null&&f(r,["mediaResolution"],R);const F=d(e,["speechConfig"]);if(F!=null&&f(r,["speechConfig"],mv(F)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=d(e,["thinkingConfig"]);M!=null&&f(r,["thinkingConfig"],M);const Q=d(e,["imageConfig"]);Q!=null&&f(r,["imageConfig"],cL(Q));const ne=d(e,["enableEnhancedCivicAnswers"]);if(ne!=null&&f(r,["enableEnhancedCivicAnswers"],ne),d(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function sL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>VM(u))),f(e,["candidates"],l)}const i=d(t,["modelVersion"]);i!=null&&f(e,["modelVersion"],i);const s=d(t,["promptFeedback"]);s!=null&&f(e,["promptFeedback"],s);const o=d(t,["responseId"]);o!=null&&f(e,["responseId"],o);const a=d(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function oL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ia(t,r)),n}function aL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Ia(t,r)),n}function lL(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function uL(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function cL(t){const e={},n=d(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=d(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),d(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(d(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function dL(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["request","model"],me(t,r));const i=d(e,["contents"]);if(i!=null){let a=_n(i);Array.isArray(a)&&(a=a.map(l=>XE(l))),f(n,["request","contents"],a)}const s=d(e,["metadata"]);s!=null&&f(n,["metadata"],s);const o=d(e,["config"]);return o!=null&&f(n,["request","generationConfig"],iL(t,o,d(n,["request"],{}))),n}function hL(t){const e={},n=d(t,["response"]);n!=null&&f(e,["response"],sL(n));const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["error"]);return i!=null&&f(e,["error"],i),e}function fL(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);if(e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),d(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function pL(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);e!==void 0&&i!=null&&f(e,["_query","pageToken"],i);const s=d(t,["filter"]);return e!==void 0&&s!=null&&f(e,["_query","filter"],s),n}function mL(t){const e={},n=d(t,["config"]);return n!=null&&fL(n,e),e}function gL(t){const e={},n=d(t,["config"]);return n!=null&&pL(n,e),e}function yL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ud(o))),f(e,["batchJobs"],s)}return e}function vL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>og(o))),f(e,["batchJobs"],s)}return e}function xL(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],tL(s));const o=d(t,["functionCall"]);o!=null&&f(e,["functionCall"],nL(o));const a=d(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(t,["inlineData"]);l!=null&&f(e,["inlineData"],OM(l));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const h=d(t,["thought"]);h!=null&&f(e,["thought"],h);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function wL(t){const e={},n=d(t,["category"]);if(n!=null&&f(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function _L(t){const e={},n=d(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=d(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],rL(r)),e}function TL(t){const e={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=d(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const i=d(t,["codeExecution"]);if(i!=null&&f(e,["codeExecution"],i),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=d(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const o=d(t,["googleMaps"]);o!=null&&f(e,["googleMaps"],lL(o));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],uL(a));const l=d(t,["googleSearchRetrieval"]);l!=null&&f(e,["googleSearchRetrieval"],l);const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Br;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(Br||(Br={}));class Zs{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IL extends Wr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Zs(Br.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=G_(this.apiClient,e),r=n._url,i=B("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const h of l){const p=Object.assign({},h);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const g=p.request;g.systemInstruction=m,p.request=g}u.push(p)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HM(this.apiClient,e);return a=B("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>og(h))}else{const u=G_(this.apiClient,e);return a=B("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>ud(h))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=WM(this.apiClient,e);return s=B("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>ud(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=aL(this.apiClient,e);return a=B("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>og(h))}else{const u=oL(this.apiClient,e);return a=B("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>ud(h))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=$M(this.apiClient,e);o=B("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=jM(this.apiClient,e);o=B("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=gL(e);return a=B("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=vL(h),m=new $_;return Object.assign(m,p),m})}else{const u=mL(e);return a=B("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=yL(h),m=new $_;return Object.assign(m,p),m})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=JM(this.apiClient,e);return a=B("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>QM(h))}else{const u=KM(this.apiClient,e);return a=B("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>YM(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SL(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function H_(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>WL(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function bL(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&f(e,["expireTime"],i);const s=d(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const o=d(t,["contents"]);if(e!==void 0&&o!=null){let h=_n(o);Array.isArray(h)&&(h=h.map(p=>H_(p))),f(e,["contents"],h)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],H_(ct(a)));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>JL(p))),f(e,["tools"],h)}const u=d(t,["toolConfig"]);if(e!==void 0&&u!=null&&f(e,["toolConfig"],KL(u)),d(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function EL(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&f(e,["expireTime"],i);const s=d(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const o=d(t,["contents"]);if(e!==void 0&&o!=null){let p=_n(o);Array.isArray(p)&&(p=p.map(m=>m)),f(e,["contents"],p)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],ct(a));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(m=>YL(m))),f(e,["tools"],p)}const u=d(t,["toolConfig"]);e!==void 0&&u!=null&&f(e,["toolConfig"],u);const h=d(t,["kmsKeyName"]);return e!==void 0&&h!=null&&f(e,["encryption_spec","kmsKeyName"],h),n}function CL(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],$E(t,r));const i=d(e,["config"]);return i!=null&&bL(i,n),n}function NL(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],$E(t,r));const i=d(e,["config"]);return i!=null&&EL(i,n),n}function AL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Kr(t,r)),n}function kL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Kr(t,r)),n}function RL(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function PL(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function DL(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function ML(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function LL(t){const e={},n=d(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=d(t,["mode"]);if(r!=null&&f(e,["mode"],r),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function UL(t){const e={},n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["parameters"]);i!=null&&f(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&f(e,["response"],o);const a=d(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function FL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Kr(t,r)),n}function OL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Kr(t,r)),n}function jL(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function $L(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function VL(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function BL(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function qL(t){const e={},n=d(t,["config"]);return n!=null&&VL(n,e),e}function GL(t){const e={},n=d(t,["config"]);return n!=null&&BL(n,e),e}function HL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["cachedContents"],s)}return e}function zL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["cachedContents"],s)}return e}function WL(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],DL(s));const o=d(t,["functionCall"]);o!=null&&f(e,["functionCall"],ML(o));const a=d(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(t,["inlineData"]);l!=null&&f(e,["inlineData"],SL(l));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const h=d(t,["thought"]);h!=null&&f(e,["thought"],h);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function KL(t){const e={},n=d(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=d(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],LL(r)),e}function JL(t){const e={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=d(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const i=d(t,["codeExecution"]);if(i!=null&&f(e,["codeExecution"],i),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=d(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const o=d(t,["googleMaps"]);o!=null&&f(e,["googleMaps"],jL(o));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],$L(a));const l=d(t,["googleSearchRetrieval"]);l!=null&&f(e,["googleSearchRetrieval"],l);const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function YL(t){const e={},n=d(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=d(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=d(t,["codeExecution"]);i!=null&&f(e,["codeExecution"],i);const s=d(t,["enterpriseWebSearch"]);s!=null&&f(e,["enterpriseWebSearch"],s);const o=d(t,["functionDeclarations"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(m=>UL(m))),f(e,["functionDeclarations"],p)}const a=d(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const l=d(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],l);const u=d(t,["googleSearchRetrieval"]);u!=null&&f(e,["googleSearchRetrieval"],u);const h=d(t,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function QL(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&f(e,["expireTime"],i),n}function XL(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&f(e,["expireTime"],i),n}function ZL(t,e){const n={},r=d(e,["name"]);r!=null&&f(n,["_url","name"],Kr(t,r));const i=d(e,["config"]);return i!=null&&QL(i,n),n}function e4(t,e){const n={},r=d(e,["name"]);r!=null&&f(n,["_url","name"],Kr(t,r));const i=d(e,["config"]);return i!=null&&XL(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t4 extends Wr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Zs(Br.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=NL(this.apiClient,e);return a=B("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=CL(this.apiClient,e);return a=B("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=OL(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=FL(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=kL(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=PL(h),m=new O_;return Object.assign(m,p),m})}else{const u=AL(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=RL(h),m=new O_;return Object.assign(m,p),m})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=e4(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=ZL(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=GL(e);return a=B("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=zL(h),m=new j_;return Object.assign(m,p),m})}else{const u=qL(e);return a=B("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=HL(h),m=new j_;return Object.assign(m,p),m})}}}function Zd(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function z_(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ee(t){return this instanceof ee?(this.v=t,this):new ee(t)}function Jn(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(g){return function(y){return Promise.resolve(y).then(g,p)}}function a(g,y){r[g]&&(i[g]=function(w){return new Promise(function(T,x){s.push([g,w,T,x])>1||l(g,w)})},y&&(i[g]=y(i[g])))}function l(g,y){try{u(r[g](y))}catch(w){m(s[0][3],w)}}function u(g){g.value instanceof ee?Promise.resolve(g.value.v).then(h,p):m(s[0][2],g)}function h(g){l("next",g)}function p(g){l("throw",g)}function m(g,y){g(y),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Yn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof z_=="function"?z_(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n4(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:ZE(n)}function ZE(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function r4(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function W_(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!ZE(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class i4{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new s4(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class s4{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),r4(s)}async sendMessage(e){var n;await this.sendPromise;const r=ct(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,h=l.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];h!=null&&(m=(a=h.slice(p))!==null&&a!==void 0?a:[]);const g=u?[u]:[];this.recordHistory(r,g,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=ct(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?W_(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Jn(this,arguments,function*(){var i,s,o,a,l,u;const h=[];try{for(var p=!0,m=Yn(e),g;g=yield ee(m.next()),i=g.done,!i;p=!0){a=g.value,p=!1;const y=a;if(n4(y)){const w=(u=(l=y.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content;w!==void 0&&h.push(w)}yield yield ee(y)}}catch(y){s={error:y}}finally{try{!p&&!i&&(o=m.return)&&(yield ee(o.call(m)))}finally{if(s)throw s.error}}this.recordHistory(n,h)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...W_(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nu extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,nu.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function o4(t){const e={},n=d(t,["file"]);return n!=null&&f(e,["file"],n),e}function a4(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function l4(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","file"],zE(n)),e}function u4(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function c4(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","file"],zE(n)),e}function d4(t){const e={},n=d(t,["uris"]);return n!=null&&f(e,["uris"],n),e}function h4(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function f4(t){const e={},n=d(t,["config"]);return n!=null&&h4(n,e),e}function p4(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["files"],s)}return e}function m4(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["files"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["files"],i)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class g4 extends Wr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Zs(Br.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async registerFiles(e){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(e){return this.registerFilesInternal(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=f4(e);return s=B("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),i.then(l=>{const u=p4(l),h=new gM;return Object.assign(h,u),h})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=o4(e);return s=B("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=a4(l),h=new yM;return Object.assign(h,u),h})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=c4(e);return s=B("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=l4(e);return s=B("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),i.then(l=>{const u=u4(l),h=new vM;return Object.assign(h,u),h})}}async registerFilesInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=d4(e);return s=B("files:register",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=m4(l),h=new xM;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cd(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function y4(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>D4(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function v4(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function x4(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function w4(t){const e={},n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["parameters"]);i!=null&&f(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&f(e,["response"],o);const a=d(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function _4(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=d(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const i=d(t,["audioTimestamp"]);i!=null&&f(e,["audioTimestamp"],i);const s=d(t,["candidateCount"]);s!=null&&f(e,["candidateCount"],s);const o=d(t,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=d(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=d(t,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=d(t,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const h=d(t,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=d(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=d(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const g=d(t,["responseMimeType"]);g!=null&&f(e,["responseMimeType"],g);const y=d(t,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const w=d(t,["responseSchema"]);w!=null&&f(e,["responseSchema"],w);const T=d(t,["routingConfig"]);T!=null&&f(e,["routingConfig"],T);const x=d(t,["seed"]);x!=null&&f(e,["seed"],x);const v=d(t,["speechConfig"]);v!=null&&f(e,["speechConfig"],v);const _=d(t,["stopSequences"]);_!=null&&f(e,["stopSequences"],_);const b=d(t,["temperature"]);b!=null&&f(e,["temperature"],b);const S=d(t,["thinkingConfig"]);S!=null&&f(e,["thinkingConfig"],S);const I=d(t,["topK"]);I!=null&&f(e,["topK"],I);const E=d(t,["topP"]);if(E!=null&&f(e,["topP"],E),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function T4(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function I4(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function S4(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],gv(p));const m=d(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=d(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=d(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],y4(ct(y)));const w=d(t,["tools"]);if(e!==void 0&&w!=null){let I=Ta(w);Array.isArray(I)&&(I=I.map(E=>L4(_a(E)))),f(e,["setup","tools"],I)}const T=d(t,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],M4(T));const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const v=d(t,["outputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","outputAudioTranscription"],v);const _=d(t,["realtimeInputConfig"]);e!==void 0&&_!=null&&f(e,["setup","realtimeInputConfig"],_);const b=d(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const S=d(t,["proactivity"]);if(e!==void 0&&S!=null&&f(e,["setup","proactivity"],S),d(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function b4(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],_4(r));const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],gv(p));const m=d(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=d(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=d(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],ct(y));const w=d(t,["tools"]);if(e!==void 0&&w!=null){let E=Ta(w);Array.isArray(E)&&(E=E.map(R=>U4(_a(R)))),f(e,["setup","tools"],E)}const T=d(t,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],T);const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const v=d(t,["outputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","outputAudioTranscription"],v);const _=d(t,["realtimeInputConfig"]);e!==void 0&&_!=null&&f(e,["setup","realtimeInputConfig"],_);const b=d(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const S=d(t,["proactivity"]);e!==void 0&&S!=null&&f(e,["setup","proactivity"],S);const I=d(t,["explicitVadSignal"]);return e!==void 0&&I!=null&&f(e,["setup","explicitVadSignal"],I),n}function E4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],me(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],S4(i,n)),n}function C4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],me(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],b4(i,n)),n}function N4(t){const e={},n=d(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function A4(t){const e={},n=d(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["weightedPrompts"],r)}return e}function k4(t){const e={},n=d(t,["media"]);if(n!=null){let u=VE(n);Array.isArray(u)&&(u=u.map(h=>cd(h))),f(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&f(e,["audio"],cd(qE(r)));const i=d(t,["audioStreamEnd"]);i!=null&&f(e,["audioStreamEnd"],i);const s=d(t,["video"]);s!=null&&f(e,["video"],cd(BE(s)));const o=d(t,["text"]);o!=null&&f(e,["text"],o);const a=d(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function R4(t){const e={},n=d(t,["media"]);if(n!=null){let u=VE(n);Array.isArray(u)&&(u=u.map(h=>h)),f(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&f(e,["audio"],qE(r));const i=d(t,["audioStreamEnd"]);i!=null&&f(e,["audioStreamEnd"],i);const s=d(t,["video"]);s!=null&&f(e,["video"],BE(s));const o=d(t,["text"]);o!=null&&f(e,["text"],o);const a=d(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function P4(t){const e={},n=d(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const r=d(t,["serverContent"]);r!=null&&f(e,["serverContent"],r);const i=d(t,["toolCall"]);i!=null&&f(e,["toolCall"],i);const s=d(t,["toolCallCancellation"]);s!=null&&f(e,["toolCallCancellation"],s);const o=d(t,["usageMetadata"]);o!=null&&f(e,["usageMetadata"],F4(o));const a=d(t,["goAway"]);a!=null&&f(e,["goAway"],a);const l=d(t,["sessionResumptionUpdate"]);l!=null&&f(e,["sessionResumptionUpdate"],l);const u=d(t,["voiceActivityDetectionSignal"]);u!=null&&f(e,["voiceActivityDetectionSignal"],u);const h=d(t,["voiceActivity"]);return h!=null&&f(e,["voiceActivity"],O4(h)),e}function D4(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],v4(s));const o=d(t,["functionCall"]);o!=null&&f(e,["functionCall"],x4(o));const a=d(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(t,["inlineData"]);l!=null&&f(e,["inlineData"],cd(l));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const h=d(t,["thought"]);h!=null&&f(e,["thought"],h);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function M4(t){const e={},n=d(t,["handle"]);if(n!=null&&f(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function L4(t){const e={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=d(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const i=d(t,["codeExecution"]);if(i!=null&&f(e,["codeExecution"],i),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=d(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const o=d(t,["googleMaps"]);o!=null&&f(e,["googleMaps"],T4(o));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],I4(a));const l=d(t,["googleSearchRetrieval"]);l!=null&&f(e,["googleSearchRetrieval"],l);const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function U4(t){const e={},n=d(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=d(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=d(t,["codeExecution"]);i!=null&&f(e,["codeExecution"],i);const s=d(t,["enterpriseWebSearch"]);s!=null&&f(e,["enterpriseWebSearch"],s);const o=d(t,["functionDeclarations"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(m=>w4(m))),f(e,["functionDeclarations"],p)}const a=d(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const l=d(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],l);const u=d(t,["googleSearchRetrieval"]);u!=null&&f(e,["googleSearchRetrieval"],u);const h=d(t,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function F4(t){const e={},n=d(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const r=d(t,["cachedContentTokenCount"]);r!=null&&f(e,["cachedContentTokenCount"],r);const i=d(t,["candidatesTokenCount"]);i!=null&&f(e,["responseTokenCount"],i);const s=d(t,["toolUsePromptTokenCount"]);s!=null&&f(e,["toolUsePromptTokenCount"],s);const o=d(t,["thoughtsTokenCount"]);o!=null&&f(e,["thoughtsTokenCount"],o);const a=d(t,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const l=d(t,["promptTokensDetails"]);if(l!=null){let g=l;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["promptTokensDetails"],g)}const u=d(t,["cacheTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["cacheTokensDetails"],g)}const h=d(t,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["responseTokensDetails"],g)}const p=d(t,["toolUsePromptTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["toolUsePromptTokensDetails"],g)}const m=d(t,["trafficType"]);return m!=null&&f(e,["trafficType"],m),e}function O4(t){const e={},n=d(t,["type"]);return n!=null&&f(e,["voiceActivityType"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function j4(t,e){const n={},r=d(t,["data"]);if(r!=null&&f(n,["data"],r),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(t,["mimeType"]);return i!=null&&f(n,["mimeType"],i),n}function $4(t,e){const n={},r=d(t,["content"]);r!=null&&f(n,["content"],r);const i=d(t,["citationMetadata"]);i!=null&&f(n,["citationMetadata"],V4(i));const s=d(t,["tokenCount"]);s!=null&&f(n,["tokenCount"],s);const o=d(t,["finishReason"]);o!=null&&f(n,["finishReason"],o);const a=d(t,["avgLogprobs"]);a!=null&&f(n,["avgLogprobs"],a);const l=d(t,["groundingMetadata"]);l!=null&&f(n,["groundingMetadata"],l);const u=d(t,["index"]);u!=null&&f(n,["index"],u);const h=d(t,["logprobsResult"]);h!=null&&f(n,["logprobsResult"],h);const p=d(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>y)),f(n,["safetyRatings"],g)}const m=d(t,["urlContextMetadata"]);return m!=null&&f(n,["urlContextMetadata"],m),n}function V4(t,e){const n={},r=d(t,["citationSources"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(n,["citations"],i)}return n}function B4(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["contents"]);if(s!=null){let o=_n(s);Array.isArray(o)&&(o=o.map(a=>a)),f(r,["contents"],o)}return r}function q4(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["tokensInfo"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(n,["tokensInfo"],s)}return n}function G4(t,e){const n={},r=d(t,["values"]);r!=null&&f(n,["values"],r);const i=d(t,["statistics"]);return i!=null&&f(n,["statistics"],H4(i)),n}function H4(t,e){const n={},r=d(t,["truncated"]);r!=null&&f(n,["truncated"],r);const i=d(t,["token_count"]);return i!=null&&f(n,["tokenCount"],i),n}function Uu(t,e){const n={},r=d(t,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>eF(o))),f(n,["parts"],s)}const i=d(t,["role"]);return i!=null&&f(n,["role"],i),n}function z4(t,e){const n={},r=d(t,["controlType"]);r!=null&&f(n,["controlType"],r);const i=d(t,["enableControlImageComputation"]);return i!=null&&f(n,["computeControl"],i),n}function W4(t,e){const n={};if(d(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function K4(t,e,n){const r={},i=d(t,["systemInstruction"]);e!==void 0&&i!=null&&f(e,["systemInstruction"],ct(i));const s=d(t,["tools"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>rC(l))),f(e,["tools"],a)}const o=d(t,["generationConfig"]);return e!==void 0&&o!=null&&f(e,["generationConfig"],jU(o)),r}function J4(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["contents"]);if(s!=null){let a=_n(s);Array.isArray(a)&&(a=a.map(l=>Uu(l))),f(r,["contents"],a)}const o=d(e,["config"]);return o!=null&&W4(o),r}function Y4(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["contents"]);if(s!=null){let a=_n(s);Array.isArray(a)&&(a=a.map(l=>l)),f(r,["contents"],a)}const o=d(e,["config"]);return o!=null&&K4(o,r),r}function Q4(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["totalTokens"]);i!=null&&f(n,["totalTokens"],i);const s=d(t,["cachedContentTokenCount"]);return s!=null&&f(n,["cachedContentTokenCount"],s),n}function X4(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["totalTokens"]);return i!=null&&f(n,["totalTokens"],i),n}function Z4(t,e,n){const r={},i=d(e,["model"]);return i!=null&&f(r,["_url","name"],me(t,i)),r}function eU(t,e,n){const r={},i=d(e,["model"]);return i!=null&&f(r,["_url","name"],me(t,i)),r}function tU(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function nU(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function rU(t,e,n){const r={},i=d(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const o=d(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const a=d(t,["aspectRatio"]);e!==void 0&&a!=null&&f(e,["parameters","aspectRatio"],a);const l=d(t,["guidanceScale"]);e!==void 0&&l!=null&&f(e,["parameters","guidanceScale"],l);const u=d(t,["seed"]);e!==void 0&&u!=null&&f(e,["parameters","seed"],u);const h=d(t,["safetyFilterLevel"]);e!==void 0&&h!=null&&f(e,["parameters","safetySetting"],h);const p=d(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=d(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&f(e,["parameters","includeSafetyAttributes"],m);const g=d(t,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const y=d(t,["language"]);e!==void 0&&y!=null&&f(e,["parameters","language"],y);const w=d(t,["outputMimeType"]);e!==void 0&&w!=null&&f(e,["parameters","outputOptions","mimeType"],w);const T=d(t,["outputCompressionQuality"]);e!==void 0&&T!=null&&f(e,["parameters","outputOptions","compressionQuality"],T);const x=d(t,["addWatermark"]);e!==void 0&&x!=null&&f(e,["parameters","addWatermark"],x);const v=d(t,["labels"]);e!==void 0&&v!=null&&f(e,["labels"],v);const _=d(t,["editMode"]);e!==void 0&&_!=null&&f(e,["parameters","editMode"],_);const b=d(t,["baseSteps"]);return e!==void 0&&b!=null&&f(e,["parameters","editConfig","baseSteps"],b),r}function iU(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const o=d(e,["referenceImages"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>oF(u))),f(r,["instances[0]","referenceImages"],l)}const a=d(e,["config"]);return a!=null&&rU(a,r),r}function sU(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Kh(o))),f(n,["generatedImages"],s)}return n}function oU(t,e,n){const r={},i=d(t,["taskType"]);e!==void 0&&i!=null&&f(e,["requests[]","taskType"],i);const s=d(t,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const o=d(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function aU(t,e,n){const r={};let i=d(n,["embeddingApiType"]);if(i===void 0&&(i="PREDICT"),i==="PREDICT"){const u=d(t,["taskType"]);e!==void 0&&u!=null&&f(e,["instances[]","task_type"],u)}else if(i==="EMBED_CONTENT"){const u=d(t,["taskType"]);e!==void 0&&u!=null&&f(e,["taskType"],u)}let s=d(n,["embeddingApiType"]);if(s===void 0&&(s="PREDICT"),s==="PREDICT"){const u=d(t,["title"]);e!==void 0&&u!=null&&f(e,["instances[]","title"],u)}else if(s==="EMBED_CONTENT"){const u=d(t,["title"]);e!==void 0&&u!=null&&f(e,["title"],u)}let o=d(n,["embeddingApiType"]);if(o===void 0&&(o="PREDICT"),o==="PREDICT"){const u=d(t,["outputDimensionality"]);e!==void 0&&u!=null&&f(e,["parameters","outputDimensionality"],u)}else if(o==="EMBED_CONTENT"){const u=d(t,["outputDimensionality"]);e!==void 0&&u!=null&&f(e,["outputDimensionality"],u)}let a=d(n,["embeddingApiType"]);if(a===void 0&&(a="PREDICT"),a==="PREDICT"){const u=d(t,["mimeType"]);e!==void 0&&u!=null&&f(e,["instances[]","mimeType"],u)}let l=d(n,["embeddingApiType"]);if(l===void 0&&(l="PREDICT"),l==="PREDICT"){const u=d(t,["autoTruncate"]);e!==void 0&&u!=null&&f(e,["parameters","autoTruncate"],u)}else if(l==="EMBED_CONTENT"){const u=d(t,["autoTruncate"]);e!==void 0&&u!=null&&f(e,["autoTruncate"],u)}return r}function lU(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["contents"]);if(s!=null){let u=fv(t,s);Array.isArray(u)&&(u=u.map(h=>h)),f(r,["requests[]","content"],u)}const o=d(e,["content"]);o!=null&&Uu(ct(o));const a=d(e,["config"]);a!=null&&oU(a,r);const l=d(e,["model"]);return l!==void 0&&f(r,["requests[]","model"],me(t,l)),r}function uU(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));let s=d(n,["embeddingApiType"]);if(s===void 0&&(s="PREDICT"),s==="PREDICT"){const l=d(e,["contents"]);if(l!=null){let u=fv(t,l);Array.isArray(u)&&(u=u.map(h=>h)),f(r,["instances[]","content"],u)}}let o=d(n,["embeddingApiType"]);if(o===void 0&&(o="PREDICT"),o==="EMBED_CONTENT"){const l=d(e,["content"]);l!=null&&f(r,["content"],ct(l))}const a=d(e,["config"]);return a!=null&&aU(a,r,n),r}function cU(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),f(n,["embeddings"],o)}const s=d(t,["metadata"]);return s!=null&&f(n,["metadata"],s),n}function dU(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>G4(a))),f(n,["embeddings"],o)}const s=d(t,["metadata"]);if(s!=null&&f(n,["metadata"],s),e&&d(e,["embeddingApiType"])==="EMBED_CONTENT"){const o=d(t,["embedding"]),a=d(t,["usageMetadata"]),l=d(t,["truncated"]);if(o){const u={};a&&a.promptTokenCount&&(u.tokenCount=a.promptTokenCount),l&&(u.truncated=l),o.statistics=u,f(n,["embeddings"],[o])}}return n}function hU(t,e){const n={},r=d(t,["endpoint"]);r!=null&&f(n,["name"],r);const i=d(t,["deployedModelId"]);return i!=null&&f(n,["deployedModelId"],i),n}function fU(t,e){const n={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["fileUri"]);r!=null&&f(n,["fileUri"],r);const i=d(t,["mimeType"]);return i!=null&&f(n,["mimeType"],i),n}function pU(t,e){const n={},r=d(t,["id"]);r!=null&&f(n,["id"],r);const i=d(t,["args"]);i!=null&&f(n,["args"],i);const s=d(t,["name"]);if(s!=null&&f(n,["name"],s),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return n}function mU(t,e){const n={},r=d(t,["allowedFunctionNames"]);r!=null&&f(n,["allowedFunctionNames"],r);const i=d(t,["mode"]);if(i!=null&&f(n,["mode"],i),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return n}function gU(t,e){const n={},r=d(t,["description"]);r!=null&&f(n,["description"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const s=d(t,["parameters"]);s!=null&&f(n,["parameters"],s);const o=d(t,["parametersJsonSchema"]);o!=null&&f(n,["parametersJsonSchema"],o);const a=d(t,["response"]);a!=null&&f(n,["response"],a);const l=d(t,["responseJsonSchema"]);if(l!=null&&f(n,["responseJsonSchema"],l),d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return n}function yU(t,e,n,r){const i={},s=d(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],Uu(ct(s)));const o=d(e,["temperature"]);o!=null&&f(i,["temperature"],o);const a=d(e,["topP"]);a!=null&&f(i,["topP"],a);const l=d(e,["topK"]);l!=null&&f(i,["topK"],l);const u=d(e,["candidateCount"]);u!=null&&f(i,["candidateCount"],u);const h=d(e,["maxOutputTokens"]);h!=null&&f(i,["maxOutputTokens"],h);const p=d(e,["stopSequences"]);p!=null&&f(i,["stopSequences"],p);const m=d(e,["responseLogprobs"]);m!=null&&f(i,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&f(i,["logprobs"],g);const y=d(e,["presencePenalty"]);y!=null&&f(i,["presencePenalty"],y);const w=d(e,["frequencyPenalty"]);w!=null&&f(i,["frequencyPenalty"],w);const T=d(e,["seed"]);T!=null&&f(i,["seed"],T);const x=d(e,["responseMimeType"]);x!=null&&f(i,["responseMimeType"],x);const v=d(e,["responseSchema"]);v!=null&&f(i,["responseSchema"],pv(v));const _=d(e,["responseJsonSchema"]);if(_!=null&&f(i,["responseJsonSchema"],_),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=d(e,["safetySettings"]);if(n!==void 0&&b!=null){let ae=b;Array.isArray(ae)&&(ae=ae.map(Te=>aF(Te))),f(n,["safetySettings"],ae)}const S=d(e,["tools"]);if(n!==void 0&&S!=null){let ae=Ta(S);Array.isArray(ae)&&(ae=ae.map(Te=>pF(_a(Te)))),f(n,["tools"],ae)}const I=d(e,["toolConfig"]);if(n!==void 0&&I!=null&&f(n,["toolConfig"],fF(I)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const E=d(e,["cachedContent"]);n!==void 0&&E!=null&&f(n,["cachedContent"],Kr(t,E));const R=d(e,["responseModalities"]);R!=null&&f(i,["responseModalities"],R);const F=d(e,["mediaResolution"]);F!=null&&f(i,["mediaResolution"],F);const M=d(e,["speechConfig"]);if(M!=null&&f(i,["speechConfig"],mv(M)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=d(e,["thinkingConfig"]);Q!=null&&f(i,["thinkingConfig"],Q);const ne=d(e,["imageConfig"]);ne!=null&&f(i,["imageConfig"],GU(ne));const se=d(e,["enableEnhancedCivicAnswers"]);if(se!=null&&f(i,["enableEnhancedCivicAnswers"],se),d(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function vU(t,e,n,r){const i={},s=d(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],ct(s));const o=d(e,["temperature"]);o!=null&&f(i,["temperature"],o);const a=d(e,["topP"]);a!=null&&f(i,["topP"],a);const l=d(e,["topK"]);l!=null&&f(i,["topK"],l);const u=d(e,["candidateCount"]);u!=null&&f(i,["candidateCount"],u);const h=d(e,["maxOutputTokens"]);h!=null&&f(i,["maxOutputTokens"],h);const p=d(e,["stopSequences"]);p!=null&&f(i,["stopSequences"],p);const m=d(e,["responseLogprobs"]);m!=null&&f(i,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&f(i,["logprobs"],g);const y=d(e,["presencePenalty"]);y!=null&&f(i,["presencePenalty"],y);const w=d(e,["frequencyPenalty"]);w!=null&&f(i,["frequencyPenalty"],w);const T=d(e,["seed"]);T!=null&&f(i,["seed"],T);const x=d(e,["responseMimeType"]);x!=null&&f(i,["responseMimeType"],x);const v=d(e,["responseSchema"]);v!=null&&f(i,["responseSchema"],pv(v));const _=d(e,["responseJsonSchema"]);_!=null&&f(i,["responseJsonSchema"],_);const b=d(e,["routingConfig"]);b!=null&&f(i,["routingConfig"],b);const S=d(e,["modelSelectionConfig"]);S!=null&&f(i,["modelConfig"],S);const I=d(e,["safetySettings"]);if(n!==void 0&&I!=null){let O=I;Array.isArray(O)&&(O=O.map(Y=>Y)),f(n,["safetySettings"],O)}const E=d(e,["tools"]);if(n!==void 0&&E!=null){let O=Ta(E);Array.isArray(O)&&(O=O.map(Y=>rC(_a(Y)))),f(n,["tools"],O)}const R=d(e,["toolConfig"]);n!==void 0&&R!=null&&f(n,["toolConfig"],R);const F=d(e,["labels"]);n!==void 0&&F!=null&&f(n,["labels"],F);const M=d(e,["cachedContent"]);n!==void 0&&M!=null&&f(n,["cachedContent"],Kr(t,M));const Q=d(e,["responseModalities"]);Q!=null&&f(i,["responseModalities"],Q);const ne=d(e,["mediaResolution"]);ne!=null&&f(i,["mediaResolution"],ne);const se=d(e,["speechConfig"]);se!=null&&f(i,["speechConfig"],mv(se));const ae=d(e,["audioTimestamp"]);ae!=null&&f(i,["audioTimestamp"],ae);const Te=d(e,["thinkingConfig"]);Te!=null&&f(i,["thinkingConfig"],Te);const Ee=d(e,["imageConfig"]);if(Ee!=null&&f(i,["imageConfig"],HU(Ee)),d(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const $t=d(e,["modelArmorConfig"]);return n!==void 0&&$t!=null&&f(n,["modelArmorConfig"],$t),i}function K_(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["contents"]);if(s!=null){let a=_n(s);Array.isArray(a)&&(a=a.map(l=>Uu(l))),f(r,["contents"],a)}const o=d(e,["config"]);return o!=null&&f(r,["generationConfig"],yU(t,o,r)),r}function J_(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["contents"]);if(s!=null){let a=_n(s);Array.isArray(a)&&(a=a.map(l=>l)),f(r,["contents"],a)}const o=d(e,["config"]);return o!=null&&f(r,["generationConfig"],vU(t,o,r)),r}function Y_(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["candidates"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(h=>$4(h))),f(n,["candidates"],u)}const s=d(t,["modelVersion"]);s!=null&&f(n,["modelVersion"],s);const o=d(t,["promptFeedback"]);o!=null&&f(n,["promptFeedback"],o);const a=d(t,["responseId"]);a!=null&&f(n,["responseId"],a);const l=d(t,["usageMetadata"]);return l!=null&&f(n,["usageMetadata"],l),n}function Q_(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(p=>p)),f(n,["candidates"],h)}const s=d(t,["createTime"]);s!=null&&f(n,["createTime"],s);const o=d(t,["modelVersion"]);o!=null&&f(n,["modelVersion"],o);const a=d(t,["promptFeedback"]);a!=null&&f(n,["promptFeedback"],a);const l=d(t,["responseId"]);l!=null&&f(n,["responseId"],l);const u=d(t,["usageMetadata"]);return u!=null&&f(n,["usageMetadata"],u),n}function xU(t,e,n){const r={};if(d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=d(t,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const o=d(t,["guidanceScale"]);if(e!==void 0&&o!=null&&f(e,["parameters","guidanceScale"],o),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=d(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const l=d(t,["personGeneration"]);e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l);const u=d(t,["includeSafetyAttributes"]);e!==void 0&&u!=null&&f(e,["parameters","includeSafetyAttributes"],u);const h=d(t,["includeRaiReason"]);e!==void 0&&h!=null&&f(e,["parameters","includeRaiReason"],h);const p=d(t,["language"]);e!==void 0&&p!=null&&f(e,["parameters","language"],p);const m=d(t,["outputMimeType"]);e!==void 0&&m!=null&&f(e,["parameters","outputOptions","mimeType"],m);const g=d(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&f(e,["parameters","outputOptions","compressionQuality"],g),d(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const y=d(t,["imageSize"]);if(e!==void 0&&y!=null&&f(e,["parameters","sampleImageSize"],y),d(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function wU(t,e,n){const r={},i=d(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const o=d(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const a=d(t,["aspectRatio"]);e!==void 0&&a!=null&&f(e,["parameters","aspectRatio"],a);const l=d(t,["guidanceScale"]);e!==void 0&&l!=null&&f(e,["parameters","guidanceScale"],l);const u=d(t,["seed"]);e!==void 0&&u!=null&&f(e,["parameters","seed"],u);const h=d(t,["safetyFilterLevel"]);e!==void 0&&h!=null&&f(e,["parameters","safetySetting"],h);const p=d(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=d(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&f(e,["parameters","includeSafetyAttributes"],m);const g=d(t,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const y=d(t,["language"]);e!==void 0&&y!=null&&f(e,["parameters","language"],y);const w=d(t,["outputMimeType"]);e!==void 0&&w!=null&&f(e,["parameters","outputOptions","mimeType"],w);const T=d(t,["outputCompressionQuality"]);e!==void 0&&T!=null&&f(e,["parameters","outputOptions","compressionQuality"],T);const x=d(t,["addWatermark"]);e!==void 0&&x!=null&&f(e,["parameters","addWatermark"],x);const v=d(t,["labels"]);e!==void 0&&v!=null&&f(e,["labels"],v);const _=d(t,["imageSize"]);e!==void 0&&_!=null&&f(e,["parameters","sampleImageSize"],_);const b=d(t,["enhancePrompt"]);return e!==void 0&&b!=null&&f(e,["parameters","enhancePrompt"],b),r}function _U(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const o=d(e,["config"]);return o!=null&&xU(o,r),r}function TU(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const o=d(e,["config"]);return o!=null&&wU(o,r),r}function IU(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>LU(a))),f(n,["generatedImages"],o)}const s=d(t,["positivePromptSafetyAttributes"]);return s!=null&&f(n,["positivePromptSafetyAttributes"],tC(s)),n}function SU(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Kh(a))),f(n,["generatedImages"],o)}const s=d(t,["positivePromptSafetyAttributes"]);return s!=null&&f(n,["positivePromptSafetyAttributes"],nC(s)),n}function bU(t,e,n){const r={},i=d(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i),d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=d(t,["durationSeconds"]);if(e!==void 0&&s!=null&&f(e,["parameters","durationSeconds"],s),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=d(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=d(t,["resolution"]);e!==void 0&&a!=null&&f(e,["parameters","resolution"],a);const l=d(t,["personGeneration"]);if(e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l),d(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=d(t,["negativePrompt"]);e!==void 0&&u!=null&&f(e,["parameters","negativePrompt"],u);const h=d(t,["enhancePrompt"]);if(e!==void 0&&h!=null&&f(e,["parameters","enhancePrompt"],h),d(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=d(t,["lastFrame"]);e!==void 0&&p!=null&&f(e,["instances[0]","lastFrame"],Jh(p));const m=d(t,["referenceImages"]);if(e!==void 0&&m!=null){let g=m;Array.isArray(g)&&(g=g.map(y=>CF(y))),f(e,["instances[0]","referenceImages"],g)}if(d(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return r}function EU(t,e,n){const r={},i=d(t,["numberOfVideos"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(t,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const o=d(t,["fps"]);e!==void 0&&o!=null&&f(e,["parameters","fps"],o);const a=d(t,["durationSeconds"]);e!==void 0&&a!=null&&f(e,["parameters","durationSeconds"],a);const l=d(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=d(t,["aspectRatio"]);e!==void 0&&u!=null&&f(e,["parameters","aspectRatio"],u);const h=d(t,["resolution"]);e!==void 0&&h!=null&&f(e,["parameters","resolution"],h);const p=d(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=d(t,["pubsubTopic"]);e!==void 0&&m!=null&&f(e,["parameters","pubsubTopic"],m);const g=d(t,["negativePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","negativePrompt"],g);const y=d(t,["enhancePrompt"]);e!==void 0&&y!=null&&f(e,["parameters","enhancePrompt"],y);const w=d(t,["generateAudio"]);e!==void 0&&w!=null&&f(e,["parameters","generateAudio"],w);const T=d(t,["lastFrame"]);e!==void 0&&T!=null&&f(e,["instances[0]","lastFrame"],tr(T));const x=d(t,["referenceImages"]);if(e!==void 0&&x!=null){let b=x;Array.isArray(b)&&(b=b.map(S=>NF(S))),f(e,["instances[0]","referenceImages"],b)}const v=d(t,["mask"]);e!==void 0&&v!=null&&f(e,["instances[0]","mask"],EF(v));const _=d(t,["compressionQuality"]);return e!==void 0&&_!=null&&f(e,["parameters","compressionQuality"],_),r}function CU(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["name"],r);const i=d(t,["metadata"]);i!=null&&f(n,["metadata"],i);const s=d(t,["done"]);s!=null&&f(n,["done"],s);const o=d(t,["error"]);o!=null&&f(n,["error"],o);const a=d(t,["response","generateVideoResponse"]);return a!=null&&f(n,["response"],RU(a)),n}function NU(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["name"],r);const i=d(t,["metadata"]);i!=null&&f(n,["metadata"],i);const s=d(t,["done"]);s!=null&&f(n,["done"],s);const o=d(t,["error"]);o!=null&&f(n,["error"],o);const a=d(t,["response"]);return a!=null&&f(n,["response"],PU(a)),n}function AU(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const o=d(e,["image"]);o!=null&&f(r,["instances[0]","image"],Jh(o));const a=d(e,["video"]);a!=null&&f(r,["instances[0]","video"],iC(a));const l=d(e,["source"]);l!=null&&DU(l,r);const u=d(e,["config"]);return u!=null&&bU(u,r),r}function kU(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["prompt"]);s!=null&&f(r,["instances[0]","prompt"],s);const o=d(e,["image"]);o!=null&&f(r,["instances[0]","image"],tr(o));const a=d(e,["video"]);a!=null&&f(r,["instances[0]","video"],sC(a));const l=d(e,["source"]);l!=null&&MU(l,r);const u=d(e,["config"]);return u!=null&&EU(u,r),r}function RU(t,e){const n={},r=d(t,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>FU(a))),f(n,["generatedVideos"],o)}const i=d(t,["raiMediaFilteredCount"]);i!=null&&f(n,["raiMediaFilteredCount"],i);const s=d(t,["raiMediaFilteredReasons"]);return s!=null&&f(n,["raiMediaFilteredReasons"],s),n}function PU(t,e){const n={},r=d(t,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>OU(a))),f(n,["generatedVideos"],o)}const i=d(t,["raiMediaFilteredCount"]);i!=null&&f(n,["raiMediaFilteredCount"],i);const s=d(t,["raiMediaFilteredReasons"]);return s!=null&&f(n,["raiMediaFilteredReasons"],s),n}function DU(t,e,n){const r={},i=d(t,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Jh(s));const o=d(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],iC(o)),r}function MU(t,e,n){const r={},i=d(t,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],tr(s));const o=d(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],sC(o)),r}function LU(t,e){const n={},r=d(t,["_self"]);r!=null&&f(n,["image"],zU(r));const i=d(t,["raiFilteredReason"]);i!=null&&f(n,["raiFilteredReason"],i);const s=d(t,["_self"]);return s!=null&&f(n,["safetyAttributes"],tC(s)),n}function Kh(t,e){const n={},r=d(t,["_self"]);r!=null&&f(n,["image"],eC(r));const i=d(t,["raiFilteredReason"]);i!=null&&f(n,["raiFilteredReason"],i);const s=d(t,["_self"]);s!=null&&f(n,["safetyAttributes"],nC(s));const o=d(t,["prompt"]);return o!=null&&f(n,["enhancedPrompt"],o),n}function UU(t,e){const n={},r=d(t,["_self"]);r!=null&&f(n,["mask"],eC(r));const i=d(t,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(n,["labels"],s)}return n}function FU(t,e){const n={},r=d(t,["video"]);return r!=null&&f(n,["video"],SF(r)),n}function OU(t,e){const n={},r=d(t,["_self"]);return r!=null&&f(n,["video"],bF(r)),n}function jU(t,e){const n={},r=d(t,["modelSelectionConfig"]);r!=null&&f(n,["modelConfig"],r);const i=d(t,["responseJsonSchema"]);i!=null&&f(n,["responseJsonSchema"],i);const s=d(t,["audioTimestamp"]);s!=null&&f(n,["audioTimestamp"],s);const o=d(t,["candidateCount"]);o!=null&&f(n,["candidateCount"],o);const a=d(t,["enableAffectiveDialog"]);a!=null&&f(n,["enableAffectiveDialog"],a);const l=d(t,["frequencyPenalty"]);l!=null&&f(n,["frequencyPenalty"],l);const u=d(t,["logprobs"]);u!=null&&f(n,["logprobs"],u);const h=d(t,["maxOutputTokens"]);h!=null&&f(n,["maxOutputTokens"],h);const p=d(t,["mediaResolution"]);p!=null&&f(n,["mediaResolution"],p);const m=d(t,["presencePenalty"]);m!=null&&f(n,["presencePenalty"],m);const g=d(t,["responseLogprobs"]);g!=null&&f(n,["responseLogprobs"],g);const y=d(t,["responseMimeType"]);y!=null&&f(n,["responseMimeType"],y);const w=d(t,["responseModalities"]);w!=null&&f(n,["responseModalities"],w);const T=d(t,["responseSchema"]);T!=null&&f(n,["responseSchema"],T);const x=d(t,["routingConfig"]);x!=null&&f(n,["routingConfig"],x);const v=d(t,["seed"]);v!=null&&f(n,["seed"],v);const _=d(t,["speechConfig"]);_!=null&&f(n,["speechConfig"],_);const b=d(t,["stopSequences"]);b!=null&&f(n,["stopSequences"],b);const S=d(t,["temperature"]);S!=null&&f(n,["temperature"],S);const I=d(t,["thinkingConfig"]);I!=null&&f(n,["thinkingConfig"],I);const E=d(t,["topK"]);E!=null&&f(n,["topK"],E);const R=d(t,["topP"]);if(R!=null&&f(n,["topP"],R),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function $U(t,e,n){const r={},i=d(e,["model"]);return i!=null&&f(r,["_url","name"],me(t,i)),r}function VU(t,e,n){const r={},i=d(e,["model"]);return i!=null&&f(r,["_url","name"],me(t,i)),r}function BU(t,e){const n={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=d(t,["enableWidget"]);return r!=null&&f(n,["enableWidget"],r),n}function qU(t,e){const n={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=d(t,["timeRangeFilter"]);return r!=null&&f(n,["timeRangeFilter"],r),n}function GU(t,e){const n={},r=d(t,["aspectRatio"]);r!=null&&f(n,["aspectRatio"],r);const i=d(t,["imageSize"]);if(i!=null&&f(n,["imageSize"],i),d(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(d(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return n}function HU(t,e){const n={},r=d(t,["aspectRatio"]);r!=null&&f(n,["aspectRatio"],r);const i=d(t,["imageSize"]);i!=null&&f(n,["imageSize"],i);const s=d(t,["personGeneration"]);s!=null&&f(n,["personGeneration"],s);const o=d(t,["outputMimeType"]);o!=null&&f(n,["imageOutputOptions","mimeType"],o);const a=d(t,["outputCompressionQuality"]);return a!=null&&f(n,["imageOutputOptions","compressionQuality"],a),n}function zU(t,e){const n={},r=d(t,["bytesBase64Encoded"]);r!=null&&f(n,["imageBytes"],zi(r));const i=d(t,["mimeType"]);return i!=null&&f(n,["mimeType"],i),n}function eC(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["gcsUri"],r);const i=d(t,["bytesBase64Encoded"]);i!=null&&f(n,["imageBytes"],zi(i));const s=d(t,["mimeType"]);return s!=null&&f(n,["mimeType"],s),n}function Jh(t,e){const n={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=d(t,["imageBytes"]);r!=null&&f(n,["bytesBase64Encoded"],zi(r));const i=d(t,["mimeType"]);return i!=null&&f(n,["mimeType"],i),n}function tr(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["gcsUri"],r);const i=d(t,["imageBytes"]);i!=null&&f(n,["bytesBase64Encoded"],zi(i));const s=d(t,["mimeType"]);return s!=null&&f(n,["mimeType"],s),n}function WU(t,e,n,r){const i={},s=d(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const o=d(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const a=d(e,["filter"]);n!==void 0&&a!=null&&f(n,["_query","filter"],a);const l=d(e,["queryBase"]);return n!==void 0&&l!=null&&f(n,["_url","models_url"],WE(t,l)),i}function KU(t,e,n,r){const i={},s=d(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const o=d(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const a=d(e,["filter"]);n!==void 0&&a!=null&&f(n,["_query","filter"],a);const l=d(e,["queryBase"]);return n!==void 0&&l!=null&&f(n,["_url","models_url"],WE(t,l)),i}function JU(t,e,n){const r={},i=d(e,["config"]);return i!=null&&WU(t,i,r),r}function YU(t,e,n){const r={},i=d(e,["config"]);return i!=null&&KU(t,i,r),r}function QU(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=d(t,["_self"]);if(s!=null){let o=KE(s);Array.isArray(o)&&(o=o.map(a=>ag(a))),f(n,["models"],o)}return n}function XU(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=d(t,["_self"]);if(s!=null){let o=KE(s);Array.isArray(o)&&(o=o.map(a=>lg(a))),f(n,["models"],o)}return n}function ZU(t,e){const n={},r=d(t,["maskMode"]);r!=null&&f(n,["maskMode"],r);const i=d(t,["segmentationClasses"]);i!=null&&f(n,["maskClasses"],i);const s=d(t,["maskDilation"]);return s!=null&&f(n,["dilation"],s),n}function ag(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["name"],r);const i=d(t,["displayName"]);i!=null&&f(n,["displayName"],i);const s=d(t,["description"]);s!=null&&f(n,["description"],s);const o=d(t,["version"]);o!=null&&f(n,["version"],o);const a=d(t,["_self"]);a!=null&&f(n,["tunedModelInfo"],mF(a));const l=d(t,["inputTokenLimit"]);l!=null&&f(n,["inputTokenLimit"],l);const u=d(t,["outputTokenLimit"]);u!=null&&f(n,["outputTokenLimit"],u);const h=d(t,["supportedGenerationMethods"]);h!=null&&f(n,["supportedActions"],h);const p=d(t,["temperature"]);p!=null&&f(n,["temperature"],p);const m=d(t,["maxTemperature"]);m!=null&&f(n,["maxTemperature"],m);const g=d(t,["topP"]);g!=null&&f(n,["topP"],g);const y=d(t,["topK"]);y!=null&&f(n,["topK"],y);const w=d(t,["thinking"]);return w!=null&&f(n,["thinking"],w),n}function lg(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["name"],r);const i=d(t,["displayName"]);i!=null&&f(n,["displayName"],i);const s=d(t,["description"]);s!=null&&f(n,["description"],s);const o=d(t,["versionId"]);o!=null&&f(n,["version"],o);const a=d(t,["deployedModels"]);if(a!=null){let m=a;Array.isArray(m)&&(m=m.map(g=>hU(g))),f(n,["endpoints"],m)}const l=d(t,["labels"]);l!=null&&f(n,["labels"],l);const u=d(t,["_self"]);u!=null&&f(n,["tunedModelInfo"],gF(u));const h=d(t,["defaultCheckpointId"]);h!=null&&f(n,["defaultCheckpointId"],h);const p=d(t,["checkpoints"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>g)),f(n,["checkpoints"],m)}return n}function eF(t,e){const n={},r=d(t,["mediaResolution"]);r!=null&&f(n,["mediaResolution"],r);const i=d(t,["codeExecutionResult"]);i!=null&&f(n,["codeExecutionResult"],i);const s=d(t,["executableCode"]);s!=null&&f(n,["executableCode"],s);const o=d(t,["fileData"]);o!=null&&f(n,["fileData"],fU(o));const a=d(t,["functionCall"]);a!=null&&f(n,["functionCall"],pU(a));const l=d(t,["functionResponse"]);l!=null&&f(n,["functionResponse"],l);const u=d(t,["inlineData"]);u!=null&&f(n,["inlineData"],j4(u));const h=d(t,["text"]);h!=null&&f(n,["text"],h);const p=d(t,["thought"]);p!=null&&f(n,["thought"],p);const m=d(t,["thoughtSignature"]);m!=null&&f(n,["thoughtSignature"],m);const g=d(t,["videoMetadata"]);return g!=null&&f(n,["videoMetadata"],g),n}function tF(t,e){const n={},r=d(t,["productImage"]);return r!=null&&f(n,["image"],tr(r)),n}function nF(t,e,n){const r={},i=d(t,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(t,["baseSteps"]);e!==void 0&&s!=null&&f(e,["parameters","baseSteps"],s);const o=d(t,["outputGcsUri"]);e!==void 0&&o!=null&&f(e,["parameters","storageUri"],o);const a=d(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const l=d(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&f(e,["parameters","safetySetting"],l);const u=d(t,["personGeneration"]);e!==void 0&&u!=null&&f(e,["parameters","personGeneration"],u);const h=d(t,["addWatermark"]);e!==void 0&&h!=null&&f(e,["parameters","addWatermark"],h);const p=d(t,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const m=d(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&f(e,["parameters","outputOptions","compressionQuality"],m);const g=d(t,["enhancePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","enhancePrompt"],g);const y=d(t,["labels"]);return e!==void 0&&y!=null&&f(e,["labels"],y),r}function rF(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["source"]);s!=null&&sF(s,r);const o=d(e,["config"]);return o!=null&&nF(o,r),r}function iF(t,e){const n={},r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Kh(s))),f(n,["generatedImages"],i)}return n}function sF(t,e,n){const r={},i=d(t,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(t,["personImage"]);e!==void 0&&s!=null&&f(e,["instances[0]","personImage","image"],tr(s));const o=d(t,["productImages"]);if(e!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>tF(l))),f(e,["instances[0]","productImages"],a)}return r}function oF(t,e){const n={},r=d(t,["referenceImage"]);r!=null&&f(n,["referenceImage"],tr(r));const i=d(t,["referenceId"]);i!=null&&f(n,["referenceId"],i);const s=d(t,["referenceType"]);s!=null&&f(n,["referenceType"],s);const o=d(t,["maskImageConfig"]);o!=null&&f(n,["maskImageConfig"],ZU(o));const a=d(t,["controlImageConfig"]);a!=null&&f(n,["controlImageConfig"],z4(a));const l=d(t,["styleImageConfig"]);l!=null&&f(n,["styleImageConfig"],l);const u=d(t,["subjectImageConfig"]);return u!=null&&f(n,["subjectImageConfig"],u),n}function tC(t,e){const n={},r=d(t,["safetyAttributes","categories"]);r!=null&&f(n,["categories"],r);const i=d(t,["safetyAttributes","scores"]);i!=null&&f(n,["scores"],i);const s=d(t,["contentType"]);return s!=null&&f(n,["contentType"],s),n}function nC(t,e){const n={},r=d(t,["safetyAttributes","categories"]);r!=null&&f(n,["categories"],r);const i=d(t,["safetyAttributes","scores"]);i!=null&&f(n,["scores"],i);const s=d(t,["contentType"]);return s!=null&&f(n,["contentType"],s),n}function aF(t,e){const n={},r=d(t,["category"]);if(r!=null&&f(n,["category"],r),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=d(t,["threshold"]);return i!=null&&f(n,["threshold"],i),n}function lF(t,e){const n={},r=d(t,["image"]);return r!=null&&f(n,["image"],tr(r)),n}function uF(t,e,n){const r={},i=d(t,["mode"]);e!==void 0&&i!=null&&f(e,["parameters","mode"],i);const s=d(t,["maxPredictions"]);e!==void 0&&s!=null&&f(e,["parameters","maxPredictions"],s);const o=d(t,["confidenceThreshold"]);e!==void 0&&o!=null&&f(e,["parameters","confidenceThreshold"],o);const a=d(t,["maskDilation"]);e!==void 0&&a!=null&&f(e,["parameters","maskDilation"],a);const l=d(t,["binaryColorThreshold"]);e!==void 0&&l!=null&&f(e,["parameters","binaryColorThreshold"],l);const u=d(t,["labels"]);return e!==void 0&&u!=null&&f(e,["labels"],u),r}function cF(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["source"]);s!=null&&hF(s,r);const o=d(e,["config"]);return o!=null&&uF(o,r),r}function dF(t,e){const n={},r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>UU(s))),f(n,["generatedMasks"],i)}return n}function hF(t,e,n){const r={},i=d(t,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],tr(s));const o=d(t,["scribbleImage"]);return e!==void 0&&o!=null&&f(e,["instances[0]","scribble"],lF(o)),r}function fF(t,e){const n={},r=d(t,["retrievalConfig"]);r!=null&&f(n,["retrievalConfig"],r);const i=d(t,["functionCallingConfig"]);return i!=null&&f(n,["functionCallingConfig"],mU(i)),n}function pF(t,e){const n={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["computerUse"]);r!=null&&f(n,["computerUse"],r);const i=d(t,["fileSearch"]);i!=null&&f(n,["fileSearch"],i);const s=d(t,["codeExecution"]);if(s!=null&&f(n,["codeExecution"],s),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(t,["functionDeclarations"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(m=>m)),f(n,["functionDeclarations"],p)}const a=d(t,["googleMaps"]);a!=null&&f(n,["googleMaps"],BU(a));const l=d(t,["googleSearch"]);l!=null&&f(n,["googleSearch"],qU(l));const u=d(t,["googleSearchRetrieval"]);u!=null&&f(n,["googleSearchRetrieval"],u);const h=d(t,["urlContext"]);return h!=null&&f(n,["urlContext"],h),n}function rC(t,e){const n={},r=d(t,["retrieval"]);r!=null&&f(n,["retrieval"],r);const i=d(t,["computerUse"]);if(i!=null&&f(n,["computerUse"],i),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=d(t,["codeExecution"]);s!=null&&f(n,["codeExecution"],s);const o=d(t,["enterpriseWebSearch"]);o!=null&&f(n,["enterpriseWebSearch"],o);const a=d(t,["functionDeclarations"]);if(a!=null){let m=a;Array.isArray(m)&&(m=m.map(g=>gU(g))),f(n,["functionDeclarations"],m)}const l=d(t,["googleMaps"]);l!=null&&f(n,["googleMaps"],l);const u=d(t,["googleSearch"]);u!=null&&f(n,["googleSearch"],u);const h=d(t,["googleSearchRetrieval"]);h!=null&&f(n,["googleSearchRetrieval"],h);const p=d(t,["urlContext"]);return p!=null&&f(n,["urlContext"],p),n}function mF(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=d(t,["createTime"]);i!=null&&f(n,["createTime"],i);const s=d(t,["updateTime"]);return s!=null&&f(n,["updateTime"],s),n}function gF(t,e){const n={},r=d(t,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&f(n,["baseModel"],r);const i=d(t,["createTime"]);i!=null&&f(n,["createTime"],i);const s=d(t,["updateTime"]);return s!=null&&f(n,["updateTime"],s),n}function yF(t,e,n){const r={},i=d(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const o=d(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),r}function vF(t,e,n){const r={},i=d(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const o=d(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),r}function xF(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","name"],me(t,i));const s=d(e,["config"]);return s!=null&&yF(s,r),r}function wF(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["config"]);return s!=null&&vF(s,r),r}function _F(t,e,n){const r={},i=d(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&f(e,["parameters","safetySetting"],s);const o=d(t,["personGeneration"]);e!==void 0&&o!=null&&f(e,["parameters","personGeneration"],o);const a=d(t,["includeRaiReason"]);e!==void 0&&a!=null&&f(e,["parameters","includeRaiReason"],a);const l=d(t,["outputMimeType"]);e!==void 0&&l!=null&&f(e,["parameters","outputOptions","mimeType"],l);const u=d(t,["outputCompressionQuality"]);e!==void 0&&u!=null&&f(e,["parameters","outputOptions","compressionQuality"],u);const h=d(t,["enhanceInputImage"]);e!==void 0&&h!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],h);const p=d(t,["imagePreservationFactor"]);e!==void 0&&p!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const m=d(t,["labels"]);e!==void 0&&m!=null&&f(e,["labels"],m);const g=d(t,["numberOfImages"]);e!==void 0&&g!=null&&f(e,["parameters","sampleCount"],g);const y=d(t,["mode"]);return e!==void 0&&y!=null&&f(e,["parameters","mode"],y),r}function TF(t,e,n){const r={},i=d(e,["model"]);i!=null&&f(r,["_url","model"],me(t,i));const s=d(e,["image"]);s!=null&&f(r,["instances[0]","image"],tr(s));const o=d(e,["upscaleFactor"]);o!=null&&f(r,["parameters","upscaleConfig","upscaleFactor"],o);const a=d(e,["config"]);return a!=null&&_F(a,r),r}function IF(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Kh(o))),f(n,["generatedImages"],s)}return n}function SF(t,e){const n={},r=d(t,["uri"]);r!=null&&f(n,["uri"],r);const i=d(t,["encodedVideo"]);i!=null&&f(n,["videoBytes"],zi(i));const s=d(t,["encoding"]);return s!=null&&f(n,["mimeType"],s),n}function bF(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["uri"],r);const i=d(t,["bytesBase64Encoded"]);i!=null&&f(n,["videoBytes"],zi(i));const s=d(t,["mimeType"]);return s!=null&&f(n,["mimeType"],s),n}function EF(t,e){const n={},r=d(t,["image"]);r!=null&&f(n,["_self"],tr(r));const i=d(t,["maskMode"]);return i!=null&&f(n,["maskMode"],i),n}function CF(t,e){const n={},r=d(t,["image"]);r!=null&&f(n,["image"],Jh(r));const i=d(t,["referenceType"]);return i!=null&&f(n,["referenceType"],i),n}function NF(t,e){const n={},r=d(t,["image"]);r!=null&&f(n,["image"],tr(r));const i=d(t,["referenceType"]);return i!=null&&f(n,["referenceType"],i),n}function iC(t,e){const n={},r=d(t,["uri"]);r!=null&&f(n,["uri"],r);const i=d(t,["videoBytes"]);i!=null&&f(n,["encodedVideo"],zi(i));const s=d(t,["mimeType"]);return s!=null&&f(n,["encoding"],s),n}function sC(t,e){const n={},r=d(t,["uri"]);r!=null&&f(n,["gcsUri"],r);const i=d(t,["videoBytes"]);i!=null&&f(n,["bytesBase64Encoded"],zi(i));const s=d(t,["mimeType"]);return s!=null&&f(n,["mimeType"],s),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AF(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["displayName"],r),n}function kF(t){const e={},n=d(t,["config"]);return n!=null&&AF(n,e),e}function RF(t,e){const n={},r=d(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function PF(t){const e={},n=d(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=d(t,["config"]);return r!=null&&RF(r,e),e}function DF(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function MF(t,e){const n={},r=d(t,["customMetadata"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["customMetadata"],s)}const i=d(t,["chunkingConfig"]);return e!==void 0&&i!=null&&f(e,["chunkingConfig"],i),n}function LF(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const s=d(t,["error"]);s!=null&&f(e,["error"],s);const o=d(t,["response"]);return o!=null&&f(e,["response"],FF(o)),e}function UF(t){const e={},n=d(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=d(t,["fileName"]);r!=null&&f(e,["fileName"],r);const i=d(t,["config"]);return i!=null&&MF(i,e),e}function FF(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const i=d(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function OF(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function jF(t){const e={},n=d(t,["config"]);return n!=null&&OF(n,e),e}function $F(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["fileSearchStores"],s)}return e}function oC(t,e){const n={},r=d(t,["mimeType"]);e!==void 0&&r!=null&&f(e,["mimeType"],r);const i=d(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(t,["customMetadata"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),f(e,["customMetadata"],a)}const o=d(t,["chunkingConfig"]);return e!==void 0&&o!=null&&f(e,["chunkingConfig"],o),n}function VF(t){const e={},n=d(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=d(t,["config"]);return r!=null&&oC(r,e),e}function BF(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qF="Content-Type",GF="X-Server-Timeout",HF="User-Agent",ug="x-goog-api-client",zF="1.42.0",WF=`google-genai-sdk/${zF}`,KF="v1beta1",JF="v1beta",YF=5,QF=[408,429,500,502,503,504];class XF{constructor(e){var n,r,i;this.clientOptions=Object.assign({},e),this.customBaseUrl=(n=e.httpOptions)===null||n===void 0?void 0:n.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const s={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const a=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!a?(s.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?s.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(s.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:KF}else{if(!this.clientOptions.apiKey)throw new nu({message:"API key must be set when using the Gemini API.",status:403});s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:JF,s.baseUrl="https://generativelanguage.googleapis.com/"}s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e,n){return!(n.baseUrl&&n.baseUrlResourceScope===rg.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e,n),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e,n),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return n&&n.extraBody!==null&&ZF(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await X_(i),new ig(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await X_(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return Jn(this,arguments,function*(){var r;const i=(r=e==null?void 0:e.body)===null||r===void 0?void 0:r.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";const a="data:",l=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:u,value:h}=yield ee(i.read());if(u){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=s.decode(h,{stream:!0});try{const y=JSON.parse(p);if("error"in y){const w=JSON.parse(JSON.stringify(y.error)),T=w.status,x=w.code,v=`got status: ${T}. ${JSON.stringify(y)}`;if(x>=400&&x<600)throw new nu({message:v,status:x})}}catch(y){if(y.name==="ApiError")throw y}o+=p;let m=-1,g=0;for(;;){m=-1,g=0;for(const T of l){const x=o.indexOf(T);x!==-1&&(m===-1||x<m)&&(m=x,g=T.length)}if(m===-1)break;const y=o.substring(0,m);o=o.substring(m+g);const w=y.trim();if(w.startsWith(a)){const T=w.substring(a.length).trim();try{const x=new Response(T,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ee(new ig(x))}catch(x){throw new Error(`exception parsing stream chunk ${T}. ${x}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,n){var r;if(!this.clientOptions.httpOptions||!this.clientOptions.httpOptions.retryOptions)return fetch(e,n);const i=this.clientOptions.httpOptions.retryOptions;return B2(async()=>{const o=await fetch(e,n);if(o.ok)return o;throw QF.includes(o.status)?new Error(`Retryable HTTP Error: ${o.statusText}`):new $2(`Non-retryable exception ${o.statusText} sending request`)},{retries:((r=i.attempts)!==null&&r!==void 0?r:YF)-1})}getDefaultHeaders(){const e={},n=WF+" "+this.clientOptions.userAgentExtra;return e[HF]=n,e[ug]=n,e[qF]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(GF,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l={file:i},u=this.getFileName(e),h=B("upload/v1beta/files",l._url),p=await this.fetchUploadUrl(h,i.sizeBytes,i.mimeType,u,l,n==null?void 0:n.httpOptions);return s.upload(e,p,this)}async uploadFileToFileSearchStore(e,n,r){var i;const s=this.clientOptions.uploader,o=await s.stat(n),a=String(o.size),l=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,h=this.getFileName(n),p={};r!=null&&oC(r,p);const m=await this.fetchUploadUrl(u,a,l,h,p,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(n,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,i,s,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function X_(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new nu({message:i,status:n}):new Error(i)}}function ZF(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],h=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&h&&typeof h=="object"&&!Array.isArray(h)?a[l]=r(h,u):(h&&u&&typeof h!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof h}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eO="mcp_used/unknown";let tO=!1;function aC(t){for(const e of t)if(nO(e)||typeof e=="object"&&"inputSchema"in e)return!0;return tO}function lC(t){var e;const n=(e=t[ug])!==null&&e!==void 0?e:"";t[ug]=(n+` ${eO}`).trimStart()}function nO(t){return t!==null&&typeof t=="object"&&t instanceof yv}function rO(t){return Jn(this,arguments,function*(n,r=100){let i,s=0;for(;s<r;){const o=yield ee(n.listTools({cursor:i}));for(const a of o.tools)yield yield ee(a),s++;if(!o.nextCursor)break;i=o.nextCursor}})}class yv{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new yv(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const h of this.mcpClients)try{for(var a=!0,l=(n=void 0,Yn(rO(h))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const p=i;o.push(p);const m=p.name;if(s[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);s[m]=h}}catch(p){n={error:p}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),AM(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function iO(t,e,n){const r=new _M;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class sO{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=lO(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const h=new Promise(_=>{u=_}),p=e.callbacks,m=function(){u({})},g=this.apiClient,y={onopen:m,onmessage:_=>{iO(g,p.onmessage,_)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(_){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(_){}},w=this.webSocketFactory.create(l,aO(o),y);w.connect(),await h;const v={setup:{model:me(this.apiClient,e.model)}};return w.send(JSON.stringify(v)),new oO(w,this.apiClient)}}class oO{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=A4(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=N4(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(ko.PLAY)}pause(){this.sendPlaybackControl(ko.PAUSE)}stop(){this.sendPlaybackControl(ko.STOP)}resetContext(){this.sendPlaybackControl(ko.RESET_CONTEXT)}close(){this.conn.close()}}function aO(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function lO(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const uO="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function cO(t,e,n){const r=new wM;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=P4(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class dO{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new sO(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let h;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&aC(e.config.tools)&&lC(p);const m=mO(p);if(this.apiClient.isVertexAI()){const F=this.apiClient.getProject(),M=this.apiClient.getLocation(),Q=this.apiClient.getApiKey(),ne=!!F&&!!M||!!Q;this.apiClient.getCustomBaseUrl()&&!ne?h=l:(h=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,h))}else{const F=this.apiClient.getApiKey();let M="BidiGenerateContent",Q="key";F!=null&&F.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),M="BidiGenerateContentConstrained",Q="access_token"),h=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${M}?${Q}=${F}`}let g=()=>{};const y=new Promise(F=>{g=F}),w=e.callbacks,T=function(){var F;(F=w==null?void 0:w.onopen)===null||F===void 0||F.call(w),g({})},x=this.apiClient,v={onopen:T,onmessage:F=>{cO(x,w.onmessage,F)},onerror:(n=w==null?void 0:w.onerror)!==null&&n!==void 0?n:function(F){},onclose:(r=w==null?void 0:w.onclose)!==null&&r!==void 0?r:function(F){}},_=this.webSocketFactory.create(h,pO(m),v);_.connect(),await y;let b=me(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&b.startsWith("publishers/")){const F=this.apiClient.getProject(),M=this.apiClient.getLocation();F&&M&&(b=`projects/${F}/locations/${M}/`+b)}let S={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Jd.AUDIO]}:e.config.responseModalities=[Jd.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],E=[];for(const F of I)if(this.isCallableTool(F)){const M=F;E.push(await M.tool())}else E.push(F);E.length>0&&(e.config.tools=E);const R={model:b,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?S=C4(this.apiClient,R):S=E4(this.apiClient,R),delete S.config,_.send(JSON.stringify(S)),new fO(_,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const hO={turnComplete:!0};class fO{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=_n(n.turns),e.isVertexAI()||(r=r.map(i=>Uu(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(uO)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},hO),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:R4(e)}:n={realtimeInput:k4(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function pO(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function mO(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Z_=10;function eT(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Vo(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Vo(t){return"callTool"in t&&typeof t.callTool=="function"}function gO(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>Vo(i)))!==null&&r!==void 0?r:!1}function tT(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,i)=>{if(Vo(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(i)}),n}function nT(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yO extends Wr{constructor(e){super(),this.apiClient=e,this.embedContent=async n=>{if(!this.apiClient.isVertexAI())return await this.embedContentInternal(n);if(n.model.includes("gemini")&&n.model!=="gemini-embedding-001"||n.model.includes("maas")){const i=_n(n.contents);if(i.length>1)throw new Error("The embedContent API for this model only supports one content at a time.");const s=Object.assign(Object.assign({},n),{content:i[0],embeddingApiType:Yd.EMBED_CONTENT});return await this.embedContentInternal(s)}else{const i=Object.assign(Object.assign({},n),{embeddingApiType:Yd.PREDICT});return await this.embedContentInternal(i)}},this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!gO(n)||eT(n.config))return await this.generateContentInternal(l);const u=tT(n);if(u.length>0){const w=u.map(T=>`tools[${T}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${w}.`)}let h,p;const m=_n(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:Z_;let y=0;for(;y<g&&(h=await this.generateContentInternal(l),!(!h.functionCalls||h.functionCalls.length===0));){const w=h.candidates[0].content,T=[];for(const x of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(Vo(x)){const _=await x.callTool(h.functionCalls);T.push(..._)}y++,p={role:"user",parts:T},l.contents=_n(l.contents),l.contents.push(w),l.contents.push(p),nT(l.config)&&(m.push(w),m.push(p))}return nT(l.config)&&(h.automaticFunctionCallingHistory=m),h},this.generateContentStream=async n=>{var r,i,s,o,a;if(this.maybeMoveToResponseJsonSchem(n),eT(n.config)){const p=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(p)}const l=tT(n);if(l.length>0){const p=l.map(m=>`tools[${m}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(s=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,h=(a=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(u&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Zs(Br.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>Vo(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&aC(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),lC(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Vo(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:Z_;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,h,p){return Jn(this,arguments,function*(){for(var m,g,y,w,T,x;a<s;){o&&(a++,o=!1);const S=yield ee(u.processParamsMaybeAddMcpUsage(p)),I=yield ee(u.generateContentStreamInternal(S)),E=[],R=[];try{for(var v=!0,_=(g=void 0,Yn(I)),b;b=yield ee(_.next()),m=b.done,!m;v=!0){w=b.value,v=!1;const F=w;if(yield yield ee(F),F.candidates&&(!((T=F.candidates[0])===null||T===void 0)&&T.content)){R.push(F.candidates[0].content);for(const M of(x=F.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(a<s&&M.functionCall){if(!M.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(M.functionCall.name)){const Q=yield ee(h.get(M.functionCall.name).callTool([M.functionCall]));E.push(...Q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${M.functionCall.name}`)}}}}catch(F){g={error:F}}finally{try{!v&&!m&&(y=_.return)&&(yield ee(y.call(_)))}finally{if(g)throw g.error}}if(E.length>0){o=!0;const F=new Ka;F.candidates=[{content:{role:"user",parts:E}}],yield yield ee(F);const M=[];M.push(...R),M.push({role:"user",parts:E});const Q=_n(p.contents).concat(M);p.contents=Q}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=J_(this.apiClient,e);return a=B("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=Q_(h),m=new Ka;return Object.assign(m,p),m})}else{const u=K_(this.apiClient,e);return a=B("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=Y_(h),m=new Ka;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=J_(this.apiClient,e);return a=B("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return Jn(this,arguments,function*(){var m,g,y,w;try{for(var T=!0,x=Yn(p),v;v=yield ee(x.next()),m=v.done,!m;T=!0){w=v.value,T=!1;const _=w,b=Q_(yield ee(_.json()),e);b.sdkHttpResponse={headers:_.headers};const S=new Ka;Object.assign(S,b),yield yield ee(S)}}catch(_){g={error:_}}finally{try{!T&&!m&&(y=x.return)&&(yield ee(y.call(x)))}finally{if(g)throw g.error}}})})}else{const u=K_(this.apiClient,e);return a=B("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(p){return Jn(this,arguments,function*(){var m,g,y,w;try{for(var T=!0,x=Yn(p),v;v=yield ee(x.next()),m=v.done,!m;T=!0){w=v.value,T=!1;const _=w,b=Y_(yield ee(_.json()),e);b.sdkHttpResponse={headers:_.headers};const S=new Ka;Object.assign(S,b),yield yield ee(S)}}catch(_){g={error:_}}finally{try{!T&&!m&&(y=x.return)&&(yield ee(y.call(x)))}finally{if(g)throw g.error}}})})}}async embedContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=uU(this.apiClient,e,e),h=RM(e.model)?"{model}:embedContent":"{model}:predict";return a=B(h,u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=dU(p,e),g=new R_;return Object.assign(g,m),g})}else{const u=lU(this.apiClient,e);return a=B("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=cU(h),m=new R_;return Object.assign(m,p),m})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=TU(this.apiClient,e);return a=B("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=SU(h),m=new P_;return Object.assign(m,p),m})}else{const u=_U(this.apiClient,e);return a=B("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=IU(h),m=new P_;return Object.assign(m,p),m})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=iU(this.apiClient,e);return s=B("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),i.then(l=>{const u=sU(l),h=new lM;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=TF(this.apiClient,e);return s=B("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),i.then(l=>{const u=IF(l),h=new uM;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=rF(this.apiClient,e);return s=B("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=iF(l),h=new cM;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=cF(this.apiClient,e);return s=B("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=dF(l),h=new dM;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=VU(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>lg(h))}else{const u=$U(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>ag(h))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=YU(this.apiClient,e);return a=B("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=XU(h),m=new D_;return Object.assign(m,p),m})}else{const u=JU(this.apiClient,e);return a=B("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=QU(h),m=new D_;return Object.assign(m,p),m})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=wF(this.apiClient,e);return a=B("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>lg(h))}else{const u=xF(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>ag(h))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=eU(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=nU(h),m=new M_;return Object.assign(m,p),m})}else{const u=Z4(this.apiClient,e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=tU(h),m=new M_;return Object.assign(m,p),m})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Y4(this.apiClient,e);return a=B("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=X4(h),m=new L_;return Object.assign(m,p),m})}else{const u=J4(this.apiClient,e);return a=B("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=Q4(h),m=new L_;return Object.assign(m,p),m})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=B4(this.apiClient,e);return s=B("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),i.then(l=>{const u=q4(l),h=new hM;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=kU(this.apiClient,e);return a=B("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=NU(h),m=new Qd;return Object.assign(m,p),m})}else{const u=AU(this.apiClient,e);return a=B("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const p=CU(h),m=new Qd;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vO extends Wr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=nM(e);return a=B("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o}else{const u=tM(e);return a=B("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=K2(e);return s=B("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xO(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function wO(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>AO(s))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function _O(t,e,n){const r={},i=d(e,["expireTime"]);n!==void 0&&i!=null&&f(n,["expireTime"],i);const s=d(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&f(n,["newSessionExpireTime"],s);const o=d(e,["uses"]);n!==void 0&&o!=null&&f(n,["uses"],o);const a=d(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&f(n,["bidiGenerateContentSetup"],NO(t,a));const l=d(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&f(n,["fieldMask"],l),r}function TO(t,e){const n={},r=d(e,["config"]);return r!=null&&f(n,["config"],_O(t,r,n)),n}function IO(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function SO(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function bO(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function EO(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function CO(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],gv(p));const m=d(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=d(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=d(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],wO(ct(y)));const w=d(t,["tools"]);if(e!==void 0&&w!=null){let I=Ta(w);Array.isArray(I)&&(I=I.map(E=>RO(_a(E)))),f(e,["setup","tools"],I)}const T=d(t,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],kO(T));const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const v=d(t,["outputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","outputAudioTranscription"],v);const _=d(t,["realtimeInputConfig"]);e!==void 0&&_!=null&&f(e,["setup","realtimeInputConfig"],_);const b=d(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const S=d(t,["proactivity"]);if(e!==void 0&&S!=null&&f(e,["setup","proactivity"],S),d(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function NO(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],me(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],CO(i,n)),n}function AO(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&f(e,["fileData"],IO(s));const o=d(t,["functionCall"]);o!=null&&f(e,["functionCall"],SO(o));const a=d(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(t,["inlineData"]);l!=null&&f(e,["inlineData"],xO(l));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const h=d(t,["thought"]);h!=null&&f(e,["thought"],h);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function kO(t){const e={},n=d(t,["handle"]);if(n!=null&&f(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function RO(t){const e={};if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=d(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const i=d(t,["codeExecution"]);if(i!=null&&f(e,["codeExecution"],i),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=d(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const o=d(t,["googleMaps"]);o!=null&&f(e,["googleMaps"],bO(o));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],EO(a));const l=d(t,["googleSearchRetrieval"]);l!=null&&f(e,["googleSearchRetrieval"],l);const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PO(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function DO(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=PO(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class MO extends Wr{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=TO(this.apiClient,e);s=B("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=DO(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LO(t,e){const n={},r=d(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function UO(t){const e={},n=d(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=d(t,["config"]);return r!=null&&LO(r,e),e}function FO(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function OO(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function jO(t){const e={},n=d(t,["parent"]);n!=null&&f(e,["_url","parent"],n);const r=d(t,["config"]);return r!=null&&OO(r,e),e}function $O(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["documents"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VO extends Wr{constructor(e){super(),this.apiClient=e,this.list=async n=>new Zs(Br.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=FO(e);return s=B("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=UO(e);i=B("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=jO(e);return s=B("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=$O(l),h=new fM;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BO extends Wr{constructor(e,n=new VO(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new Zs(Br.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=kF(e);return s=B("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=DF(e);return s=B("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=PF(e);i=B("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=jF(e);return s=B("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=$F(l),h=new pM;return Object.assign(h,u),h})}}async uploadToFileSearchStoreInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=VF(e);return s=B("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=BF(l),h=new mM;return Object.assign(h,u),h})}}async importFile(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=UF(e);return s=B("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=LF(l),h=new dv;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let uC=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return uC=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};const qO=()=>uC();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cg(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const dg=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jn extends Error{}class Jt extends jn{constructor(e,n,r,i){super(`${Jt.makeMessage(e,n,r)}`),this.status=e,this.headers=i,this.error=n}static makeMessage(e,n,r){const i=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,r,i){if(!e||!i)return new Yh({message:r,cause:dg(n)});const s=n;return e===400?new dC(e,s,r,i):e===401?new hC(e,s,r,i):e===403?new fC(e,s,r,i):e===404?new pC(e,s,r,i):e===409?new mC(e,s,r,i):e===422?new gC(e,s,r,i):e===429?new yC(e,s,r,i):e>=500?new vC(e,s,r,i):new Jt(e,s,r,i)}}class hg extends Jt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Yh extends Jt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class cC extends Yh{constructor({message:e}={}){super({message:e??"Request timed out."})}}class dC extends Jt{}class hC extends Jt{}class fC extends Jt{}class pC extends Jt{}class mC extends Jt{}class gC extends Jt{}class yC extends Jt{}class vC extends Jt{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GO=/^[a-z][a-z0-9+.-]*:/i,HO=t=>GO.test(t);let fg=t=>(fg=Array.isArray,fg(t));const zO=fg;let WO=zO;const rT=WO;function KO(t){if(!t)return!0;for(const e in t)return!1;return!0}function JO(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const YO=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new jn(`${t} must be an integer`);if(e<0)throw new jn(`${t} must be a positive integer`);return e},QO=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const XO=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const po="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZO(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const ej=()=>{var t,e,n,r,i;const s=ZO();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":po,"X-Stainless-OS":sT(Deno.build.os),"X-Stainless-Arch":iT(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":po,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":po,"X-Stainless-OS":sT((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":iT((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const o=tj();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":po,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":po,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function tj(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const i=r[1]||0,s=r[2]||0,o=r[3]||0;return{browser:e,version:`${i}.${s}.${o}`}}}return null}const iT=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",sT=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Rc;const nj=()=>Rc??(Rc=ej());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rj(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function xC(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function ij(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return xC({start(){},async pull(n){const{done:r,value:i}=await e.next();r?n.close():n.enqueue(i)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function wC(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function sj(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const r=t.getReader(),i=r.cancel();r.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oj=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _C=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Cp(t,e,n){return _C(),new File(t,e??"unknown_file",n)}function aj(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const lj=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const TC=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",uj=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&TC(t),cj=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function dj(t,e,n){if(_C(),t=await t,uj(t))return t instanceof File?t:Cp([await t.arrayBuffer()],t.name);if(cj(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Cp(await pg(i),e,n)}const r=await pg(t);if(e||(e=aj(t)),!(n!=null&&n.type)){const i=r.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof i=="string"&&(n=Object.assign(Object.assign({},n),{type:i}))}return Cp(r,e,n)}async function pg(t){var e,n,r,i,s;let o=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)o.push(t);else if(TC(t))o.push(t instanceof Blob?t:await t.arrayBuffer());else if(lj(t))try{for(var a=!0,l=Yn(t),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const h=i;o.push(...await pg(h))}}catch(h){n={error:h}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}else{const h=(s=t==null?void 0:t.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof t}${h?`; constructor: ${h}`:""}${hj(t)}`)}return o}function hj(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IC{constructor(e){this._client=e}}IC._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SC(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const oT=Object.freeze(Object.create(null)),fj=(t=SC)=>function(n,...r){if(n.length===1)return n[0];let i=!1;const s=[],o=n.reduce((h,p,m)=>{var g,y,w;/[?#]/.test(p)&&(i=!0);const T=r[m];let x=(i?encodeURIComponent:t)(""+T);return m!==r.length&&(T==null||typeof T=="object"&&T.toString===((w=Object.getPrototypeOf((y=Object.getPrototypeOf((g=T.hasOwnProperty)!==null&&g!==void 0?g:oT))!==null&&y!==void 0?y:oT))===null||w===void 0?void 0:w.toString))&&(x=T+"",s.push({start:h.length+p.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(T).slice(8,-1)} is not a valid path parameter`})),h+p+(m===r.length?"":x)},""),a=o.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=l.exec(a))!==null;)s.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(s.sort((h,p)=>h.start-p.start),s.length>0){let h=0;const p=s.reduce((m,g)=>{const y=" ".repeat(g.start-h),w="^".repeat(g.length);return h=g.start+g.length,m+y+w},"");throw new jn(`Path parameters result in path with invalid segments:
${s.map(m=>m.error).join(`
`)}
${o}
${p}`)}return o},Pc=fj(SC);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bC extends IC{create(e,n){var r;const{api_version:i=this._client.apiVersion}=e,s=Zd(e,["api_version"]);if("model"in s&&"agent_config"in s)throw new jn("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new jn("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Pc`/${i}/interactions`,Object.assign(Object.assign({body:s},n),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,n={},r){const{api_version:i=this._client.apiVersion}=n??{};return this._client.delete(Pc`/${i}/interactions/${e}`,r)}cancel(e,n={},r){const{api_version:i=this._client.apiVersion}=n??{};return this._client.post(Pc`/${i}/interactions/${e}/cancel`,r)}get(e,n={},r){var i;const s=n??{},{api_version:o=this._client.apiVersion}=s,a=Zd(s,["api_version"]);return this._client.get(Pc`/${o}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(i=n==null?void 0:n.stream)!==null&&i!==void 0?i:!1}))}}bC._key=Object.freeze(["interactions"]);class EC extends bC{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pj(t){let e=0;for(const i of t)e+=i.length;const n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}let Dc;function vv(t){let e;return(Dc??(e=new globalThis.TextEncoder,Dc=e.encode.bind(e)))(t)}let Mc;function aT(t){let e;return(Mc??(e=new globalThis.TextDecoder,Mc=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qh{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?vv(e):e;this.buffer=pj([this.buffer,n]);const r=[];let i;for(;(i=mj(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){r.push(aT(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,o=aT(this.buffer.subarray(0,s));r.push(o),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}Qh.NEWLINE_CHARS=new Set([`
`,"\r"]);Qh.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function mj(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function gj(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eh={off:0,error:200,warn:300,info:400,debug:500},lT=(t,e,n)=>{if(t){if(JO(eh,t))return t;Bt(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(eh))}`)}};function hl(){}function Lc(t,e,n){return!e||eh[t]>eh[n]?hl:e[t].bind(e)}const yj={error:hl,warn:hl,info:hl,debug:hl};let uT=new WeakMap;function Bt(t){var e;const n=t.logger,r=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return yj;const i=uT.get(n);if(i&&i[0]===r)return i[1];const s={error:Lc("error",n,r),warn:Lc("warn",n,r),info:Lc("info",n,r),debug:Lc("debug",n,r)};return uT.set(n,[r,s]),s}const os=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ro{constructor(e,n,r){this.iterator=e,this.controller=n,this.client=r}static fromSSEResponse(e,n,r){let i=!1;const s=r?Bt(r):console;function o(){return Jn(this,arguments,function*(){var l,u,h,p;if(i)throw new jn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let m=!1;try{try{for(var g=!0,y=Yn(vj(e,n)),w;w=yield ee(y.next()),l=w.done,!l;g=!0){p=w.value,g=!1;const T=p;if(!m)if(T.data.startsWith("[DONE]")){m=!0;continue}else try{yield yield ee(JSON.parse(T.data))}catch(x){throw s.error("Could not parse message into JSON:",T.data),s.error("From chunk:",T.raw),x}}}catch(T){u={error:T}}finally{try{!g&&!l&&(h=y.return)&&(yield ee(h.call(y)))}finally{if(u)throw u.error}}m=!0}catch(T){if(cg(T))return yield ee(void 0);throw T}finally{m||n.abort()}})}return new Ro(o,n,r)}static fromReadableStream(e,n,r){let i=!1;function s(){return Jn(this,arguments,function*(){var l,u,h,p;const m=new Qh,g=wC(e);try{for(var y=!0,w=Yn(g),T;T=yield ee(w.next()),l=T.done,!l;y=!0){p=T.value,y=!1;const x=p;for(const v of m.decode(x))yield yield ee(v)}}catch(x){u={error:x}}finally{try{!y&&!l&&(h=w.return)&&(yield ee(h.call(w)))}finally{if(u)throw u.error}}for(const x of m.flush())yield yield ee(x)})}function o(){return Jn(this,arguments,function*(){var l,u,h,p;if(i)throw new jn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let m=!1;try{try{for(var g=!0,y=Yn(s()),w;w=yield ee(y.next()),l=w.done,!l;g=!0){p=w.value,g=!1;const T=p;m||T&&(yield yield ee(JSON.parse(T)))}}catch(T){u={error:T}}finally{try{!g&&!l&&(h=y.return)&&(yield ee(h.call(y)))}finally{if(u)throw u.error}}m=!0}catch(T){if(cg(T))return yield ee(void 0);throw T}finally{m||n.abort()}})}return new Ro(o,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),i=s=>({next:()=>{if(s.length===0){const o=r.next();e.push(o),n.push(o)}return s.shift()}});return[new Ro(()=>i(e),this.controller,this.client),new Ro(()=>i(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return xC({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:i,done:s}=await n.next();if(s)return r.close();const o=vv(JSON.stringify(i)+`
`);r.enqueue(o)}catch(i){r.error(i)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}}function vj(t,e){return Jn(this,arguments,function*(){var r,i,s,o;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new jn("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new jn("Attempted to iterate over a response with no body");const a=new wj,l=new Qh,u=wC(t.body);try{for(var h=!0,p=Yn(xj(u)),m;m=yield ee(p.next()),r=m.done,!r;h=!0){o=m.value,h=!1;const g=o;for(const y of l.decode(g)){const w=a.decode(y);w&&(yield yield ee(w))}}}catch(g){i={error:g}}finally{try{!h&&!r&&(s=p.return)&&(yield ee(s.call(p)))}finally{if(i)throw i.error}}for(const g of l.flush()){const y=a.decode(g);y&&(yield yield ee(y))}})}function xj(t){return Jn(this,arguments,function*(){var n,r,i,s;let o=new Uint8Array;try{for(var a=!0,l=Yn(t),u;u=yield ee(l.next()),n=u.done,!n;a=!0){s=u.value,a=!1;const h=s;if(h==null)continue;const p=h instanceof ArrayBuffer?new Uint8Array(h):typeof h=="string"?vv(h):h;let m=new Uint8Array(o.length+p.length);m.set(o),m.set(p,o.length),o=m;let g;for(;(g=gj(o))!==-1;)yield yield ee(o.slice(0,g)),o=o.slice(g)}}catch(h){r={error:h}}finally{try{!a&&!n&&(i=l.return)&&(yield ee(i.call(l)))}finally{if(r)throw r.error}}o.length>0&&(yield yield ee(o))})}class wj{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,i]=_j(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}function _j(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Tj(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:i,startTime:s}=e,o=await(async()=>{var a;if(e.options.stream)return Bt(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Ro.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const l=n.headers.get("content-type"),u=(a=l==null?void 0:l.split(";")[0])===null||a===void 0?void 0:a.trim();return(u==null?void 0:u.includes("application/json"))||(u==null?void 0:u.endsWith("+json"))?n.headers.get("content-length")==="0"?void 0:await n.json():await n.text()})();return Bt(t).debug(`[${r}] response parsed`,os({retryOfRequestLogID:i,url:n.url,status:n.status,body:o,durationMs:Date.now()-s})),o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xv extends Promise{constructor(e,n,r=Tj){super(i=>{i(null)}),this.responsePromise=n,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new xv(this.client,this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CC=Symbol("brand.privateNullableHeaders");function*Ij(t){if(!t)return;if(CC in t){const{values:r,nulls:i}=t;yield*r.entries();for(const s of i)yield[s,null];return}let e=!1,n;t instanceof Headers?n=t.entries():rT(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const i=r[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const s=rT(r[1])?r[1]:[r[1]];let o=!1;for(const a of s)a!==void 0&&(e&&!o&&(o=!0,yield[i,null]),yield[i,a])}}const Ja=t=>{const e=new Headers,n=new Set;for(const r of t){const i=new Set;for(const[s,o]of Ij(r)){const a=s.toLowerCase();i.has(a)||(e.delete(s),i.add(a)),o===null?(e.delete(s),n.add(a)):(e.append(s,o),n.delete(a))}}return{[CC]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Np=t=>{var e,n,r,i,s,o;if(typeof globalThis.process<"u")return(r=(n=(e=globalThis.process.env)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(o=(s=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||s===void 0?void 0:s.call(i,t))===null||o===void 0?void 0:o.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var NC;class Xh{constructor(e){var n,r,i,s,o,a,l,{baseURL:u=Np("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:h=(n=Np("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:p="v1beta"}=e,m=Zd(e,["baseURL","apiKey","apiVersion"]);const g=Object.assign(Object.assign({apiKey:h,apiVersion:p},m),{baseURL:u||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(r=g.timeout)!==null&&r!==void 0?r:Xh.DEFAULT_TIMEOUT,this.logger=(i=g.logger)!==null&&i!==void 0?i:console;const y="warn";this.logLevel=y,this.logLevel=(o=(s=lT(g.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:lT(Np("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&o!==void 0?o:y,this.fetchOptions=g.fetchOptions,this.maxRetries=(a=g.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(l=g.fetch)!==null&&l!==void 0?l:rj(),this.encoder=oj,this._options=g,this.apiKey=h,this.apiVersion=p,this.clientAdapter=g.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=Ja([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return Ja([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Ja([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new jn(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${po}`}defaultIdempotencyKey(){return`stainless-node-retry-${qO()}`}makeStatusError(e,n,r,i){return Jt.generate(e,n,r,i)}buildURL(e,n,r){const i=!this.baseURLOverridden()&&r||this.baseURL,s=HO(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return KO(o)||(n=Object.assign(Object.assign({},o),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(s.search=this.stringifyQuery(n)),s.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(i=>Object.assign({method:e,path:n},i)))}request(e,n=null){return new xv(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var i,s,o;const a=await e,l=(i=a.maxRetries)!==null&&i!==void 0?i:this.maxRetries;n==null&&(n=l),await this.prepareOptions(a);const{req:u,url:h,timeout:p}=await this.buildRequest(a,{retryCount:l-n});await this.prepareRequest(u,{url:h,options:a});const m="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=r===void 0?"":`, retryOf: ${r}`,y=Date.now();if(Bt(this).debug(`[${m}] sending request`,os({retryOfRequestLogID:r,method:a.method,url:h,options:a,headers:u.headers})),!((s=a.signal)===null||s===void 0)&&s.aborted)throw new hg;const w=new AbortController,T=await this.fetchWithTimeout(h,u,p,w).catch(dg),x=Date.now();if(T instanceof globalThis.Error){const _=`retrying, ${n} attempts remaining`;if(!((o=a.signal)===null||o===void 0)&&o.aborted)throw new hg;const b=cg(T)||/timed? ?out/i.test(String(T)+("cause"in T?String(T.cause):""));if(n)return Bt(this).info(`[${m}] connection ${b?"timed out":"failed"} - ${_}`),Bt(this).debug(`[${m}] connection ${b?"timed out":"failed"} (${_})`,os({retryOfRequestLogID:r,url:h,durationMs:x-y,message:T.message})),this.retryRequest(a,n,r??m);throw Bt(this).info(`[${m}] connection ${b?"timed out":"failed"} - error; no more retries left`),Bt(this).debug(`[${m}] connection ${b?"timed out":"failed"} (error; no more retries left)`,os({retryOfRequestLogID:r,url:h,durationMs:x-y,message:T.message})),b?new cC:new Yh({cause:T})}const v=`[${m}${g}] ${u.method} ${h} ${T.ok?"succeeded":"failed"} with status ${T.status} in ${x-y}ms`;if(!T.ok){const _=await this.shouldRetry(T);if(n&&_){const F=`retrying, ${n} attempts remaining`;return await sj(T.body),Bt(this).info(`${v} - ${F}`),Bt(this).debug(`[${m}] response error (${F})`,os({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,durationMs:x-y})),this.retryRequest(a,n,r??m,T.headers)}const b=_?"error; no more retries left":"error; not retryable";Bt(this).info(`${v} - ${b}`);const S=await T.text().catch(F=>dg(F).message),I=QO(S),E=I?void 0:S;throw Bt(this).debug(`[${m}] response error (${b})`,os({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,message:E,durationMs:Date.now()-y})),this.makeStatusError(T.status,I,E,T.headers)}return Bt(this).info(v),Bt(this).debug(`[${m}] response start`,os({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,durationMs:x-y})),{response:T,options:a,controller:w,requestLogID:m,retryOfRequestLogID:r,startTime:y}}async fetchWithTimeout(e,n,r,i){const s=n||{},{signal:o,method:a}=s,l=Zd(s,["signal","method"]),u=this._makeAbort(i);o&&o.addEventListener("abort",u,{once:!0});const h=setTimeout(u,r),p=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,m=Object.assign(Object.assign(Object.assign({signal:i.signal},p?{duplex:"half"}:{}),{method:"GET"}),l);a&&(m.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,m)}finally{clearTimeout(h)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,i){var s;let o;const a=i==null?void 0:i.get("retry-after-ms");if(a){const u=parseFloat(a);Number.isNaN(u)||(o=u)}const l=i==null?void 0:i.get("retry-after");if(l&&!o){const u=parseFloat(l);Number.isNaN(u)?o=Date.parse(l)-Date.now():o=u*1e3}if(!(o&&0<=o&&o<60*1e3)){const u=(s=e.maxRetries)!==null&&s!==void 0?s:this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(n,u)}return await XO(o),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const s=n-e,o=Math.min(.5*Math.pow(2,s),8),a=1-Math.random()*.25;return o*a*1e3}async buildRequest(e,{retryCount:n=0}={}){var r,i,s;const o=Object.assign({},e),{method:a,path:l,query:u,defaultBaseURL:h}=o,p=this.buildURL(l,u,h);"timeout"in o&&YO("timeout",o.timeout),o.timeout=(r=o.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:m,body:g}=this.buildBody({options:o}),y=await this.buildHeaders({options:e,method:a,bodyHeaders:m,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:y},o.signal&&{signal:o.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(s=o.fetchOptions)!==null&&s!==void 0?s:{}),url:p,timeout:o.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:i}){let s={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const o=await this.authHeaders(e);let a=Ja([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),nj()),this._options.defaultHeaders,r,e.headers,o]);return this.validateHeaders(a),a.values}_makeAbort(e){return()=>e.abort()}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=Ja([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:ij(e)}:typeof e=="object"&&r.values.get("content-type")==="application/x-www-form-urlencoded"?{bodyHeaders:{"content-type":"application/x-www-form-urlencoded"},body:this.stringifyQuery(e)}:this.encoder({body:e,headers:r})}}Xh.DEFAULT_TIMEOUT=6e4;class mt extends Xh{constructor(){super(...arguments),this.interactions=new EC(this)}}NC=mt;mt.GeminiNextGenAPIClient=NC;mt.GeminiNextGenAPIClientError=jn;mt.APIError=Jt;mt.APIConnectionError=Yh;mt.APIConnectionTimeoutError=cC;mt.APIUserAbortError=hg;mt.NotFoundError=pC;mt.ConflictError=mC;mt.RateLimitError=yC;mt.BadRequestError=dC;mt.AuthenticationError=hC;mt.InternalServerError=vC;mt.PermissionDeniedError=fC;mt.UnprocessableEntityError=gC;mt.toFile=dj;mt.Interactions=EC;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Sj(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function bj(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function Ej(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function Cj(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function Nj(t,e,n){const r={};if(d(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&f(e,["displayName"],i),d(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=d(t,["epochCount"]);e!==void 0&&s!=null&&f(e,["tuningTask","hyperparameters","epochCount"],s);const o=d(t,["learningRateMultiplier"]);if(o!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),d(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(d(t,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(d(t,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const a=d(t,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const l=d(t,["learningRate"]);if(e!==void 0&&l!=null&&f(e,["tuningTask","hyperparameters","learningRate"],l),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(d(t,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(d(t,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(d(t,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(d(t,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");if(d(t,["encryptionSpec"])!==void 0)throw new Error("encryptionSpec parameter is not supported in Gemini API.");return r}function Aj(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const I=d(t,["validationDataset"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec"],Ap(I))}else if(i==="PREFERENCE_TUNING"){const I=d(t,["validationDataset"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec"],Ap(I))}else if(i==="DISTILLATION"){const I=d(t,["validationDataset"]);e!==void 0&&I!=null&&f(e,["distillationSpec"],Ap(I))}const s=d(t,["tunedModelDisplayName"]);e!==void 0&&s!=null&&f(e,["tunedModelDisplayName"],s);const o=d(t,["description"]);e!==void 0&&o!=null&&f(e,["description"],o);let a=d(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const I=d(t,["epochCount"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],I)}else if(a==="PREFERENCE_TUNING"){const I=d(t,["epochCount"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],I)}else if(a==="DISTILLATION"){const I=d(t,["epochCount"]);e!==void 0&&I!=null&&f(e,["distillationSpec","hyperParameters","epochCount"],I)}let l=d(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const I=d(t,["learningRateMultiplier"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],I)}else if(l==="PREFERENCE_TUNING"){const I=d(t,["learningRateMultiplier"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],I)}else if(l==="DISTILLATION"){const I=d(t,["learningRateMultiplier"]);e!==void 0&&I!=null&&f(e,["distillationSpec","hyperParameters","learningRateMultiplier"],I)}let u=d(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const I=d(t,["exportLastCheckpointOnly"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],I)}else if(u==="PREFERENCE_TUNING"){const I=d(t,["exportLastCheckpointOnly"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],I)}else if(u==="DISTILLATION"){const I=d(t,["exportLastCheckpointOnly"]);e!==void 0&&I!=null&&f(e,["distillationSpec","exportLastCheckpointOnly"],I)}let h=d(n,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const I=d(t,["adapterSize"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],I)}else if(h==="PREFERENCE_TUNING"){const I=d(t,["adapterSize"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],I)}else if(h==="DISTILLATION"){const I=d(t,["adapterSize"]);e!==void 0&&I!=null&&f(e,["distillationSpec","hyperParameters","adapterSize"],I)}let p=d(n,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const I=d(t,["tuningMode"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","tuningMode"],I)}const m=d(t,["customBaseModel"]);e!==void 0&&m!=null&&f(e,["customBaseModel"],m);let g=d(n,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const I=d(t,["batchSize"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","hyperParameters","batchSize"],I)}let y=d(n,["config","method"]);if(y===void 0&&(y="SUPERVISED_FINE_TUNING"),y==="SUPERVISED_FINE_TUNING"){const I=d(t,["learningRate"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRate"],I)}const w=d(t,["labels"]);e!==void 0&&w!=null&&f(e,["labels"],w);const T=d(t,["beta"]);e!==void 0&&T!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],T);const x=d(t,["baseTeacherModel"]);e!==void 0&&x!=null&&f(e,["distillationSpec","baseTeacherModel"],x);const v=d(t,["tunedTeacherModelSource"]);e!==void 0&&v!=null&&f(e,["distillationSpec","tunedTeacherModelSource"],v);const _=d(t,["sftLossWeightMultiplier"]);e!==void 0&&_!=null&&f(e,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],_);const b=d(t,["outputUri"]);e!==void 0&&b!=null&&f(e,["outputUri"],b);const S=d(t,["encryptionSpec"]);return e!==void 0&&S!=null&&f(e,["encryptionSpec"],S),r}function kj(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const s=d(t,["trainingDataset"]);s!=null&&Vj(s);const o=d(t,["config"]);return o!=null&&Nj(o,n),n}function Rj(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const s=d(t,["trainingDataset"]);s!=null&&Bj(s,n,e);const o=d(t,["config"]);return o!=null&&Aj(o,n,e),n}function Pj(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function Dj(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function Mj(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const o=d(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),r}function Lj(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const o=d(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),r}function Uj(t,e){const n={},r=d(t,["config"]);return r!=null&&Mj(r,n),n}function Fj(t,e){const n={},r=d(t,["config"]);return r!=null&&Lj(r,n),n}function Oj(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=d(t,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>AC(a))),f(n,["tuningJobs"],o)}return n}function jj(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=d(t,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>mg(a))),f(n,["tuningJobs"],o)}return n}function $j(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["model"],r);const i=d(t,["name"]);return i!=null&&f(n,["endpoint"],i),n}function Vj(t,e){const n={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=d(t,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(n,["examples","examples"],i)}return n}function Bj(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}else if(i==="DISTILLATION"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["distillationSpec","promptDatasetUri"],o)}let s=d(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}else if(s==="DISTILLATION"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["distillationSpec","promptDatasetUri"],o)}if(d(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function AC(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const s=d(t,["state"]);s!=null&&f(n,["state"],HE(s));const o=d(t,["createTime"]);o!=null&&f(n,["createTime"],o);const a=d(t,["tuningTask","startTime"]);a!=null&&f(n,["startTime"],a);const l=d(t,["tuningTask","completeTime"]);l!=null&&f(n,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const h=d(t,["description"]);h!=null&&f(n,["description"],h);const p=d(t,["baseModel"]);p!=null&&f(n,["baseModel"],p);const m=d(t,["_self"]);return m!=null&&f(n,["tunedModel"],$j(m)),n}function mg(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const s=d(t,["state"]);s!=null&&f(n,["state"],HE(s));const o=d(t,["createTime"]);o!=null&&f(n,["createTime"],o);const a=d(t,["startTime"]);a!=null&&f(n,["startTime"],a);const l=d(t,["endTime"]);l!=null&&f(n,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const h=d(t,["error"]);h!=null&&f(n,["error"],h);const p=d(t,["description"]);p!=null&&f(n,["description"],p);const m=d(t,["baseModel"]);m!=null&&f(n,["baseModel"],m);const g=d(t,["tunedModel"]);g!=null&&f(n,["tunedModel"],g);const y=d(t,["preTunedModel"]);y!=null&&f(n,["preTunedModel"],y);const w=d(t,["supervisedTuningSpec"]);w!=null&&f(n,["supervisedTuningSpec"],w);const T=d(t,["preferenceOptimizationSpec"]);T!=null&&f(n,["preferenceOptimizationSpec"],T);const x=d(t,["distillationSpec"]);x!=null&&f(n,["distillationSpec"],x);const v=d(t,["tuningDataStats"]);v!=null&&f(n,["tuningDataStats"],v);const _=d(t,["encryptionSpec"]);_!=null&&f(n,["encryptionSpec"],_);const b=d(t,["partnerModelTuningSpec"]);b!=null&&f(n,["partnerModelTuningSpec"],b);const S=d(t,["customBaseModel"]);S!=null&&f(n,["customBaseModel"],S);const I=d(t,["experiment"]);I!=null&&f(n,["experiment"],I);const E=d(t,["labels"]);E!=null&&f(n,["labels"],E);const R=d(t,["outputUri"]);R!=null&&f(n,["outputUri"],R);const F=d(t,["pipelineJob"]);F!=null&&f(n,["pipelineJob"],F);const M=d(t,["serviceAccount"]);M!=null&&f(n,["serviceAccount"],M);const Q=d(t,["tunedModelDisplayName"]);Q!=null&&f(n,["tunedModelDisplayName"],Q);const ne=d(t,["veoTuningSpec"]);return ne!=null&&f(n,["veoTuningSpec"],ne),n}function qj(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const s=d(t,["metadata"]);s!=null&&f(n,["metadata"],s);const o=d(t,["done"]);o!=null&&f(n,["done"],o);const a=d(t,["error"]);return a!=null&&f(n,["error"],a),n}function Ap(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const i=d(t,["vertexDatasetResource"]);return i!=null&&f(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gj extends Wr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Zs(Br.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:ng.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Dj(e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>mg(h))}else{const u=Pj(e);return a=B("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>AC(h))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Fj(e);return a=B("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=jj(h),m=new U_;return Object.assign(m,p),m})}else{const u=Uj(e);return a=B("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=Oj(h),m=new U_;return Object.assign(m,p),m})}}async cancel(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=bj(e);return a=B("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=Cj(h),m=new F_;return Object.assign(m,p),m})}else{const u=Sj(e);return a=B("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),o.then(h=>{const p=Ej(h),m=new F_;return Object.assign(m,p),m})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Rj(e,e);return s=B("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),i.then(l=>mg(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=kj(e);return s=B("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),i.then(l=>qj(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hj{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const zj=1024*1024*8,Wj=3,Kj=1e3,Jj=2,th="x-goog-upload-status";async function Yj(t,e,n){var r;const i=await kC(t,e,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[th])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function Qj(t,e,n){var r;const i=await kC(t,e,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[th])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=jE(s),a=new hv;return Object.assign(a,o),a}async function kC(t,e,n){var r,i;let s=0,o=0,a=new ig(new Response),l="upload";for(s=t.size;o<s;){const u=Math.min(zj,s-o),h=t.slice(o,o+u);o+u>=s&&(l+=", finalize");let p=0,m=Kj;for(;p<Wj&&(a=await n.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[th]));)p++,await Zj(m),m=m*Jj;if(o+=u,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i[th])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function Xj(t){return{size:t.size,type:t.type}}function Zj(t){return new Promise(e=>setTimeout(e,t))}class e${async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Yj(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Qj(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Xj(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t${create(e,n,r){return new n$(e,n,r)}}class n${constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cT="x-goog-api-key";class r${constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(cT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(cT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const i$="gl-node/";class s${get interactions(){var e;if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const n=this.httpOptions;n!=null&&n.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const r=new mt({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:n==null?void 0:n.timeout,maxRetries:(e=n==null?void 0:n.retryOptions)===null||e===void 0?void 0:e.attempts});return this._interactions=r.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=z2(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new r$(this.apiKey);this.apiClient=new XF({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:i$+"web",uploader:new e$,downloader:new Hj}),this.models=new yO(this.apiClient),this.live=new dO(this.apiClient,i,new t$),this.batches=new IL(this.apiClient),this.chats=new i4(this.models,this.apiClient),this.caches=new t4(this.apiClient),this.files=new g4(this.apiClient),this.operations=new vO(this.apiClient),this.authTokens=new MO(this.apiClient),this.tunings=new Gj(this.apiClient),this.fileSearchStores=new BO(this.apiClient)}}const RC=()=>{try{return}catch{return""}};let o$=RC();const a$=()=>{const t=RC()||o$;return t?new s$({apiKey:t}):(console.warn("Gemini API Key is missing. AI features will be disabled until configured."),null)},l$=async(t,e,n)=>{const r=a$();if(!r)return"      .      API.";const i="gemini-3-flash-preview",s=`
             .
        : ${t}
         : ${e}
         : ${n}

             :
        1.  ** :** (    )
        2.  **  :** (   )
        3.  **  :** (  )
        4.  **  :** (  )
        5.  ** :** (   )
        6.  **  :** (         )
        
              .
    `;try{return(await r.models.generateContent({model:i,contents:s})).text||"   ."}catch(o){throw console.error("Error generating lesson plan:",o),new Error("Failed to generate lesson plan from Gemini API.")}},u$=({content:t,strings:e,language:n})=>{const[r,i]=N.useState(""),[s,o]=N.useState(""),[a,l]=N.useState("  "),[u,h]=N.useState(""),[p,m]=N.useState(!1),[g,y]=N.useState(""),w=N.useCallback(async()=>{if(!a.trim()){y(e.errorEnterTopic);return}m(!0),y(""),h("");try{const T=await l$(r,s,a);h(T)}catch(T){y(e.errorFailedPlan),console.error(T)}finally{m(!1)}},[r,s,a,e]);return c.jsx("section",{className:"py-20 bg-gray-50",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h2",{className:"text-4xl font-extrabold text-blue-900",children:(t==null?void 0:t.aiPlannerTitle)||e.aiPlannerTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:(t==null?void 0:t.aiPlannerSubtitle)||e.aiPlannerSubtitle})]}),c.jsxs("div",{className:"max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-lg",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"ai-subject",className:"block text-sm font-medium text-gray-700 mb-1",children:e.subject}),c.jsxs("select",{id:"ai-subject",value:r,onChange:T=>i(T.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",children:[c.jsx("option",{children:""}),c.jsx("option",{children:""}),c.jsx("option",{children:" "}),c.jsx("option",{children:" "})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"ai-level",className:"block text-sm font-medium text-gray-700 mb-1",children:e.level}),c.jsxs("select",{id:"ai-level",value:s,onChange:T=>o(T.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500",children:[c.jsx("option",{children:""}),c.jsx("option",{children:""}),c.jsx("option",{children:""})]})]}),c.jsxs("div",{className:"md:col-span-3",children:[c.jsx("label",{htmlFor:"ai-topic",className:"block text-sm font-medium text-gray-700 mb-1",children:e.topic}),c.jsx("input",{type:"text",id:"ai-topic",value:a,onChange:T=>l(T.target.value),placeholder:e.topicPlaceholder,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500"})]})]}),c.jsx("button",{onClick:w,disabled:p,className:"w-full bg-blue-900 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-800 transition-colors duration-300 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center",children:p?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.generating,"..."]}):e.generatePlan}),g&&c.jsx("p",{className:"text-red-500 text-center mt-4",children:g}),u&&c.jsxs("div",{className:"mt-8 p-6 bg-gray-100 border-r-4 border-green-500 rounded-md",children:[c.jsx("h4",{className:"text-xl font-bold text-blue-900 mb-4",children:e.suggestedPlan}),c.jsx("pre",{className:"whitespace-pre-wrap text-gray-700 font-sans",children:u})]})]})]})})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},c$=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},DC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,h=s>>2,p=(s&3)<<4|a>>4;let m=(a&15)<<2|u>>6,g=u&63;l||(g=64,o||(m=64)),r.push(n[h],n[p],n[m],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(PC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):c$(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||p==null)throw new d$;const m=s<<2|a>>4;if(r.push(m),u!==64){const g=a<<4&240|u>>2;if(r.push(g),p!==64){const y=u<<6&192|p;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class d$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const h$=function(t){const e=PC(t);return DC.encodeByteArray(e,!0)},nh=function(t){return h$(t).replace(/\./g,"")},MC=function(t){try{return DC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function rh(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!f$(n)||(t[n]=rh(t[n],e[n]));return t}function f$(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p$(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m$=()=>p$().__FIREBASE_DEFAULTS__,g$=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},y$=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&MC(t[1]);return e&&JSON.parse(e)},wv=()=>{try{return m$()||g$()||y$()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},LC=()=>{var t;return(t=wv())===null||t===void 0?void 0:t.config},v$=t=>{var e;return(e=wv())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w$(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[nh(JSON.stringify(n)),nh(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _$(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ve())}function _v(){var t;const e=(t=wv())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function T$(){return typeof self=="object"&&self.self===self}function Zh(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Tv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UC(){const t=Ve();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function I$(){return!_v()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ls(){try{return typeof indexedDB=="object"}catch{return!1}}function Iv(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function FC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S$="FirebaseError";class bt extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=S$,Object.setPrototypeOf(this,bt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jr.prototype.create)}}class Jr{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?b$(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new bt(i,a,r)}}function b$(t,e){return t.replace(E$,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const E$=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dT(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function C$(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function gg(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(hT(s)&&hT(o)){if(!gg(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function hT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Po(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function fl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function OC(t,e){const n=new N$(t,e);return n.subscribe.bind(n)}class N${constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");A$(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=kp),i.error===void 0&&(i.error=kp),i.complete===void 0&&(i.complete=kp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function A$(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function kp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k$=1e3,R$=2,P$=4*60*60*1e3,D$=.5;function fT(t,e=k$,n=R$){const r=e*Math.pow(n,t),i=Math.round(D$*r*(Math.random()-.5)*2);return Math.min(P$,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t){return t&&t._delegate?t._delegate:t}class Yt{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const as="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M${constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new x$;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(U$(e))try{this.getOrInitializeService({instanceIdentifier:as})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=as){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=as){return this.instances.has(e)}getOptions(e=as){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:L$(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=as){return this.component?this.component.multipleInstances?e:as:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function L$(t){return t===as?void 0:t}function U$(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F${constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new M$(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sv=[];var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const jC={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},O$=de.INFO,j$={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},$$=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=j$[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Fu{constructor(e){this.name=e,this._logLevel=O$,this._logHandler=$$,this._userLogHandler=null,Sv.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}function V$(t){Sv.forEach(e=>{e.setLogLevel(t)})}function B$(t,e){for(const n of Sv){let r=null;e&&e.level&&(r=jC[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(r??i.logLevel)&&t({level:de[s].toLowerCase(),message:a,args:o,type:i.name})}}}const q$=(t,e)=>e.some(n=>t instanceof n);let pT,mT;function G$(){return pT||(pT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function H$(){return mT||(mT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $C=new WeakMap,yg=new WeakMap,VC=new WeakMap,Rp=new WeakMap,bv=new WeakMap;function z$(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ci(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&$C.set(n,t)}).catch(()=>{}),bv.set(e,t),e}function W$(t){if(yg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});yg.set(t,e)}let vg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return yg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||VC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ci(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function K$(t){vg=t(vg)}function J$(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Pp(this),e,...n);return VC.set(r,e.sort?e.sort():[e]),Ci(r)}:H$().includes(t)?function(...e){return t.apply(Pp(this),e),Ci($C.get(this))}:function(...e){return Ci(t.apply(Pp(this),e))}}function Y$(t){return typeof t=="function"?J$(t):(t instanceof IDBTransaction&&W$(t),q$(t,G$())?new Proxy(t,vg):t)}function Ci(t){if(t instanceof IDBRequest)return z$(t);if(Rp.has(t))return Rp.get(t);const e=Y$(t);return e!==t&&(Rp.set(t,e),bv.set(e,t)),e}const Pp=t=>bv.get(t);function Q$(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Ci(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ci(o.result),l.oldVersion,l.newVersion,Ci(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const X$=["get","getKey","getAll","getAllKeys","count"],Z$=["put","add","delete","clear"],Dp=new Map;function gT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Dp.get(e))return Dp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Z$.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||X$.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return Dp.set(e,s),s}K$(t=>({...t,get:(e,n,r)=>gT(e,n)||t.get(e,n,r),has:(e,n)=>!!gT(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(tV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function tV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const xg="@firebase/app",yT="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=new Fu("@firebase/app"),nV="@firebase/app-compat",rV="@firebase/analytics-compat",iV="@firebase/analytics",sV="@firebase/app-check-compat",oV="@firebase/app-check",aV="@firebase/auth",lV="@firebase/auth-compat",uV="@firebase/database",cV="@firebase/database-compat",dV="@firebase/functions",hV="@firebase/functions-compat",fV="@firebase/installations",pV="@firebase/installations-compat",mV="@firebase/messaging",gV="@firebase/messaging-compat",yV="@firebase/performance",vV="@firebase/performance-compat",xV="@firebase/remote-config",wV="@firebase/remote-config-compat",_V="@firebase/storage",TV="@firebase/storage-compat",IV="@firebase/firestore",SV="@firebase/firestore-compat",bV="firebase",EV="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri="[DEFAULT]",CV={[xg]:"fire-core",[nV]:"fire-core-compat",[iV]:"fire-analytics",[rV]:"fire-analytics-compat",[oV]:"fire-app-check",[sV]:"fire-app-check-compat",[aV]:"fire-auth",[lV]:"fire-auth-compat",[uV]:"fire-rtdb",[cV]:"fire-rtdb-compat",[dV]:"fire-fn",[hV]:"fire-fn-compat",[fV]:"fire-iid",[pV]:"fire-iid-compat",[mV]:"fire-fcm",[gV]:"fire-fcm-compat",[yV]:"fire-perf",[vV]:"fire-perf-compat",[xV]:"fire-rc",[wV]:"fire-rc-compat",[_V]:"fire-gcs",[TV]:"fire-gcs-compat",[IV]:"fire-fst",[SV]:"fire-fst-compat","fire-js":"fire-js",[bV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=new Map,ru=new Map;function ih(t,e){try{t.container.addComponent(e)}catch(n){Us.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function BC(t,e){t.container.addOrOverwriteComponent(e)}function $n(t){const e=t.name;if(ru.has(e))return Us.debug(`There were multiple attempts to register component ${e}.`),!1;ru.set(e,t);for(const n of Pi.values())ih(n,t);return!0}function ef(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function NV(t,e,n=Ri){ef(t,e).clearInstance(n)}function AV(){ru.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Lr=new Jr("app","Firebase",kV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RV=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Yt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lr.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi=EV;function Ev(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Ri,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Lr.create("bad-app-name",{appName:String(i)});if(n||(n=LC()),!n)throw Lr.create("no-options");const s=Pi.get(i);if(s){if(gg(n,s.options)&&gg(r,s.config))return s;throw Lr.create("duplicate-app",{appName:i})}const o=new F$(i);for(const l of ru.values())o.addComponent(l);const a=new RV(n,r,o);return Pi.set(i,a),a}function PV(t=Ri){const e=Pi.get(t);if(!e&&t===Ri&&LC())return Ev();if(!e)throw Lr.create("no-app",{appName:t});return e}function DV(){return Array.from(Pi.values())}async function qC(t){const e=t.name;Pi.has(e)&&(Pi.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function pn(t,e,n){var r;let i=(r=CV[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Us.warn(a.join(" "));return}$n(new Yt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function GC(t,e){if(t!==null&&typeof t!="function")throw Lr.create("invalid-log-argument");B$(t,e)}function HC(t){V$(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MV="firebase-heartbeat-database",LV=1,iu="firebase-heartbeat-store";let Mp=null;function zC(){return Mp||(Mp=Q$(MV,LV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(iu)}}}).catch(t=>{throw Lr.create("idb-open",{originalErrorMessage:t.message})})),Mp}async function UV(t){try{return await(await zC()).transaction(iu).objectStore(iu).get(WC(t))}catch(e){if(e instanceof bt)Us.warn(e.message);else{const n=Lr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Us.warn(n.message)}}}async function vT(t,e){try{const r=(await zC()).transaction(iu,"readwrite");await r.objectStore(iu).put(e,WC(t)),await r.done}catch(n){if(n instanceof bt)Us.warn(n.message);else{const r=Lr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Us.warn(r.message)}}}function WC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV=1024,OV=30*24*60*60*1e3;class jV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new VV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=xT();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=OV}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=xT(),{heartbeatsToSend:n,unsentEntries:r}=$V(this._heartbeatsCache.heartbeats),i=nh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function xT(){return new Date().toISOString().substring(0,10)}function $V(t,e=FV){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),wT(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),wT(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class VV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ls()?Iv().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await UV(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return vT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return vT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function wT(t){return nh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BV(t){$n(new Yt("platform-logger",e=>new eV(e),"PRIVATE")),$n(new Yt("heartbeat",e=>new jV(e),"PRIVATE")),pn(xg,yT,t),pn(xg,yT,"esm2017"),pn("fire-js","")}BV("");const qV=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:bt,SDK_VERSION:Wi,_DEFAULT_ENTRY_NAME:Ri,_addComponent:ih,_addOrOverwriteComponent:BC,_apps:Pi,_clearComponents:AV,_components:ru,_getProvider:ef,_registerComponent:$n,_removeServiceInstance:NV,deleteApp:qC,getApp:PV,getApps:DV,initializeApp:Ev,onLog:GC,registerVersion:pn,setLogLevel:HC},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,n){this._delegate=e,this.firebase=n,ih(e,new Yt("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),qC(this._delegate)))}_getService(e,n=Ri){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=Ri){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){ih(this._delegate,e)}_addOrOverwriteComponent(e){BC(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HV={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},_T=new Jr("app-compat","Firebase",HV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zV(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:pn,setLogLevel:HC,onLog:GC,apps:null,SDK_VERSION:Wi,INTERNAL:{registerComponent:a,removeApp:r,useAsService:l,modularAPIs:qV}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||Ri,!dT(e,u))throw _T.create("no-app",{appName:u});return e[u]}i.App=t;function s(u,h={}){const p=Ev(u,h);if(dT(e,p.name))return e[p.name];const m=new t(p,n);return e[p.name]=m,m}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const h=u.name,p=h.replace("-compat","");if($n(u)&&u.type==="PUBLIC"){const m=(g=i())=>{if(typeof g[p]!="function")throw _T.create("invalid-app-argument",{appName:h});return g[p]()};u.serviceProps!==void 0&&rh(m,u.serviceProps),n[p]=m,t.prototype[p]=function(...g){return this._getService.bind(this,h).apply(this,u.multipleInstances?g:[])}}return u.type==="PUBLIC"?n[p]:null}function l(u,h){return h==="serverAuth"?null:h}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(){const t=zV(GV);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:KC,extendNamespace:e,createSubscribe:OC,ErrorFactory:Jr,deepExtend:rh});function e(n){rh(t,n)}return t}const WV=KC();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT=new Fu("@firebase/app-compat"),KV="@firebase/app-compat",JV="0.2.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YV(t){pn(KV,JV,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(T$()&&self.firebase!==void 0){TT.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&TT.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const mn=WV;YV();var QV="firebase",XV="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn.registerVersion(QV,XV,"app-compat");const ZV=(t,e)=>e.some(n=>t instanceof n);let IT,ST;function e3(){return IT||(IT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function t3(){return ST||(ST=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const JC=new WeakMap,wg=new WeakMap,YC=new WeakMap,Lp=new WeakMap,Cv=new WeakMap;function n3(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ni(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&JC.set(n,t)}).catch(()=>{}),Cv.set(e,t),e}function r3(t){if(wg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});wg.set(t,e)}let _g={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return wg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||YC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ni(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function i3(t){_g=t(_g)}function s3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Up(this),e,...n);return YC.set(r,e.sort?e.sort():[e]),Ni(r)}:t3().includes(t)?function(...e){return t.apply(Up(this),e),Ni(JC.get(this))}:function(...e){return Ni(t.apply(Up(this),e))}}function o3(t){return typeof t=="function"?s3(t):(t instanceof IDBTransaction&&r3(t),ZV(t,e3())?new Proxy(t,_g):t)}function Ni(t){if(t instanceof IDBRequest)return n3(t);if(Lp.has(t))return Lp.get(t);const e=o3(t);return e!==t&&(Lp.set(t,e),Cv.set(e,t)),e}const Up=t=>Cv.get(t);function a3(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Ni(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ni(o.result),l.oldVersion,l.newVersion,Ni(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}const l3=["get","getKey","getAll","getAllKeys","count"],u3=["put","add","delete","clear"],Fp=new Map;function bT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Fp.get(e))return Fp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=u3.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||l3.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return Fp.set(e,s),s}i3(t=>({...t,get:(e,n,r)=>bT(e,n)||t.get(e,n,r),has:(e,n)=>!!bT(e,n)||t.has(e,n)}));const QC="@firebase/installations",Nv="0.6.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC=1e4,ZC=`w:${Nv}`,eN="FIS_v2",c3="https://firebaseinstallations.googleapis.com/v1",d3=60*60*1e3,h3="installations",f3="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Fs=new Jr(h3,f3,p3);function tN(t){return t instanceof bt&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nN({projectId:t}){return`${c3}/projects/${t}/installations`}function rN(t){return{token:t.token,requestStatus:2,expiresIn:g3(t.expiresIn),creationTime:Date.now()}}async function iN(t,e){const r=(await e.json()).error;return Fs.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function sN({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function m3(t,{refreshToken:e}){const n=sN(t);return n.append("Authorization",y3(e)),n}async function oN(t){const e=await t();return e.status>=500&&e.status<600?t():e}function g3(t){return Number(t.replace("s","000"))}function y3(t){return`${eN} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v3({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=nN(t),i=sN(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={fid:n,authVersion:eN,appId:t.appId,sdkVersion:ZC},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await oN(()=>fetch(r,a));if(l.ok){const u=await l.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:rN(u.authToken)}}else throw await iN("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aN(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x3(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3=/^[cdef][\w-]{21}$/,Tg="";function _3(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=T3(t);return w3.test(n)?n:Tg}catch{return Tg}}function T3(t){return x3(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN=new Map;function uN(t,e){const n=tf(t);cN(n,e),I3(n,e)}function cN(t,e){const n=lN.get(t);if(n)for(const r of n)r(e)}function I3(t,e){const n=S3();n&&n.postMessage({key:t,fid:e}),b3()}let ys=null;function S3(){return!ys&&"BroadcastChannel"in self&&(ys=new BroadcastChannel("[Firebase] FID Change"),ys.onmessage=t=>{cN(t.data.key,t.data.fid)}),ys}function b3(){lN.size===0&&ys&&(ys.close(),ys=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3="firebase-installations-database",C3=1,Os="firebase-installations-store";let Op=null;function Av(){return Op||(Op=a3(E3,C3,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Os)}}})),Op}async function sh(t,e){const n=tf(t),i=(await Av()).transaction(Os,"readwrite"),s=i.objectStore(Os),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&uN(t,e.fid),e}async function dN(t){const e=tf(t),r=(await Av()).transaction(Os,"readwrite");await r.objectStore(Os).delete(e),await r.done}async function nf(t,e){const n=tf(t),i=(await Av()).transaction(Os,"readwrite"),s=i.objectStore(Os),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&uN(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kv(t){let e;const n=await nf(t.appConfig,r=>{const i=N3(r),s=A3(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Tg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function N3(t){const e=t||{fid:_3(),registrationStatus:0};return hN(e)}function A3(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Fs.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=k3(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:R3(t)}:{installationEntry:e}}async function k3(t,e){try{const n=await v3(t,e);return sh(t.appConfig,n)}catch(n){throw tN(n)&&n.customData.serverCode===409?await dN(t.appConfig):await sh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function R3(t){let e=await ET(t.appConfig);for(;e.registrationStatus===1;)await aN(100),e=await ET(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await kv(t);return r||n}return e}function ET(t){return nf(t,e=>{if(!e)throw Fs.create("installation-not-found");return hN(e)})}function hN(t){return P3(t)?{fid:t.fid,registrationStatus:0}:t}function P3(t){return t.registrationStatus===1&&t.registrationTime+XC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D3({appConfig:t,heartbeatServiceProvider:e},n){const r=M3(t,n),i=m3(t,n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={installation:{sdkVersion:ZC,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await oN(()=>fetch(r,a));if(l.ok){const u=await l.json();return rN(u)}else throw await iN("Generate Auth Token",l)}function M3(t,{fid:e}){return`${nN(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rv(t,e=!1){let n;const r=await nf(t.appConfig,s=>{if(!fN(s))throw Fs.create("not-registered");const o=s.authToken;if(!e&&F3(o))return s;if(o.requestStatus===1)return n=L3(t,e),s;{if(!navigator.onLine)throw Fs.create("app-offline");const a=j3(s);return n=U3(t,a),a}});return n?await n:r.authToken}async function L3(t,e){let n=await CT(t.appConfig);for(;n.authToken.requestStatus===1;)await aN(100),n=await CT(t.appConfig);const r=n.authToken;return r.requestStatus===0?Rv(t,e):r}function CT(t){return nf(t,e=>{if(!fN(e))throw Fs.create("not-registered");const n=e.authToken;return $3(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function U3(t,e){try{const n=await D3(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await sh(t.appConfig,r),n}catch(n){if(tN(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await dN(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await sh(t.appConfig,r)}throw n}}function fN(t){return t!==void 0&&t.registrationStatus===2}function F3(t){return t.requestStatus===2&&!O3(t)}function O3(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+d3}function j3(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function $3(t){return t.requestStatus===1&&t.requestTime+XC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V3(t){const e=t,{installationEntry:n,registrationPromise:r}=await kv(e);return r?r.catch(console.error):Rv(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B3(t,e=!1){const n=t;return await q3(n),(await Rv(n,e)).token}async function q3(t){const{registrationPromise:e}=await kv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G3(t){if(!t||!t.options)throw jp("App Configuration");if(!t.name)throw jp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw jp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function jp(t){return Fs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN="installations",H3="installations-internal",z3=t=>{const e=t.getProvider("app").getImmediate(),n=G3(e),r=ef(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},W3=t=>{const e=t.getProvider("app").getImmediate(),n=ef(e,pN).getImmediate();return{getId:()=>V3(n),getToken:i=>B3(n,i)}};function K3(){$n(new Yt(pN,z3,"PUBLIC")),$n(new Yt(H3,W3,"PRIVATE"))}K3();pn(QC,Nv);pn(QC,Nv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT="analytics",J3="firebase_id",Y3="origin",Q3=60*1e3,X3="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Pv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ht=new Fu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Sn=new Jr("analytics","Analytics",Z3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e5(t){if(!t.startsWith(Pv)){const e=Sn.create("invalid-gtag-resource",{gtagURL:t});return ht.warn(e.message),""}return t}function mN(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function t5(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function n5(t,e){const n=t5("firebase-js-sdk-policy",{createScriptURL:e5}),r=document.createElement("script"),i=`${Pv}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function r5(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function i5(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await mN(n)).find(u=>u.measurementId===i);l&&await e[l.appId]}}catch(a){ht.error(a)}t("config",i,s)}async function s5(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await mN(n);for(const l of o){const u=a.find(p=>p.measurementId===l),h=u&&e[u.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){ht.error(s)}}function o5(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await s5(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await i5(t,e,n,r,a,l)}else if(s==="consent"){const[a]=o;t("consent","update",a)}else if(s==="get"){const[a,l,u]=o;t("get",a,l,u)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){ht.error(a)}}return i}function a5(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=o5(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function l5(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Pv)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5=30,c5=1e3;class d5{constructor(e={},n=c5){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const gN=new d5;function h5(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function f5(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:h5(r)},s=X3.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Sn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function p5(t,e=gN,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Sn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Sn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new y5;return setTimeout(async()=>{a.abort()},n!==void 0?n:Q3),yN({appId:r,apiKey:i,measurementId:s},o,a,e)}async function yN(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=gN){var s;const{appId:o,measurementId:a}=t;try{await m5(r,e)}catch(l){if(a)return ht.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await f5(t);return i.deleteThrottleMetadata(o),l}catch(l){const u=l;if(!g5(u)){if(i.deleteThrottleMetadata(o),a)return ht.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:a};throw l}const h=Number((s=u==null?void 0:u.customData)===null||s===void 0?void 0:s.httpStatus)===503?fT(n,i.intervalMillis,u5):fT(n,i.intervalMillis),p={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return i.setThrottleMetadata(o,p),ht.debug(`Calling attemptFetch again in ${h} millis`),yN(t,p,r,i)}}function m5(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Sn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function g5(t){if(!(t instanceof bt)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class y5{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function v5(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}async function x5(t,e,n,r){if(r&&r.global)return t("set",{screen_name:n}),Promise.resolve();{const i=await e;t("config",i,{update:!0,screen_name:n})}}async function w5(t,e,n,r){if(r&&r.global)return t("set",{user_id:n}),Promise.resolve();{const i=await e;t("config",i,{update:!0,user_id:n})}}async function _5(t,e,n,r){if(r&&r.global){const i={};for(const s of Object.keys(n))i[`user_properties.${s}`]=n[s];return t("set",i),Promise.resolve()}else{const i=await e;t("config",i,{update:!0,user_properties:n})}}async function T5(t,e){const n=await t;window[`ga-disable-${n}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I5(){if(Ls())try{await Iv()}catch(t){return ht.warn(Sn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return ht.warn(Sn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function S5(t,e,n,r,i,s,o){var a;const l=p5(t);l.then(g=>{n[g.measurementId]=g.appId,t.options.measurementId&&g.measurementId!==t.options.measurementId&&ht.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${g.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(g=>ht.error(g)),e.push(l);const u=I5().then(g=>{if(g)return r.getId()}),[h,p]=await Promise.all([l,u]);l5(s)||n5(s,h.measurementId),i("js",new Date);const m=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return m[Y3]="firebase",m.update=!0,p!=null&&(m[J3]=p),i("config",h.measurementId,m),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let b5=class{constructor(e){this.app=e}_delete(){return delete Ur[this.app.options.appId],Promise.resolve()}},Ur={},AT=[];const kT={};let dd="dataLayer",vN="gtag",RT,Ou,Ig=!1;function E5(t){if(Ig)throw Sn.create("already-initialized");t.dataLayerName&&(dd=t.dataLayerName),t.gtagName&&(vN=t.gtagName)}function C5(){const t=[];if(Zh()&&t.push("This is a browser extension environment."),FC()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Sn.create("invalid-analytics-context",{errorInfo:e});ht.warn(n.message)}}function N5(t,e,n){C5();const r=t.options.appId;if(!r)throw Sn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)ht.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Sn.create("no-api-key");if(Ur[r]!=null)throw Sn.create("already-exists",{id:r});if(!Ig){r5(dd);const{wrappedGtag:s,gtagCore:o}=a5(Ur,AT,kT,dd,vN);Ou=s,RT=o,Ig=!0}return Ur[r]=S5(t,AT,kT,e,RT,dd,n),new b5(t)}async function A5(){if(Zh()||!FC()||!Ls())return!1;try{return await Iv()}catch{return!1}}function k5(t,e,n){t=J(t),x5(Ou,Ur[t.app.options.appId],e,n).catch(r=>ht.error(r))}function R5(t,e,n){t=J(t),w5(Ou,Ur[t.app.options.appId],e,n).catch(r=>ht.error(r))}function P5(t,e,n){t=J(t),_5(Ou,Ur[t.app.options.appId],e,n).catch(r=>ht.error(r))}function D5(t,e){t=J(t),T5(Ur[t.app.options.appId],e).catch(n=>ht.error(n))}function xN(t,e,n,r){t=J(t),v5(Ou,Ur[t.app.options.appId],e,n,r).catch(i=>ht.error(i))}const PT="@firebase/analytics",DT="0.10.0";function M5(){$n(new Yt(NT,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return N5(r,i,n)},"PUBLIC")),$n(new Yt("analytics-internal",t,"PRIVATE")),pn(PT,DT),pn(PT,DT,"esm2017");function t(e){try{const n=e.getProvider(NT).getImmediate();return{logEvent:(r,i,s)=>xN(n,r,i,s)}}catch(n){throw Sn.create("interop-component-reg-failed",{reason:n})}}}M5();const L5="@firebase/analytics-compat",U5="0.2.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,n){this.app=e,this._delegate=n}logEvent(e,n,r){xN(this._delegate,e,n,r)}setCurrentScreen(e,n){k5(this._delegate,e,n)}setUserId(e,n){R5(this._delegate,e,n)}setUserProperties(e,n){P5(this._delegate,e,n)}setAnalyticsCollectionEnabled(e){D5(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sg;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(Sg||(Sg={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5=t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("analytics").getImmediate();return new wN(e,n)};function O5(){const t={Analytics:wN,settings:E5,isSupported:A5,EventName:Sg};mn.INTERNAL.registerComponent(new Yt("analytics-compat",F5,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}O5();mn.registerVersion(L5,U5);function Dv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}const Ya={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},uo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j5(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}}function _N(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $5=j5,V5=_N,TN=new Jr("auth","Firebase",_N());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh=new Fu("@firebase/auth");function B5(t,...e){oh.logLevel<=de.WARN&&oh.warn(`Auth (${Wi}): ${t}`,...e)}function hd(t,...e){oh.logLevel<=de.ERROR&&oh.error(`Auth (${Wi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(t,...e){throw Mv(t,...e)}function Et(t,...e){return Mv(t,...e)}function IN(t,e,n){const r=Object.assign(Object.assign({},V5()),{[e]:n});return new Jr("auth","Firebase",r).create(e,{appName:t.name})}function ba(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&At(t,"argument-error"),IN(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Mv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return TN.create(t,...e)}function U(t,e,...n){if(!t)throw Mv(e,...n)}function dr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw hd(e),new Error(e)}function Xn(t,e){t||dr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Lv(){return MT()==="http:"||MT()==="https:"}function MT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Lv()||Zh()||"connection"in navigator)?navigator.onLine:!0}function G5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n){this.shortDelay=e,this.longDelay=n,Xn(n>e,"Short delay should be less than long delay!"),this.isMobile=_$()||Tv()}get(){return q5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(t,e){Xn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;dr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;dr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;dr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z5=new ju(3e4,6e4);function tt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function st(t,e,n,r,i={}){return bN(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Sa(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),SN.fetch()(EN(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function bN(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},H5),e);try{const i=new W5(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw pl(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw pl(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw pl(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw pl(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw IN(t,h,u);At(t,h)}}catch(i){if(i instanceof bt)throw i;At(t,"network-request-failed",{message:String(i)})}}async function Yr(t,e,n,r,i={}){const s=await st(t,e,n,r,i);return"mfaPendingCredential"in s&&At(t,"multi-factor-auth-required",{_serverResponse:s}),s}function EN(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Uv(t.config,i):`${t.config.apiScheme}://${i}`}class W5{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Et(this.auth,"network-request-failed")),z5.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function pl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Et(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K5(t,e){return st(t,"POST","/v1/accounts:delete",e)}async function J5(t,e){return st(t,"POST","/v1/accounts:update",e)}async function Y5(t,e){return st(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Q5(t,e=!1){const n=J(t),r=await n.getIdToken(e),i=rf(r);U(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Al($p(i.auth_time)),issuedAtTime:Al($p(i.iat)),expirationTime:Al($p(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function $p(t){return Number(t)*1e3}function rf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return hd("JWT malformed, contained fewer than 3 sections"),null;try{const i=MC(n);return i?JSON.parse(i):(hd("Failed to decode base64 JWT payload"),null)}catch(i){return hd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function X5(t){const e=rf(t);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qr(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof bt&&Z5(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Z5({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Al(this.lastLoginAt),this.creationTime=Al(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ou(t){var e;const n=t.auth,r=await t.getIdToken(),i=await qr(t,Y5(n,{idToken:r}));U(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?r6(s.providerUserInfo):[],a=n6(t.providerData,o),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),h=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new CN(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,p)}async function t6(t){const e=J(t);await ou(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function n6(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function r6(t){return t.map(e=>{var{providerId:n}=e,r=Dv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i6(t,e){const n=await bN(t,{},async()=>{const r=Sa({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=EN(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",SN.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):X5(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return U(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await i6(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new au;return r&&(U(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(U(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new au,this.toJSON())}_performRefresh(){return dr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ri(t,e){U(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class bs{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Dv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new e6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new CN(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await qr(this,this.stsTokenManager.getToken(this.auth,e));return U(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Q5(this,e)}reload(){return t6(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new bs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await ou(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await qr(this,K5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,u,h;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,g=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,y=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(a=n.tenantId)!==null&&a!==void 0?a:void 0,T=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,x=(u=n.createdAt)!==null&&u!==void 0?u:void 0,v=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:_,emailVerified:b,isAnonymous:S,providerData:I,stsTokenManager:E}=n;U(_&&E,e,"internal-error");const R=au.fromJSON(this.name,E);U(typeof _=="string",e,"internal-error"),ri(p,e.name),ri(m,e.name),U(typeof b=="boolean",e,"internal-error"),U(typeof S=="boolean",e,"internal-error"),ri(g,e.name),ri(y,e.name),ri(w,e.name),ri(T,e.name),ri(x,e.name),ri(v,e.name);const F=new bs({uid:_,auth:e,email:m,emailVerified:b,displayName:p,isAnonymous:S,photoURL:y,phoneNumber:g,tenantId:w,stsTokenManager:R,createdAt:x,lastLoginAt:v});return I&&Array.isArray(I)&&(F.providerData=I.map(M=>Object.assign({},M))),T&&(F._redirectEventId=T),F}static async _fromIdTokenResponse(e,n,r=!1){const i=new au;i.updateFromServerResponse(n);const s=new bs({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ou(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT=new Map;function Tn(t){Xn(t instanceof Function,"Expected a class definition");let e=LT.get(t);return e?(Xn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,LT.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}NN.type="NONE";const ra=NN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(t,e,n){return`firebase:${t}:${e}:${n}`}class Bo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Es(this.userKey,i.apiKey,s),this.fullPersistenceKey=Es("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?bs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Bo(Tn(ra),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Tn(ra);const o=Es(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const h=await u._get(o);if(h){const p=bs._fromJSON(e,h);u!==s&&(a=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Bo(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new Bo(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(AN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(PN(e))return"Blackberry";if(DN(e))return"Webos";if(Fv(e))return"Safari";if((e.includes("chrome/")||kN(e))&&!e.includes("edge/"))return"Chrome";if($u(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function AN(t=Ve()){return/firefox\//i.test(t)}function Fv(t=Ve()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kN(t=Ve()){return/crios\//i.test(t)}function RN(t=Ve()){return/iemobile/i.test(t)}function $u(t=Ve()){return/android/i.test(t)}function PN(t=Ve()){return/blackberry/i.test(t)}function DN(t=Ve()){return/webos/i.test(t)}function Ea(t=Ve()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function s6(t=Ve()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function o6(t=Ve()){var e;return Ea(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function a6(){return UC()&&document.documentMode===10}function MN(t=Ve()){return Ea(t)||$u(t)||DN(t)||PN(t)||/windows phone/i.test(t)||RN(t)}function l6(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(t,e=[]){let n;switch(t){case"Browser":n=UT(Ve());break;case"Worker":n=`${UT(Ve())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Wi}/${r}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u6(t){return(await st(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function UN(t,e){return st(t,"GET","/v2/recaptchaConfig",tt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(t){return t!==void 0&&t.getResponse!==void 0}function OT(t){return t!==void 0&&t.enterprise!==void 0}class FN{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(n=>n.provider==="EMAIL_PASSWORD_PROVIDER"&&n.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function Ov(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Et("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",c6().appendChild(r)})}function ON(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const d6="https://www.google.com/recaptcha/enterprise.js?render=",h6="recaptcha-enterprise",f6="NO_RECAPTCHA";class jN{constructor(e){this.type=h6,this.auth=Qe(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{UN(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new FN(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;OT(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(f6)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&OT(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}Ov(d6+a).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})}}async function Di(t,e,n,r=!1){const i=new jN(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jT(this),this.idTokenSubscription=new jT(this),this.beforeStateQueue=new p6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=TN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Tn(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Bo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ou(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=G5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?J(e):null;return n&&U(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Tn(e))})}async initializeRecaptchaConfig(){const e=await UN(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new FN(e);this.tenantId==null?this._agentRecaptchaConfig=n:this._tenantRecaptchaConfigs[this.tenantId]=n,n.emailPasswordEnabled&&new jN(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Jr("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Tn(e)||this._popupRedirectResolver;U(n,this,"argument-error"),this.redirectPersistenceManager=await Bo.create(this,[Tn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return U(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof n=="function"?e.addObserver(n,r,i):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=LN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&B5(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Qe(t){return J(t)}class jT{constructor(e){this.auth=e,this.observer=null,this.addObserver=OC(n=>this.observer=n)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function g6(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Tn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function y6(t,e,n){const r=Qe(t);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=$N(e),{host:o,port:a}=v6(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||x6()}function $N(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function v6(t){const e=$N(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:$T(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:$T(o)}}}function $T(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function x6(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return dr("not implemented")}_getIdTokenResponse(e){return dr("not implemented")}_linkToIdToken(e,n){return dr("not implemented")}_getReauthenticationResolver(e){return dr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VN(t,e){return st(t,"POST","/v1/accounts:resetPassword",tt(t,e))}async function BN(t,e){return st(t,"POST","/v1/accounts:update",e)}async function w6(t,e){return st(t,"POST","/v1/accounts:update",tt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vp(t,e){return Yr(t,"POST","/v1/accounts:signInWithPassword",tt(t,e))}async function sf(t,e){return st(t,"POST","/v1/accounts:sendOobCode",tt(t,e))}async function _6(t,e){return sf(t,e)}async function Bp(t,e){return sf(t,e)}async function qp(t,e){return sf(t,e)}async function T6(t,e){return sf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I6(t,e){return Yr(t,"POST","/v1/accounts:signInWithEmailLink",tt(t,e))}async function S6(t,e){return Yr(t,"POST","/v1/accounts:signInWithEmailLink",tt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu extends Ca{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new lu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new lu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){var n;switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((n=e._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const i=await Di(e,r,"signInWithPassword");return Vp(e,i)}else return Vp(e,r).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const s=await Di(e,r,"signInWithPassword");return Vp(e,s)}else return Promise.reject(i)});case"emailLink":return I6(e,{email:this._email,oobCode:this._password});default:At(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return BN(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return S6(e,{idToken:n,email:this._email,oobCode:this._password});default:At(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fr(t,e){return Yr(t,"POST","/v1/accounts:signInWithIdp",tt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6="http://localhost";class wr extends Ca{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new wr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):At("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Dv(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new wr(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Fr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Fr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Fr(e,n)}buildRequest(){const e={requestUri:b6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Sa(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E6(t,e){return st(t,"POST","/v1/accounts:sendVerificationCode",tt(t,e))}async function C6(t,e){return Yr(t,"POST","/v1/accounts:signInWithPhoneNumber",tt(t,e))}async function N6(t,e){const n=await Yr(t,"POST","/v1/accounts:signInWithPhoneNumber",tt(t,e));if(n.temporaryProof)throw pl(t,"account-exists-with-different-credential",n);return n}const A6={USER_NOT_FOUND:"user-not-found"};async function k6(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Yr(t,"POST","/v1/accounts:signInWithPhoneNumber",tt(t,n),A6)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs extends Ca{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Cs({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Cs({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return C6(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return N6(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return k6(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new Cs({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R6(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function P6(t){const e=Po(fl(t)).link,n=e?Po(fl(e)).deep_link_id:null,r=Po(fl(t)).deep_link_id;return(r?Po(fl(r)).link:null)||r||n||e||t}class of{constructor(e){var n,r,i,s,o,a;const l=Po(fl(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,h=(r=l.oobCode)!==null&&r!==void 0?r:null,p=R6((i=l.mode)!==null&&i!==void 0?i:null);U(u&&h&&p,"argument-error"),this.apiKey=u,this.operation=p,this.code=h,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=P6(e);try{return new of(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.providerId=Ki.PROVIDER_ID}static credential(e,n){return lu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=of.parseLink(n);return U(r,"argument-error"),lu._fromEmailAndCode(e,r.code,r.tenantId)}}Ki.PROVIDER_ID="password";Ki.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ki.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends Qr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class qo extends Na{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return U("providerId"in n&&"signInMethod"in n,"argument-error"),wr._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return U(e.idToken||e.accessToken,"argument-error"),wr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return qo.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return qo.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!n&&!s||!a)return null;try{return new qo(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or extends Na{constructor(){super("facebook.com")}static credential(e){return wr._fromParams({providerId:or.PROVIDER_ID,signInMethod:or.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return or.credentialFromTaggedObject(e)}static credentialFromError(e){return or.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return or.credential(e.oauthAccessToken)}catch{return null}}}or.FACEBOOK_SIGN_IN_METHOD="facebook.com";or.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar extends Na{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return wr._fromParams({providerId:ar.PROVIDER_ID,signInMethod:ar.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ar.credentialFromTaggedObject(e)}static credentialFromError(e){return ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ar.credential(n,r)}catch{return null}}}ar.GOOGLE_SIGN_IN_METHOD="google.com";ar.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr extends Na{constructor(){super("github.com")}static credential(e){return wr._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return lr.credentialFromTaggedObject(e)}static credentialFromError(e){return lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return lr.credential(e.oauthAccessToken)}catch{return null}}}lr.GITHUB_SIGN_IN_METHOD="github.com";lr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D6="http://localhost";class ia extends Ca{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return Fr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Fr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Fr(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new ia(r,s)}static _create(e,n){return new ia(e,n)}buildRequest(){return{requestUri:D6,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M6="saml.";class ah extends Qr{constructor(e){U(e.startsWith(M6),"argument-error"),super(e)}static credentialFromResult(e){return ah.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return ah.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=ia.fromJSON(e);return U(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return ia._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur extends Na{constructor(){super("twitter.com")}static credential(e,n){return wr._fromParams({providerId:ur.PROVIDER_ID,signInMethod:ur.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ur.credentialFromTaggedObject(e)}static credentialFromError(e){return ur.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ur.credential(n,r)}catch{return null}}}ur.TWITTER_SIGN_IN_METHOD="twitter.com";ur.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fd(t,e){return Yr(t,"POST","/v1/accounts:signUp",tt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await bs._fromIdTokenResponse(e,r,i),o=VT(r);return new Vn({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=VT(r);return new Vn({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function VT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L6(t){var e;const n=Qe(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Vn({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await fd(n,{returnSecureToken:!0}),i=await Vn._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh extends bt{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,lh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new lh(e,n,r,i)}}function qN(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?lh._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GN(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U6(t,e){const n=J(t);await af(!0,n,e);const{providerUserInfo:r}=await J5(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=GN(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function jv(t,e,n=!1){const r=await qr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Vn._forOperation(t,"link",r)}async function af(t,e,n){await ou(e);const r=GN(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";U(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HN(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await qr(t,qN(r,i,e,t),n);U(s.idToken,r,"internal-error");const o=rf(s.idToken);U(o,r,"internal-error");const{sub:a}=o;return U(t.uid===a,r,"user-mismatch"),Vn._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&At(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zN(t,e,n=!1){const r="signIn",i=await qN(t,r,e),s=await Vn._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function lf(t,e){return zN(Qe(t),e)}async function WN(t,e){const n=J(t);return await af(!1,n,e.providerId),jv(n,e)}async function KN(t,e){return HN(J(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F6(t,e){return Yr(t,"POST","/v1/accounts:signInWithCustomToken",tt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O6(t,e){const n=Qe(t),r=await F6(n,{token:e,returnSecureToken:!0}),i=await Vn._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?$v._fromServerResponse(e,n):"totpInfo"in n?Vv._fromServerResponse(e,n):At(e,"internal-error")}}class $v extends Vu{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new $v(n)}}class Vv extends Vu{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new Vv(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Go(t,e,n){var r;U(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),U(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(U(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(U(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j6(t,e,n){var r;const i=Qe(t),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const o=await Di(i,s,"getOobCode",!0);n&&Go(i,o,n),await Bp(i,o)}else n&&Go(i,s,n),await Bp(i,s).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const a=await Di(i,s,"getOobCode",!0);n&&Go(i,a,n),await Bp(i,a)}else return Promise.reject(o)})}async function $6(t,e,n){await VN(J(t),{oobCode:e,newPassword:n})}async function V6(t,e){await w6(J(t),{oobCode:e})}async function JN(t,e){const n=J(t),r=await VN(n,{oobCode:e}),i=r.requestType;switch(U(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":U(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":U(r.mfaInfo,n,"internal-error");default:U(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Vu._fromServerResponse(Qe(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function B6(t,e){const{data:n}=await JN(J(t),e);return n.email}async function q6(t,e,n){var r;const i=Qe(t),s={returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"};let o;if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const u=await Di(i,s,"signUpPassword");o=fd(i,u)}else o=fd(i,s).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const h=await Di(i,s,"signUpPassword");return fd(i,h)}else return Promise.reject(u)});const a=await o.catch(u=>Promise.reject(u)),l=await Vn._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(l.user),l}function G6(t,e,n){return lf(J(t),Ki.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H6(t,e,n){var r;const i=Qe(t),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(a,l){U(l.handleCodeInApp,i,"argument-error"),l&&Go(i,a,l)}if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const a=await Di(i,s,"getOobCode",!0);o(a,n),await qp(i,a)}else o(s,n),await qp(i,s).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const l=await Di(i,s,"getOobCode",!0);o(l,n),await qp(i,l)}else return Promise.reject(a)})}function z6(t,e){const n=of.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function W6(t,e,n){const r=J(t),i=Ki.credentialWithLink(e,n||su());return U(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),lf(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K6(t,e){return st(t,"POST","/v1/accounts:createAuthUri",tt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J6(t,e){const n=Lv()?su():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await K6(J(t),r);return i||[]}async function Y6(t,e){const n=J(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&Go(n.auth,i,e);const{email:s}=await _6(n.auth,i);s!==t.email&&await t.reload()}async function Q6(t,e,n){const r=J(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&Go(r.auth,s,n);const{email:o}=await T6(r.auth,s);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X6(t,e){return st(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=J(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await qr(r,X6(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function eB(t,e){return YN(J(t),e,null)}function tB(t,e){return YN(J(t),null,e)}async function YN(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const o=await qr(t,BN(r,s));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nB(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const o=(n=(e=rf(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new Ho(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new rB(s,i);case"github.com":return new iB(s,i);case"google.com":return new sB(s,i);case"twitter.com":return new oB(s,i,t.screenName||null);case"custom":case"anonymous":return new Ho(s,null);default:return new Ho(s,r,i)}}class Ho{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class QN extends Ho{constructor(e,n,r,i){super(e,n,r),this.username=i}}class rB extends Ho{constructor(e,n){super(e,"facebook.com",n)}}class iB extends QN{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class sB extends Ho{constructor(e,n){super(e,"google.com",n)}}class oB extends QN{constructor(e,n,r){super(e,"twitter.com",n,r)}}function aB(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:nB(n)}class vs{constructor(e,n,r){this.type=e,this.credential=n,this.auth=r}static _fromIdtoken(e,n){return new vs("enroll",e,n)}static _fromMfaPendingCredential(e){return new vs("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return vs._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return vs._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Qe(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Vu._fromServerResponse(r,a));U(i.mfaPendingCredential,r,"internal-error");const o=vs._fromMfaPendingCredential(i.mfaPendingCredential);return new Bv(o,s,async a=>{const l=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const u=Object.assign(Object.assign({},i),{idToken:l.idToken,refreshToken:l.refreshToken});switch(n.operationType){case"signIn":const h=await Vn._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(h.user),h;case"reauthenticate":return U(n.user,r,"internal-error"),Vn._forOperation(n.user,n.operationType,u);default:At(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function lB(t,e){var n;const r=J(t),i=e;return U(e.customData.operationType,r,"argument-error"),U((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),Bv._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uB(t,e){return st(t,"POST","/v2/accounts/mfaEnrollment:start",tt(t,e))}function cB(t,e){return st(t,"POST","/v2/accounts/mfaEnrollment:finalize",tt(t,e))}function dB(t,e){return st(t,"POST","/v2/accounts/mfaEnrollment:withdraw",tt(t,e))}class qv{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Vu._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new qv(e)}async getSession(){return vs._fromIdtoken(await this.user.getIdToken(),this.user.auth)}async enroll(e,n){const r=e,i=await this.getSession(),s=await qr(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await qr(this.user,dB(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Gp=new WeakMap;function hB(t){const e=J(t);return Gp.has(e)||Gp.set(e,qv._fromUser(e)),Gp.get(e)}const uh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(uh,"1"),this.storage.removeItem(uh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fB(){const t=Ve();return Fv(t)||Ea(t)}const pB=1e3,mB=10;class ZN extends XN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=fB()&&l6(),this.fallbackToPolling=MN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);a6()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,mB):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},pB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ZN.type="LOCAL";const Gv=ZN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1 extends XN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}e1.type="SESSION";const js=e1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gB(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new uf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await gB(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}uf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=Bu("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(){return window}function vB(t){Ze().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hv(){return typeof Ze().WorkerGlobalScope<"u"&&typeof Ze().importScripts=="function"}async function xB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wB(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function _B(){return Hv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1="firebaseLocalStorageDb",TB=1,ch="firebaseLocalStorage",n1="fbase_key";class qu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function cf(t,e){return t.transaction([ch],e?"readwrite":"readonly").objectStore(ch)}function IB(){const t=indexedDB.deleteDatabase(t1);return new qu(t).toPromise()}function bg(){const t=indexedDB.open(t1,TB);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(ch,{keyPath:n1})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(ch)?e(r):(r.close(),await IB(),e(await bg()))})})}async function BT(t,e,n){const r=cf(t,!0).put({[n1]:e,value:n});return new qu(r).toPromise()}async function SB(t,e){const n=cf(t,!1).get(e),r=await new qu(n).toPromise();return r===void 0?null:r.value}function qT(t,e){const n=cf(t,!0).delete(e);return new qu(n).toPromise()}const bB=800,EB=3;class r1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>EB)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Hv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=uf._getInstance(_B()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await xB(),!this.activeServiceWorker)return;this.sender=new yB(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await bg();return await BT(e,uh,"1"),await qT(e,uh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>BT(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>SB(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>qT(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=cf(i,!1).getAll();return new qu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}r1.type="LOCAL";const uu=r1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(t,e){return st(t,"POST","/v2/accounts/mfaSignIn:start",tt(t,e))}function NB(t,e){return st(t,"POST","/v2/accounts/mfaSignIn:finalize",tt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AB=500,kB=6e4,Uc=1e12;class RB{constructor(e){this.auth=e,this.counter=Uc,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new PB(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||Uc;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||Uc;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||Uc;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class PB{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;U(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=DB(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},kB)},AB))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function DB(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp=ON("rcb"),MB=new ju(3e4,6e4),LB="https://www.google.com/recaptcha/api.js?";class UB{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Ze().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return U(FB(n),e,"argument-error"),this.shouldResolveImmediately(n)&&FT(Ze().grecaptcha)?Promise.resolve(Ze().grecaptcha):new Promise((r,i)=>{const s=Ze().setTimeout(()=>{i(Et(e,"network-request-failed"))},MB.get());Ze()[Hp]=()=>{Ze().clearTimeout(s),delete Ze()[Hp];const a=Ze().grecaptcha;if(!a||!FT(a)){i(Et(e,"internal-error"));return}const l=a.render;a.render=(u,h)=>{const p=l(u,h);return this.counter++,p},this.hostLanguage=n,r(a)};const o=`${LB}?${Sa({onload:Hp,render:"explicit",hl:n})}`;Ov(o).catch(()=>{clearTimeout(s),i(Et(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=Ze().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function FB(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class OB{async load(e){return new RB(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1="recaptcha",jB={theme:"light",type:"image"};let $B=class{constructor(e,n=Object.assign({},jB),r){this.parameters=n,this.type=i1,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Qe(r),this.isInvisible=this.parameters.size==="invisible",U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof e=="string"?document.getElementById(e):e;U(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new OB:new UB,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){U(!this.parameters.sitekey,this.auth,"argument-error"),U(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=Ze()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){U(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){U(Lv()&&!Hv(),this.auth,"internal-error"),await VB(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await u6(this.auth);U(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return U(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function VB(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Cs._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function BB(t,e,n){const r=Qe(t),i=await df(r,e,J(n));return new zv(i,s=>lf(r,s))}async function qB(t,e,n){const r=J(t);await af(!1,r,"phone");const i=await df(r.auth,e,J(n));return new zv(i,s=>WN(r,s))}async function GB(t,e,n){const r=J(t),i=await df(r.auth,e,J(n));return new zv(i,s=>KN(r,s))}async function df(t,e,n){var r;const i=await n.verify();try{U(typeof i=="string",t,"argument-error"),U(n.type===i1,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const o=s.session;if("phoneNumber"in s)return U(o.type==="enroll",t,"internal-error"),(await uB(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{U(o.type==="signin",t,"internal-error");const a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return U(a,t,"missing-multi-factor-info"),(await CB(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await E6(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{n._reset()}}async function HB(t,e){await jv(J(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s=class pd{constructor(e){this.providerId=pd.PROVIDER_ID,this.auth=Qe(e)}verifyPhoneNumber(e,n){return df(this.auth,e,J(n))}static credential(e,n){return Cs._fromVerification(e,n)}static credentialFromResult(e){const n=e;return pd.credentialFromTaggedObject(n)}static credentialFromError(e){return pd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Cs._fromTokenResponse(n,r):null}};$s.PROVIDER_ID="phone";$s.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(t,e){return e?Tn(e):(U(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv extends Ca{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fr(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Fr(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Fr(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function zB(t){return zN(t.auth,new Wv(t),t.bypassAuthState)}function WB(t){const{auth:e,user:n}=t;return U(n,e,"internal-error"),HN(n,new Wv(t),t.bypassAuthState)}async function KB(t){const{auth:e,user:n}=t;return U(n,e,"internal-error"),jv(n,new Wv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zB;case"linkViaPopup":case"linkViaRedirect":return KB;case"reauthViaPopup":case"reauthViaRedirect":return WB;default:At(this.auth,"internal-error")}}resolve(e){Xn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JB=new ju(2e3,1e4);async function YB(t,e,n){const r=Qe(t);ba(t,e,Qr);const i=eo(r,n);return new kr(r,"signInViaPopup",e,i).executeNotNull()}async function QB(t,e,n){const r=J(t);ba(r.auth,e,Qr);const i=eo(r.auth,n);return new kr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function XB(t,e,n){const r=J(t);ba(r.auth,e,Qr);const i=eo(r.auth,n);return new kr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class kr extends s1{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,kr.currentPopupAction&&kr.currentPopupAction.cancel(),kr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return U(e,this.auth,"internal-error"),e}async onExecution(){Xn(this.filter.length===1,"Popup operations only handle one event");const e=Bu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Et(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Et(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,kr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Et(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,JB.get())};e()}}kr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZB="pendingRedirect",kl=new Map;class eq extends s1{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=kl.get(this.auth._key());if(!e){try{const r=await tq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}kl.set(this.auth._key(),e)}return this.bypassAuthState||kl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function tq(t,e){const n=a1(e),r=o1(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function Kv(t,e){return o1(t)._set(a1(e),"true")}function nq(){kl.clear()}function Jv(t,e){kl.set(t._key(),e)}function o1(t){return Tn(t._redirectPersistence)}function a1(t){return Es(ZB,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rq(t,e,n){return iq(t,e,n)}async function iq(t,e,n){const r=Qe(t);ba(t,e,Qr),await r._initializationPromise;const i=eo(r,n);return await Kv(i,r),i._openRedirect(r,e,"signInViaRedirect")}function sq(t,e,n){return oq(t,e,n)}async function oq(t,e,n){const r=J(t);ba(r.auth,e,Qr),await r.auth._initializationPromise;const i=eo(r.auth,n);await Kv(i,r.auth);const s=await l1(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function aq(t,e,n){return lq(t,e,n)}async function lq(t,e,n){const r=J(t);ba(r.auth,e,Qr),await r.auth._initializationPromise;const i=eo(r.auth,n);await af(!1,r,e.providerId),await Kv(i,r.auth);const s=await l1(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function uq(t,e){return await Qe(t)._initializationPromise,hf(t,e,!1)}async function hf(t,e,n=!1){const r=Qe(t),i=eo(r,e),o=await new eq(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function l1(t){const e=Bu(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cq=10*60*1e3;class u1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!dq(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!c1(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Et(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cq&&this.cachedEventUids.clear(),this.cachedEventUids.has(GT(e))}saveEventToCache(e){this.cachedEventUids.add(GT(e)),this.lastProcessedEventTime=Date.now()}}function GT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function c1({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function dq(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return c1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d1(t,e={}){return st(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hq=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fq=/^https?/;async function pq(t){if(t.config.emulator)return;const{authorizedDomains:e}=await d1(t);for(const n of e)try{if(mq(n))return}catch{}At(t,"unauthorized-domain")}function mq(t){const e=su(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!fq.test(n))return!1;if(hq.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gq=new ju(3e4,6e4);function HT(){const t=Ze().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function yq(t){return new Promise((e,n)=>{var r,i,s;function o(){HT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{HT(),n(Et(t,"network-request-failed"))},timeout:gq.get()})}if(!((i=(r=Ze().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ze().gapi)===null||s===void 0)&&s.load)o();else{const a=ON("iframefcb");return Ze()[a]=()=>{gapi.load?o():n(Et(t,"network-request-failed"))},Ov(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw md=null,e})}let md=null;function vq(t){return md=md||yq(t),md}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xq=new ju(5e3,15e3),wq="__/auth/iframe",_q="emulator/auth/iframe",Tq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Iq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Sq(t){const e=t.config;U(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Uv(e,_q):`https://${t.config.authDomain}/${wq}`,r={apiKey:e.apiKey,appName:t.name,v:Wi},i=Iq.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Sa(r).slice(1)}`}async function bq(t){const e=await vq(t),n=Ze().gapi;return U(n,t,"internal-error"),e.open({where:document.body,url:Sq(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tq,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Et(t,"network-request-failed"),a=Ze().setTimeout(()=>{s(o)},xq.get());function l(){Ze().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Cq=500,Nq=600,Aq="_blank",kq="http://localhost";class zT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Rq(t,e,n,r=Cq,i=Nq){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Eq),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Ve().toLowerCase();n&&(a=kN(u)?Aq:n),AN(u)&&(e=e||kq,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[g,y])=>`${m}${g}=${y},`,"");if(o6(u)&&a!=="_self")return Pq(e||"",a),new zT(null);const p=window.open(e||"",a,h);U(p,t,"popup-blocked");try{p.focus()}catch{}return new zT(p)}function Pq(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dq="__/auth/handler",Mq="emulator/auth/handler",Lq=encodeURIComponent("fac");async function Eg(t,e,n,r,i,s){U(t.config.authDomain,t,"auth-domain-config-required"),U(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Wi,eventId:i};if(e instanceof Qr){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",C$(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries(s||{}))o[h]=p}if(e instanceof Na){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),u=l?`#${Lq}=${encodeURIComponent(l)}`:"";return`${Uq(t)}?${Sa(a).slice(1)}${u}`}function Uq({config:t}){return t.emulator?Uv(t,Mq):`https://${t.authDomain}/${Dq}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="webStorageSupport";class Fq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=js,this._completeRedirectFn=hf,this._overrideRedirectResult=Jv}async _openPopup(e,n,r,i){var s;Xn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await Eg(e,n,r,su(),i);return Rq(e,o,Bu())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Eg(e,n,r,su(),i);return vB(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Xn(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await bq(e),r=new u1(e);return n.register("authEvent",i=>(U(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(zp,{type:zp},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[zp];o!==void 0&&n(!!o),At(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=pq(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return MN()||Fv()||Ea()}}const Oq=Fq;class jq{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return dr("unexpected MultiFactorSessionType")}}}class Yv extends jq{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Yv(e)}_finalizeEnroll(e,n,r){return cB(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return NB(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class h1{constructor(){}static assertion(e){return Yv._fromCredential(e)}}h1.FACTOR_ID="phone";var WT="@firebase/auth",KT="0.23.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $q{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vq(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function Bq(t){$n(new Yt("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;U(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:LN(t)},u=new m6(r,i,s,l);return g6(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),$n(new Yt("auth-internal",e=>{const n=Qe(e.getProvider("auth").getImmediate());return(r=>new $q(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(WT,KT,Vq(t)),pn(WT,KT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq=5*60;v$("authIdTokenMaxAge");Bq("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gq=2e3;async function Hq(t,e,n){var r;const{BuildInfo:i}=Vs();Xn(e.sessionId,"AuthEvent did not contain a session ID");const s=await Yq(e.sessionId),o={};return Ea()?o.ibi=i.packageName:$u()?o.apn=i.packageName:At(t,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Eg(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function zq(t){const{BuildInfo:e}=Vs(),n={};Ea()?n.iosBundleId=e.packageName:$u()?n.androidPackageName=e.packageName:At(t,"operation-not-supported-in-this-environment"),await d1(t,n)}function Wq(t){const{cordova:e}=Vs();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,s6()?"_blank":"_system","location=yes"),n(i)})})}async function Kq(t,e,n){const{cordova:r}=Vs();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function l(){var p;s();const m=(p=r.plugins.browsertab)===null||p===void 0?void 0:p.close;typeof m=="function"&&m(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function u(){a||(a=window.setTimeout(()=>{o(Et(t,"redirect-cancelled-by-user"))},Gq))}function h(){(document==null?void 0:document.visibilityState)==="visible"&&u()}e.addPassiveListener(l),document.addEventListener("resume",u,!1),$u()&&document.addEventListener("visibilitychange",h,!1),i=()=>{e.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",h,!1),a&&window.clearTimeout(a)}})}finally{i()}}function Jq(t){var e,n,r,i,s,o,a,l,u,h;const p=Vs();U(typeof((e=p==null?void 0:p.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),U(typeof((n=p==null?void 0:p.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),U(typeof((s=(i=(r=p==null?void 0:p.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((l=(a=(o=p==null?void 0:p.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||l===void 0?void 0:l.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((h=(u=p==null?void 0:p.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||h===void 0?void 0:h.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function Yq(t){const e=Qq(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function Qq(t){if(Xn(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xq=20;class Zq extends u1{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function eG(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:rG(),postBody:null,tenantId:t.tenantId,error:Et(t,"no-auth-event")}}function tG(t,e){return Cg()._set(Ng(t),e)}async function JT(t){const e=await Cg()._get(Ng(t));return e&&await Cg()._remove(Ng(t)),e}function nG(t,e){var n,r;const i=sG(e);if(i.includes("/__/auth/callback")){const s=gd(i),o=s.firebaseError?iG(decodeURIComponent(s.firebaseError)):null,a=(r=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],l=a?Et(a):null;return l?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function rG(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<Xq;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function Cg(){return Tn(Gv)}function Ng(t){return Es("authEvent",t.config.apiKey,t.name)}function iG(t){try{return JSON.parse(t)}catch{return null}}function sG(t){const e=gd(t),n=e.link?decodeURIComponent(e.link):void 0,r=gd(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return gd(i).link||i||r||n||t}function gd(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Po(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oG=500;class aG{constructor(){this._redirectPersistence=js,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=hf,this._overrideRedirectResult=Jv}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new Zq(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){At(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){Jq(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),nq(),await this._originValidation(e);const o=eG(e,r,i);await tG(e,o);const a=await Hq(e,o,n),l=await Wq(a);return Kq(e,s,l)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=zq(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Vs(),o=setTimeout(async()=>{await JT(e),n.onEvent(YT())},oG),a=async h=>{clearTimeout(o);const p=await JT(e);let m=null;p&&(h!=null&&h.url)&&(m=nG(p,h.url)),n.onEvent(m||YT())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const l=i,u=`${s.packageName.toLowerCase()}://`;Vs().handleOpenURL=async h=>{if(h.toLowerCase().startsWith(u)&&a({url:h}),typeof l=="function")try{l(h)}catch(p){console.error(p)}}}}const lG=aG;function YT(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Et("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uG(t,e){Qe(t)._logFramework(e)}var cG="@firebase/auth-compat",dG="0.4.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hG=1e3;function Rl(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function fG(){return Rl()==="http:"||Rl()==="https:"}function f1(t=Ve()){return!!((Rl()==="file:"||Rl()==="ionic:"||Rl()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function pG(){return Tv()||_v()}function mG(){return UC()&&(document==null?void 0:document.documentMode)===11}function gG(t=Ve()){return/Edge\/\d+/.test(t)}function yG(t=Ve()){return mG()||gG(t)}function p1(){try{const t=self.localStorage,e=Bu();if(t)return t.setItem(e,"1"),t.removeItem(e),yG()?Ls():!0}catch{return Qv()&&Ls()}return!1}function Qv(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Wp(){return(fG()||Zh()||f1())&&!pG()&&p1()&&!Qv()}function m1(){return f1()&&typeof document<"u"}async function vG(){return m1()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},hG);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function xG(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xn={LOCAL:"local",NONE:"none",SESSION:"session"},Qa=U,g1="persistence";function wG(t,e){if(Qa(Object.values(xn).includes(e),t,"invalid-persistence-type"),Tv()){Qa(e!==xn.SESSION,t,"unsupported-persistence-type");return}if(_v()){Qa(e===xn.NONE,t,"unsupported-persistence-type");return}if(Qv()){Qa(e===xn.NONE||e===xn.LOCAL&&Ls(),t,"unsupported-persistence-type");return}Qa(e===xn.NONE||p1(),t,"unsupported-persistence-type")}async function Ag(t){await t._initializationPromise;const e=y1(),n=Es(g1,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function _G(t,e){const n=y1();if(!n)return[];const r=Es(g1,t,e);switch(n.getItem(r)){case xn.NONE:return[ra];case xn.LOCAL:return[uu,js];case xn.SESSION:return[js];default:return[]}}function y1(){var t;try{return((t=xG())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TG=U;class yi{constructor(){this.browserResolver=Tn(Oq),this.cordovaResolver=Tn(lG),this.underlyingResolver=null,this._redirectPersistence=js,this._completeRedirectFn=hf,this._overrideRedirectResult=Jv}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return m1()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return TG(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await vG();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(t){return t.unwrap()}function IG(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SG(t){return x1(t)}function bG(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new EG(t,lB(t,e))}else if(r){const i=x1(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function x1(t){const{_tokenResponse:e}=t instanceof bt?t.customData:t;if(!e)return null;if(!(t instanceof bt)&&"temporaryProof"in e&&"phoneNumber"in e)return $s.credentialFromResult(t);const n=e.providerId;if(!n||n===Ya.PASSWORD)return null;let r;switch(n){case Ya.GOOGLE:r=ar;break;case Ya.FACEBOOK:r=or;break;case Ya.GITHUB:r=lr;break;case Ya.TWITTER:r=ur;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:l}=e;return!s&&!o&&!i&&!a?null:a?n.startsWith("saml.")?ia._create(n,a):wr._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:i,accessToken:s}):new qo(n).credential({idToken:i,accessToken:s,rawNonce:l})}return t instanceof bt?r.credentialFromError(t):r.credentialFromResult(t)}function rn(t,e){return e.catch(n=>{throw n instanceof bt&&bG(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:SG(n),additionalUserInfo:aB(n),user:Rr.getOrCreate(i)}})}async function kg(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>rn(t,n.confirm(r))}}class EG{constructor(e,n){this.resolver=n,this.auth=IG(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return rn(v1(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this._delegate=e,this.multiFactor=hB(e)}static getOrCreate(e){return Rr.USER_MAP.has(e)||Rr.USER_MAP.set(e,new Rr(e)),Rr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return rn(this.auth,WN(this._delegate,e))}async linkWithPhoneNumber(e,n){return kg(this.auth,qB(this._delegate,e,n))}async linkWithPopup(e){return rn(this.auth,XB(this._delegate,e,yi))}async linkWithRedirect(e){return await Ag(Qe(this.auth)),aq(this._delegate,e,yi)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return rn(this.auth,KN(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return kg(this.auth,GB(this._delegate,e,n))}reauthenticateWithPopup(e){return rn(this.auth,QB(this._delegate,e,yi))}async reauthenticateWithRedirect(e){return await Ag(Qe(this.auth)),sq(this._delegate,e,yi)}sendEmailVerification(e){return Y6(this._delegate,e)}async unlink(e){return await U6(this._delegate,e),this}updateEmail(e){return eB(this._delegate,e)}updatePassword(e){return tB(this._delegate,e)}updatePhoneNumber(e){return HB(this._delegate,e)}updateProfile(e){return Z6(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return Q6(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Rr.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=U;class Rg{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Xa(r,"invalid-api-key",{appName:e.name}),Xa(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?yi:void 0;this._delegate=n.initialize({options:{persistence:CG(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap($5),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Rr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){y6(this._delegate,e,n)}applyActionCode(e){return V6(this._delegate,e)}checkActionCode(e){return JN(this._delegate,e)}confirmPasswordReset(e,n){return $6(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return rn(this._delegate,q6(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return J6(this._delegate,e)}isSignInWithEmailLink(e){return z6(this._delegate,e)}async getRedirectResult(){Xa(Wp(),this._delegate,"operation-not-supported-in-this-environment");const e=await uq(this._delegate,yi);return e?rn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){uG(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:s,complete:o}=QT(e,n,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,n,r){const{next:i,error:s,complete:o}=QT(e,n,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,n){return H6(this._delegate,e,n)}sendPasswordResetEmail(e,n){return j6(this._delegate,e,n||void 0)}async setPersistence(e){wG(this._delegate,e);let n;switch(e){case xn.SESSION:n=js;break;case xn.LOCAL:n=await Tn(uu)._isAvailable()?uu:Gv;break;case xn.NONE:n=ra;break;default:return At("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return rn(this._delegate,L6(this._delegate))}signInWithCredential(e){return rn(this._delegate,lf(this._delegate,e))}signInWithCustomToken(e){return rn(this._delegate,O6(this._delegate,e))}signInWithEmailAndPassword(e,n){return rn(this._delegate,G6(this._delegate,e,n))}signInWithEmailLink(e,n){return rn(this._delegate,W6(this._delegate,e,n))}signInWithPhoneNumber(e,n){return kg(this._delegate,BB(this._delegate,e,n))}async signInWithPopup(e){return Xa(Wp(),this._delegate,"operation-not-supported-in-this-environment"),rn(this._delegate,YB(this._delegate,e,yi))}async signInWithRedirect(e){return Xa(Wp(),this._delegate,"operation-not-supported-in-this-environment"),await Ag(this._delegate),rq(this._delegate,e,yi)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return B6(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Rg.Persistence=xn;function QT(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:o=>i(o&&Rr.getOrCreate(o)),error:e,complete:n}}function CG(t,e){const n=_G(t,e);if(typeof self<"u"&&!n.includes(uu)&&n.push(uu),typeof window<"u")for(const r of[Gv,js])n.includes(r)||n.push(r);return n.includes(ra)||n.push(ra),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(){this.providerId="phone",this._delegate=new $s(v1(mn.auth()))}static credential(e,n){return $s.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}Xv.PHONE_SIGN_IN_METHOD=$s.PHONE_SIGN_IN_METHOD;Xv.PROVIDER_ID=$s.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NG=U;class AG{constructor(e,n,r=mn.app()){var i;NG((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new $B(e,n,r.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kG="auth-compat";function RG(t){t.INTERNAL.registerComponent(new Yt(kG,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Rg(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:uo.EMAIL_SIGNIN,PASSWORD_RESET:uo.PASSWORD_RESET,RECOVER_EMAIL:uo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:uo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:uo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:uo.VERIFY_EMAIL}},EmailAuthProvider:Ki,FacebookAuthProvider:or,GithubAuthProvider:lr,GoogleAuthProvider:ar,OAuthProvider:qo,SAMLAuthProvider:ah,PhoneAuthProvider:Xv,PhoneMultiFactorGenerator:h1,RecaptchaVerifier:AG,TwitterAuthProvider:ur,Auth:Rg,AuthCredential:Ca,Error:bt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(cG,dG)}RG(mn);var PG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},V,Zv=Zv||{},te=PG||self;function ff(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Gu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function DG(t){return Object.prototype.hasOwnProperty.call(t,Kp)&&t[Kp]||(t[Kp]=++MG)}var Kp="closure_uid_"+(1e9*Math.random()>>>0),MG=0;function LG(t,e,n){return t.call.apply(t.bind,arguments)}function UG(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Ft(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ft=LG:Ft=UG,Ft.apply(null,arguments)}function Fc(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function gt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Ji(){this.s=this.s,this.o=this.o}var FG=0;Ji.prototype.s=!1;Ji.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),FG!=0)&&DG(this)};Ji.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const w1=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function e0(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function XT(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(ff(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Ot(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Ot.prototype.h=function(){this.defaultPrevented=!0};var OG=function(){if(!te.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{te.addEventListener("test",()=>{},e),te.removeEventListener("test",()=>{},e)}catch{}return t}();function cu(t){return/^[\s\xa0]*$/.test(t)}function pf(){var t=te.navigator;return t&&(t=t.userAgent)?t:""}function cr(t){return pf().indexOf(t)!=-1}function t0(t){return t0[" "](t),t}t0[" "]=function(){};function jG(t,e){var n=R9;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var $G=cr("Opera"),sa=cr("Trident")||cr("MSIE"),_1=cr("Edge"),Pg=_1||sa,T1=cr("Gecko")&&!(pf().toLowerCase().indexOf("webkit")!=-1&&!cr("Edge"))&&!(cr("Trident")||cr("MSIE"))&&!cr("Edge"),VG=pf().toLowerCase().indexOf("webkit")!=-1&&!cr("Edge");function I1(){var t=te.document;return t?t.documentMode:void 0}var Dg;e:{var Jp="",Yp=function(){var t=pf();if(T1)return/rv:([^\);]+)(\)|;)/.exec(t);if(_1)return/Edge\/([\d\.]+)/.exec(t);if(sa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(VG)return/WebKit\/(\S+)/.exec(t);if($G)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Yp&&(Jp=Yp?Yp[1]:""),sa){var Qp=I1();if(Qp!=null&&Qp>parseFloat(Jp)){Dg=String(Qp);break e}}Dg=Jp}var Mg;if(te.document&&sa){var ZT=I1();Mg=ZT||parseInt(Dg,10)||void 0}else Mg=void 0;var BG=Mg;function du(t,e){if(Ot.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(T1){e:{try{t0(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:qG[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&du.$.h.call(this)}}gt(du,Ot);var qG={2:"touch",3:"pen",4:"mouse"};du.prototype.h=function(){du.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Hu="closure_listenable_"+(1e6*Math.random()|0),GG=0;function HG(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++GG,this.fa=this.ia=!1}function mf(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function n0(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function zG(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function S1(t){const e={};for(const n in t)e[n]=t[n];return e}const eI="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b1(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<eI.length;s++)n=eI[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function gf(t){this.src=t,this.g={},this.h=0}gf.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Ug(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new HG(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Lg(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=w1(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(mf(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Ug(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var r0="closure_lm_"+(1e6*Math.random()|0),Xp={};function E1(t,e,n,r,i){if(r&&r.once)return N1(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)E1(t,e[s],n,r,i);return null}return n=o0(n),t&&t[Hu]?t.O(e,n,Gu(r)?!!r.capture:!!r,i):C1(t,e,n,!1,r,i)}function C1(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Gu(i)?!!i.capture:!!i,a=s0(t);if(a||(t[r0]=a=new gf(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=WG(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)OG||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(k1(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function WG(){function t(n){return e.call(t.src,t.listener,n)}const e=KG;return t}function N1(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)N1(t,e[s],n,r,i);return null}return n=o0(n),t&&t[Hu]?t.P(e,n,Gu(r)?!!r.capture:!!r,i):C1(t,e,n,!0,r,i)}function A1(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)A1(t,e[s],n,r,i);else r=Gu(r)?!!r.capture:!!r,n=o0(n),t&&t[Hu]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Ug(s,n,r,i),-1<n&&(mf(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=s0(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ug(e,n,r,i)),(n=-1<t?e[t]:null)&&i0(n))}function i0(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Hu])Lg(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(k1(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=s0(e))?(Lg(n,t),n.h==0&&(n.src=null,e[r0]=null)):mf(t)}}}function k1(t){return t in Xp?Xp[t]:Xp[t]="on"+t}function KG(t,e){if(t.fa)t=!0;else{e=new du(e,this);var n=t.listener,r=t.la||t.src;t.ia&&i0(t),t=n.call(r,e)}return t}function s0(t){return t=t[r0],t instanceof gf?t:null}var Zp="__closure_events_fn_"+(1e9*Math.random()>>>0);function o0(t){return typeof t=="function"?t:(t[Zp]||(t[Zp]=function(e){return t.handleEvent(e)}),t[Zp])}function pt(){Ji.call(this),this.i=new gf(this),this.S=this,this.J=null}gt(pt,Ji);pt.prototype[Hu]=!0;pt.prototype.removeEventListener=function(t,e,n,r){A1(this,t,e,n,r)};function Ct(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Ot(e,t);else if(e instanceof Ot)e.target=e.target||t;else{var i=e;e=new Ot(r,t),b1(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Oc(o,r,!0,e)&&i}if(o=e.g=t,i=Oc(o,r,!0,e)&&i,i=Oc(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Oc(o,r,!1,e)&&i}pt.prototype.N=function(){if(pt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)mf(n[r]);delete t.g[e],t.h--}}this.J=null};pt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};pt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Oc(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Lg(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var a0=te.JSON.stringify;class JG{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function YG(){var t=l0;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class QG{constructor(){this.h=this.g=null}add(e,n){const r=R1.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var R1=new JG(()=>new XG,t=>t.reset());class XG{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function ZG(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function e9(t){te.setTimeout(()=>{throw t},0)}let hu,fu=!1,l0=new QG,P1=()=>{const t=te.Promise.resolve(void 0);hu=()=>{t.then(t9)}};var t9=()=>{for(var t;t=YG();){try{t.h.call(t.g)}catch(n){e9(n)}var e=R1;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}fu=!1};function yf(t,e){pt.call(this),this.h=t||1,this.g=e||te,this.j=Ft(this.qb,this),this.l=Date.now()}gt(yf,pt);V=yf.prototype;V.ga=!1;V.T=null;V.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ct(this,"tick"),this.ga&&(u0(this),this.start()))}};V.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function u0(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}V.N=function(){yf.$.N.call(this),u0(this),delete this.g};function c0(t,e,n){if(typeof t=="function")n&&(t=Ft(t,n));else if(t&&typeof t.handleEvent=="function")t=Ft(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:te.setTimeout(t,e||0)}function D1(t){t.g=c0(()=>{t.g=null,t.i&&(t.i=!1,D1(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class n9 extends Ji{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:D1(this)}N(){super.N(),this.g&&(te.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pu(t){Ji.call(this),this.h=t,this.g={}}gt(pu,Ji);var tI=[];function M1(t,e,n,r){Array.isArray(n)||(n&&(tI[0]=n.toString()),n=tI);for(var i=0;i<n.length;i++){var s=E1(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function L1(t){n0(t.g,function(e,n){this.g.hasOwnProperty(n)&&i0(e)},t),t.g={}}pu.prototype.N=function(){pu.$.N.call(this),L1(this)};pu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function vf(){this.g=!0}vf.prototype.Ea=function(){this.g=!1};function r9(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var h=u[0];u=u[1];var p=h.split("_");o=2<=p.length&&p[1]=="type"?o+(h+"="+u+"&"):o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function i9(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Do(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+o9(t,n)+(r?" "+r:"")})}function s9(t,e){t.info(function(){return"TIMEOUT: "+e})}vf.prototype.info=function(){};function o9(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return a0(n)}catch{return e}}var to={},nI=null;function xf(){return nI=nI||new pt}to.Ta="serverreachability";function U1(t){Ot.call(this,to.Ta,t)}gt(U1,Ot);function mu(t){const e=xf();Ct(e,new U1(e))}to.STAT_EVENT="statevent";function F1(t,e){Ot.call(this,to.STAT_EVENT,t),this.stat=e}gt(F1,Ot);function zt(t){const e=xf();Ct(e,new F1(e,t))}to.Ua="timingevent";function O1(t,e){Ot.call(this,to.Ua,t),this.size=e}gt(O1,Ot);function zu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return te.setTimeout(function(){t()},e)}var wf={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},j1={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function d0(){}d0.prototype.h=null;function rI(t){return t.h||(t.h=t.i())}function $1(){}var Wu={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function h0(){Ot.call(this,"d")}gt(h0,Ot);function f0(){Ot.call(this,"c")}gt(f0,Ot);var Fg;function _f(){}gt(_f,d0);_f.prototype.g=function(){return new XMLHttpRequest};_f.prototype.i=function(){return{}};Fg=new _f;function Ku(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new pu(this),this.P=a9,t=Pg?125:void 0,this.V=new yf(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new V1}function V1(){this.i=null,this.g="",this.h=!1}var a9=45e3,Og={},dh={};V=Ku.prototype;V.setTimeout=function(t){this.P=t};function jg(t,e,n){t.L=1,t.v=If(Gr(e)),t.s=n,t.S=!0,B1(t,null)}function B1(t,e){t.G=Date.now(),Ju(t),t.A=Gr(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),Y1(n.i,"t",r),t.C=0,n=t.l.J,t.h=new V1,t.g=yA(t.l,n?e:null,!t.s),0<t.O&&(t.M=new n9(Ft(t.Pa,t,t.g),t.O)),M1(t.U,t.g,"readystatechange",t.nb),e=t.I?S1(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),mu(),r9(t.j,t.u,t.A,t.m,t.W,t.s)}V.nb=function(t){t=t.target;const e=this.M;e&&hr(t)==3?e.l():this.Pa(t)};V.Pa=function(t){try{if(t==this.g)e:{const h=hr(this.g);var e=this.g.Ia();const p=this.g.da();if(!(3>h)&&(h!=3||Pg||this.g&&(this.h.h||this.g.ja()||aI(this.g)))){this.J||h!=4||e==7||(e==8||0>=p?mu(3):mu(2)),Tf(this);var n=this.g.da();this.ca=n;t:if(q1(this)){var r=aI(this.g);t="";var i=r.length,s=hr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xs(this),Pl(this);var o="";break t}this.h.i=new te.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,i9(this.j,this.u,this.A,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!cu(a)){var u=a;break t}}u=null}if(n=u)Do(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$g(this,n);else{this.i=!1,this.o=3,zt(12),xs(this),Pl(this);break e}}this.S?(G1(this,h,o),Pg&&this.i&&h==3&&(M1(this.U,this.V,"tick",this.mb),this.V.start())):(Do(this.j,this.m,o,null),$g(this,o)),h==4&&xs(this),this.i&&!this.J&&(h==4?fA(this.l,this):(this.i=!1,Ju(this)))}else N9(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,zt(12)):(this.o=0,zt(13)),xs(this),Pl(this)}}}catch{}finally{}};function q1(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function G1(t,e,n){let r=!0,i;for(;!t.J&&t.C<n.length;)if(i=l9(t,n),i==dh){e==4&&(t.o=4,zt(14),r=!1),Do(t.j,t.m,null,"[Incomplete Response]");break}else if(i==Og){t.o=4,zt(15),Do(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Do(t.j,t.m,i,null),$g(t,i);q1(t)&&i!=dh&&i!=Og&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,zt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),x0(e),e.M=!0,zt(11))):(Do(t.j,t.m,n,"[Invalid Chunked Response]"),xs(t),Pl(t))}V.mb=function(){if(this.g){var t=hr(this.g),e=this.g.ja();this.C<e.length&&(Tf(this),G1(this,t,e),this.i&&t!=4&&Ju(this))}};function l9(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?dh:(n=Number(e.substring(n,r)),isNaN(n)?Og:(r+=1,r+n>e.length?dh:(e=e.slice(r,r+n),t.C=r+n,e)))}V.cancel=function(){this.J=!0,xs(this)};function Ju(t){t.Y=Date.now()+t.P,H1(t,t.P)}function H1(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=zu(Ft(t.lb,t),e)}function Tf(t){t.B&&(te.clearTimeout(t.B),t.B=null)}V.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(s9(this.j,this.A),this.L!=2&&(mu(),zt(17)),xs(this),this.o=2,Pl(this)):H1(this,this.Y-t)};function Pl(t){t.l.H==0||t.J||fA(t.l,t)}function xs(t){Tf(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,u0(t.V),L1(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function $g(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Vg(n.i,t))){if(!t.K&&Vg(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)ph(n),Ef(n);else break e;v0(n),zt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=zu(Ft(n.ib,n),6e3));if(1>=Z1(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else ws(n,11)}else if((t.K||n.g==t)&&ph(n),!cu(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];const h=u[3];h!=null&&(n.ra=h,n.l.info("VER="+n.ra));const p=u[4];p!=null&&(n.Ga=p,n.l.info("SVER="+n.Ga));const m=u[5];m!=null&&typeof m=="number"&&0<m&&(r=1.5*m,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const g=t.g;if(g){const y=g.g?g.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var s=r.i;s.g||y.indexOf("spdy")==-1&&y.indexOf("quic")==-1&&y.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(p0(s,s.h),s.h=null))}if(r.F){const w=g.g?g.g.getResponseHeader("X-HTTP-Session-Id"):null;w&&(r.Da=w,Ne(r.I,r.F,w))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=gA(r,r.J?r.pa:null,r.Y),o.K){eA(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(Tf(a),Ju(a)),r.g=o}else dA(r);0<n.j.length&&Cf(n)}else u[0]!="stop"&&u[0]!="close"||ws(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?ws(n,7):y0(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}mu(4)}catch{}}function u9(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(ff(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function c9(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(ff(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function z1(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(ff(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=c9(t),r=u9(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var W1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function d9(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ns(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ns){this.h=t.h,hh(this,t.j),this.s=t.s,this.g=t.g,fh(this,t.m),this.l=t.l;var e=t.i,n=new gu;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),iI(this,n),this.o=t.o}else t&&(e=String(t).match(W1))?(this.h=!1,hh(this,e[1]||"",!0),this.s=ml(e[2]||""),this.g=ml(e[3]||"",!0),fh(this,e[4]),this.l=ml(e[5]||"",!0),iI(this,e[6]||"",!0),this.o=ml(e[7]||"")):(this.h=!1,this.i=new gu(null,this.h))}Ns.prototype.toString=function(){var t=[],e=this.j;e&&t.push(gl(e,sI,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(gl(e,sI,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(gl(n,n.charAt(0)=="/"?p9:f9,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",gl(n,g9)),t.join("")};function Gr(t){return new Ns(t)}function hh(t,e,n){t.j=n?ml(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function fh(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function iI(t,e,n){e instanceof gu?(t.i=e,y9(t.i,t.h)):(n||(e=gl(e,m9)),t.i=new gu(e,t.h))}function Ne(t,e,n){t.i.set(e,n)}function If(t){return Ne(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ml(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function gl(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,h9),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function h9(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var sI=/[#\/\?@]/g,f9=/[#\?:]/g,p9=/[#\?]/g,m9=/[#\?@]/g,g9=/#/g;function gu(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Yi(t){t.g||(t.g=new Map,t.h=0,t.i&&d9(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}V=gu.prototype;V.add=function(t,e){Yi(this),this.i=null,t=Aa(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function K1(t,e){Yi(t),e=Aa(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function J1(t,e){return Yi(t),e=Aa(t,e),t.g.has(e)}V.forEach=function(t,e){Yi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};V.ta=function(){Yi(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};V.Z=function(t){Yi(this);let e=[];if(typeof t=="string")J1(this,t)&&(e=e.concat(this.g.get(Aa(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};V.set=function(t,e){return Yi(this),this.i=null,t=Aa(this,t),J1(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};V.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function Y1(t,e,n){K1(t,e),0<n.length&&(t.i=null,t.g.set(Aa(t,e),e0(n)),t.h+=n.length)}V.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Aa(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function y9(t,e){e&&!t.j&&(Yi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(K1(this,r),Y1(this,i,n))},t)),t.j=e}var v9=class{constructor(t,e){this.g=t,this.map=e}};function Q1(t){this.l=t||x9,te.PerformanceNavigationTiming?(t=te.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(te.g&&te.g.Ka&&te.g.Ka()&&te.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var x9=10;function X1(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Z1(t){return t.h?1:t.g?t.g.size:0}function Vg(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function p0(t,e){t.g?t.g.add(e):t.h=e}function eA(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Q1.prototype.cancel=function(){if(this.i=tA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function tA(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return e0(t.i)}var w9=class{stringify(t){return te.JSON.stringify(t,void 0)}parse(t){return te.JSON.parse(t,void 0)}};function _9(){this.g=new w9}function T9(t,e,n){const r=n||"";try{z1(t,function(i,s){let o=i;Gu(i)&&(o=a0(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function I9(t,e){const n=new vf;if(te.Image){const r=new Image;r.onload=Fc(jc,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Fc(jc,n,r,"TestLoadImage: error",!1,e),r.onabort=Fc(jc,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Fc(jc,n,r,"TestLoadImage: timeout",!1,e),te.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function jc(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Yu(t){this.l=t.fc||null,this.j=t.ob||!1}gt(Yu,d0);Yu.prototype.g=function(){return new Sf(this.l,this.j)};Yu.prototype.i=function(t){return function(){return t}}({});function Sf(t,e){pt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=m0,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}gt(Sf,pt);var m0=0;V=Sf.prototype;V.open=function(t,e){if(this.readyState!=m0)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,yu(this)};V.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||te).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};V.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Qu(this)),this.readyState=m0};V.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,yu(this)),this.g&&(this.readyState=3,yu(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof te.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;nA(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function nA(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}V.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Qu(this):yu(this),this.readyState==3&&nA(this)}};V.Za=function(t){this.g&&(this.response=this.responseText=t,Qu(this))};V.Ya=function(t){this.g&&(this.response=t,Qu(this))};V.ka=function(){this.g&&Qu(this)};function Qu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,yu(t)}V.setRequestHeader=function(t,e){this.v.append(t,e)};V.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};V.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function yu(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Sf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var S9=te.JSON.parse;function Ge(t){pt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=rA,this.L=this.M=!1}gt(Ge,pt);var rA="",b9=/^https?$/i,E9=["POST","PUT"];V=Ge.prototype;V.Oa=function(t){this.M=t};V.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Fg.g(),this.C=this.u?rI(this.u):rI(Fg),this.g.onreadystatechange=Ft(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){oI(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=te.FormData&&t instanceof te.FormData,!(0<=w1(E9,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{oA(this),0<this.B&&((this.L=C9(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ft(this.ua,this)):this.A=c0(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){oI(this,s)}};function C9(t){return sa&&typeof t.timeout=="number"&&t.ontimeout!==void 0}V.ua=function(){typeof Zv<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ct(this,"timeout"),this.abort(8))};function oI(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,iA(t),bf(t)}function iA(t){t.F||(t.F=!0,Ct(t,"complete"),Ct(t,"error"))}V.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ct(this,"complete"),Ct(this,"abort"),bf(this))};V.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),bf(this,!0)),Ge.$.N.call(this)};V.La=function(){this.s||(this.G||this.v||this.l?sA(this):this.kb())};V.kb=function(){sA(this)};function sA(t){if(t.h&&typeof Zv<"u"&&(!t.C[1]||hr(t)!=4||t.da()!=2)){if(t.v&&hr(t)==4)c0(t.La,0,t);else if(Ct(t,"readystatechange"),hr(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(W1)[1]||null;!i&&te.self&&te.self.location&&(i=te.self.location.protocol.slice(0,-1)),r=!b9.test(i?i.toLowerCase():"")}n=r}if(n)Ct(t,"complete"),Ct(t,"success");else{t.m=6;try{var s=2<hr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",iA(t)}}finally{bf(t)}}}}function bf(t,e){if(t.g){oA(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Ct(t,"ready");try{n.onreadystatechange=r}catch{}}}function oA(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(te.clearTimeout(t.A),t.A=null)}V.isActive=function(){return!!this.g};function hr(t){return t.g?t.g.readyState:0}V.da=function(){try{return 2<hr(this)?this.g.status:-1}catch{return-1}};V.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};V.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),S9(e)}};function aI(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case rA:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function N9(t){const e={};t=(t.g&&2<=hr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(cu(t[r]))continue;var n=ZG(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}zG(e,function(r){return r.join(", ")})}V.Ia=function(){return this.m};V.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function aA(t){let e="";return n0(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function g0(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=aA(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ne(t,e,n))}function Za(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function lA(t){this.Ga=0,this.j=[],this.l=new vf,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Za("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Za("baseRetryDelayMs",5e3,t),this.hb=Za("retryDelaySeedMs",1e4,t),this.eb=Za("forwardChannelMaxRetries",2,t),this.xa=Za("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Q1(t&&t.concurrentRequestLimit),this.Ja=new _9,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}V=lA.prototype;V.ra=8;V.H=1;function y0(t){if(uA(t),t.H==3){var e=t.W++,n=Gr(t.I);if(Ne(n,"SID",t.K),Ne(n,"RID",e),Ne(n,"TYPE","terminate"),Xu(t,n),e=new Ku(t,t.l,e),e.L=2,e.v=If(Gr(n)),n=!1,te.navigator&&te.navigator.sendBeacon)try{n=te.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&te.Image&&(new Image().src=e.v,n=!0),n||(e.g=yA(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Ju(e)}mA(t)}function Ef(t){t.g&&(x0(t),t.g.cancel(),t.g=null)}function uA(t){Ef(t),t.u&&(te.clearTimeout(t.u),t.u=null),ph(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&te.clearTimeout(t.m),t.m=null)}function Cf(t){if(!X1(t.i)&&!t.m){t.m=!0;var e=t.Na;hu||P1(),fu||(hu(),fu=!0),l0.add(e,t),t.C=0}}function A9(t,e){return Z1(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=zu(Ft(t.Na,t,e),pA(t,t.C)),t.C++,!0)}V.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new Ku(this,this.l,t);let s=this.s;if(this.U&&(s?(s=S1(s),b1(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=cA(this,i,e),n=Gr(this.I),Ne(n,"RID",t),Ne(n,"CVER",22),this.F&&Ne(n,"X-HTTP-Session-Id",this.F),Xu(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(aA(s)))+"&"+e:this.o&&g0(n,this.o,s)),p0(this.i,i),this.bb&&Ne(n,"TYPE","init"),this.P?(Ne(n,"$req",e),Ne(n,"SID","null"),i.aa=!0,jg(i,n,null)):jg(i,n,e),this.H=2}}else this.H==3&&(t?lI(this,t):this.j.length==0||X1(this.i)||lI(this))};function lI(t,e){var n;e?n=e.m:n=t.W++;const r=Gr(t.I);Ne(r,"SID",t.K),Ne(r,"RID",n),Ne(r,"AID",t.V),Xu(t,r),t.o&&t.s&&g0(r,t.o,t.s),n=new Ku(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=cA(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),p0(t.i,n),jg(n,r,e)}function Xu(t,e){t.na&&n0(t.na,function(n,r){Ne(e,r,n)}),t.h&&z1({},function(n,r){Ne(e,r,n)})}function cA(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Ft(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let u=i[l].g;const h=i[l].map;if(u-=s,0>u)s=Math.max(0,i[l].g-100),a=!1;else try{T9(h,o,"req"+u+"_")}catch{r&&r(h)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function dA(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;hu||P1(),fu||(hu(),fu=!0),l0.add(e,t),t.A=0}}function v0(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=zu(Ft(t.Ma,t),pA(t,t.A)),t.A++,!0)}V.Ma=function(){if(this.u=null,hA(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=zu(Ft(this.jb,this),t)}};V.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,zt(10),Ef(this),hA(this))};function x0(t){t.B!=null&&(te.clearTimeout(t.B),t.B=null)}function hA(t){t.g=new Ku(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Gr(t.wa);Ne(e,"RID","rpc"),Ne(e,"SID",t.K),Ne(e,"AID",t.V),Ne(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ne(e,"TO",t.qa),Ne(e,"TYPE","xmlhttp"),Xu(t,e),t.o&&t.s&&g0(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=If(Gr(e)),n.s=null,n.S=!0,B1(n,t)}V.ib=function(){this.v!=null&&(this.v=null,Ef(this),v0(this),zt(19))};function ph(t){t.v!=null&&(te.clearTimeout(t.v),t.v=null)}function fA(t,e){var n=null;if(t.g==e){ph(t),x0(t),t.g=null;var r=2}else if(Vg(t.i,e))n=e.F,eA(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;r=xf(),Ct(r,new O1(r,n)),Cf(t)}else dA(t);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&A9(t,e)||r==2&&v0(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:ws(t,5);break;case 4:ws(t,10);break;case 3:ws(t,6);break;default:ws(t,2)}}}function pA(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ws(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Ft(t.pb,t);n||(n=new Ns("//www.google.com/images/cleardot.gif"),te.location&&te.location.protocol=="http"||hh(n,"https"),If(n)),I9(n.toString(),r)}else zt(2);t.H=0,t.h&&t.h.za(e),mA(t),uA(t)}V.pb=function(t){t?(this.l.info("Successfully pinged google.com"),zt(2)):(this.l.info("Failed to ping google.com"),zt(1))};function mA(t){if(t.H=0,t.ma=[],t.h){const e=tA(t.i);(e.length!=0||t.j.length!=0)&&(XT(t.ma,e),XT(t.ma,t.j),t.i.i.length=0,e0(t.j),t.j.length=0),t.h.ya()}}function gA(t,e,n){var r=n instanceof Ns?Gr(n):new Ns(n);if(r.g!="")e&&(r.g=e+"."+r.g),fh(r,r.m);else{var i=te.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ns(null);r&&hh(s,r),e&&(s.g=e),i&&fh(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Ne(r,n,e),Ne(r,"VER",t.ra),Xu(t,r),r}function yA(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new Ge(new Yu({ob:!0})):new Ge(t.va),e.Oa(t.J),e}V.isActive=function(){return!!this.h&&this.h.isActive(this)};function vA(){}V=vA.prototype;V.Ba=function(){};V.Aa=function(){};V.za=function(){};V.ya=function(){};V.isActive=function(){return!0};V.Va=function(){};function mh(){if(sa&&!(10<=Number(BG)))throw Error("Environmental error: no available transport.")}mh.prototype.g=function(t,e){return new En(t,e)};function En(t,e){pt.call(this),this.g=new lA(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!cu(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!cu(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ka(this)}gt(En,pt);En.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;zt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=gA(t,null,t.Y),Cf(t)};En.prototype.close=function(){y0(this.g)};En.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=a0(t),t=n);e.j.push(new v9(e.fb++,t)),e.H==3&&Cf(e)};En.prototype.N=function(){this.g.h=null,delete this.j,y0(this.g),delete this.g,En.$.N.call(this)};function xA(t){h0.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}gt(xA,h0);function wA(){f0.call(this),this.status=1}gt(wA,f0);function ka(t){this.g=t}gt(ka,vA);ka.prototype.Ba=function(){Ct(this.g,"a")};ka.prototype.Aa=function(t){Ct(this.g,new xA(t))};ka.prototype.za=function(t){Ct(this.g,new wA)};ka.prototype.ya=function(){Ct(this.g,"b")};function k9(){this.blockSize=-1}function Zn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}gt(Zn,k9);Zn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function em(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Zn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)em(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){em(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){em(this,r),i=0;break}}this.h=i,this.i+=e};Zn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function we(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var R9={};function w0(t){return-128<=t&&128>t?jG(t,function(e){return new we([e|0],0>e?-1:0)}):new we([t|0],0>t?-1:0)}function fr(t){if(isNaN(t)||!isFinite(t))return zo;if(0>t)return Tt(fr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Bg;return new we(e,0)}function _A(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Tt(_A(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=fr(Math.pow(e,8)),r=zo,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=fr(Math.pow(e,s)),r=r.R(s).add(fr(o))):(r=r.R(n),r=r.add(fr(o)))}return r}var Bg=4294967296,zo=w0(0),qg=w0(1),uI=w0(16777216);V=we.prototype;V.ea=function(){if(Pn(this))return-Tt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Bg+r)*e,e*=Bg}return t};V.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Pr(this))return"0";if(Pn(this))return"-"+Tt(this).toString(t);for(var e=fr(Math.pow(t,6)),n=this,r="";;){var i=yh(n,e).g;n=gh(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Pr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};V.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Pr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Pn(t){return t.h==-1}V.X=function(t){return t=gh(this,t),Pn(t)?-1:Pr(t)?0:1};function Tt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new we(n,~t.h).add(qg)}V.abs=function(){return Pn(this)?Tt(this):this};V.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new we(n,n[n.length-1]&-2147483648?-1:0)};function gh(t,e){return t.add(Tt(e))}V.R=function(t){if(Pr(this)||Pr(t))return zo;if(Pn(this))return Pn(t)?Tt(this).R(Tt(t)):Tt(Tt(this).R(t));if(Pn(t))return Tt(this.R(Tt(t)));if(0>this.X(uI)&&0>t.X(uI))return fr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=o*l,$c(n,2*r+2*i),n[2*r+2*i+1]+=s*l,$c(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,$c(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,$c(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new we(n,0)};function $c(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function el(t,e){this.g=t,this.h=e}function yh(t,e){if(Pr(e))throw Error("division by zero");if(Pr(t))return new el(zo,zo);if(Pn(t))return e=yh(Tt(t),e),new el(Tt(e.g),Tt(e.h));if(Pn(e))return e=yh(t,Tt(e)),new el(Tt(e.g),e.h);if(30<t.g.length){if(Pn(t)||Pn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=qg,r=e;0>=r.X(t);)n=cI(n),r=cI(r);var i=co(n,1),s=co(r,1);for(r=co(r,2),n=co(n,2);!Pr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=co(r,1),n=co(n,1)}return e=gh(t,i.R(e)),new el(i,e)}for(i=zo;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=fr(n),o=s.R(e);Pn(o)||0<o.X(t);)n-=r,s=fr(n),o=s.R(e);Pr(s)&&(s=qg),i=i.add(s),t=gh(t,o)}return new el(i,t)}V.gb=function(t){return yh(this,t).h};V.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new we(n,this.h&t.h)};V.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new we(n,this.h|t.h)};V.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new we(n,this.h^t.h)};function cI(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new we(n,t.h)}function co(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new we(i,t.h)}mh.prototype.createWebChannel=mh.prototype.g;En.prototype.send=En.prototype.u;En.prototype.open=En.prototype.m;En.prototype.close=En.prototype.close;wf.NO_ERROR=0;wf.TIMEOUT=8;wf.HTTP_ERROR=6;j1.COMPLETE="complete";$1.EventType=Wu;Wu.OPEN="a";Wu.CLOSE="b";Wu.ERROR="c";Wu.MESSAGE="d";pt.prototype.listen=pt.prototype.O;Ge.prototype.listenOnce=Ge.prototype.P;Ge.prototype.getLastError=Ge.prototype.Sa;Ge.prototype.getLastErrorCode=Ge.prototype.Ia;Ge.prototype.getStatus=Ge.prototype.da;Ge.prototype.getResponseJson=Ge.prototype.Wa;Ge.prototype.getResponseText=Ge.prototype.ja;Ge.prototype.send=Ge.prototype.ha;Ge.prototype.setWithCredentials=Ge.prototype.Oa;Zn.prototype.digest=Zn.prototype.l;Zn.prototype.reset=Zn.prototype.reset;Zn.prototype.update=Zn.prototype.j;we.prototype.add=we.prototype.add;we.prototype.multiply=we.prototype.R;we.prototype.modulo=we.prototype.gb;we.prototype.compare=we.prototype.X;we.prototype.toNumber=we.prototype.ea;we.prototype.toString=we.prototype.toString;we.prototype.getBits=we.prototype.D;we.fromNumber=fr;we.fromString=_A;var P9=function(){return new mh},D9=function(){return xf()},tm=wf,M9=j1,L9=to,dI={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},U9=Yu,Vc=$1,F9=Ge,O9=Zn,Wo=we;const hI="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ra="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi=new Fu("@firebase/firestore");function Gg(){return Mi.logLevel}function j9(t){Mi.setLogLevel(t)}function D(t,...e){if(Mi.logLevel<=de.DEBUG){const n=e.map(_0);Mi.debug(`Firestore (${Ra}): ${t}`,...n)}}function Ke(t,...e){if(Mi.logLevel<=de.ERROR){const n=e.map(_0);Mi.error(`Firestore (${Ra}): ${t}`,...n)}}function er(t,...e){if(Mi.logLevel<=de.WARN){const n=e.map(_0);Mi.warn(`Firestore (${Ra}): ${t}`,...n)}}function _0(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q(t="Unexpected state"){const e=`FIRESTORE (${Ra}) INTERNAL ASSERTION FAILED: `+t;throw Ke(e),new Error(e)}function K(t,e){t||q()}function $9(t,e){t||q()}function $(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class P extends bt{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class V9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ut.UNAUTHENTICATED))}shutdown(){}}class B9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class q9{constructor(e){this.t=e,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new ft;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ft,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{D("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(D("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ft)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(D("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(K(typeof r.accessToken=="string"),new TA(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string"),new ut(e)}}class G9{constructor(e,n,r){this.h=e,this.l=n,this.m=r,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class H9{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new G9(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class z9{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class W9{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,n){const r=s=>{s.error!=null&&D("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,D("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{D("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):D("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(K(typeof n.token=="string"),this.T=n.token,new z9(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K9(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=K9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function re(t,e){return t<e?-1:t>e?1:0}function oa(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function SA(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new P(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new P(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new P(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ue.fromMillis(Date.now())}static fromDate(e){return Ue.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ue(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.timestamp=e}static fromTimestamp(e){return new W(e)}static min(){return new W(new Ue(0,0))}static max(){return new W(new Ue(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,n,r){n===void 0?n=0:n>e.length&&q(),r===void 0?r=e.length-n:r>e.length-n&&q(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return vu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof vu?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class he extends vu{construct(e,n,r){return new he(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new P(k.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new he(n)}static emptyPath(){return new he([])}}const J9=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Je extends vu{construct(e,n,r){return new Je(e,n,r)}static isValidIdentifier(e){return J9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Je.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Je(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new P(k.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(k.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new P(k.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new P(k.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Je(n)}static emptyPath(){return new Je([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.path=e}static fromPath(e){return new j(he.fromString(e))}static fromName(e){return new j(he.fromString(e).popFirst(5))}static empty(){return new j(he.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&he.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return he.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new j(new he(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Hg(t){return t.fields.find(e=>e.kind===2)}function ls(t){return t.fields.filter(e=>e.kind!==2)}bA.UNKNOWN_ID=-1;class Y9{constructor(e,n){this.fieldPath=e,this.kind=n}}class vh{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new vh(0,Cn.min())}}function EA(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new Ue(n+1,0):new Ue(n,r));return new Cn(i,j.empty(),e)}function CA(t){return new Cn(t.readTime,t.key,-1)}class Cn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Cn(W.min(),j.empty(),-1)}static max(){return new Cn(W.max(),j.empty(),-1)}}function T0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=j.comparator(t.documentKey,e.documentKey),n!==0?n:re(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qi(t){if(t.code!==k.FAILED_PRECONDITION||t.message!==NA)throw t;D("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new A((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof A?n:A.resolve(n)}catch(n){return A.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):A.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):A.reject(n)}static resolve(e){return new A((n,r)=>{n(e)})}static reject(e){return new A((n,r)=>{r(e)})}static waitFor(e){return new A((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=A.resolve(!1);for(const r of e)n=n.next(i=>i?A.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new A((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(h=>{o[u]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new A((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.v=new ft,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{n.error?this.v.reject(new Dl(e,n.error)):this.v.resolve()},this.transaction.onerror=r=>{const i=I0(r.target.error);this.v.reject(new Dl(e,i))}}static open(e,n,r,i){try{return new Nf(n,e.transaction(i,r))}catch(s){throw new Dl(n,s)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(D("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new X9(n)}}class zn{constructor(e,n,r){this.name=e,this.version=n,this.V=r,zn.S(Ve())===12.2&&Ke("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return D("SimpleDb","Removing database:",e),us(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ls())return!1;if(zn.C())return!0;const e=Ve(),n=zn.S(e),r=0<n&&n<10,i=zn.N(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.k)==="YES"}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static N(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async $(e){return this.db||(D("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Dl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new P(k.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new P(k.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Dl(e,o))},i.onupgradeneeded=s=>{D("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.V.O(o,i.transaction,s.oldVersion,this.version).next(()=>{D("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.F&&(this.db.onversionchange=n=>this.F(n)),this.db}B(e){this.F=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.$(e);const a=Nf.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.P(),u)).catch(u=>(a.abort(u),A.reject(u))).toPromise();return l.catch(()=>{}),await a.R,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(D("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Q9{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return us(this.L.delete())}}class Dl extends P{constructor(e,n){super(k.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Xi(t){return t.name==="IndexedDbTransactionError"}class X9{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(D("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(D("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),us(r)}add(e){return D("SimpleDb","ADD",this.store.name,e,e),us(this.store.add(e))}get(e){return us(this.store.get(e)).next(n=>(n===void 0&&(n=null),D("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return D("SimpleDb","DELETE",this.store.name,e),us(this.store.delete(e))}count(){return D("SimpleDb","COUNT",this.store.name),us(this.store.count())}j(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.W(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new A((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}H(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new A((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}J(e,n){D("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}X(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Z(e){const n=this.cursor({});return new A((r,i)=>{n.onerror=s=>{const o=I0(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new A((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new Q9(a),u=n(a.primaryKey,a.value,l);if(u instanceof A){const h=u.catch(p=>(l.done(),A.reject(p)));r.push(h)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>A.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function us(t){return new A((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=I0(r.target.error);n(i)}})}let fI=!1;function I0(t){const e=zn.S(Ve());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fI||(fI=!0,setTimeout(()=>{throw r},0)),r}}return t}class Z9{constructor(e,n){this.asyncQueue=e,this.tt=n,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}et(e){D("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{D("IndexBackiller",`Documents written: ${await this.tt.nt()}`)}catch(n){Xi(n)?D("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await Qi(n)}await this.et(6e4)})}}class eH{constructor(e,n){this.localStore=e,this.persistence=n}async nt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.st(n,e))}st(e,n){const r=new Set;let i=n,s=!0;return A.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return D("IndexBackiller",`Processing collection: ${o}`),this.it(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}it(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.rt(i,s)).next(a=>(D("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}rt(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=CA(s);T0(o,r)>0&&(r=o)}),new Cn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>n.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}ln.ct=-1;function Zu(t){return t==null}function xu(t){return t===0&&1/t==-1/0}function kA(t){return typeof t=="number"&&Number.isInteger(t)&&!xu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=pI(e)),e=tH(t.get(n),e);return pI(e)}function tH(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function pI(t){return t+""}function pr(t){const e=t.length;if(K(e>=2),e===2)return K(t.charAt(0)===""&&t.charAt(1)===""),he.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&q(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:q()}s=o+2}return new he(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(t,e){return[t,Kt(e)]}function RA(t,e,n){return[t,Kt(e),n]}const nH={},rH=["prefixPath","collectionGroup","readTime","documentId"],iH=["prefixPath","collectionGroup","documentId"],sH=["collectionGroup","readTime","prefixPath","documentId"],oH=["canonicalId","targetId"],aH=["targetId","path"],lH=["path","targetId"],uH=["collectionId","parent"],cH=["indexId","uid"],dH=["uid","sequenceNumber"],hH=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],fH=["indexId","uid","orderedDocumentKey"],pH=["userId","collectionPath","documentId"],mH=["userId","collectionPath","largestBatchId"],gH=["userId","collectionGroup","largestBatchId"],PA=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],yH=[...PA,"documentOverlays"],DA=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],MA=DA,vH=[...MA,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg extends AA{constructor(e,n){super(),this.ht=e,this.currentSequenceNumber=n}}function yt(t,e){const n=$(t);return zn.M(n.ht,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function no(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function LA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e,n){this.comparator=e,this.root=n||_t.EMPTY}insert(e,n){return new be(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(e){return new be(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bc(this.root,e,this.comparator,!0)}}class Bc{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??_t.RED,this.left=i??_t.EMPTY,this.right=s??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new _t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return _t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();const e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(t,e,n,r,i){return this}insert(t,e,n){return new _t(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.comparator=e,this.data=new be(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new yI(this.data.getIterator())}getIteratorFrom(e){return new yI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Re(this.comparator);return n.data=e,n}}class yI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ho(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.fields=e,e.sort(Je.comparator)}static empty(){return new un([])}unionWith(e){let n=new Re(Je.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new un(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return oa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xH(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new UA("Invalid base64 string: "+i):i}}(e);return new it(n)}static fromUint8Array(e){const n=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new it(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}it.EMPTY_BYTE_STRING=new it("");const wH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Li(t){if(K(!!t),typeof t=="string"){let e=0;const n=wH.exec(t);if(K(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:qe(t.seconds),nanos:qe(t.nanos)}}function qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ui(t){return typeof t=="string"?it.fromBase64String(t):it.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function S0(t){const e=t.mapValue.fields.__previous_value__;return Af(e)?S0(e):e}function wu(t){const e=Li(t.mapValue.fields.__local_write_time__.timestampValue);return new Ue(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _H{constructor(e,n,r,i,s,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Fi{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Fi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Fi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},vd={nullValue:"NULL_VALUE"};function Bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Af(t)?4:FA(t)?9007199254740991:10:q()}function _r(t,e){if(t===e)return!0;const n=Bs(t);if(n!==Bs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return wu(t).isEqual(wu(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=Li(r.timestampValue),o=Li(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return Ui(r.bytesValue).isEqual(Ui(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return qe(r.geoPointValue.latitude)===qe(i.geoPointValue.latitude)&&qe(r.geoPointValue.longitude)===qe(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return qe(r.integerValue)===qe(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=qe(r.doubleValue),o=qe(i.doubleValue);return s===o?xu(s)===xu(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return oa(t.arrayValue.values||[],e.arrayValue.values||[],_r);case 10:return function(r,i){const s=r.mapValue.fields||{},o=i.mapValue.fields||{};if(gI(s)!==gI(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!_r(s[a],o[a])))return!1;return!0}(t,e);default:return q()}}function _u(t,e){return(t.values||[]).find(n=>_r(n,e))!==void 0}function Oi(t,e){if(t===e)return 0;const n=Bs(t),r=Bs(e);if(n!==r)return re(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return re(t.booleanValue,e.booleanValue);case 2:return function(i,s){const o=qe(i.integerValue||i.doubleValue),a=qe(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return vI(t.timestampValue,e.timestampValue);case 4:return vI(wu(t),wu(e));case 5:return re(t.stringValue,e.stringValue);case 6:return function(i,s){const o=Ui(i),a=Ui(s);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(i,s){const o=i.split("/"),a=s.split("/");for(let l=0;l<o.length&&l<a.length;l++){const u=re(o[l],a[l]);if(u!==0)return u}return re(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,s){const o=re(qe(i.latitude),qe(s.latitude));return o!==0?o:re(qe(i.longitude),qe(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,s){const o=i.values||[],a=s.values||[];for(let l=0;l<o.length&&l<a.length;++l){const u=Oi(o[l],a[l]);if(u)return u}return re(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===vi.mapValue&&s===vi.mapValue)return 0;if(i===vi.mapValue)return 1;if(s===vi.mapValue)return-1;const o=i.fields||{},a=Object.keys(o),l=s.fields||{},u=Object.keys(l);a.sort(),u.sort();for(let h=0;h<a.length&&h<u.length;++h){const p=re(a[h],u[h]);if(p!==0)return p;const m=Oi(o[a[h]],l[u[h]]);if(m!==0)return m}return re(a.length,u.length)}(t.mapValue,e.mapValue);default:throw q()}}function vI(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return re(t,e);const n=Li(t),r=Li(e),i=re(n.seconds,r.seconds);return i!==0?i:re(n.nanos,r.nanos)}function aa(t){return Wg(t)}function Wg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const i=Li(r);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ui(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,j.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let i="[",s=!0;for(const o of r.values||[])s?s=!1:i+=",",i+=Wg(o);return i+"]"}(t.arrayValue):"mapValue"in t?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${Wg(r.fields[a])}`;return s+"}"}(t.mapValue):q();var e,n}function qs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Kg(t){return!!t&&"integerValue"in t}function Tu(t){return!!t&&"arrayValue"in t}function xI(t){return!!t&&"nullValue"in t}function wI(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xd(t){return!!t&&"mapValue"in t}function Ml(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return no(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ml(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ml(t.arrayValue.values[n]);return e}return Object.assign({},t)}function FA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function TH(t){return"nullValue"in t?vd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?qs(Fi.empty(),j.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:q()}function IH(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?qs(Fi.empty(),j.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?vi:q()}function _I(t,e){const n=Oi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function TI(t,e){const n=Oi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.value=e}static empty(){return new It({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!xd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ml(n)}setAll(e){let n=Je.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Ml(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());xd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return _r(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];xd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){no(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new It(Ml(this.value))}}function OA(t){const e=[];return no(t.fields,(n,r)=>{const i=new Je([n]);if(xd(r)){const s=OA(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ae(e,0,W.min(),W.min(),W.min(),It.empty(),0)}static newFoundDocument(e,n,r,i){return new Ae(e,1,n,W.min(),r,i,0)}static newNoDocument(e,n){return new Ae(e,2,n,W.min(),W.min(),It.empty(),0)}static newUnknownDocument(e,n){return new Ae(e,3,n,W.min(),W.min(),It.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=It.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=It.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ae&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ae(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,n){this.position=e,this.inclusive=n}}function II(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=j.comparator(j.fromName(o.referenceValue),n.key):r=Oi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function SI(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!_r(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e,n="asc"){this.field=e,this.dir=n}}function SH(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{}class le extends jA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new bH(e,n,r):n==="array-contains"?new NH(e,r):n==="in"?new HA(e,r):n==="not-in"?new AH(e,r):n==="array-contains-any"?new kH(e,r):new le(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new EH(e,r):new CH(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Oi(n,this.value)):n!==null&&Bs(this.value)===Bs(n)&&this.matchesComparison(Oi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class ve extends jA{constructor(e,n){super(),this.filters=e,this.op=n,this.lt=null}static create(e,n){return new ve(e,n)}matches(e){return la(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(n=>n.isInequality());return e!==null?e.field:null}ft(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function la(t){return t.op==="and"}function Jg(t){return t.op==="or"}function b0(t){return $A(t)&&la(t)}function $A(t){for(const e of t.filters)if(e instanceof ve)return!1;return!0}function Yg(t){if(t instanceof le)return t.field.canonicalString()+t.op.toString()+aa(t.value);if(b0(t))return t.filters.map(e=>Yg(e)).join(",");{const e=t.filters.map(n=>Yg(n)).join(",");return`${t.op}(${e})`}}function VA(t,e){return t instanceof le?function(n,r){return r instanceof le&&n.op===r.op&&n.field.isEqual(r.field)&&_r(n.value,r.value)}(t,e):t instanceof ve?function(n,r){return r instanceof ve&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((i,s,o)=>i&&VA(s,r.filters[o]),!0):!1}(t,e):void q()}function BA(t,e){const n=t.filters.concat(e);return ve.create(n,t.op)}function qA(t){return t instanceof le?function(e){return`${e.field.canonicalString()} ${e.op} ${aa(e.value)}`}(t):t instanceof ve?function(e){return e.op.toString()+" {"+e.getFilters().map(qA).join(" ,")+"}"}(t):"Filter"}class bH extends le{constructor(e,n,r){super(e,n,r),this.key=j.fromName(r.referenceValue)}matches(e){const n=j.comparator(e.key,this.key);return this.matchesComparison(n)}}class EH extends le{constructor(e,n){super(e,"in",n),this.keys=GA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class CH extends le{constructor(e,n){super(e,"not-in",n),this.keys=GA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function GA(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>j.fromName(r.referenceValue))}class NH extends le{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Tu(n)&&_u(n.arrayValue,this.value)}}class HA extends le{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&_u(this.value.arrayValue,n)}}class AH extends le{constructor(e,n){super(e,"not-in",n)}matches(e){if(_u(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!_u(this.value.arrayValue,n)}}class kH extends le{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Tu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>_u(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RH{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.dt=null}}function Qg(t,e=null,n=[],r=[],i=null,s=null,o=null){return new RH(t,e,n,r,i,s,o)}function Gs(t){const e=$(t);if(e.dt===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Yg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Zu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>aa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>aa(r)).join(",")),e.dt=n}return e.dt}function ec(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!SH(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!VA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!SI(t.startAt,e.startAt)&&SI(t.endAt,e.endAt)}function xh(t){return j.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function wh(t,e){return t.filters.filter(n=>n instanceof le&&n.field.isEqual(e))}function bI(t,e,n){let r=vd,i=!0;for(const s of wh(t,e)){let o=vd,a=!0;switch(s.op){case"<":case"<=":o=TH(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=vd}_I({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];_I({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function EI(t,e,n){let r=vi,i=!0;for(const s of wh(t,e)){let o=vi,a=!0;switch(s.op){case">=":case">":o=IH(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=vi}TI({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];TI({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.wt=null,this._t=null,this.startAt,this.endAt}}function zA(t,e,n,r,i,s,o,a){return new Xr(t,e,n,r,i,s,o,a)}function Pa(t){return new Xr(t)}function CI(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function E0(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function kf(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function C0(t){return t.collectionGroup!==null}function As(t){const e=$(t);if(e.wt===null){e.wt=[];const n=kf(e),r=E0(e);if(n!==null&&r===null)n.isKeyField()||e.wt.push(new Ko(n)),e.wt.push(new Ko(Je.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Ko(Je.keyField(),s))}}}return e.wt}function gn(t){const e=$(t);if(!e._t)if(e.limitType==="F")e._t=Qg(e.path,e.collectionGroup,As(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const s of As(e)){const o=s.dir==="desc"?"asc":"desc";n.push(new Ko(s.field,o))}const r=e.endAt?new ji(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new ji(e.startAt.position,e.startAt.inclusive):null;e._t=Qg(e.path,e.collectionGroup,n,e.filters,e.limit,r,i)}return e._t}function Xg(t,e){e.getFirstInequalityField(),kf(t);const n=t.filters.concat([e]);return new Xr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function _h(t,e,n){return new Xr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function tc(t,e){return ec(gn(t),gn(e))&&t.limitType===e.limitType}function WA(t){return`${Gs(gn(t))}|lt:${t.limitType}`}function Zg(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>qA(r)).join(", ")}]`),Zu(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(r)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>aa(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>aa(r)).join(",")),`Target(${n})`}(gn(t))}; limitType=${t.limitType})`}function nc(t,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):j.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,r){for(const i of As(n))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(i,s,o){const a=II(i,s,o);return i.inclusive?a<=0:a<0}(n.startAt,As(n),r)||n.endAt&&!function(i,s,o){const a=II(i,s,o);return i.inclusive?a>=0:a>0}(n.endAt,As(n),r))}(t,e)}function KA(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function JA(t){return(e,n)=>{let r=!1;for(const i of As(t)){const s=PH(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function PH(t,e,n){const r=t.field.isKeyField()?j.comparator(e.key,n.key):function(i,s,o){const a=s.data.field(i),l=o.data.field(i);return a!==null&&l!==null?Oi(a,l):q()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){no(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return LA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DH=new be(j.comparator);function cn(){return DH}const YA=new be(j.comparator);function yl(...t){let e=YA;for(const n of t)e=e.insert(n.key,n);return e}function QA(t){let e=YA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function mr(){return Ll()}function XA(){return Ll()}function Ll(){return new Zi(t=>t.toString(),(t,e)=>t.isEqual(e))}const MH=new be(j.comparator),LH=new Re(j.comparator);function ie(...t){let e=LH;for(const n of t)e=e.add(n);return e}const UH=new Re(re);function N0(){return UH}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xu(e)?"-0":e}}function ek(t){return{integerValue:""+t}}function tk(t,e){return kA(e)?ek(e):ZA(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(){this._=void 0}}function FH(t,e,n){return t instanceof ua?function(r,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Af(i)&&(i=S0(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(n,e):t instanceof Hs?rk(t,e):t instanceof zs?ik(t,e):function(r,i){const s=nk(r,i),o=NI(s)+NI(r.gt);return Kg(s)&&Kg(r.gt)?ek(o):ZA(r.serializer,o)}(t,e)}function OH(t,e,n){return t instanceof Hs?rk(t,e):t instanceof zs?ik(t,e):n}function nk(t,e){return t instanceof ca?Kg(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class ua extends Rf{}class Hs extends Rf{constructor(e){super(),this.elements=e}}function rk(t,e){const n=sk(e);for(const r of t.elements)n.some(i=>_r(i,r))||n.push(r);return{arrayValue:{values:n}}}class zs extends Rf{constructor(e){super(),this.elements=e}}function ik(t,e){let n=sk(e);for(const r of t.elements)n=n.filter(i=>!_r(i,r));return{arrayValue:{values:n}}}class ca extends Rf{constructor(e,n){super(),this.serializer=e,this.gt=n}}function NI(t){return qe(t.integerValue||t.doubleValue)}function sk(t){return Tu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,n){this.field=e,this.transform=n}}function jH(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof Hs&&r instanceof Hs||n instanceof zs&&r instanceof zs?oa(n.elements,r.elements,_r):n instanceof ca&&r instanceof ca?_r(n.gt,r.gt):n instanceof ua&&r instanceof ua}(t.transform,e.transform)}class $H{constructor(e,n){this.version=e,this.transformResults=n}}class Le{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Le}static exists(e){return new Le(void 0,e)}static updateTime(e){return new Le(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Pf{}function ok(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ma(t.key,Le.none()):new Da(t.key,t.data,Le.none());{const n=t.data,r=It.empty();let i=new Re(Je.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Zr(t.key,r,new un(i.toArray()),Le.none())}}function VH(t,e,n){t instanceof Da?function(r,i,s){const o=r.value.clone(),a=kI(r.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Zr?function(r,i,s){if(!wd(r.precondition,i))return void i.convertToUnknownDocument(s.version);const o=kI(r.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(ak(r)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,n):function(r,i,s){i.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function Ul(t,e,n,r){return t instanceof Da?function(i,s,o,a){if(!wd(i.precondition,s))return o;const l=i.value.clone(),u=RI(i.fieldTransforms,a,s);return l.setAll(u),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Zr?function(i,s,o,a){if(!wd(i.precondition,s))return o;const l=RI(i.fieldTransforms,a,s),u=s.data;return u.setAll(ak(i)),u.setAll(l),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,s,o){return wd(i.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,n)}function BH(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=nk(r.transform,i||null);s!=null&&(n===null&&(n=It.empty()),n.set(r.field,s))}return n||null}function AI(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&oa(n,r,(i,s)=>jH(i,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Da extends Pf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zr extends Pf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function ak(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function kI(t,e,n){const r=new Map;K(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,OH(o,a,n[i]))}return r}function RI(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,FH(s,o,e))}return r}class Ma extends Pf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class A0 extends Pf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&VH(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ul(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ul(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=XA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=ok(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ie())}isEqual(e){return this.batchId===e.batchId&&oa(this.mutations,e.mutations,(n,r)=>AI(n,r))&&oa(this.baseMutations,e.baseMutations,(n,r)=>AI(n,r))}}class R0{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){K(e.mutations.length===r.length);let i=MH;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new R0(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qH{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe,ce;function lk(t){switch(t){default:return q();case k.CANCELLED:case k.UNKNOWN:case k.DEADLINE_EXCEEDED:case k.RESOURCE_EXHAUSTED:case k.INTERNAL:case k.UNAVAILABLE:case k.UNAUTHENTICATED:return!1;case k.INVALID_ARGUMENT:case k.NOT_FOUND:case k.ALREADY_EXISTS:case k.PERMISSION_DENIED:case k.FAILED_PRECONDITION:case k.ABORTED:case k.OUT_OF_RANGE:case k.UNIMPLEMENTED:case k.DATA_LOSS:return!0}}function uk(t){if(t===void 0)return Ke("GRPC error has no .code"),k.UNKNOWN;switch(t){case Xe.OK:return k.OK;case Xe.CANCELLED:return k.CANCELLED;case Xe.UNKNOWN:return k.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return k.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return k.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return k.INTERNAL;case Xe.UNAVAILABLE:return k.UNAVAILABLE;case Xe.UNAUTHENTICATED:return k.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return k.INVALID_ARGUMENT;case Xe.NOT_FOUND:return k.NOT_FOUND;case Xe.ALREADY_EXISTS:return k.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return k.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return k.FAILED_PRECONDITION;case Xe.ABORTED:return k.ABORTED;case Xe.OUT_OF_RANGE:return k.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return k.UNIMPLEMENTED;case Xe.DATA_LOSS:return k.DATA_LOSS;default:return q()}}(ce=Xe||(Xe={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return qc}static getOrCreateInstance(){return qc===null&&(qc=new D0),qc}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let qc=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GH=new Wo([4294967295,4294967295],0);function PI(t){const e=ck().encode(t),n=new O9;return n.update(e),new Uint8Array(n.digest())}function DI(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Wo([n,r],0),new Wo([i,s],0)]}class M0{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new vl(`Invalid padding: ${n}`);if(r<0)throw new vl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new vl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new vl(`Invalid padding when bitmap length is 0: ${n}`);this.It=8*e.length-n,this.Tt=Wo.fromNumber(this.It)}Et(e,n,r){let i=e.add(n.multiply(Wo.fromNumber(r)));return i.compare(GH)===1&&(i=new Wo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const n=PI(e),[r,i]=DI(n);for(let s=0;s<this.hashCount;s++){const o=this.Et(r,i,s);if(!this.At(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new M0(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.It===0)return;const n=PI(e),[r,i]=DI(n);for(let s=0;s<this.hashCount;s++){const o=this.Et(r,i,s);this.Rt(o)}}Rt(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,sc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ic(W.min(),i,new be(re),cn(),ie())}}class sc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new sc(r,n,ie(),ie(),ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,n,r,i){this.Pt=e,this.removedTargetIds=n,this.key=r,this.bt=i}}class dk{constructor(e,n){this.targetId=e,this.Vt=n}}class hk{constructor(e,n,r=it.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class MI{constructor(){this.St=0,this.Dt=UI(),this.Ct=it.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=ie(),n=ie(),r=ie();return this.Dt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:q()}}),new sc(this.Ct,this.xt,e,n,r)}Ft(){this.Nt=!1,this.Dt=UI()}Bt(e,n){this.Nt=!0,this.Dt=this.Dt.insert(e,n)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class HH{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=cn(),this.zt=LI(),this.Wt=new be(re)}Ht(e){for(const n of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(n,e.bt):this.Yt(n,e.key,e.bt);for(const n of e.removedTargetIds)this.Yt(n,e.key,e.bt)}Xt(e){this.forEachTarget(e,n=>{const r=this.Zt(n);switch(e.state){case 0:this.te(n)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(n);break;case 3:this.te(n)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(n)&&(this.ee(n),r.$t(e.resumeToken));break;default:q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Qt.forEach((r,i)=>{this.te(i)&&n(i)})}ne(e){var n;const r=e.targetId,i=e.Vt.count,s=this.se(r);if(s){const o=s.target;if(xh(o))if(i===0){const a=new j(o.path);this.Yt(r,a,Ae.newNoDocument(a,W.min()))}else K(i===1);else{const a=this.ie(r);if(a!==i){const l=this.re(e,a);if(l!==0){this.ee(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,u)}(n=D0.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(u,h,p){var m,g,y,w,T,x;const v={localCacheCount:h,existenceFilterCount:p.count},_=p.unchangedNames;return _&&(v.bloomFilter={applied:u===0,hashCount:(m=_==null?void 0:_.hashCount)!==null&&m!==void 0?m:0,bitmapLength:(w=(y=(g=_==null?void 0:_.bits)===null||g===void 0?void 0:g.bitmap)===null||y===void 0?void 0:y.length)!==null&&w!==void 0?w:0,padding:(x=(T=_==null?void 0:_.bits)===null||T===void 0?void 0:T.padding)!==null&&x!==void 0?x:0}),v}(l,a,e.Vt))}}}}re(e,n){const{unchangedNames:r,count:i}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=r;let l,u;try{l=Ui(s).toUint8Array()}catch(h){if(h instanceof UA)return er("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw h}try{u=new M0(l,o,a)}catch(h){return er(h instanceof vl?"BloomFilter error: ":"Applying bloom filter failed: ",h),1}return u.It===0?1:i!==n-this.oe(e.targetId,u)?2:0}oe(e,n){const r=this.Gt.getRemoteKeysForTarget(e);let i=0;return r.forEach(s=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;n.vt(a)||(this.Yt(e,s,null),i++)}),i}ce(e){const n=new Map;this.Qt.forEach((s,o)=>{const a=this.se(o);if(a){if(s.current&&xh(a.target)){const l=new j(a.target.path);this.jt.get(l)!==null||this.ae(o,l)||this.Yt(o,l,Ae.newNoDocument(l,e))}s.Mt&&(n.set(o,s.Ot()),s.Ft())}});let r=ie();this.zt.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.se(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const i=new ic(e,n,this.Wt,this.jt,r);return this.jt=cn(),this.zt=LI(),this.Wt=new be(re),i}Jt(e,n){if(!this.te(e))return;const r=this.ae(e,n.key)?2:0;this.Zt(e).Bt(n.key,r),this.jt=this.jt.insert(n.key,n),this.zt=this.zt.insert(n.key,this.he(n.key).add(e))}Yt(e,n,r){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,n)?i.Bt(n,1):i.Lt(n),this.zt=this.zt.insert(n,this.he(n).delete(e)),r&&(this.jt=this.jt.insert(n,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const n=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let n=this.Qt.get(e);return n||(n=new MI,this.Qt.set(e,n)),n}he(e){let n=this.zt.get(e);return n||(n=new Re(re),this.zt=this.zt.insert(e,n)),n}te(e){const n=this.se(e)!==null;return n||D("WatchChangeAggregator","Detected inactive target",e),n}se(e){const n=this.Qt.get(e);return n&&n.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new MI),this.Gt.getRemoteKeysForTarget(e).forEach(n=>{this.Yt(e,n,null)})}ae(e,n){return this.Gt.getRemoteKeysForTarget(e).has(n)}}function LI(){return new be(j.comparator)}function UI(){return new be(j.comparator)}const zH=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),WH=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),KH=(()=>({and:"AND",or:"OR"}))();class JH{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ey(t,e){return t.useProto3Json||Zu(e)?e:{value:e}}function da(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function YH(t,e){return da(t,e.toTimestamp())}function Ye(t){return K(!!t),W.fromTimestamp(function(e){const n=Li(e);return new Ue(n.seconds,n.nanos)}(t))}function L0(t,e){return function(n){return new he(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function pk(t){const e=he.fromString(t);return K(Ik(e)),e}function Iu(t,e){return L0(t.databaseId,e.path)}function vr(t,e){const n=pk(e);if(n.get(1)!==t.databaseId.projectId)throw new P(k.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new P(k.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new j(gk(n))}function ty(t,e){return L0(t.databaseId,e)}function mk(t){const e=pk(t);return e.length===4?he.emptyPath():gk(e)}function Su(t){return new he(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gk(t){return K(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function FI(t,e,n){return{name:Iu(t,e),fields:n.value.mapValue.fields}}function yk(t,e,n){const r=vr(t,e.name),i=Ye(e.updateTime),s=e.createTime?Ye(e.createTime):W.min(),o=new It({mapValue:{fields:e.fields}}),a=Ae.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function QH(t,e){return"found"in e?function(n,r){K(!!r.found),r.found.name,r.found.updateTime;const i=vr(n,r.found.name),s=Ye(r.found.updateTime),o=r.found.createTime?Ye(r.found.createTime):W.min(),a=new It({mapValue:{fields:r.found.fields}});return Ae.newFoundDocument(i,s,o,a)}(t,e):"missing"in e?function(n,r){K(!!r.missing),K(!!r.readTime);const i=vr(n,r.missing),s=Ye(r.readTime);return Ae.newNoDocument(i,s)}(t,e):q()}function XH(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(K(u===void 0||typeof u=="string"),it.fromBase64String(u||"")):(K(u===void 0||u instanceof Uint8Array),it.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const u=l.code===void 0?k.UNKNOWN:uk(l.code);return new P(u,l.message||"")}(o);n=new hk(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=vr(t,r.document.name),s=Ye(r.document.updateTime),o=r.document.createTime?Ye(r.document.createTime):W.min(),a=new It({mapValue:{fields:r.document.fields}}),l=Ae.newFoundDocument(i,s,o,a),u=r.targetIds||[],h=r.removedTargetIds||[];n=new _d(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=vr(t,r.document),s=r.readTime?Ye(r.readTime):W.min(),o=Ae.newNoDocument(i,s),a=r.removedTargetIds||[];n=new _d([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=vr(t,r.document),s=r.removedTargetIds||[];n=new _d([],s,i,null)}else{if(!("filter"in e))return q();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new qH(i,s),a=r.targetId;n=new dk(a,o)}}return n}function bu(t,e){let n;if(e instanceof Da)n={update:FI(t,e.key,e.value)};else if(e instanceof Ma)n={delete:Iu(t,e.key)};else if(e instanceof Zr)n={update:FI(t,e.key,e.data),updateMask:iz(e.fieldMask)};else{if(!(e instanceof A0))return q();n={verify:Iu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,s){const o=s.transform;if(o instanceof ua)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Hs)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof zs)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof ca)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw q()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:YH(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:q()}(t,e.precondition)),n}function ny(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Le.updateTime(Ye(i.updateTime)):i.exists!==void 0?Le.exists(i.exists):Le.none()}(e.currentDocument):Le.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,o){let a=null;if("setToServerValue"in o)K(o.setToServerValue==="REQUEST_TIME"),a=new ua;else if("appendMissingElements"in o){const u=o.appendMissingElements.values||[];a=new Hs(u)}else if("removeAllFromArray"in o){const u=o.removeAllFromArray.values||[];a=new zs(u)}else"increment"in o?a=new ca(s,o.increment):q();const l=Je.fromServerFormat(o.fieldPath);return new rc(l,a)}(t,i)):[];if(e.update){e.update.name;const i=vr(t,e.update.name),s=new It({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const l=a.fieldPaths||[];return new un(l.map(u=>Je.fromServerFormat(u)))}(e.updateMask);return new Zr(i,s,o,n,r)}return new Da(i,s,n,r)}if(e.delete){const i=vr(t,e.delete);return new Ma(i,n)}if(e.verify){const i=vr(t,e.verify);return new A0(i,n)}return q()}function ZH(t,e){return t&&t.length>0?(K(e!==void 0),t.map(n=>function(r,i){let s=r.updateTime?Ye(r.updateTime):Ye(i);return s.isEqual(W.min())&&(s=Ye(i)),new $H(s,r.transformResults||[])}(n,e))):[]}function vk(t,e){return{documents:[ty(t,e.path)]}}function xk(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=ty(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ty(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(l){if(l.length!==0)return Tk(ve.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(u=>function(h){return{field:mo(h.field),direction:tz(h.dir)}}(u))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=ey(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function wk(t){let e=mk(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){K(r===1);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(h){const p=_k(h);return p instanceof ve&&b0(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(h=>function(p){return new Ko(go(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h)));let a=null;n.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,Zu(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(h){const p=!!h.before,m=h.values||[];return new ji(m,p)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const p=!h.before,m=h.values||[];return new ji(m,p)}(n.endAt)),zA(e,i,o,s,a,"F",l,u)}function ez(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function _k(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=go(e.unaryFilter.field);return le.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=go(e.unaryFilter.field);return le.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=go(e.unaryFilter.field);return le.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=go(e.unaryFilter.field);return le.create(s,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(t):t.fieldFilter!==void 0?function(e){return le.create(go(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return ve.create(e.compositeFilter.filters.map(n=>_k(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return q()}}(e.compositeFilter.op))}(t):q()}function tz(t){return zH[t]}function nz(t){return WH[t]}function rz(t){return KH[t]}function mo(t){return{fieldPath:t.canonicalString()}}function go(t){return Je.fromServerFormat(t.fieldPath)}function Tk(t){return t instanceof le?function(e){if(e.op==="=="){if(wI(e.value))return{unaryFilter:{field:mo(e.field),op:"IS_NAN"}};if(xI(e.value))return{unaryFilter:{field:mo(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(wI(e.value))return{unaryFilter:{field:mo(e.field),op:"IS_NOT_NAN"}};if(xI(e.value))return{unaryFilter:{field:mo(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mo(e.field),op:nz(e.op),value:e.value}}}(t):t instanceof ve?function(e){const n=e.getFilters().map(r=>Tk(r));return n.length===1?n[0]:{compositeFilter:{op:rz(e.op),filters:n}}}(t):q()}function iz(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Ik(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,n,r,i,s=W.min(),o=W.min(),a=it.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Dr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Dr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Dr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Dr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e){this.fe=e}}function sz(t,e){let n;if(e.document)n=yk(t.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=j.fromSegments(e.noDocument.path),i=Ks(e.noDocument.readTime);n=Ae.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{const r=j.fromSegments(e.unknownDocument.path),i=Ks(e.unknownDocument.version);n=Ae.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(r){const i=new Ue(r[0],r[1]);return W.fromTimestamp(i)}(e.readTime)),n}function OI(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Th(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,s){return{name:Iu(i,s.key),fields:s.data.value.mapValue.fields,updateTime:da(i,s.version.toTimestamp()),createTime:da(i,s.createTime.toTimestamp())}}(t.fe,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ws(e.version)};else{if(!e.isUnknownDocument())return q();r.unknownDocument={path:n.path.toArray(),version:Ws(e.version)}}return r}function Th(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ws(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ks(t){const e=new Ue(t.seconds,t.nanoseconds);return W.fromTimestamp(e)}function cs(t,e){const n=(e.baseMutations||[]).map(s=>ny(t.fe,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>ny(t.fe,s)),i=Ue.fromMillis(e.localWriteTimeMs);return new k0(e.batchId,i,n,r)}function xl(t){const e=Ks(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ks(t.lastLimboFreeSnapshotVersion):W.min();let r;var i;return t.query.documents!==void 0?(K((i=t.query).documents.length===1),r=gn(Pa(mk(i.documents[0])))):r=function(s){return gn(wk(s))}(t.query),new Dr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,it.fromBase64String(t.resumeToken))}function bk(t,e){const n=Ws(e.snapshotVersion),r=Ws(e.lastLimboFreeSnapshotVersion);let i;i=xh(e.target)?vk(t.fe,e.target):xk(t.fe,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Gs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function U0(t){const e=wk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?_h(e,e.limit,"L"):e}function nm(t,e){return new P0(e.largestBatchId,ny(t.fe,e.overlayMutation))}function jI(t,e){const n=e.path.lastSegment();return[t,Kt(e.path.popLast()),n]}function $I(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Ws(r.readTime),documentKey:Kt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oz{getBundleMetadata(e,n){return VI(e).get(n).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Ks(i.createTime),version:i.version};var i})}saveBundleMetadata(e,n){return VI(e).put({bundleId:(r=n).id,createTime:Ws(Ye(r.createTime)),version:r.version});var r}getNamedQuery(e,n){return BI(e).get(n).next(r=>{if(r)return{name:(i=r).name,query:U0(i.bundledQuery),readTime:Ks(i.readTime)};var i})}saveNamedQuery(e,n){return BI(e).put(function(r){return{name:r.name,readTime:Ws(Ye(r.readTime)),bundledQuery:r.bundledQuery}}(n))}}function VI(t){return yt(t,"bundles")}function BI(t){return yt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,n){this.serializer=e,this.userId=n}static de(e,n){const r=n.uid||"";return new Df(e,r)}getOverlay(e,n){return tl(e).get(jI(this.userId,n)).next(r=>r?nm(this.serializer,r):null)}getOverlays(e,n){const r=mr();return A.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new P0(n,o);i.push(this.we(e,a))}),A.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Kt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(tl(e).J("collectionPathOverlayIndex",a))}),A.waitFor(s)}getOverlaysForCollection(e,n,r){const i=mr(),s=Kt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return tl(e).j("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=nm(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=mr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return tl(e).X({index:"collectionGroupOverlayIndex",range:a},(l,u,h)=>{const p=nm(this.serializer,u);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):h.done()}).next(()=>s)}we(e,n){return tl(e).put(function(r,i,s){const[o,a,l]=jI(i,s.mutation.key);return{userId:i,collectionPath:a,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:bu(r.fe,s.mutation)}}(this.serializer,this.userId,n))}}function tl(t){return yt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(){}_e(e,n){this.me(e,n),n.ge()}me(e,n){if("nullValue"in e)this.ye(n,5);else if("booleanValue"in e)this.ye(n,10),n.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(n,15),n.pe(qe(e.integerValue));else if("doubleValue"in e){const r=qe(e.doubleValue);isNaN(r)?this.ye(n,13):(this.ye(n,15),xu(r)?n.pe(0):n.pe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ye(n,20),typeof r=="string"?n.Ie(r):(n.Ie(`${r.seconds||""}`),n.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,n),this.Ee(n);else if("bytesValue"in e)this.ye(n,30),n.Ae(Ui(e.bytesValue)),this.Ee(n);else if("referenceValue"in e)this.ve(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.ye(n,45),n.pe(r.latitude||0),n.pe(r.longitude||0)}else"mapValue"in e?FA(e)?this.ye(n,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,n),this.Ee(n)):"arrayValue"in e?(this.Pe(e.arrayValue,n),this.Ee(n)):q()}Te(e,n){this.ye(n,25),this.be(e,n)}be(e,n){n.Ie(e)}Re(e,n){const r=e.fields||{};this.ye(n,55);for(const i of Object.keys(r))this.Te(i,n),this.me(r[i],n)}Pe(e,n){const r=e.values||[];this.ye(n,50);for(const i of r)this.me(i,n)}ve(e,n){this.ye(n,37),j.fromName(e).path.forEach(r=>{this.ye(n,60),this.be(r,n)})}ye(e,n){e.pe(n)}Ee(e){e.pe(2)}}ds.Ve=new ds;function az(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function qI(t){const e=64-function(n){let r=0;for(let i=0;i<8;++i){const s=az(255&n[i]);if(r+=s,s!==8)break}return r}(t);return Math.ceil(e/8)}class lz{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.De(r.value),r=n.next();this.Ce()}xe(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ne(r.value),r=n.next();this.ke()}Me(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.De(r);else if(r<2048)this.De(960|r>>>6),this.De(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.De(480|r>>>12),this.De(128|63&r>>>6),this.De(128|63&r);else{const i=n.codePointAt(0);this.De(240|i>>>18),this.De(128|63&i>>>12),this.De(128|63&i>>>6),this.De(128|63&i)}}this.Ce()}$e(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ne(r);else if(r<2048)this.Ne(960|r>>>6),this.Ne(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ne(480|r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r);else{const i=n.codePointAt(0);this.Ne(240|i>>>18),this.Ne(128|63&i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i)}}this.ke()}Oe(e){const n=this.Fe(e),r=qI(n);this.Be(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Le(e){const n=this.Fe(e),r=qI(n);this.Be(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const n=function(i){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}De(e){const n=255&e;n===0?(this.Ue(0),this.Ue(255)):n===255?(this.Ue(255),this.Ue(0)):this.Ue(n)}Ne(e){const n=255&e;n===0?(this.Ge(0),this.Ge(255)):n===255?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class uz{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class cz{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class nl{constructor(){this.je=new lz,this.ze=new uz(this.je),this.We=new cz(this.je)}seed(e){this.je.seed(e)}He(e){return e===0?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Je(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new hs(this.indexId,this.documentKey,this.arrayValue,r)}}function ii(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=GI(t.arrayValue,e.arrayValue),n!==0?n:(n=GI(t.directionalValue,e.directionalValue),n!==0?n:j.comparator(t.documentKey,e.documentKey)))}function GI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dz{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const n of e.filters){const r=n;r.isInequality()?this.Ze=r:this.Xe.push(r)}}tn(e){K(e.collectionGroup===this.collectionId);const n=Hg(e);if(n!==void 0&&!this.en(n))return!1;const r=ls(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.en(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Ze!==void 0){if(!i.has(this.Ze.field.canonicalString())){const a=r[s];if(!this.nn(this.Ze,a)||!this.sn(this.Ye[o++],a))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.Ye.length||!this.sn(this.Ye[o++],a))return!1}return!0}en(e){for(const n of this.Xe)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(t){var e,n;if(K(t instanceof le||t instanceof ve),t instanceof le){if(t instanceof HA){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>le.create(t.field,"==",s)))||[];return ve.create(i,"or")}return t}const r=t.filters.map(i=>Ek(i));return ve.create(r,t.op)}function hz(t){if(t.getFilters().length===0)return[];const e=sy(Ek(t));return K(Ck(e)),ry(e)||iy(e)?[e]:e.getFilters()}function ry(t){return t instanceof le}function iy(t){return t instanceof ve&&b0(t)}function Ck(t){return ry(t)||iy(t)||function(e){if(e instanceof ve&&Jg(e)){for(const n of e.getFilters())if(!ry(n)&&!iy(n))return!1;return!0}return!1}(t)}function sy(t){if(K(t instanceof le||t instanceof ve),t instanceof le)return t;if(t.filters.length===1)return sy(t.filters[0]);const e=t.filters.map(r=>sy(r));let n=ve.create(e,t.op);return n=Ih(n),Ck(n)?n:(K(n instanceof ve),K(la(n)),K(n.filters.length>1),n.filters.reduce((r,i)=>F0(r,i)))}function F0(t,e){let n;return K(t instanceof le||t instanceof ve),K(e instanceof le||e instanceof ve),n=t instanceof le?e instanceof le?function(r,i){return ve.create([r,i],"and")}(t,e):HI(t,e):e instanceof le?HI(e,t):function(r,i){if(K(r.filters.length>0&&i.filters.length>0),la(r)&&la(i))return BA(r,i.getFilters());const s=Jg(r)?r:i,o=Jg(r)?i:r,a=s.filters.map(l=>F0(l,o));return ve.create(a,"or")}(t,e),Ih(n)}function HI(t,e){if(la(e))return BA(e,t.getFilters());{const n=e.filters.map(r=>F0(t,r));return ve.create(n,"or")}}function Ih(t){if(K(t instanceof le||t instanceof ve),t instanceof le)return t;const e=t.getFilters();if(e.length===1)return Ih(e[0]);if($A(t))return t;const n=e.map(i=>Ih(i)),r=[];return n.forEach(i=>{i instanceof le?r.push(i):i instanceof ve&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:ve.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fz{constructor(){this.rn=new O0}addToCollectionParentIndex(e,n){return this.rn.add(n),A.resolve()}getCollectionParents(e,n){return A.resolve(this.rn.getEntries(n))}addFieldIndex(e,n){return A.resolve()}deleteFieldIndex(e,n){return A.resolve()}getDocumentsMatchingTarget(e,n){return A.resolve(null)}getIndexType(e,n){return A.resolve(0)}getFieldIndexes(e,n){return A.resolve([])}getNextCollectionGroupToUpdate(e){return A.resolve(null)}getMinOffset(e,n){return A.resolve(Cn.min())}getMinOffsetFromCollectionGroup(e,n){return A.resolve(Cn.min())}updateCollectionGroup(e,n,r){return A.resolve()}updateIndexEntries(e,n){return A.resolve()}}class O0{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Re(he.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(he.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=new Uint8Array(0);class pz{constructor(e,n){this.user=e,this.databaseId=n,this.on=new O0,this.un=new Zi(r=>Gs(r),(r,i)=>ec(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.on.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.on.add(n)});const s={collectionId:r,parent:Kt(i)};return zI(e).put(s)}return A.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[SA(n),""],!1,!0);return zI(e).j(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(pr(o.parent))}return r})}addFieldIndex(e,n){const r=Hc(e),i=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=il(e);return s.next(a=>{o.put($I(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Hc(e),i=il(e),s=rl(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=rl(e);let i=!0;const s=new Map;return A.forEach(this.cn(n),o=>this.an(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ie();const a=[];return A.forEach(s,(l,u)=>{var h;D("IndexedDbIndexManager",`Using index ${h=l,`id=${h.indexId}|cg=${h.collectionGroup}|f=${h.fields.map(_=>`${_.fieldPath}:${_.kind}`).join(",")}`} to execute ${Gs(n)}`);const p=function(_,b){const S=Hg(b);if(S===void 0)return null;for(const I of wh(_,S.fieldPath))switch(I.op){case"array-contains-any":return I.value.arrayValue.values||[];case"array-contains":return[I.value]}return null}(u,l),m=function(_,b){const S=new Map;for(const I of ls(b))for(const E of wh(_,I.fieldPath))switch(E.op){case"==":case"in":S.set(I.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return S.set(I.fieldPath.canonicalString(),E.value),Array.from(S.values())}return null}(u,l),g=function(_,b){const S=[];let I=!0;for(const E of ls(b)){const R=E.kind===0?bI(_,E.fieldPath,_.startAt):EI(_,E.fieldPath,_.startAt);S.push(R.value),I&&(I=R.inclusive)}return new ji(S,I)}(u,l),y=function(_,b){const S=[];let I=!0;for(const E of ls(b)){const R=E.kind===0?EI(_,E.fieldPath,_.endAt):bI(_,E.fieldPath,_.endAt);S.push(R.value),I&&(I=R.inclusive)}return new ji(S,I)}(u,l),w=this.hn(l,u,g),T=this.hn(l,u,y),x=this.ln(l,u,m),v=this.fn(l.indexId,p,w,g.inclusive,T,y.inclusive,x);return A.forEach(v,_=>r.H(_,n.limit).next(b=>{b.forEach(S=>{const I=j.fromSegments(S.documentKey);o.has(I)||(o=o.add(I),a.push(I))})}))}).next(()=>a)}return A.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=hz(ve.create(e.filters,"and")).map(r=>Qg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}fn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),h=[];for(let p=0;p<l;++p){const m=n?this.dn(n[p/u]):Gc,g=this.wn(e,m,r[p%u],i),y=this._n(e,m,s[p%u],o),w=a.map(T=>this.wn(e,m,T,!0));h.push(...this.createRange(g,y,w))}return h}wn(e,n,r,i){const s=new hs(e,j.empty(),n,r);return i?s:s.Je()}_n(e,n,r,i){const s=new hs(e,j.empty(),n,r);return i?s.Je():s}an(e,n){const r=new dz(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.cn(n);return A.forEach(i,s=>this.an(e,s).next(o=>{o?r!==0&&o.fields.length<function(a){let l=new Re(Je.comparator),u=!1;for(const h of a.filters)for(const p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?u=!0:l=l.add(p.field));for(const h of a.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(n)&&i.length>1&&r===2?1:r)}mn(e,n){const r=new nl;for(const i of ls(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.He(i.kind);ds.Ve._e(s,o)}return r.Qe()}dn(e){const n=new nl;return ds.Ve._e(e,n.He(0)),n.Qe()}gn(e,n){const r=new nl;return ds.Ve._e(qs(this.databaseId,n),r.He(function(i){const s=ls(i);return s.length===0?0:s[s.length-1].kind}(e))),r.Qe()}ln(e,n,r){if(r===null)return[];let i=[];i.push(new nl);let s=0;for(const o of ls(e)){const a=r[s++];for(const l of i)if(this.yn(n,o.fieldPath)&&Tu(a))i=this.pn(i,o,a);else{const u=l.He(o.kind);ds.Ve._e(a,u)}}return this.In(i)}hn(e,n,r){return this.ln(e,n,r.position)}In(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Qe();return n}pn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new nl;l.seed(a.Qe()),ds.Ve._e(o,l.He(n.kind)),s.push(l)}return s}yn(e,n){return!!e.filters.find(r=>r instanceof le&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Hc(e),i=il(e);return(n?r.j("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.j()).next(s=>{const o=[];return A.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(u,h){const p=h?new vh(h.sequenceNumber,new Cn(Ks(h.readTime),new j(pr(h.documentKey)),h.largestBatchId)):vh.empty(),m=u.fields.map(([g,y])=>new Y9(Je.fromServerFormat(g),y));return new bA(u.indexId,u.collectionGroup,m,p)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:re(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Hc(e),s=il(e);return this.Tn(e).next(o=>i.j("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>A.forEach(a,l=>s.put($I(l.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return A.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?A.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),A.forEach(a,l=>this.En(e,i,l).next(u=>{const h=this.An(s,l);return u.isEqual(h)?A.resolve():this.vn(e,s,l,u,h)}))))})}Rn(e,n,r,i){return rl(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,n.key),documentKey:n.key.path.toArray()})}Pn(e,n,r,i){return rl(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,n.key),n.key.path.toArray()])}En(e,n,r){const i=rl(e);let s=new Re(ii);return i.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,n)])},(o,a)=>{s=s.add(new hs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}An(e,n){let r=new Re(ii);const i=this.mn(n,e);if(i==null)return r;const s=Hg(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Tu(o))for(const a of o.arrayValue.values||[])r=r.add(new hs(n.indexId,e.key,this.dn(a),i))}else r=r.add(new hs(n.indexId,e.key,Gc,i));return r}vn(e,n,r,i,s){D("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,l,u,h,p){const m=a.getIterator(),g=l.getIterator();let y=ho(m),w=ho(g);for(;y||w;){let T=!1,x=!1;if(y&&w){const v=u(y,w);v<0?x=!0:v>0&&(T=!0)}else y!=null?x=!0:T=!0;T?(h(w),w=ho(g)):x?(p(y),y=ho(m)):(y=ho(m),w=ho(g))}}(i,s,ii,a=>{o.push(this.Rn(e,n,r,a))},a=>{o.push(this.Pn(e,n,r,a))}),A.waitFor(o)}Tn(e){let n=1;return il(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ii(o,a)).filter((o,a,l)=>!a||ii(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=ii(o,e),l=ii(o,n);if(a===0)i[0]=e.Je();else if(a>0&&l<0)i.push(o),i.push(o.Je());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Gc,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Gc,[]];s.push(IDBKeyRange.bound(a,l))}return s}bn(e,n){return ii(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(WI)}getMinOffset(e,n){return A.mapArray(this.cn(n),r=>this.an(e,r).next(i=>i||q())).next(WI)}}function zI(t){return yt(t,"collectionParents")}function rl(t){return yt(t,"indexEntries")}function Hc(t){return yt(t,"indexConfiguration")}function il(t){return yt(t,"indexState")}function WI(t){K(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;T0(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Cn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class sn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new sn(e,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.X({range:o},(h,p,m)=>(a++,m.delete()));s.push(l.next(()=>{K(a===1)}));const u=[];for(const h of n.mutations){const p=RA(e,h.key.path,n.batchId);s.push(i.delete(p)),u.push(h.key)}return A.waitFor(s).next(()=>u)}function Sh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw q();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(41943040,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);class Mf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Vn={}}static de(e,n,r,i){K(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Mf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return si(e).X({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=yo(e),o=si(e);return o.add({}).next(a=>{K(typeof a=="number");const l=new k0(a,n,r,i),u=function(m,g,y){const w=y.baseMutations.map(x=>bu(m.fe,x)),T=y.mutations.map(x=>bu(m.fe,x));return{userId:g,batchId:y.batchId,localWriteTimeMs:y.localWriteTime.toMillis(),baseMutations:w,mutations:T}}(this.serializer,this.userId,l),h=[];let p=new Re((m,g)=>re(m.canonicalString(),g.canonicalString()));for(const m of i){const g=RA(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(o.put(u)),h.push(s.put(g,nH))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Vn[a]=l.keys()}),A.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return si(e).get(n).next(r=>r?(K(r.userId===this.userId),cs(this.serializer,r)):null)}Sn(e,n){return this.Vn[n]?A.resolve(this.Vn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Vn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return si(e).X({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(K(a.batchId>=r),s=cs(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return si(e).X({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return si(e).j("userMutationsIndex",n).next(r=>r.map(i=>cs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=yd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return yo(e).X({range:i},(o,a,l)=>{const[u,h,p]=o,m=pr(h);if(u===this.userId&&n.path.isEqual(m))return si(e).get(p).next(g=>{if(!g)throw q();K(g.userId===this.userId),s.push(cs(this.serializer,g))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Re(re);const i=[];return n.forEach(s=>{const o=yd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=yo(e).X({range:a},(u,h,p)=>{const[m,g,y]=u,w=pr(g);m===this.userId&&s.path.isEqual(w)?r=r.add(y):p.done()});i.push(l)}),A.waitFor(i).next(()=>this.Dn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=yd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Re(re);return yo(e).X({range:o},(l,u,h)=>{const[p,m,g]=l,y=pr(m);p===this.userId&&r.isPrefixOf(y)?y.length===i&&(a=a.add(g)):h.done()}).next(()=>this.Dn(e,a))}Dn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(si(e).get(s).next(o=>{if(o===null)throw q();K(o.userId===this.userId),r.push(cs(this.serializer,o))}))}),A.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return Nk(e.ht,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Cn(n.batchId)}),A.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return A.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return yo(e).X({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=pr(s[1]);i.push(l)}else a.done()}).next(()=>{K(i.length===0)})})}containsKey(e,n){return Ak(e,this.userId,n)}xn(e){return kk(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Ak(t,e,n){const r=yd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return yo(t).X({range:s,Y:!0},(a,l,u)=>{const[h,p,m]=a;h===e&&p===i&&(o=!0),u.done()}).next(()=>o)}function si(t){return yt(t,"mutations")}function yo(t){return yt(t,"documentMutations")}function kk(t){return yt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Js(0)}static Mn(){return new Js(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mz{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.$n(e).next(n=>{const r=new Js(n.highestTargetId);return n.highestTargetId=r.next(),this.On(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(n=>W.fromTimestamp(new Ue(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.$n(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.On(e,i)))}addTargetData(e,n){return this.Fn(e,n).next(()=>this.$n(e).next(r=>(r.targetCount+=1,this.Bn(n,r),this.On(e,r))))}updateTargetData(e,n){return this.Fn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>fo(e).delete(n.targetId)).next(()=>this.$n(e)).next(r=>(K(r.targetCount>0),r.targetCount-=1,this.On(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return fo(e).X((o,a)=>{const l=xl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>A.waitFor(s)).next(()=>i)}forEachTarget(e,n){return fo(e).X((r,i)=>{const s=xl(i);n(s)})}$n(e){return JI(e).get("targetGlobalKey").next(n=>(K(n!==null),n))}On(e,n){return JI(e).put("targetGlobalKey",n)}Fn(e,n){return fo(e).put(bk(this.serializer,n))}Bn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.$n(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Gs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return fo(e).X({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const u=xl(a);ec(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=hi(e);return n.forEach(o=>{const a=Kt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),A.waitFor(i)}removeMatchingKeys(e,n,r){const i=hi(e);return A.forEach(n,s=>{const o=Kt(s.path);return A.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=hi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=hi(e);let s=ie();return i.X({range:r,Y:!0},(o,a,l)=>{const u=pr(o[1]),h=new j(u);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=Kt(n.path),i=IDBKeyRange.bound([r],[SA(r)],!1,!0);let s=0;return hi(e).X({index:"documentTargetsIndex",Y:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}le(e,n){return fo(e).get(n).next(r=>r?xl(r):null)}}function fo(t){return yt(t,"targets")}function JI(t){return yt(t,"targetGlobal")}function hi(t){return yt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI([t,e],[n,r]){const i=re(t,n);return i===0?re(e,r):i}class gz{constructor(e){this.Ln=e,this.buffer=new Re(YI),this.qn=0}Un(){return++this.qn}Kn(e){const n=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();YI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class yz{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}Qn(e){D("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Xi(n)?D("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Qi(n)}await this.Qn(3e5)})}}class vz{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.zn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return A.resolve(ln.ct);const r=new gz(n);return this.jn.forEachTarget(e,i=>r.Kn(i.sequenceNumber)).next(()=>this.jn.Wn(e,i=>r.Kn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(D("LruGarbageCollector","Garbage collection skipped; disabled"),A.resolve(KI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(D("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),KI):this.Hn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,n){let r,i,s,o,a,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(D("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),Gg()<=de.DEBUG&&D("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),A.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function xz(t,e){return new vz(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wz{constructor(e,n){this.db=e,this.garbageCollector=xz(this,n)}zn(e){const n=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Jn(e){let n=0;return this.Wn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Wn(e,n){return this.Yn(e,(r,i)=>n(i))}addReference(e,n,r){return zc(e,r)}removeReference(e,n,r){return zc(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return zc(e,n)}Xn(e,n){return function(r,i){let s=!1;return kk(r).Z(o=>Ak(r,o,i).next(a=>(a&&(s=!0),A.resolve(!a)))).next(()=>s)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Yn(e,(o,a)=>{if(a<=n){const l=this.Xn(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,W.min()),hi(e).delete([0,Kt(o.path)])))});i.push(l)}}).next(()=>A.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return zc(e,n)}Yn(e,n){const r=hi(e);let i,s=ln.ct;return r.X({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==ln.ct&&n(new j(pr(i)),s),s=u,i=l):s=ln.ct}).next(()=>{s!==ln.ct&&n(new j(pr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function zc(t,e){return hi(t).put(function(n,r){return{targetId:0,path:Kt(n.path),sequenceNumber:r}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(){this.changes=new Zi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ae.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?A.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _z{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return rs(e).put(r)}removeEntry(e,n,r){return rs(e).delete(function(i,s){const o=i.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Th(s),o[o.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Zn(e,r)))}getEntry(e,n){let r=Ae.newInvalidDocument(n);return rs(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(sl(n))},(i,s)=>{r=this.ts(n,s)}).next(()=>r)}es(e,n){let r={size:0,document:Ae.newInvalidDocument(n)};return rs(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(sl(n))},(i,s)=>{r={document:this.ts(n,s),size:Sh(s)}}).next(()=>r)}getEntries(e,n){let r=cn();return this.ns(e,n,(i,s)=>{const o=this.ts(i,s);r=r.insert(i,o)}).next(()=>r)}ss(e,n){let r=cn(),i=new be(j.comparator);return this.ns(e,n,(s,o)=>{const a=this.ts(s,o);r=r.insert(s,a),i=i.insert(s,Sh(o))}).next(()=>({documents:r,rs:i}))}ns(e,n,r){if(n.isEmpty())return A.resolve();let i=new Re(ZI);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(sl(i.first()),sl(i.last())),o=i.getIterator();let a=o.getNext();return rs(e).X({index:"documentKeyIndex",range:s},(l,u,h)=>{const p=j.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&ZI(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?h.G(sl(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i){const s=n.path,o=[s.popLast().toArray(),s.lastSegment(),Th(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return rs(e).j(IDBKeyRange.bound(o,a,!0)).next(l=>{let u=cn();for(const h of l){const p=this.ts(j.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(nc(n,p)||i.has(p.key))&&(u=u.insert(p.key,p))}return u})}getAllFromCollectionGroup(e,n,r,i){let s=cn();const o=XI(n,r),a=XI(n,Cn.max());return rs(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,h)=>{const p=this.ts(j.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new Tz(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return QI(e).get("remoteDocumentGlobalKey").next(n=>(K(!!n),n))}Zn(e,n){return QI(e).put("remoteDocumentGlobalKey",n)}ts(e,n){if(n){const r=sz(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(W.min())))return r}return Ae.newInvalidDocument(e)}}function Pk(t){return new _z(t)}class Tz extends Rk{constructor(e,n){super(),this.os=e,this.trackRemovals=n,this.us=new Zi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Re((s,o)=>re(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.us.get(s);if(n.push(this.os.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=OI(this.os.serializer,o);i=i.add(s.path.popLast());const u=Sh(l);r+=u-a.size,n.push(this.os.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=OI(this.os.serializer,o.convertToNoDocument(W.min()));n.push(this.os.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.os.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.os.updateMetadata(e,r)),A.waitFor(n)}getFromCache(e,n){return this.os.es(e,n).next(r=>(this.us.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.os.ss(e,n).next(({documents:r,rs:i})=>(i.forEach((s,o)=>{this.us.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function QI(t){return yt(t,"remoteDocumentGlobal")}function rs(t){return yt(t,"remoteDocumentsV14")}function sl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function XI(t,e){const n=e.documentKey.path.toArray();return[t,Th(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function ZI(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=re(n[s],r[s]),i)return i;return i=re(n.length,r.length),i||(i=re(n[n.length-2],r[r.length-2]),i||re(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iz{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ul(r.mutation,i,un.empty(),Ue.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ie()){const i=mr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=yl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=mr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ie()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=cn();const o=Ll(),a=Ll();return n.forEach((l,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Zr)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Ul(h.mutation,u,h.mutation.getFieldMask(),Ue.now())):o.set(u.key,un.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),n.forEach((u,h)=>{var p;return a.set(u,new Iz(h,(p=o.get(u))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Ll();let i=new be((o,a)=>o-a),s=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let h=r.get(l)||un.empty();h=a.applyToLocalView(u,h),r.set(l,h);const p=(i.get(a.batchId)||ie()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,p=XA();h.forEach(m=>{if(!s.has(m)){const g=ok(n.get(m),r.get(m));g!==null&&p.set(m,g),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return A.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(i){return j.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):C0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):A.resolve(mr());let a=-1,l=s;return o.next(u=>A.forEach(u,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(h)?A.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ie())).next(h=>({batchId:a,changes:QA(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new j(n)).next(r=>{let i=yl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const i=n.collectionGroup;let s=yl();return this.indexManager.getCollectionParents(e,i).next(o=>A.forEach(o,a=>{const l=function(u,h){return new Xr(h,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(u=>{u.forEach((h,p)=>{s=s.insert(h,p)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i))).next(s=>{i.forEach((a,l)=>{const u=l.getKey();s.get(u)===null&&(s=s.insert(u,Ae.newInvalidDocument(u)))});let o=yl();return s.forEach((a,l)=>{const u=i.get(a);u!==void 0&&Ul(u.mutation,l,un.empty(),Ue.now()),nc(n,l)&&(o=o.insert(a,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,n){return A.resolve(this.cs.get(n))}saveBundleMetadata(e,n){var r;return this.cs.set(n.id,{id:(r=n).id,version:r.version,createTime:Ye(r.createTime)}),A.resolve()}getNamedQuery(e,n){return A.resolve(this.hs.get(n))}saveNamedQuery(e,n){return this.hs.set(n.name,function(r){return{name:r.name,query:U0(r.bundledQuery),readTime:Ye(r.readTime)}}(n)),A.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bz{constructor(){this.overlays=new be(j.comparator),this.ls=new Map}getOverlay(e,n){return A.resolve(this.overlays.get(n))}getOverlays(e,n){const r=mr();return A.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.we(e,n,s)}),A.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.ls.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(r)),A.resolve()}getOverlaysForCollection(e,n,r){const i=mr(),s=n.length+1,o=new j(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return A.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new be((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=mr(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=mr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=i)););return A.resolve(a)}we(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.ls.get(i.largestBatchId).delete(r.key);this.ls.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new P0(n,r));let s=this.ls.get(n);s===void 0&&(s=ie(),this.ls.set(n,s)),this.ls.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(){this.fs=new Re(at.ds),this.ws=new Re(at._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,n){const r=new at(e,n);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.ys(new at(e,n))}ps(e,n){e.forEach(r=>this.removeReference(r,n))}Is(e){const n=new j(new he([])),r=new at(n,e),i=new at(n,e+1),s=[];return this.ws.forEachInRange([r,i],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const n=new j(new he([])),r=new at(n,e),i=new at(n,e+1);let s=ie();return this.ws.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new at(e,0),r=this.fs.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class at{constructor(e,n){this.key=e,this.As=n}static ds(e,n){return j.comparator(e.key,n.key)||re(e.As,n.As)}static _s(e,n){return re(e.As,n.As)||j.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ez{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new Re(at.ds)}checkEmpty(e){return A.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new k0(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Rs=this.Rs.add(new at(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return A.resolve(o)}lookupMutationBatch(e,n){return A.resolve(this.Ps(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.bs(r),s=i<0?0:i;return A.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return A.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return A.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new at(n,0),i=new at(n,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([r,i],o=>{const a=this.Ps(o.As);s.push(a)}),A.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Re(re);return n.forEach(i=>{const s=new at(i,0),o=new at(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],a=>{r=r.add(a.As)})}),A.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;j.isDocumentKey(s)||(s=s.child(""));const o=new at(new j(s),0);let a=new Re(re);return this.Rs.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.As)),!0)},o),A.resolve(this.Vs(a))}Vs(e){const n=[];return e.forEach(r=>{const i=this.Ps(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){K(this.Ss(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Rs;return A.forEach(n.mutations,i=>{const s=new at(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,n){const r=new at(n,0),i=this.Rs.firstAfterOrEqual(r);return A.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,A.resolve()}Ss(e,n){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const n=this.bs(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{constructor(e){this.Ds=e,this.docs=new be(j.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Ds(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return A.resolve(r?r.document.mutableCopy():Ae.newInvalidDocument(n))}getEntries(e,n){let r=cn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ae.newInvalidDocument(i))}),A.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=cn();const o=n.path,a=new j(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||T0(CA(h),r)<=0||(i.has(h.key)||nc(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return A.resolve(s)}getAllFromCollectionGroup(e,n,r,i){q()}Cs(e,n){return A.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Nz(this)}getSize(e){return A.resolve(this.size)}}class Nz extends Rk{constructor(e){super(),this.os=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.os.addEntry(e,i)):this.os.removeEntry(r)}),A.waitFor(n)}getFromCache(e,n){return this.os.getEntry(e,n)}getAllFromCache(e,n){return this.os.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Az{constructor(e){this.persistence=e,this.xs=new Zi(n=>Gs(n),ec),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.Ns=0,this.ks=new j0,this.targetCount=0,this.Ms=Js.kn()}forEachTarget(e,n){return this.xs.forEach((r,i)=>n(i)),A.resolve()}getLastRemoteSnapshotVersion(e){return A.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return A.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),A.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Ns&&(this.Ns=n),A.resolve()}Fn(e){this.xs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Ms=new Js(n),this.highestTargetId=n),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,n){return this.Fn(n),this.targetCount+=1,A.resolve()}updateTargetData(e,n){return this.Fn(n),A.resolve()}removeTargetData(e,n){return this.xs.delete(n.target),this.ks.Is(n.targetId),this.targetCount-=1,A.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),A.waitFor(s).next(()=>i)}getTargetCount(e){return A.resolve(this.targetCount)}getTargetData(e,n){const r=this.xs.get(n)||null;return A.resolve(r)}addMatchingKeys(e,n,r){return this.ks.gs(n,r),A.resolve()}removeMatchingKeys(e,n,r){this.ks.ps(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),A.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.ks.Is(n),A.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ks.Es(n);return A.resolve(r)}containsKey(e,n){return A.resolve(this.ks.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e,n){this.$s={},this.overlays={},this.Os=new ln(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Az(this),this.indexManager=new fz,this.remoteDocumentCache=function(r){return new Cz(r)}(r=>this.referenceDelegate.Ls(r)),this.serializer=new Sk(n),this.qs=new Sz(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new bz,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.$s[e.toKey()];return r||(r=new Ez(n,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,n,r){D("MemoryPersistence","Starting transaction:",e);const i=new kz(this.Os.next());return this.referenceDelegate.Us(),r(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(e,n){return A.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,n)))}}class kz extends AA{constructor(e){super(),this.currentSequenceNumber=e}}class Lf{constructor(e){this.persistence=e,this.Qs=new j0,this.js=null}static zs(e){return new Lf(e)}get Ws(){if(this.js)return this.js;throw q()}addReference(e,n,r){return this.Qs.addReference(r,n),this.Ws.delete(r.toString()),A.resolve()}removeReference(e,n,r){return this.Qs.removeReference(r,n),this.Ws.add(r.toString()),A.resolve()}markPotentiallyOrphaned(e,n){return this.Ws.add(n.toString()),A.resolve()}removeTarget(e,n){this.Qs.Is(n.targetId).forEach(i=>this.Ws.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Us(){this.js=new Set}Ks(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return A.forEach(this.Ws,r=>{const i=j.fromPath(r);return this.Hs(e,i).next(s=>{s||n.removeEntry(i,W.min())})}).next(()=>(this.js=null,n.apply(e)))}updateLimboDocument(e,n){return this.Hs(e,n).next(r=>{r?this.Ws.delete(n.toString()):this.Ws.add(n.toString())})}Ls(e){return 0}Hs(e,n){return A.or([()=>A.resolve(this.Qs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gs(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rz{constructor(e){this.serializer=e}O(e,n,r,i){const s=new Nf("createOrUpgrade",n);r<1&&i>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mI,{unique:!0}),a.createObjectStore("documentMutations")}(e),eS(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=A.resolve();return r<3&&i>=3&&(r!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),eS(e)),o=o.next(()=>function(a){const l=a.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:W.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(a,l){return l.store("mutations").j().next(u=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mI,{unique:!0});const h=l.store("mutations"),p=u.map(m=>h.put(m));return A.waitFor(p)})}(e,s))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Ys(s))),r<6&&i>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(s)))),r<7&&i>=7&&(o=o.next(()=>this.Zs(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ei(s))),r<11&&i>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(a){const l=a.createObjectStore("documentOverlays",{keyPath:pH});l.createIndex("collectionPathOverlayIndex",mH,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",gH,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(a){const l=a.createObjectStore("remoteDocumentsV14",{keyPath:rH});l.createIndex("documentKeyIndex",iH),l.createIndex("collectionGroupIndex",sH)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:cH}).createIndex("sequenceNumberIndex",dH,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:hH}).createIndex("documentKeyIndex",fH,{unique:!1})}(e))),o}Xs(e){let n=0;return e.store("remoteDocuments").X((r,i)=>{n+=Sh(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Ys(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.j().next(i=>A.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",o).next(a=>A.forEach(a,l=>{K(l.userId===s.userId);const u=cs(this.serializer,l);return Nk(e,s.userId,u).next(()=>{})}))}))}Zs(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.X((o,a)=>{const l=new he(o),u=function(h){return[0,Kt(h)]}(l);s.push(n.get(u).next(h=>h?A.resolve():(p=>n.put({targetId:0,path:Kt(p),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>A.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:uH});const r=n.store("collectionParents"),i=new O0,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Kt(l)})}};return n.store("remoteDocuments").X({Y:!0},(o,a)=>{const l=new he(o);return s(l.popLast())}).next(()=>n.store("documentMutations").X({Y:!0},([o,a,l],u)=>{const h=pr(a);return s(h.popLast())}))}ei(e){const n=e.store("targets");return n.X((r,i)=>{const s=xl(i),o=bk(this.serializer,s);return n.put(o)})}ni(e,n){const r=n.store("remoteDocuments"),i=[];return r.X((s,o)=>{const a=n.store("remoteDocumentsV14"),l=(u=o,u.document?new j(he.fromString(u.document.name).popFirst(5)):u.noDocument?j.fromSegments(u.noDocument.path):u.unknownDocument?j.fromSegments(u.unknownDocument.path):q()).path.toArray();var u;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const h={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(h))}).next(()=>A.waitFor(i))}si(e,n){const r=n.store("mutations"),i=Pk(this.serializer),s=new Mk(Lf.zs,this.serializer.fe);return r.j().next(o=>{const a=new Map;return o.forEach(l=>{var u;let h=(u=a.get(l.userId))!==null&&u!==void 0?u:ie();cs(this.serializer,l).keys().forEach(p=>h=h.add(p)),a.set(l.userId,h)}),A.forEach(a,(l,u)=>{const h=new ut(u),p=Df.de(this.serializer,h),m=s.getIndexManager(h),g=Mf.de(h,this.serializer,m,s.referenceDelegate);return new Dk(i,g,p,m).recalculateAndSaveOverlaysForDocumentKeys(new zg(n,ln.ct),l).next()})})}}function eS(t){t.createObjectStore("targetDocuments",{keyPath:aH}).createIndex("documentTargetsIndex",lH,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",oH,{unique:!0}),t.createObjectStore("targetGlobal")}const rm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class $0{constructor(e,n,r,i,s,o,a,l,u,h,p=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ii=s,this.window=o,this.document=a,this.ri=u,this.oi=h,this.ui=p,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=m=>Promise.resolve(),!$0.D())throw new P(k.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wz(this,i),this.di=n+"main",this.serializer=new Sk(l),this.wi=new zn(this.di,this.ui,new Rz(this.serializer)),this.Bs=new mz(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Pk(this.serializer),this.qs=new oz,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,h===!1&&Ke("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(k.FAILED_PRECONDITION,rm);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new ln(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){return this.fi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Wc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(n=>{n||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(n=>this.isPrimary&&!n?this.Ai(e).next(()=>!1):!!n&&this.vi(e).next(()=>!0))).catch(e=>{if(Xi(e))return D("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return D("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return ol(e).get("owner").next(n=>A.resolve(this.Ri(n)))}Pi(e){return Wc(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Vi(this.li,18e5)){this.li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=yt(n,"clientMetadata");return r.j().next(i=>{const s=this.Si(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return A.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this._i)for(const n of e)this._i.removeItem(this.Di(n.clientId))}}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?A.resolve(!0):ol(e).get("owner").next(n=>{if(n!==null&&this.Vi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)){if(this.Ri(n)&&this.networkEnabled)return!0;if(!this.Ri(n)){if(!n.allowTabSynchronization)throw new P(k.FAILED_PRECONDITION,rm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Wc(e).j().next(r=>this.Si(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&D("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),await this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new zg(e,ln.ct);return this.Ai(n).next(()=>this.Pi(n))}),this.wi.close(),this.Mi()}Si(e,n){return e.filter(r=>this.Vi(r.updateTimeMs,n)&&!this.Ci(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Wc(e).j().next(n=>this.Si(n,18e5).map(r=>r.clientId)))}get started(){return this.Fs}getMutationQueue(e,n){return Mf.de(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new pz(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return Df.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,n,r){D("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=(o=this.ui)===15?vH:o===14?MA:o===13?DA:o===12?yH:o===11?PA:void q();var o;let a;return this.wi.runTransaction(e,i,s,l=>(a=new zg(l,this.Os?this.Os.next():ln.ct),n==="readwrite-primary"?this.Ti(a).next(u=>!!u||this.Ei(a)).next(u=>{if(!u)throw Ke(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new P(k.FAILED_PRECONDITION,NA);return r(a)}).next(u=>this.vi(a).next(()=>u)):this.Oi(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Oi(e){return ol(e).get("owner").next(n=>{if(n!==null&&this.Vi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)&&!this.Ri(n)&&!(this.oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new P(k.FAILED_PRECONDITION,rm)})}vi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ol(e).put("owner",n)}static D(){return zn.D()}Ai(e){const n=ol(e);return n.get("owner").next(r=>this.Ri(r)?(D("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):A.resolve())}Vi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ke(`Detected an update time that is in the future: ${e} > ${r}`),!1))}gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground=this.document.visibilityState==="visible")}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();const n=/(?:Version|Mobile)\/1[456]/;I$()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var n;try{const r=((n=this._i)===null||n===void 0?void 0:n.getItem(this.Di(e)))!==null;return D("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ke("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){Ke("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ol(t){return yt(t,"owner")}function Wc(t){return yt(t,"clientMetadata")}function V0(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Fi=r,this.Bi=i}static Li(e,n){let r=ie(),i=ie();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new B0(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(){this.qi=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.qi=!0}getDocumentsMatchingQuery(e,n,r,i){return this.Ki(e,n).next(s=>s||this.Gi(e,n,i,r)).next(s=>s||this.Qi(e,n))}Ki(e,n){if(CI(n))return A.resolve(null);let r=gn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=_h(n,null,"F"),r=gn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ie(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ji(n,a);return this.zi(n,u,o,l.readTime)?this.Ki(e,_h(n,null,"F")):this.Wi(e,u,n,l)}))})))}Gi(e,n,r,i){return CI(n)||i.isEqual(W.min())?this.Qi(e,n):this.Ui.getDocuments(e,r).next(s=>{const o=this.ji(n,s);return this.zi(n,o,r,i)?this.Qi(e,n):(Gg()<=de.DEBUG&&D("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Zg(n)),this.Wi(e,o,n,EA(i,-1)))})}ji(e,n){let r=new Re(JA(e));return n.forEach((i,s)=>{nc(e,s)&&(r=r.add(s))}),r}zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(e,n){return Gg()<=de.DEBUG&&D("QueryEngine","Using full collection scan to execute query:",Zg(n)),this.Ui.getDocumentsMatchingQuery(e,n,Cn.min())}Wi(e,n,r,i){return this.Ui.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pz{constructor(e,n,r,i){this.persistence=e,this.Hi=n,this.serializer=i,this.Ji=new be(re),this.Yi=new Zi(s=>Gs(s),ec),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Dk(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ji))}}function Uk(t,e,n,r){return new Pz(t,e,n,r)}async function Fk(t,e){const n=$(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.tr(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ie();for(const u of i){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(u=>({er:u,removedBatchIds:o,addedBatchIds:a}))})})}function Dz(t,e){const n=$(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,l,u){const h=l.batch,p=h.keys();let m=A.resolve();return p.forEach(g=>{m=m.next(()=>u.getEntry(a,g)).next(y=>{const w=l.docVersions.get(g);K(w!==null),y.version.compareTo(w)<0&&(h.applyToRemoteDocument(y,l),y.isValidDocument()&&(y.setReadTime(l.commitVersion),u.addEntry(y)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(a,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=ie();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Ok(t){const e=$(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Bs.getLastRemoteSnapshotVersion(n))}function Mz(t,e){const n=$(t),r=e.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const a=[];e.targetChanges.forEach((h,p)=>{const m=i.get(p);if(!m)return;a.push(n.Bs.removeMatchingKeys(s,h.removedDocuments,p).next(()=>n.Bs.addMatchingKeys(s,h.addedDocuments,p)));let g=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?g=g.withResumeToken(it.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(p,g),function(y,w,T){return y.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(m,g,h)&&a.push(n.Bs.updateTargetData(s,g))});let l=cn(),u=ie();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(jk(s,o,e.documentUpdates).next(h=>{l=h.nr,u=h.sr})),!r.isEqual(W.min())){const h=n.Bs.getLastRemoteSnapshotVersion(s).next(p=>n.Bs.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return A.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ji=i,s))}function jk(t,e,n){let r=ie(),i=ie();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=cn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(W.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):D("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{nr:o,sr:i}})}function Lz(t,e){const n=$(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ha(t,e){const n=$(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Bs.getTargetData(r,e).next(s=>s?(i=s,A.resolve(i)):n.Bs.allocateTargetId(r).next(o=>(i=new Dr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Bs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ji.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(r.targetId,r),n.Yi.set(e,r.targetId)),r})}async function fa(t,e,n){const r=$(t),i=r.Ji.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Xi(o))throw o;D("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(i.target)}function bh(t,e,n){const r=$(t);let i=W.min(),s=ie();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,l,u){const h=$(a),p=h.Yi.get(u);return p!==void 0?A.resolve(h.Ji.get(p)):h.Bs.getTargetData(l,u)}(r,o,gn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,n?i:W.min(),n?s:ie())).next(a=>(Bk(r,KA(e),a),{documents:a,ir:s})))}function $k(t,e){const n=$(t),r=$(n.Bs),i=n.Ji.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.le(s,e).next(o=>o?o.target:null))}function Vk(t,e){const n=$(t),r=n.Xi.get(e)||W.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.Zi.getAllFromCollectionGroup(i,e,EA(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Bk(n,e,i),i))}function Bk(t,e,n){let r=t.Xi.get(e)||W.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Xi.set(e,r)}async function Uz(t,e,n,r){const i=$(t);let s=ie(),o=cn();for(const u of n){const h=e.rr(u.metadata.name);u.document&&(s=s.add(h));const p=e.ur(u);p.setReadTime(e.cr(u.metadata.readTime)),o=o.insert(h,p)}const a=i.Zi.newChangeBuffer({trackRemovals:!0}),l=await ha(i,function(u){return gn(Pa(he.fromString(`__bundle__/docs/${u}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>jk(u,a,o).next(h=>(a.apply(u),h)).next(h=>i.Bs.removeMatchingKeysForTargetId(u,l.targetId).next(()=>i.Bs.addMatchingKeys(u,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,h.nr,h.sr)).next(()=>h.nr)))}async function Fz(t,e,n=ie()){const r=await ha(t,gn(U0(e.bundledQuery))),i=$(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=Ye(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.qs.saveNamedQuery(s,e);const a=r.withResumeToken(it.EMPTY_BYTE_STRING,o);return i.Ji=i.Ji.insert(a.targetId,a),i.Bs.updateTargetData(s,a).next(()=>i.Bs.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Bs.addMatchingKeys(s,n,r.targetId)).next(()=>i.qs.saveNamedQuery(s,e))})}function tS(t,e){return`firestore_clients_${t}_${e}`}function nS(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function im(t,e){return`firestore_targets_${t}_${e}`}class Eh{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static ar(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new P(i.error.code,i.error.message))),o?new Eh(e,n,i.state,s):(Ke("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Fl{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static ar(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new P(r.error.code,r.error.message))),s?new Fl(e,r.state,i):(Ke("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ch{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static ar(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=N0();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=kA(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Ch(e,s):(Ke("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class q0{constructor(e,n){this.clientId=e,this.onlineState=n}static ar(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new q0(n.clientId,n.onlineState):(Ke("SharedClientState",`Failed to parse online state: ${e}`),null)}}class oy{constructor(){this.activeTargetIds=N0()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sm{constructor(e,n,r,i,s){this.window=e,this.ii=n,this.persistenceKey=r,this.wr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new be(re),this.started=!1,this.yr=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=tS(this.persistenceKey,this.wr),this.Ir=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new oy),this.Tr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.Rr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.$i();for(const r of e){if(r===this.wr)continue;const i=this.getItem(tS(this.persistenceKey,r));if(i){const s=Ch.ar(r,i);s&&(this.gr=this.gr.insert(s.clientId,s))}}this.Pr();const n=this.storage.getItem(this.vr);if(n){const r=this.br(n);r&&this.Vr(r)}for(const r of this.yr)this.mr(r);this.yr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let n=!1;return this.gr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,n,r){this.Dr(e,n,r),this.Cr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(im(this.persistenceKey,e));if(r){const i=Fl.ar(e,r);i&&(n=i.state)}}return this.Nr.lr(e),this.Pr(),n}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(im(this.persistenceKey,e))}updateQueryState(e,n,r){this.kr(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Cr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return D("SharedClientState","READ",e,n),n}setItem(e,n){D("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){D("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){const n=e;if(n.storageArea===this.storage){if(D("SharedClientState","EVENT",n.key,n.newValue),n.key===this.pr)return void Ke("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Tr.test(n.key)){if(n.newValue==null){const r=this.Or(n.key);return this.Fr(r,null)}{const r=this.Br(n.key,n.newValue);if(r)return this.Fr(r.clientId,r)}}else if(this.Er.test(n.key)){if(n.newValue!==null){const r=this.Lr(n.key,n.newValue);if(r)return this.qr(r)}}else if(this.Ar.test(n.key)){if(n.newValue!==null){const r=this.Ur(n.key,n.newValue);if(r)return this.Kr(r)}}else if(n.key===this.vr){if(n.newValue!==null){const r=this.br(n.newValue);if(r)return this.Vr(r)}}else if(n.key===this.Ir){const r=function(i){let s=ln.ct;if(i!=null)try{const o=JSON.parse(i);K(typeof o=="number"),s=o}catch(o){Ke("SharedClientState","Failed to read sequence number from WebStorage",o)}return s}(n.newValue);r!==ln.ct&&this.sequenceNumberHandler(r)}else if(n.key===this.Rr){const r=this.Gr(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Qr(i)))}}}else this.yr.push(n)})}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,n,r){const i=new Eh(this.currentUser,e,n,r),s=nS(this.persistenceKey,this.currentUser,e);this.setItem(s,i.hr())}Cr(e){const n=nS(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Mr(e){const n={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(n))}kr(e,n,r){const i=im(this.persistenceKey,e),s=new Fl(e,n,r);this.setItem(i,s.hr())}$r(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Rr,n)}Or(e){const n=this.Tr.exec(e);return n?n[1]:null}Br(e,n){const r=this.Or(e);return Ch.ar(r,n)}Lr(e,n){const r=this.Er.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Eh.ar(new ut(s),i,n)}Ur(e,n){const r=this.Ar.exec(e),i=Number(r[1]);return Fl.ar(i,n)}br(e){return q0.ar(e)}Gr(e){return JSON.parse(e)}async qr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.jr(e.batchId,e.state,e.error);D("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,n){const r=n?this.gr.insert(e,n):this.gr.remove(e),i=this.Sr(this.gr),s=this.Sr(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.Wr(o,a).then(()=>{this.gr=r})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let n=N0();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class qk{constructor(){this.Hr=new oy,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,n,r){this.Jr[e]=n}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new oy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){D("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){D("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kc=null;function om(){return Kc===null?Kc=268435456+Math.round(2147483648*Math.random()):Kc++,"0x"+Kc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $z{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mt="WebChannelConnection";class Vz extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.mo=n+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,n,r,i,s){const o=om(),a=this.To(e,n);D("RestConnection",`Sending RPC '${e}' ${o}:`,a,r);const l={};return this.Eo(l,i,s),this.Ao(e,a,l,r).then(u=>(D("RestConnection",`Received RPC '${e}' ${o}: `,u),u),u=>{throw er("RestConnection",`RPC '${e}' ${o} failed with error: `,u,"url: ",a,"request:",r),u})}vo(e,n,r,i,s,o){return this.Io(e,n,r,i,s)}Eo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ra,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}To(e,n){const r=jz[e];return`${this.mo}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,n,r,i){const s=om();return new Promise((o,a)=>{const l=new F9;l.setWithCredentials(!0),l.listenOnce(M9.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case tm.NO_ERROR:const h=l.getResponseJson();D(Mt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case tm.TIMEOUT:D(Mt,`RPC '${e}' ${s} timed out`),a(new P(k.DEADLINE_EXCEEDED,"Request time out"));break;case tm.HTTP_ERROR:const p=l.getStatus();if(D(Mt,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const y=function(w){const T=w.toLowerCase().replace(/_/g,"-");return Object.values(k).indexOf(T)>=0?T:k.UNKNOWN}(g.status);a(new P(y,g.message))}else a(new P(k.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new P(k.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{D(Mt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);D(Mt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}Ro(e,n,r){const i=om(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=P9(),a=D9(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.xmlHttpFactory=new U9({})),this.Eo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=s.join("");D(Mt,`Creating RPC '${e}' stream ${i}: ${h}`,l);const p=o.createWebChannel(h,l);let m=!1,g=!1;const y=new $z({ro:T=>{g?D(Mt,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(m||(D(Mt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),D(Mt,`RPC '${e}' stream ${i} sending:`,T),p.send(T))},oo:()=>p.close()}),w=(T,x,v)=>{T.listen(x,_=>{try{v(_)}catch(b){setTimeout(()=>{throw b},0)}})};return w(p,Vc.EventType.OPEN,()=>{g||D(Mt,`RPC '${e}' stream ${i} transport opened.`)}),w(p,Vc.EventType.CLOSE,()=>{g||(g=!0,D(Mt,`RPC '${e}' stream ${i} transport closed`),y.wo())}),w(p,Vc.EventType.ERROR,T=>{g||(g=!0,er(Mt,`RPC '${e}' stream ${i} transport errored:`,T),y.wo(new P(k.UNAVAILABLE,"The operation could not be completed")))}),w(p,Vc.EventType.MESSAGE,T=>{var x;if(!g){const v=T.data[0];K(!!v);const _=v,b=_.error||((x=_[0])===null||x===void 0?void 0:x.error);if(b){D(Mt,`RPC '${e}' stream ${i} received error:`,b);const S=b.status;let I=function(R){const F=Xe[R];if(F!==void 0)return uk(F)}(S),E=b.message;I===void 0&&(I=k.INTERNAL,E="Unknown error status: "+S+" with message "+b.message),g=!0,y.wo(new P(I,E)),p.close()}else D(Mt,`RPC '${e}' stream ${i} received:`,v),y._o(v)}}),w(a,L9.STAT_EVENT,T=>{T.stat===dI.PROXY?D(Mt,`RPC '${e}' stream ${i} detected buffering proxy`):T.stat===dI.NOPROXY&&D(Mt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.fo()},0),y}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(){return typeof window<"u"?window:null}function Td(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(t){return new JH(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=n,this.Po=r,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const n=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),i=Math.max(0,n-r);i>0&&D("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,n,r,i,s,o,a,l){this.ii=e,this.$o=r,this.Oo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new G0(e,n)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,n){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():n&&n.code===k.RESOURCE_EXHAUSTED?(Ke(n.toString()),Ke("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===k.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(n)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Fo===n&&this.Zo(r,i)},r=>{e(()=>{const i=new P(k.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(i)})})}Zo(e,n){const r=this.Xo(this.Fo);this.stream=this.eu(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{r(()=>this.tu(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return D("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return n=>{this.ii.enqueueAndForget(()=>this.Fo===e?n():(D("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Bz extends Hk{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}eu(e,n){return this.connection.Ro("Listen",e,n)}onMessage(e){this.qo.reset();const n=XH(this.serializer,e),r=function(i){if(!("targetChange"in i))return W.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?W.min():s.readTime?Ye(s.readTime):W.min()}(e);return this.listener.nu(n,r)}su(e){const n={};n.database=Su(this.serializer),n.addTarget=function(i,s){let o;const a=s.target;if(o=xh(a)?{documents:vk(i,a)}:{query:xk(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=fk(i,s.resumeToken);const l=ey(i,s.expectedCount);l!==null&&(o.expectedCount=l)}else if(s.snapshotVersion.compareTo(W.min())>0){o.readTime=da(i,s.snapshotVersion.toTimestamp());const l=ey(i,s.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const r=ez(this.serializer,e);r&&(n.labels=r),this.Wo(n)}iu(e){const n={};n.database=Su(this.serializer),n.removeTarget=e,this.Wo(n)}}class qz extends Hk{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,n){return this.connection.Ro("Write",e,n)}onMessage(e){if(K(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const n=ZH(e.writeResults,e.commitTime),r=Ye(e.commitTime);return this.listener.cu(r,n)}return K(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Su(this.serializer),this.Wo(e)}uu(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>bu(this.serializer,r))};this.Wo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gz extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new P(k.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new P(k.UNKNOWN,i.toString())})}vo(e,n,r,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(k.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class Hz{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Ke(n),this.mu=!1):D("OnlineStateTracker",n)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(o=>{r.enqueueAndForget(async()=>{es(this)&&(D("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=$(a);l.vu.add(4),await La(l),l.bu.set("Unknown"),l.vu.delete(4),await ac(l)}(this))})}),this.bu=new Hz(r,i)}}async function ac(t){if(es(t))for(const e of t.Ru)await e(!0)}async function La(t){for(const e of t.Ru)await e(!1)}function Uf(t,e){const n=$(t);n.Au.has(e.targetId)||(n.Au.set(e.targetId,e),W0(n)?z0(n):Fa(n).Ko()&&H0(n,e))}function Eu(t,e){const n=$(t),r=Fa(n);n.Au.delete(e),r.Ko()&&zk(n,e),n.Au.size===0&&(r.Ko()?r.jo():es(n)&&n.bu.set("Unknown"))}function H0(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fa(t).su(e)}function zk(t,e){t.Vu.qt(e),Fa(t).iu(e)}function z0(t){t.Vu=new HH({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),Fa(t).start(),t.bu.gu()}function W0(t){return es(t)&&!Fa(t).Uo()&&t.Au.size>0}function es(t){return $(t).vu.size===0}function Wk(t){t.Vu=void 0}async function Wz(t){t.Au.forEach((e,n)=>{H0(t,e)})}async function Kz(t,e){Wk(t),W0(t)?(t.bu.Iu(e),z0(t)):t.bu.set("Unknown")}async function Jz(t,e,n){if(t.bu.set("Online"),e instanceof hk&&e.state===2&&e.cause)try{await async function(r,i){const s=i.cause;for(const o of i.targetIds)r.Au.has(o)&&(await r.remoteSyncer.rejectListen(o,s),r.Au.delete(o),r.Vu.removeTarget(o))}(t,e)}catch(r){D("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Nh(t,r)}else if(e instanceof _d?t.Vu.Ht(e):e instanceof dk?t.Vu.ne(e):t.Vu.Xt(e),!n.isEqual(W.min()))try{const r=await Ok(t.localStore);n.compareTo(r)>=0&&await function(i,s){const o=i.Vu.ce(s);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const u=i.Au.get(l);u&&i.Au.set(l,u.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach((a,l)=>{const u=i.Au.get(a);if(!u)return;i.Au.set(a,u.withResumeToken(it.EMPTY_BYTE_STRING,u.snapshotVersion)),zk(i,a);const h=new Dr(u.target,a,l,u.sequenceNumber);H0(i,h)}),i.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){D("RemoteStore","Failed to raise snapshot:",r),await Nh(t,r)}}async function Nh(t,e,n){if(!Xi(e))throw e;t.vu.add(1),await La(t),t.bu.set("Offline"),n||(n=()=>Ok(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{D("RemoteStore","Retrying IndexedDB access"),await n(),t.vu.delete(1),await ac(t)})}function Kk(t,e){return e().catch(n=>Nh(t,n,e))}async function Ua(t){const e=$(t),n=$i(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;Yz(e);)try{const i=await Lz(e.localStore,r);if(i===null){e.Eu.length===0&&n.jo();break}r=i.batchId,Qz(e,i)}catch(i){await Nh(e,i)}Jk(e)&&Yk(e)}function Yz(t){return es(t)&&t.Eu.length<10}function Qz(t,e){t.Eu.push(e);const n=$i(t);n.Ko()&&n.ou&&n.uu(e.mutations)}function Jk(t){return es(t)&&!$i(t).Uo()&&t.Eu.length>0}function Yk(t){$i(t).start()}async function Xz(t){$i(t).hu()}async function Zz(t){const e=$i(t);for(const n of t.Eu)e.uu(n.mutations)}async function e8(t,e,n){const r=t.Eu.shift(),i=R0.from(r,e,n);await Kk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ua(t)}async function t8(t,e){e&&$i(t).ou&&await async function(n,r){if(i=r.code,lk(i)&&i!==k.ABORTED){const s=n.Eu.shift();$i(n).Qo(),await Kk(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Ua(n)}var i}(t,e),Jk(t)&&Yk(t)}async function iS(t,e){const n=$(t);n.asyncQueue.verifyOperationInProgress(),D("RemoteStore","RemoteStore received new credentials");const r=es(n);n.vu.add(3),await La(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.vu.delete(3),await ac(n)}async function ay(t,e){const n=$(t);e?(n.vu.delete(2),await ac(n)):e||(n.vu.add(2),await La(n),n.bu.set("Unknown"))}function Fa(t){return t.Su||(t.Su=function(e,n,r){const i=$(e);return i.fu(),new Bz(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{uo:Wz.bind(null,t),ao:Kz.bind(null,t),nu:Jz.bind(null,t)}),t.Ru.push(async e=>{e?(t.Su.Qo(),W0(t)?z0(t):t.bu.set("Unknown")):(await t.Su.stop(),Wk(t))})),t.Su}function $i(t){return t.Du||(t.Du=function(e,n,r){const i=$(e);return i.fu(),new qz(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{uo:Xz.bind(null,t),ao:t8.bind(null,t),au:Zz.bind(null,t),cu:e8.bind(null,t)}),t.Ru.push(async e=>{e?(t.Du.Qo(),await Ua(t)):(await t.Du.stop(),t.Eu.length>0&&(D("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))})),t.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ft,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new K0(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(k.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Oa(t,e){if(Ke("AsyncQueue",`${e}: ${t}`),Xi(t))return new P(k.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.comparator=e?(n,r)=>e(n,r)||j.comparator(n.key,r.key):(n,r)=>j.comparator(n.key,r.key),this.keyedMap=yl(),this.sortedSet=new be(this.comparator)}static emptySet(e){return new Jo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Jo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Jo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(){this.Cu=new be(j.comparator)}track(e){const n=e.doc.key,r=this.Cu.get(n);r?e.type!==0&&r.type===3?this.Cu=this.Cu.insert(n,e):e.type===3&&r.type!==1?this.Cu=this.Cu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Cu=this.Cu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Cu=this.Cu.remove(n):e.type===1&&r.type===2?this.Cu=this.Cu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):q():this.Cu=this.Cu.insert(n,e)}xu(){const e=[];return this.Cu.inorderTraversal((n,r)=>{e.push(r)}),e}}class pa{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new pa(e,n,Jo.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n8{constructor(){this.Nu=void 0,this.listeners=[]}}class r8{constructor(){this.queries=new Zi(e=>WA(e),tc),this.onlineState="Unknown",this.ku=new Set}}async function J0(t,e){const n=$(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new n8),i)try{s.Nu=await n.onListen(r)}catch(o){const a=Oa(o,`Initialization of query '${Zg(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Mu(n.onlineState),s.Nu&&e.$u(s.Nu)&&Q0(n)}async function Y0(t,e){const n=$(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function i8(t,e){const n=$(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.$u(i)&&(r=!0);o.Nu=i}}r&&Q0(n)}function s8(t,e,n){const r=$(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function Q0(t){t.ku.forEach(e=>{e.next()})}class X0{constructor(e,n,r){this.query=e,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new pa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),n=!0):this.qu(e,this.onlineState)&&(this.Uu(e),n=!0),this.Bu=e,n}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let n=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),n=!0),n}qu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Ku||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const n=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Uu(e){e=pa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(e,n){this.Gu=e,this.byteLength=n}Qu(){return"metadata"in this.Gu}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e){this.serializer=e}rr(e){return vr(this.serializer,e)}ur(e){return e.metadata.exists?yk(this.serializer,e.document,!1):Ae.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return Ye(e)}}class a8{constructor(e,n,r){this.ju=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Qk(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++n;const r=he.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}Wu(e){const n=new Map,r=new oS(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.rr(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||ie()).add(s);n.set(o,a)}}return n}async complete(){const e=await Uz(this.localStore,new oS(this.serializer),this.documents,this.ju.id),n=this.Wu(this.documents);for(const r of this.queries)await Fz(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:e}}}function Qk(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(e){this.key=e}}class Zk{constructor(e){this.key=e}}class eR{constructor(e,n){this.query=e,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=ie(),this.mutatedKeys=ie(),this.tc=JA(e),this.ec=new Jo(this.tc)}get nc(){return this.Yu}sc(e,n){const r=n?n.ic:new sS,i=n?n.ec:this.ec;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{const m=i.get(h),g=nc(this.query,p)?p:null,y=!!m&&this.mutatedKeys.has(m.key),w=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let T=!1;m&&g?m.data.isEqual(g.data)?y!==w&&(r.track({type:3,doc:g}),T=!0):this.rc(m,g)||(r.track({type:2,doc:g}),T=!0,(l&&this.tc(g,l)>0||u&&this.tc(g,u)<0)&&(a=!0)):!m&&g?(r.track({type:0,doc:g}),T=!0):m&&!g&&(r.track({type:1,doc:m}),T=!0,(l||u)&&(a=!0)),T&&(g?(o=o.add(g),s=w?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{ec:o,ic:r,zi:a,mutatedKeys:s}}rc(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((u,h)=>function(p,m){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return g(p)-g(m)}(u.type,h.type)||this.tc(u.doc,h.doc)),this.oc(r);const o=n?this.uc():[],a=this.Zu.size===0&&this.current?1:0,l=a!==this.Xu;return this.Xu=a,s.length!==0||l?{snapshot:new pa(this.query,e.ec,i,s,e.mutatedKeys,a===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new sS,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(n=>this.Yu=this.Yu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Yu=this.Yu.delete(n)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=ie(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const n=[];return e.forEach(r=>{this.Zu.has(r)||n.push(new Zk(r))}),this.Zu.forEach(r=>{e.has(r)||n.push(new Xk(r))}),n}hc(e){this.Yu=e.ir,this.Zu=ie();const n=this.sc(e.documents);return this.applyChanges(n,!0)}lc(){return pa.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class l8{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class u8{constructor(e){this.key=e,this.fc=!1}}class c8{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new Zi(a=>WA(a),tc),this._c=new Map,this.mc=new Set,this.gc=new be(j.comparator),this.yc=new Map,this.Ic=new j0,this.Tc={},this.Ec=new Map,this.Ac=Js.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function d8(t,e){const n=rx(t);let r,i;const s=n.wc.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{const o=await ha(n.localStore,gn(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await Z0(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Uf(n.remoteStore,o)}return i}async function Z0(t,e,n,r,i){t.Rc=(p,m,g)=>async function(y,w,T,x){let v=w.view.sc(T);v.zi&&(v=await bh(y.localStore,w.query,!1).then(({documents:S})=>w.view.sc(S,v)));const _=x&&x.targetChanges.get(w.targetId),b=w.view.applyChanges(v,y.isPrimaryClient,_);return ly(y,w.targetId,b.cc),b.snapshot}(t,p,m,g);const s=await bh(t.localStore,e,!0),o=new eR(e,s.ir),a=o.sc(s.documents),l=sc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);ly(t,n,u.cc);const h=new l8(e,n,o);return t.wc.set(e,h),t._c.has(n)?t._c.get(n).push(e):t._c.set(n,[e]),u.snapshot}async function h8(t,e){const n=$(t),r=n.wc.get(e),i=n._c.get(r.targetId);if(i.length>1)return n._c.set(r.targetId,i.filter(s=>!tc(s,e))),void n.wc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await fa(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Eu(n.remoteStore,r.targetId),ma(n,r.targetId)}).catch(Qi)):(ma(n,r.targetId),await fa(n.localStore,r.targetId,!0))}async function f8(t,e,n){const r=ix(t);try{const i=await function(s,o){const a=$(s),l=Ue.now(),u=o.reduce((m,g)=>m.add(g.key),ie());let h,p;return a.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=cn(),y=ie();return a.Zi.getEntries(m,u).next(w=>{g=w,g.forEach((T,x)=>{x.isValidDocument()||(y=y.add(T))})}).next(()=>a.localDocuments.getOverlayedDocuments(m,g)).next(w=>{h=w;const T=[];for(const x of o){const v=BH(x,h.get(x.key).overlayedDocument);v!=null&&T.push(new Zr(x.key,v,OA(v.value.mapValue),Le.exists(!0)))}return a.mutationQueue.addMutationBatch(m,l,T,o)}).next(w=>{p=w;const T=w.applyToLocalDocumentSet(h,y);return a.documentOverlayCache.saveOverlays(m,w.batchId,T)})}).then(()=>({batchId:p.batchId,changes:QA(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let l=s.Tc[s.currentUser.toKey()];l||(l=new be(re)),l=l.insert(o,a),s.Tc[s.currentUser.toKey()]=l}(r,i.batchId,n),await ei(r,i.changes),await Ua(r.remoteStore)}catch(i){const s=Oa(i,"Failed to persist write");n.reject(s)}}async function tR(t,e){const n=$(t);try{const r=await Mz(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.yc.get(s);o&&(K(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.fc=!0:i.modifiedDocuments.size>0?K(o.fc):i.removedDocuments.size>0&&(K(o.fc),o.fc=!1))}),await ei(n,r,e)}catch(r){await Qi(r)}}function aS(t,e,n){const r=$(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.wc.forEach((s,o)=>{const a=o.view.Mu(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){const a=$(s);a.onlineState=o;let l=!1;a.queries.forEach((u,h)=>{for(const p of h.listeners)p.Mu(o)&&(l=!0)}),l&&Q0(a)}(r.eventManager,e),i.length&&r.dc.nu(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function p8(t,e,n){const r=$(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.yc.get(e),s=i&&i.key;if(s){let o=new be(j.comparator);o=o.insert(s,Ae.newNoDocument(s,W.min()));const a=ie().add(s),l=new ic(W.min(),new Map,new be(re),o,a);await tR(r,l),r.gc=r.gc.remove(s),r.yc.delete(e),nx(r)}else await fa(r.localStore,e,!1).then(()=>ma(r,e,n)).catch(Qi)}async function m8(t,e){const n=$(t),r=e.batch.batchId;try{const i=await Dz(n.localStore,e);tx(n,r,null),ex(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ei(n,i)}catch(i){await Qi(i)}}async function g8(t,e,n){const r=$(t);try{const i=await function(s,o){const a=$(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return a.mutationQueue.lookupMutationBatch(l,o).next(h=>(K(h!==null),u=h.keys(),a.mutationQueue.removeMutationBatch(l,h))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>a.localDocuments.getDocuments(l,u))})}(r.localStore,e);tx(r,e,n),ex(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ei(r,i)}catch(i){await Qi(i)}}async function y8(t,e){const n=$(t);es(n.remoteStore)||D("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(s){const o=$(s);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(r===-1)return void e.resolve();const i=n.Ec.get(r)||[];i.push(e),n.Ec.set(r,i)}catch(r){const i=Oa(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function ex(t,e){(t.Ec.get(e)||[]).forEach(n=>{n.resolve()}),t.Ec.delete(e)}function tx(t,e,n){const r=$(t);let i=r.Tc[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Tc[r.currentUser.toKey()]=i}}function ma(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t._c.get(e))t.wc.delete(r),n&&t.dc.Pc(r,n);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach(r=>{t.Ic.containsKey(r)||nR(t,r)})}function nR(t,e){t.mc.delete(e.path.canonicalString());const n=t.gc.get(e);n!==null&&(Eu(t.remoteStore,n),t.gc=t.gc.remove(e),t.yc.delete(n),nx(t))}function ly(t,e,n){for(const r of n)r instanceof Xk?(t.Ic.addReference(r.key,e),v8(t,r)):r instanceof Zk?(D("SyncEngine","Document no longer in limbo: "+r.key),t.Ic.removeReference(r.key,e),t.Ic.containsKey(r.key)||nR(t,r.key)):q()}function v8(t,e){const n=e.key,r=n.path.canonicalString();t.gc.get(n)||t.mc.has(r)||(D("SyncEngine","New document in limbo: "+n),t.mc.add(r),nx(t))}function nx(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const n=new j(he.fromString(e)),r=t.Ac.next();t.yc.set(r,new u8(n)),t.gc=t.gc.insert(n,r),Uf(t.remoteStore,new Dr(gn(Pa(n.path)),r,"TargetPurposeLimboResolution",ln.ct))}}async function ei(t,e,n){const r=$(t),i=[],s=[],o=[];r.wc.isEmpty()||(r.wc.forEach((a,l)=>{o.push(r.Rc(l,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,u!=null&&u.fromCache?"not-current":"current"),u){i.push(u);const h=B0.Li(l.targetId,u);s.push(h)}}))}),await Promise.all(o),r.dc.nu(i),await async function(a,l){const u=$(a);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>A.forEach(l,p=>A.forEach(p.Fi,m=>u.persistence.referenceDelegate.addReference(h,p.targetId,m)).next(()=>A.forEach(p.Bi,m=>u.persistence.referenceDelegate.removeReference(h,p.targetId,m)))))}catch(h){if(!Xi(h))throw h;D("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const p=h.targetId;if(!h.fromCache){const m=u.Ji.get(p),g=m.snapshotVersion,y=m.withLastLimboFreeSnapshotVersion(g);u.Ji=u.Ji.insert(p,y)}}}(r.localStore,s))}async function x8(t,e){const n=$(t);if(!n.currentUser.isEqual(e)){D("SyncEngine","User change. New user:",e.toKey());const r=await Fk(n.localStore,e);n.currentUser=e,function(i,s){i.Ec.forEach(o=>{o.forEach(a=>{a.reject(new P(k.CANCELLED,s))})}),i.Ec.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ei(n,r.er)}}function w8(t,e){const n=$(t),r=n.yc.get(e);if(r&&r.fc)return ie().add(r.key);{let i=ie();const s=n._c.get(e);if(!s)return i;for(const o of s){const a=n.wc.get(o);i=i.unionWith(a.view.nc)}return i}}async function _8(t,e){const n=$(t),r=await bh(n.localStore,e.query,!0),i=e.view.hc(r);return n.isPrimaryClient&&ly(n,e.targetId,i.cc),i}async function T8(t,e){const n=$(t);return Vk(n.localStore,e).then(r=>ei(n,r))}async function I8(t,e,n,r){const i=$(t),s=await function(o,a){const l=$(o),u=$(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.Sn(h,a).next(p=>p?l.localDocuments.getDocuments(h,p):A.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Ua(i.remoteStore):n==="acknowledged"||n==="rejected"?(tx(i,e,r||null),ex(i,e),function(o,a){$($(o).mutationQueue).Cn(a)}(i.localStore,e)):q(),await ei(i,s)):D("SyncEngine","Cannot apply mutation batch with id: "+e)}async function S8(t,e){const n=$(t);if(rx(n),ix(n),e===!0&&n.vc!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await lS(n,r.toArray());n.vc=!0,await ay(n.remoteStore,!0);for(const s of i)Uf(n.remoteStore,s)}else if(e===!1&&n.vc!==!1){const r=[];let i=Promise.resolve();n._c.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(ma(n,o),fa(n.localStore,o,!0))),Eu(n.remoteStore,o)}),await i,await lS(n,r),function(s){const o=$(s);o.yc.forEach((a,l)=>{Eu(o.remoteStore,l)}),o.Ic.Ts(),o.yc=new Map,o.gc=new be(j.comparator)}(n),n.vc=!1,await ay(n.remoteStore,!1)}}async function lS(t,e,n){const r=$(t),i=[],s=[];for(const o of e){let a;const l=r._c.get(o);if(l&&l.length!==0){a=await ha(r.localStore,gn(l[0]));for(const u of l){const h=r.wc.get(u),p=await _8(r,h);p.snapshot&&s.push(p.snapshot)}}else{const u=await $k(r.localStore,o);a=await ha(r.localStore,u),await Z0(r,rR(u),o,!1,a.resumeToken)}i.push(a)}return r.dc.nu(s),i}function rR(t){return zA(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function b8(t){const e=$(t);return $($(e.localStore).persistence).$i()}async function E8(t,e,n,r){const i=$(t);if(i.vc)return void D("SyncEngine","Ignoring unexpected query state notification.");const s=i._c.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await Vk(i.localStore,KA(s[0])),a=ic.createSynthesizedRemoteEventForCurrentChange(e,n==="current",it.EMPTY_BYTE_STRING);await ei(i,o,a);break}case"rejected":await fa(i.localStore,e,!0),ma(i,e,r);break;default:q()}}async function C8(t,e,n){const r=rx(t);if(r.vc){for(const i of e){if(r._c.has(i)){D("SyncEngine","Adding an already active target "+i);continue}const s=await $k(r.localStore,i),o=await ha(r.localStore,s);await Z0(r,rR(s),o.targetId,!1,o.resumeToken),Uf(r.remoteStore,o)}for(const i of n)r._c.has(i)&&await fa(r.localStore,i,!1).then(()=>{Eu(r.remoteStore,i),ma(r,i)}).catch(Qi)}}function rx(t){const e=$(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=w8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=p8.bind(null,e),e.dc.nu=i8.bind(null,e.eventManager),e.dc.Pc=s8.bind(null,e.eventManager),e}function ix(t){const e=$(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=m8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=g8.bind(null,e),e}function N8(t,e,n){const r=$(t);(async function(i,s,o){try{const a=await s.getMetadata();if(await function(p,m){const g=$(p),y=Ye(m.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",w=>g.qs.getBundleMetadata(w,m.id)).then(w=>!!w&&w.createTime.compareTo(y)>=0)}(i.localStore,a))return await s.close(),o._completeWith(function(p){return{taskState:"Success",documentsLoaded:p.totalDocuments,bytesLoaded:p.totalBytes,totalDocuments:p.totalDocuments,totalBytes:p.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(Qk(a));const l=new a8(a,i.localStore,s.serializer);let u=await s.bc();for(;u;){const p=await l.zu(u);p&&o._updateProgress(p),u=await s.bc()}const h=await l.complete();return await ei(i,h.Ju,void 0),await function(p,m){const g=$(p);return g.persistence.runTransaction("Save bundle","readwrite",y=>g.qs.saveBundleMetadata(y,m))}(i.localStore,a),o._completeWith(h.progress),Promise.resolve(h.Hu)}catch(a){return er("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class uy{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=oc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Uk(this.persistence,new Lk,e.initialUser,this.serializer)}createPersistence(e){return new Mk(Lf.zs,this.serializer)}createSharedClientState(e){return new qk}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class iR extends uy{constructor(e,n,r){super(),this.Vc=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Vc.initialize(this,e),await ix(this.Vc.syncEngine),await Ua(this.Vc.remoteStore),await this.persistence.Ii(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return Uk(this.persistence,new Lk,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new yz(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new eH(n,this.persistence);return new Z9(e.asyncQueue,r)}createPersistence(e){const n=V0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new $0(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Gk(),Td(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new qk}}class A8 extends iR{constructor(e,n){super(e,n,!1),this.Vc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Vc.syncEngine;this.sharedClientState instanceof sm&&(this.sharedClientState.syncEngine={jr:I8.bind(null,n),zr:E8.bind(null,n),Wr:C8.bind(null,n),$i:b8.bind(null,n),Qr:T8.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ii(async r=>{await S8(this.Vc.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=Gk();if(!sm.D(n))throw new P(k.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=V0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new sm(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class sx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>aS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=x8.bind(null,this.syncEngine),await ay(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new r8}createDatastore(e){const n=oc(e.databaseInfo.databaseId),r=(i=e.databaseInfo,new Vz(i));var i;return function(s,o,a,l){return new Gz(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,i=e.asyncQueue,s=a=>aS(this.syncEngine,a,0),o=rS.D()?new rS:new Oz,new zz(n,r,i,s,o);var n,r,i,s,o}createSyncEngine(e,n){return function(r,i,s,o,a,l,u){const h=new c8(r,i,s,o,a,l);return u&&(h.vc=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=$(e);D("RemoteStore","RemoteStore shutting down."),n.vu.add(5),await La(n),n.Pu.shutdown(),n.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Ke("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k8{constructor(e,n){this.Cc=e,this.serializer=n,this.metadata=new ft,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(r=>{r&&r.Qu()?this.metadata.resolve(r.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Gu)}`))},r=>this.metadata.reject(r))}close(){return this.Cc.cancel()}async getMetadata(){return this.metadata.promise}async bc(){return await this.getMetadata(),this.Nc()}async Nc(){const e=await this.kc();if(e===null)return null;const n=this.xc.decode(e),r=Number(n);isNaN(r)&&this.Mc(`length string (${n}) is not valid number`);const i=await this.$c(r);return new o8(JSON.parse(i),e.length+r)}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async kc(){for(;this.Oc()<0&&!await this.Fc(););if(this.buffer.length===0)return null;const e=this.Oc();e<0&&this.Mc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async $c(e){for(;this.buffer.length<e;)await this.Fc()&&this.Mc("Reached the end of bundle when more is expected.");const n=this.xc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}async Fc(){const e=await this.Cc.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new P(k.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(r,i){const s=$(r),o=Su(s.serializer)+"/documents",a={documents:i.map(p=>Iu(s.serializer,p))},l=await s.vo("BatchGetDocuments",o,a,i.length),u=new Map;l.forEach(p=>{const m=QH(s.serializer,p);u.set(m.key.toString(),m)});const h=[];return i.forEach(p=>{const m=u.get(p.toString());K(!!m),h.push(m)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ma(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=j.fromPath(r);this.mutations.push(new A0(i,this.precondition(i)))}),await async function(n,r){const i=$(n),s=Su(i.serializer)+"/documents",o={writes:r.map(a=>bu(i.serializer,a))};await i.Io("Commit",s,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw q();n=W.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new P(k.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(W.min())?Le.exists(!1):Le.updateTime(n):Le.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(W.min()))throw new P(k.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Le.updateTime(n)}return Le.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P8{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Bc=r.maxAttempts,this.qo=new G0(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){this.qo.No(async()=>{const e=new R8(this.datastore),n=this.qc(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Uc(i)}))}).catch(r=>{this.Uc(r)})})}qc(e){try{const n=this.updateFunction(e);return!Zu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!lk(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ut.UNAUTHENTICATED,this.clientId=IA.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{D("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(D("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new P(k.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ft;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Oa(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Id(t,e){t.asyncQueue.verifyOperationInProgress(),D("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Fk(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function cy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ox(t);D("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>iS(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>iS(e.remoteStore,s)),t._onlineComponents=e}function sR(t){return t.name==="FirebaseError"?t.code===k.FAILED_PRECONDITION||t.code===k.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function ox(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){D("FirestoreClient","Using user provided OfflineComponentProvider");try{await Id(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!sR(n))throw n;er("Error using user provided cache. Falling back to memory cache: "+n),await Id(t,new uy)}}else D("FirestoreClient","Using default OfflineComponentProvider"),await Id(t,new uy);return t._offlineComponents}async function Of(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(D("FirestoreClient","Using user provided OnlineComponentProvider"),await cy(t,t._uninitializedComponentsProvider._online)):(D("FirestoreClient","Using default OnlineComponentProvider"),await cy(t,new sx))),t._onlineComponents}function oR(t){return ox(t).then(e=>e.persistence)}function ax(t){return ox(t).then(e=>e.localStore)}function aR(t){return Of(t).then(e=>e.remoteStore)}function lx(t){return Of(t).then(e=>e.syncEngine)}function M8(t){return Of(t).then(e=>e.datastore)}async function ga(t){const e=await Of(t),n=e.eventManager;return n.onListen=d8.bind(null,e.syncEngine),n.onUnlisten=h8.bind(null,e.syncEngine),n}function L8(t){return t.asyncQueue.enqueue(async()=>{const e=await oR(t),n=await aR(t);return e.setNetworkEnabled(!0),function(r){const i=$(r);return i.vu.delete(0),ac(i)}(n)})}function U8(t){return t.asyncQueue.enqueue(async()=>{const e=await oR(t),n=await aR(t);return e.setNetworkEnabled(!1),async function(r){const i=$(r);i.vu.add(0),await La(i),i.bu.set("Offline")}(n)})}function F8(t,e){const n=new ft;return t.asyncQueue.enqueueAndForget(async()=>async function(r,i,s){try{const o=await function(a,l){const u=$(a);return u.persistence.runTransaction("read document","readonly",h=>u.localDocuments.getDocument(h,l))}(r,i);o.isFoundDocument()?s.resolve(o):o.isNoDocument()?s.resolve(null):s.reject(new P(k.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=Oa(o,`Failed to get document '${i} from cache`);s.reject(a)}}(await ax(t),e,n)),n.promise}function lR(t,e,n={}){const r=new ft;return t.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,l){const u=new Ff({next:p=>{s.enqueueAndForget(()=>Y0(i,h));const m=p.docs.has(o);!m&&p.fromCache?l.reject(new P(k.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&a&&a.source==="server"?l.reject(new P(k.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new X0(Pa(o.path),u,{includeMetadataChanges:!0,Ku:!0});return J0(i,h)}(await ga(t),t.asyncQueue,e,n,r)),r.promise}function O8(t,e){const n=new ft;return t.asyncQueue.enqueueAndForget(async()=>async function(r,i,s){try{const o=await bh(r,i,!0),a=new eR(i,o.ir),l=a.sc(o.documents),u=a.applyChanges(l,!1);s.resolve(u.snapshot)}catch(o){const a=Oa(o,`Failed to execute query '${i} against cache`);s.reject(a)}}(await ax(t),e,n)),n.promise}function uR(t,e,n={}){const r=new ft;return t.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,l){const u=new Ff({next:p=>{s.enqueueAndForget(()=>Y0(i,h)),p.fromCache&&a.source==="server"?l.reject(new P(k.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new X0(o,u,{includeMetadataChanges:!0,Ku:!0});return J0(i,h)}(await ga(t),t.asyncQueue,e,n,r)),r.promise}function j8(t,e){const n=new Ff(e);return t.asyncQueue.enqueueAndForget(async()=>function(r,i){$(r).ku.add(i),i.next()}(await ga(t),n)),()=>{n.Dc(),t.asyncQueue.enqueueAndForget(async()=>function(r,i){$(r).ku.delete(i)}(await ga(t),n))}}function $8(t,e,n,r){const i=function(s,o){let a;return a=typeof s=="string"?ck().encode(s):s,function(l,u){return new k8(l,u)}(function(l,u){if(l instanceof Uint8Array)return uS(l,u);if(l instanceof ArrayBuffer)return uS(new Uint8Array(l),u);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,oc(e));t.asyncQueue.enqueueAndForget(async()=>{N8(await lx(t),i,r)})}function V8(t,e){return t.asyncQueue.enqueue(async()=>function(n,r){const i=$(n);return i.persistence.runTransaction("Get named query","readonly",s=>i.qs.getNamedQuery(s,r))}(await ax(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(t,e,n){if(!n)throw new P(k.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dR(t,e,n,r){if(e===!0&&r===!0)throw new P(k.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function dS(t){if(!j.isDocumentKey(t))throw new P(k.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hS(t){if(j.isDocumentKey(t))throw new P(k.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function jf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":q()}function pe(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new P(k.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=jf(t);throw new P(k.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function hR(t,e){if(e<=0)throw new P(k.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(k.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(k.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new P(k.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new P(k.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new P(k.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(n=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,n.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var n,r}}class lc{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fS({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new P(k.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new P(k.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fS(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new V9;switch(n.type){case"firstParty":return new H9(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new P(k.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=cS.get(e);n&&(D("ComponentProvider","Removing Datastore"),cS.delete(e),n.terminate())}(this),Promise.resolve()}}function B8(t,e,n,r={}){var i;const s=(t=pe(t,lc))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&er("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=ut.MOCK_USER;else{a=w$(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new P(k.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ut(u)}t._authCredentials=new B9(new TA(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pe(this.firestore,e,this._key)}}class kt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new kt(this.firestore,e,this._query)}}class xr extends kt{constructor(e,n,r){super(e,n,Pa(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pe(this.firestore,null,new j(e))}withConverter(e){return new xr(this.firestore,e,this._path)}}function fR(t,e,...n){if(t=J(t),ux("collection","path",e),t instanceof lc){const r=he.fromString(e,...n);return hS(r),new xr(t,null,r)}{if(!(t instanceof Pe||t instanceof xr))throw new P(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(he.fromString(e,...n));return hS(r),new xr(t.firestore,null,r)}}function q8(t,e){if(t=pe(t,lc),ux("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(k.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new kt(t,null,function(n){return new Xr(he.emptyPath(),n)}(e))}function Ah(t,e,...n){if(t=J(t),arguments.length===1&&(e=IA.A()),ux("doc","path",e),t instanceof lc){const r=he.fromString(e,...n);return dS(r),new Pe(t,null,new j(r))}{if(!(t instanceof Pe||t instanceof xr))throw new P(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(he.fromString(e,...n));return dS(r),new Pe(t.firestore,t instanceof xr?t.converter:null,new j(r))}}function pR(t,e){return t=J(t),e=J(e),(t instanceof Pe||t instanceof xr)&&(e instanceof Pe||e instanceof xr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function mR(t,e){return t=J(t),e=J(e),t instanceof kt&&e instanceof kt&&t.firestore===e.firestore&&tc(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new G0(this,"async_queue_retry"),this.Xc=()=>{const n=Td();n&&D("AsyncQueue","Visibility state changed to "+n.visibilityState),this.qo.Mo()};const e=Td();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const n=Td();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const n=new ft;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Xi(e))throw e;D("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const n=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{this.Wc=r,this.Hc=!1;const i=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(r);throw Ke("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Hc=!1,r))));return this.Gc=n,n}enqueueAfterDelay(e,n,r){this.Zc(),this.Yc.indexOf(e)>-1&&(n=0);const i=K0.createAndSchedule(this,e,n,r,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&q()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const n of this.zc)if(n.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.zc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const n=this.zc.indexOf(e);this.zc.splice(n,1)}}function dy(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const i of n)if(i in r&&typeof r[i]=="function")return!0;return!1}(t,["next","error","complete"])}class H8{constructor(){this._progressObserver={},this._taskCompletionResolver=new ft,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z8=-1;class He extends lc{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new G8,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||gR(this),this._firestoreClient.terminate()}}function vt(t){return t._firestoreClient||gR(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function gR(t){var e,n,r;const i=t._freezeSettings(),s=function(o,a,l,u){return new _H(o,a,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,cR(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new D8(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.cache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.cache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function W8(t,e){vR(t=pe(t,He));const n=vt(t);if(n._uninitializedComponentsProvider)throw new P(k.FAILED_PRECONDITION,"SDK cache is already specified.");er("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new sx;return yR(n,i,new iR(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function K8(t){vR(t=pe(t,He));const e=vt(t);if(e._uninitializedComponentsProvider)throw new P(k.FAILED_PRECONDITION,"SDK cache is already specified.");er("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new sx;return yR(e,r,new A8(r,n.cacheSizeBytes))}function yR(t,e,n){const r=new ft;return t.asyncQueue.enqueue(async()=>{try{await Id(t,n),await cy(t,e),r.resolve()}catch(i){const s=i;if(!sR(s))throw s;er("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function J8(t){if(t._initialized&&!t._terminated)throw new P(k.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ft;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!zn.D())return Promise.resolve();const r=n+"main";await zn.delete(r)}(V0(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function Y8(t){return function(e){const n=new ft;return e.asyncQueue.enqueueAndForget(async()=>y8(await lx(e),n)),n.promise}(vt(t=pe(t,He)))}function Q8(t){return L8(vt(t=pe(t,He)))}function X8(t){return U8(vt(t=pe(t,He)))}function Z8(t,e){const n=vt(t=pe(t,He)),r=new H8;return $8(n,t._databaseId,e,r),r}function eW(t,e){return V8(vt(t=pe(t,He)),e).then(n=>n?new kt(t,null,n.query):null)}function vR(t){if(t._initialized||t._terminated)throw new P(k.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Tr(it.fromBase64String(e))}catch(n){throw new P(k.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Tr(it.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new P(k.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Je(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new P(k.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new P(k.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tW=/^__.*__$/;class nW{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Zr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Da(e,this.data,n,this.fieldTransforms)}}class xR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Zr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function wR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}class Vf{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Vf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.aa({path:r,la:!1});return i.fa(e),i}da(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.aa({path:r,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return kh(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(wR(this.ca)&&tW.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class rW{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||oc(e)}ya(e,n,r,i=!1){return new Vf({ca:e,methodName:n,ga:r,path:Je.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function io(t){const e=t._freezeSettings(),n=oc(t._databaseId);return new rW(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Bf(t,e,n,r,i,s={}){const o=t.ya(s.merge||s.mergeFields?2:0,e,n,i);fx("Data must be an object, but it was:",o,r);const a=IR(r,o);let l,u;if(s.merge)l=new un(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const p of s.mergeFields){const m=hy(e,p,n);if(!o.contains(m))throw new P(k.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);bR(h,m)||h.push(m)}l=new un(h),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new nW(new It(a),l,u)}class uc extends ro{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof uc}}function _R(t,e,n){return new Vf({ca:3,ga:e.settings.ga,methodName:t._methodName,la:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class cx extends ro{_toFieldTransform(e){return new rc(e.path,new ua)}isEqual(e){return e instanceof cx}}class iW extends ro{constructor(e,n){super(e),this.pa=n}_toFieldTransform(e){const n=_R(this,e,!0),r=this.pa.map(s=>so(s,n)),i=new Hs(r);return new rc(e.path,i)}isEqual(e){return this===e}}class sW extends ro{constructor(e,n){super(e),this.pa=n}_toFieldTransform(e){const n=_R(this,e,!0),r=this.pa.map(s=>so(s,n)),i=new zs(r);return new rc(e.path,i)}isEqual(e){return this===e}}class oW extends ro{constructor(e,n){super(e),this.Ia=n}_toFieldTransform(e){const n=new ca(e.serializer,tk(e.serializer,this.Ia));return new rc(e.path,n)}isEqual(e){return this===e}}function dx(t,e,n,r){const i=t.ya(1,e,n);fx("Data must be an object, but it was:",i,r);const s=[],o=It.empty();no(r,(l,u)=>{const h=px(e,l,n);u=J(u);const p=i.da(h);if(u instanceof uc)s.push(h);else{const m=so(u,p);m!=null&&(s.push(h),o.set(h,m))}});const a=new un(s);return new xR(o,a,i.fieldTransforms)}function hx(t,e,n,r,i,s){const o=t.ya(1,e,n),a=[hy(e,r,n)],l=[i];if(s.length%2!=0)throw new P(k.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(hy(e,s[m])),l.push(s[m+1]);const u=[],h=It.empty();for(let m=a.length-1;m>=0;--m)if(!bR(u,a[m])){const g=a[m];let y=l[m];y=J(y);const w=o.da(g);if(y instanceof uc)u.push(g);else{const T=so(y,w);T!=null&&(u.push(g),h.set(g,T))}}const p=new un(u);return new xR(h,p,o.fieldTransforms)}function TR(t,e,n,r=!1){return so(n,t.ya(r?4:3,e))}function so(t,e){if(SR(t=J(t)))return fx("Unsupported field value:",e,t),IR(t,e);if(t instanceof ro)return function(n,r){if(!wR(r.ca))throw r._a(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(n,r){const i=[];let s=0;for(const o of n){let a=so(o,r.wa(s));a==null&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(t,e)}return function(n,r){if((n=J(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return tk(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Ue.fromDate(n);return{timestampValue:da(r.serializer,i)}}if(n instanceof Ue){const i=new Ue(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:da(r.serializer,i)}}if(n instanceof $f)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Tr)return{bytesValue:fk(r.serializer,n._byteString)};if(n instanceof Pe){const i=r.databaseId,s=n.firestore._databaseId;if(!s.isEqual(i))throw r._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:L0(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r._a(`Unsupported field value: ${jf(n)}`)}(t,e)}function IR(t,e){const n={};return LA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):no(t,(r,i)=>{const s=so(i,e.ha(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function SR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ue||t instanceof $f||t instanceof Tr||t instanceof Pe||t instanceof ro)}function fx(t,e,n){if(!SR(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=jf(n);throw r==="an object"?e._a(t+" a custom object"):e._a(t+" "+r)}}function hy(t,e,n){if((e=J(e))instanceof Vi)return e._internalPath;if(typeof e=="string")return px(t,e);throw kh("Field path arguments must be of type string or ",t,!1,void 0,n)}const aW=new RegExp("[~\\*/\\[\\]]");function px(t,e,n){if(e.search(aW)>=0)throw kh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Vi(...e.split("."))._internalPath}catch{throw kh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function kh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new P(k.INVALID_ARGUMENT,a+t+l)}function bR(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(qf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class lW extends Cu{data(){return super.data()}}function qf(t,e){return typeof e=="string"?px(t,e):e instanceof Vi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new P(k.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mx{}class cc extends mx{}function oi(t,e,...n){let r=[];e instanceof mx&&r.push(e),r=r.concat(n),function(i){const s=i.filter(a=>a instanceof gx).length,o=i.filter(a=>a instanceof Gf).length;if(s>1||s>0&&o>0)throw new P(k.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Gf extends cc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Gf(e,n,r)}_apply(e){const n=this._parse(e);return NR(e._query,n),new kt(e.firestore,e.converter,Xg(e._query,n))}_parse(e){const n=io(e.firestore);return function(i,s,o,a,l,u,h){let p;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new P(k.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){mS(h,u);const m=[];for(const g of h)m.push(pS(a,i,g));p={arrayValue:{values:m}}}else p=pS(a,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||mS(h,u),p=TR(o,s,h,u==="in"||u==="not-in");return le.create(l,u,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function uW(t,e,n){const r=e,i=qf("where",t);return Gf._create(i,r,n)}class gx extends mx{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new gx(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ve.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,i){let s=r;const o=i.getFlattenedFilters();for(const a of o)NR(s,a),s=Xg(s,a)}(e._query,n),new kt(e.firestore,e.converter,Xg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class yx extends cc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new yx(e,n)}_apply(e){const n=function(r,i,s){if(r.startAt!==null)throw new P(k.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new P(k.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Ko(i,s);return function(a,l){if(E0(a)===null){const u=kf(a);u!==null&&AR(a,u,l.field)}}(r,o),o}(e._query,this._field,this._direction);return new kt(e.firestore,e.converter,function(r,i){const s=r.explicitOrderBy.concat([i]);return new Xr(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function cW(t,e="asc"){const n=e,r=qf("orderBy",t);return yx._create(r,n)}class Hf extends cc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Hf(e,n,r)}_apply(e){return new kt(e.firestore,e.converter,_h(e._query,this._limit,this._limitType))}}function dW(t){return hR("limit",t),Hf._create("limit",t,"F")}function hW(t){return hR("limitToLast",t),Hf._create("limitToLast",t,"L")}class zf extends cc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new zf(e,n,r)}_apply(e){const n=CR(e,this.type,this._docOrFields,this._inclusive);return new kt(e.firestore,e.converter,function(r,i){return new Xr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)}(e._query,n))}}function fW(...t){return zf._create("startAt",t,!0)}function pW(...t){return zf._create("startAfter",t,!1)}class Wf extends cc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Wf(e,n,r)}_apply(e){const n=CR(e,this.type,this._docOrFields,this._inclusive);return new kt(e.firestore,e.converter,function(r,i){return new Xr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)}(e._query,n))}}function mW(...t){return Wf._create("endBefore",t,!1)}function gW(...t){return Wf._create("endAt",t,!0)}function CR(t,e,n,r){if(n[0]=J(n[0]),n[0]instanceof Cu)return function(i,s,o,a,l){if(!a)throw new P(k.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const h of As(i))if(h.field.isKeyField())u.push(qs(s,a.key));else{const p=a.data.field(h.field);if(Af(p))throw new P(k.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const m=h.field.canonicalString();throw new P(k.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}u.push(p)}return new ji(u,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=io(t.firestore);return function(s,o,a,l,u,h){const p=s.explicitOrderBy;if(u.length>p.length)throw new P(k.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let g=0;g<u.length;g++){const y=u[g];if(p[g].field.isKeyField()){if(typeof y!="string")throw new P(k.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof y}`);if(!C0(s)&&y.indexOf("/")!==-1)throw new P(k.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${y}' contains a slash.`);const w=s.path.child(he.fromString(y));if(!j.isDocumentKey(w))throw new P(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${w}' is not because it contains an odd number of segments.`);const T=new j(w);m.push(qs(o,T))}else{const w=TR(a,l,y);m.push(w)}}return new ji(m,h)}(t._query,t.firestore._databaseId,i,e,n,r)}}function pS(t,e,n){if(typeof(n=J(n))=="string"){if(n==="")throw new P(k.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!C0(e)&&n.indexOf("/")!==-1)throw new P(k.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(he.fromString(n));if(!j.isDocumentKey(r))throw new P(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return qs(t,new j(r))}if(n instanceof Pe)return qs(t,n._key);throw new P(k.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jf(n)}.`)}function mS(t,e){if(!Array.isArray(t)||t.length===0)throw new P(k.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function NR(t,e){if(e.isInequality()){const r=kf(t),i=e.field;if(r!==null&&!r.isEqual(i))throw new P(k.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=E0(t);s!==null&&AR(t,i,s)}const n=function(r,i){for(const s of r)for(const o of s.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new P(k.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(k.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function AR(t,e,n){if(!n.isEqual(e))throw new P(k.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class vx{convertValue(e,n="none"){switch(Bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ui(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw q()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return no(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new $f(qe(e.latitude),qe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=S0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(wu(e));default:return null}}convertTimestamp(e){const n=Li(e);return new Ue(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=he.fromString(e);K(Ik(r));const i=new Fi(r.get(1),r.get(3)),s=new j(r.popFirst(5));return i.isEqual(n)||Ke(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class yW extends vx{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hr extends Cu{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ol(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(qf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ol extends Hr{data(e={}){return super.data(e)}}class Bi{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new _s(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ol(this._firestore,this._userDataWriter,r.key,r,new _s(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new P(k.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(o=>{const a=new Ol(r._firestore,r._userDataWriter,o.doc.key,o.doc,new _s(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const a=new Ol(r._firestore,r._userDataWriter,o.doc.key,o.doc,new _s(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let l=-1,u=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:vW(o.type),doc:a,oldIndex:l,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function vW(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function kR(t,e){return t instanceof Hr&&e instanceof Hr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Bi&&e instanceof Bi&&t._firestore===e._firestore&&mR(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xW(t){t=pe(t,Pe);const e=pe(t.firestore,He);return lR(vt(e),t._key).then(n=>xx(e,t,n))}class oo extends vx{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}}function wW(t){t=pe(t,Pe);const e=pe(t.firestore,He),n=vt(e),r=new oo(e);return F8(n,t._key).then(i=>new Hr(e,r,t._key,i,new _s(i!==null&&i.hasLocalMutations,!0),t.converter))}function _W(t){t=pe(t,Pe);const e=pe(t.firestore,He);return lR(vt(e),t._key,{source:"server"}).then(n=>xx(e,t,n))}function TW(t){t=pe(t,kt);const e=pe(t.firestore,He),n=vt(e),r=new oo(e);return ER(t._query),uR(n,t._query).then(i=>new Bi(e,r,t,i))}function IW(t){t=pe(t,kt);const e=pe(t.firestore,He),n=vt(e),r=new oo(e);return O8(n,t._query).then(i=>new Bi(e,r,t,i))}function SW(t){t=pe(t,kt);const e=pe(t.firestore,He),n=vt(e),r=new oo(e);return uR(n,t._query,{source:"server"}).then(i=>new Bi(e,r,t,i))}function gS(t,e,n){t=pe(t,Pe);const r=pe(t.firestore,He),i=Kf(t.converter,e,n);return dc(r,[Bf(io(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Le.none())])}function yS(t,e,n,...r){t=pe(t,Pe);const i=pe(t.firestore,He),s=io(i);let o;return o=typeof(e=J(e))=="string"||e instanceof Vi?hx(s,"updateDoc",t._key,e,n,r):dx(s,"updateDoc",t._key,e),dc(i,[o.toMutation(t._key,Le.exists(!0))])}function bW(t){return dc(pe(t.firestore,He),[new Ma(t._key,Le.none())])}function EW(t,e){const n=pe(t.firestore,He),r=Ah(t),i=Kf(t.converter,e);return dc(n,[Bf(io(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Le.exists(!1))]).then(()=>r)}function RR(t,...e){var n,r,i;t=J(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||dy(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(dy(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,h;if(t instanceof Pe)u=pe(t.firestore,He),h=Pa(t._key.path),l={next:p=>{e[o]&&e[o](xx(u,t,p))},error:e[o+1],complete:e[o+2]};else{const p=pe(t,kt);u=pe(p.firestore,He),h=p._query;const m=new oo(u);l={next:g=>{e[o]&&e[o](new Bi(u,m,p,g))},error:e[o+1],complete:e[o+2]},ER(t._query)}return function(p,m,g,y){const w=new Ff(y),T=new X0(m,w,g);return p.asyncQueue.enqueueAndForget(async()=>J0(await ga(p),T)),()=>{w.Dc(),p.asyncQueue.enqueueAndForget(async()=>Y0(await ga(p),T))}}(vt(u),h,a,l)}function CW(t,e){return j8(vt(t=pe(t,He)),dy(e)?e:{next:e})}function dc(t,e){return function(n,r){const i=new ft;return n.asyncQueue.enqueueAndForget(async()=>f8(await lx(n),r,i)),i.promise}(vt(t),e)}function xx(t,e,n){const r=n.docs.get(e._key),i=new oo(t);return new Hr(t,i,e._key,r,new _s(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NW={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AW{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=io(e)}set(e,n,r){this._verifyNotCommitted();const i=fi(e,this._firestore),s=Kf(i.converter,n,r),o=Bf(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Le.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=fi(e,this._firestore);let o;return o=typeof(n=J(n))=="string"||n instanceof Vi?hx(this._dataReader,"WriteBatch.update",s._key,n,r,i):dx(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Le.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=fi(e,this._firestore);return this._mutations=this._mutations.concat(new Ma(n._key,Le.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(k.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function fi(t,e){if((t=J(t)).firestore!==e)throw new P(k.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kW extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=io(e)}get(e){const n=fi(e,this._firestore),r=new yW(this._firestore);return this._transaction.lookup([n._key]).then(i=>{if(!i||i.length!==1)return q();const s=i[0];if(s.isFoundDocument())return new Cu(this._firestore,r,s.key,s,n.converter);if(s.isNoDocument())return new Cu(this._firestore,r,n._key,null,n.converter);throw q()})}set(e,n,r){const i=fi(e,this._firestore),s=Kf(i.converter,n,r),o=Bf(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,n,r,...i){const s=fi(e,this._firestore);let o;return o=typeof(n=J(n))=="string"||n instanceof Vi?hx(this._dataReader,"Transaction.update",s._key,n,r,i):dx(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,o),this}delete(e){const n=fi(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=fi(e,this._firestore),r=new oo(this._firestore);return super.get(e).then(i=>new Hr(this._firestore,r,n._key,i._document,new _s(!1,!1),n.converter))}}function RW(t,e,n){t=pe(t,He);const r=Object.assign(Object.assign({},NW),n);return function(i){if(i.maxAttempts<1)throw new P(k.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,s,o){const a=new ft;return i.asyncQueue.enqueueAndForget(async()=>{const l=await M8(i);new P8(i.asyncQueue,l,o,s,a).run()}),a.promise}(vt(t),i=>e(new kW(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PW(){return new uc("deleteField")}function DW(){return new cx("serverTimestamp")}function MW(...t){return new iW("arrayUnion",t)}function LW(...t){return new sW("arrayRemove",t)}function UW(t){return new oW("increment",t)}(function(t,e=!0){(function(n){Ra=n})(Wi),$n(new Yt("firestore",(n,{instanceIdentifier:r,options:i})=>{const s=n.getProvider("app").getImmediate(),o=new He(new q9(n.getProvider("auth-internal")),new W9(n.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new P(k.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fi(a.options.projectId,l)}(s,r),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),pn(hI,"3.13.0",t),pn(hI,"3.13.0","esm2017")})();const FW="@firebase/firestore-compat",OW="0.3.12";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wx(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function xS(){if(!xH())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}let PR=class fy{constructor(e){this._delegate=e}static fromBase64String(e){return xS(),new fy(Tr.fromBase64String(e))}static fromUint8Array(e){return vS(),new fy(Tr.fromUint8Array(e))}toBase64(){return xS(),this._delegate.toBase64()}toUint8Array(){return vS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t){return jW(t,["next","error","complete"])}function jW(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $W{enableIndexedDbPersistence(e,n){return W8(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return K8(e._delegate)}clearIndexedDbPersistence(e){return J8(e._delegate)}}class DR{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Fi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&er("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){B8(this._delegate,e,n,r)}enableNetwork(){return Q8(this._delegate)}disableNetwork(){return X8(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,dR("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Y8(this._delegate)}onSnapshotsInSync(e){return CW(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ya(this,fR(this._delegate,e))}catch(n){throw Ht(n,"collection()","Firestore.collection()")}}doc(e){try{return new Mn(this,Ah(this._delegate,e))}catch(n){throw Ht(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Gt(this,q8(this._delegate,e))}catch(n){throw Ht(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return RW(this._delegate,n=>e(new MR(this,n)))}batch(){return vt(this._delegate),new LR(new AW(this._delegate,e=>dc(this._delegate,e)))}loadBundle(e){return Z8(this._delegate,e)}namedQuery(e){return eW(this._delegate,e).then(n=>n?new Gt(this,n):null)}}class Jf extends vx{constructor(e){super(),this.firestore=e}convertBytes(e){return new PR(new Tr(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Mn.forKey(n,this.firestore,null)}}function VW(t){j9(t)}class MR{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Jf(e)}get(e){const n=Ts(e);return this._delegate.get(n).then(r=>new Nu(this._firestore,new Hr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Ts(e);return r?(wx("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Ts(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Ts(e);return this._delegate.delete(n),this}}class LR{constructor(e){this._delegate=e}set(e,n,r){const i=Ts(e);return r?(wx("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Ts(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Ts(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Ys{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new Ol(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Au(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Ys.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new Ys(e,new Jf(e),n),i.set(n,s)),s}}Ys.INSTANCES=new WeakMap;class Mn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Jf(e)}static forPath(e,n,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Mn(n,new Pe(n._delegate,r,new j(e)))}static forKey(e,n,r){return new Mn(n,new Pe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ya(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ya(this.firestore,fR(this._delegate,e))}catch(n){throw Ht(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=J(e),e instanceof Pe?pR(this._delegate,e):!1}set(e,n){n=wx("DocumentReference.set",n);try{return n?gS(this._delegate,e,n):gS(this._delegate,e)}catch(r){throw Ht(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?yS(this._delegate,e):yS(this._delegate,e,n,...r)}catch(i){throw Ht(i,"updateDoc()","DocumentReference.update()")}}delete(){return bW(this._delegate)}onSnapshot(...e){const n=UR(e),r=FR(e,i=>new Nu(this.firestore,new Hr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return RR(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=wW(this._delegate):(e==null?void 0:e.source)==="server"?n=_W(this._delegate):n=xW(this._delegate),n.then(r=>new Nu(this.firestore,new Hr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Mn(this.firestore,e?this._delegate.withConverter(Ys.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ht(t,e,n){return t.message=t.message.replace(e,n),t}function UR(t){for(const e of t)if(typeof e=="object"&&!py(e))return e;return{}}function FR(t,e){var n,r;let i;return py(t[0])?i=t[0]:py(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Nu{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Mn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return kR(this._delegate,e._delegate)}}class Au extends Nu{data(e){const n=this._delegate.data(e);return $9(n!==void 0),n}}class Gt{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Jf(e)}where(e,n,r){try{return new Gt(this.firestore,oi(this._delegate,uW(e,n,r)))}catch(i){throw Ht(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Gt(this.firestore,oi(this._delegate,cW(e,n)))}catch(r){throw Ht(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Gt(this.firestore,oi(this._delegate,dW(e)))}catch(n){throw Ht(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Gt(this.firestore,oi(this._delegate,hW(e)))}catch(n){throw Ht(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Gt(this.firestore,oi(this._delegate,fW(...e)))}catch(n){throw Ht(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Gt(this.firestore,oi(this._delegate,pW(...e)))}catch(n){throw Ht(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Gt(this.firestore,oi(this._delegate,mW(...e)))}catch(n){throw Ht(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Gt(this.firestore,oi(this._delegate,gW(...e)))}catch(n){throw Ht(n,"endAt()","Query.endAt()")}}isEqual(e){return mR(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=IW(this._delegate):(e==null?void 0:e.source)==="server"?n=SW(this._delegate):n=TW(this._delegate),n.then(r=>new my(this.firestore,new Bi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=UR(e),r=FR(e,i=>new my(this.firestore,new Bi(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return RR(this._delegate,n,r)}withConverter(e){return new Gt(this.firestore,e?this._delegate.withConverter(Ys.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class BW{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Au(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class my{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Gt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Au(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new BW(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Au(this._firestore,r))})}isEqual(e){return kR(this._delegate,e._delegate)}}class ya extends Gt{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Mn(this.firestore,e):null}doc(e){try{return e===void 0?new Mn(this.firestore,Ah(this._delegate)):new Mn(this.firestore,Ah(this._delegate,e))}catch(n){throw Ht(n,"doc()","CollectionReference.doc()")}}add(e){return EW(this._delegate,e).then(n=>new Mn(this.firestore,n))}isEqual(e){return pR(this._delegate,e._delegate)}withConverter(e){return new ya(this.firestore,e?this._delegate.withConverter(Ys.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ts(t){return pe(t,Pe)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(...e){this._delegate=new Vi(...e)}static documentId(){return new _x(Je.keyField().canonicalString())}isEqual(e){return e=J(e),e instanceof Vi?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this._delegate=e}static serverTimestamp(){const e=DW();return e._methodName="FieldValue.serverTimestamp",new fs(e)}static delete(){const e=PW();return e._methodName="FieldValue.delete",new fs(e)}static arrayUnion(...e){const n=MW(...e);return n._methodName="FieldValue.arrayUnion",new fs(n)}static arrayRemove(...e){const n=LW(...e);return n._methodName="FieldValue.arrayRemove",new fs(n)}static increment(e){const n=UW(e);return n._methodName="FieldValue.increment",new fs(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qW={Firestore:DR,GeoPoint:$f,Timestamp:Ue,Blob:PR,Transaction:MR,WriteBatch:LR,DocumentReference:Mn,DocumentSnapshot:Nu,Query:Gt,QueryDocumentSnapshot:Au,QuerySnapshot:my,CollectionReference:ya,FieldPath:_x,FieldValue:fs,setLogLevel:VW,CACHE_SIZE_UNLIMITED:z8};function GW(t,e){t.INTERNAL.registerComponent(new Yt("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},qW)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HW(t){GW(t,(e,n)=>new DR(e,n,new $W)),t.registerVersion(FW,OW)}HW(mn);const zW=[{id:"1",username:" ",email:"student@example.com",phone:"0791234567",password:"password123",userType:"Student",serviceType:"",educationStage:" /",grade:" ",curriculum:"  ",subjects:["",""],age:"15"}],WW=[{id:"1",name:" ",email:"ahmad@jotutor.com",permissions:"Manage Teachers"},{id:"2",name:" ",email:"sara@jotutor.com",permissions:"Full Control"}],KW=[{id:"101",date:new Date("2023-10-26T10:00:00Z").toISOString(),userId:"1",userName:" ",courseId:"c1",courseName:"   ",amount:179,currency:"JOD",status:"Success"},{id:"102",date:new Date("2023-10-25T14:30:00Z").toISOString(),userId:"2",userName:" ",courseId:"c3",courseName:"   ",amount:247,currency:"JOD",status:"Failed"}],JW=[{id:"1",name:" ",avatarUrl:"https://i.ibb.co/6yv0fbv/image.jpg",level:" ",experience:8,specialties:["",""],rating:4.9,reviews:120,pricePerHour:25,bio:"                .",qualifications:["  "," "]},{id:"2",name:" ",avatarUrl:"https://i.ibb.co/yQj50tq/image.jpg",level:" ",experience:12,specialties:[" ","  TOEFL"],rating:5,reviews:250,pricePerHour:35,bio:"               .",qualifications:["   "," TESOL"]}],YW=[{id:"c1",title:"Primary Stage Std 8Sessions X 2Hours",description:"   8   .",priceJod:179,priceUsd:252,priceSar:948,duration:"8 Sessions",level:"",category:"",teacher:" ",imageUrl:"https://i.ibb.co/W2zXzLg/image.jpg",isFeatured:!0,sessionCount:8,totalHours:16},{id:"c2",title:"Secondary to High Std 8Sessions X 2Hours",description:"    8   .",priceJod:247,priceUsd:348,priceSar:1309,duration:"8 Sessions",level:" / ",category:"",teacher:" ",imageUrl:"https://i.ibb.co/R2W74zN/image.jpg",sessionCount:8,totalHours:16},{id:"c3",title:"Foundation Educ Fnd 8Sessions X 2Hours",description:"  8   .",priceJod:229,priceUsd:323,priceSar:1213,duration:"8 Sessions",level:"",category:"",teacher:" ",imageUrl:"https://i.ibb.co/yqgzk8N/image.jpg",sessionCount:8,totalHours:16}],QW=[{id:"1",name:" ",role:" ",avatarUrl:"https://i.ibb.co/Jqj3B2W/image.jpg",quote:" !          .      ."}],XW=[{id:"1",title:"5   ",author:" JoTutor",date:"2023-10-15T12:00:00Z",excerpt:"   ...",imageUrl:"https://i.ibb.co/L8zB3Sy/image.jpg",tags:[""],type:"article",content:"<p> </p>"}],ZW=[{id:"1",title:"     ",description:"       ",imageUrl:"https://i.ibb.co/4ZRTCY4g/image.jpg"}],e7={featuresTitle:"  JoTutor",featuresSubtitle:"        .",feature1Title:" ",feature1Desc:"    .",feature2Title:" ",feature2Desc:"   .",feature3Title:"  ",feature3Desc:"   .",howItWorksTitle:" ",howItWorksSubtitle:"     .",step1Title:"  ",step1Desc:"  .",step2Title:" ",step2Desc:"  .",step3Title:" ",step3Desc:"    .",teacherSearchTitle:"   ",teacherSearchSubtitle:"   .",discoverMoreTeachers:"   ",coursesPreviewTitle:" ",coursesPreviewSubtitle:"  .",discoverMoreCourses:"   ",testimonialsTitle:"  ",testimonialsSubtitle:"    .",aiPlannerTitle:"  ",aiPlannerSubtitle:"    ."},t7={heroImage:"https://i.ibb.co/YFL8kfwv/image.jpg",aboutTitle:" JoTutor",visionTitle:"",vision:"    .",visionImage:"https://i.ibb.co/4ZRTCY4g/image.jpg",missionTitle:"",mission:"   .",teacherCommunityTitle:"",teacherCommunity:"   .",whyJoTutorTitle:" ",whyJoTutor:[" "," "]},n7={serviceTypes:["","",""," ",""],educationStages:["","","/","",""],curriculums:["  "," "," "],subjects:["",""," "],languages:["",""]},r7={homepage:e7,about:t7,faq:[{id:"1",question:" ",answer:"  ."}],contact:{email:"contact@jotutor.com",phone:"+962 79 123 4567",address:", ",facebook:"#",instagram:"#",youtube:"#",linkedin:"#"},privacy:"  ",terms:" "},ai={users:zW,staff:WW,payments:KW,teachers:JW,courses:YW,testimonials:QW,blogPosts:XW,heroSlides:ZW,siteContent:r7,onboardingOptions:n7},i7={apiKey:"AIzaSyD22o_UCJ7xrbawNuIlACvFtbQB9HeUn9g",authDomain:"jototur-2f755.firebaseapp.com",projectId:"jototur-2f755",storageBucket:"jototur-2f755.appspot.com",messagingSenderId:"122916103662",appId:"1:122916103662:web:bd7ef6e0c6d7be0a2bdaff",measurementId:"G-YSH7WBLZYB"};let wS;try{mn.apps.length?wS=mn.app():wS=mn.initializeApp(i7)}catch(t){console.error("Firebase initialization failed:",t)}const Vt=mn.auth?mn.auth():null,Ut=mn.firestore?mn.firestore():null,Yf={Users:"users",Teachers:"teachers",Courses:"courses",Staff:"staff",Payments:"payments",Testimonials:"testimonials",Blog:"blogPosts",HeroSlides:"heroSlides"},s7=["Teachers","Courses","Testimonials","Blog","HeroSlides"],ku=t=>{if(Array.isArray(t))return t.map(ku);if(t!==null&&typeof t=="object"){const e={};return Object.keys(t).forEach(n=>{const r=ku(t[n]);r!==void 0&&(e[n]=r)}),e}return t},OR=async()=>{if(!Ut)return{success:!1,data:{}};const t={},e=[];for(const r of s7){const i=Yf[r],s=Ut.collection(i).get().then(o=>{const a=o.docs.map(u=>({...u.data(),id:u.id})),l=i==="blogPosts"?"blog":i;t[l]=a});e.push(s)}const n=Ut.collection("config").doc("main").get().then(r=>{r.exists?t.config=r.data():(console.warn("Config document 'main' does not exist in Firestore."),t.config={siteContent:null,siteContentEn:null,onboardingOptions:null})});return e.push(n),await Promise.all(e),{success:!0,data:t}},o7=async()=>{if(!Ut)return{success:!1,data:{}};const t={},e=[],n=["Users","Staff","Payments"];for(const r of n){const i=Yf[r];try{const o=(await Ut.collection(i).get()).docs.map(a=>({...a.data(),id:a.id}));t[r]=o}catch{e.push(r)}}return{success:e.length===0,data:t,failedCollections:e}},a7=t=>Vt?Vt.onAuthStateChanged(t):()=>{},al=async(t,e)=>{if(!Ut)return{success:!1,error:"Database not initialized"};const n=Yf[t],r=Ut.batch(),i=Ut.collection(n);try{const s=ku(e),o=await i.get(),a=new Set(o.docs.map(u=>u.id)),l=new Set(s.map(u=>u.id.toString()));return s.forEach(u=>{const{id:h,...p}=u,m=i.doc(h.toString());r.set(m,p)}),a.forEach(u=>{l.has(u)||r.delete(i.doc(u))}),await r.commit(),{success:!0}}catch(s){return console.error(`Error overwriting ${n}:`,s),{success:!1,error:s.message}}},am=async t=>{if(!Ut)return{success:!1,error:"Database not initialized"};try{const e=ku(t);return await Ut.collection("config").doc("main").set(e,{merge:!0}),{success:!0}}catch(e){return console.error("Error updating Firestore config:",e),{success:!1,error:e.message}}},Jc=async(t,e,n)=>{if(!Ut)return{success:!1,error:"Database not initialized"};const r=Yf[t];try{const i=ku(n);return await Ut.collection(r).doc(e).set(i,{merge:!0}),{success:!0}}catch(i){return{success:!1,error:i.message}}},l7=({onNavigate:t,strings:e})=>{const n=document.documentElement.lang==="en",[r,i]=N.useState(null),[s,o]=N.useState({facebook:"",instagram:"",youtube:"",linkedin:""});N.useEffect(()=>{OR().then(h=>{var p;if(h.success&&((p=h.data.config)!=null&&p.siteContent)){const m=h.data.config.siteContent;m.footer&&i(m.footer),m.contact&&o({facebook:m.contact.facebook||"#",instagram:m.contact.instagram||"#",youtube:m.contact.youtube||"#",linkedin:m.contact.linkedin||"#"})}})},[]);const a=[{label:e.navAbout,page:"about"},{label:e.footerJoinTeacher,page:"join"},{label:e.footerFAQ,page:"faq"},{label:e.navBlog,page:"blog"}],l=[{label:e.privacyTitle,page:"privacy"},{label:e.termsTitle,page:"terms"},{label:e.paymentRefundTitle,page:"payment-refund"}],u="https://docs.google.com/forms/d/e/1FAIpQLSdR8nxLM30CJgzGiBLyeY9Txcug_YfrRXa2xMVYOUe0ldSUZw/viewform?usp=sf_link";return c.jsx("footer",{className:"bg-blue-900 text-white",children:c.jsxs("div",{className:"container mx-auto px-6 py-12",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsxs("button",{onClick:()=>t("home"),className:"flex items-center space-x-2 space-x-reverse mb-4",children:[c.jsx("img",{src:"https://i.ibb.co/XxGsLR3D/15.png",alt:"JoTutor Logo",className:"h-10 w-auto bg-white rounded-md p-1"}),c.jsx("span",{className:"font-bold text-2xl",children:"JoTutor"})]}),c.jsx("p",{className:"text-blue-200",children:n?(r==null?void 0:r.description_en)||e.footerDescription:(r==null?void 0:r.description)||e.footerDescription})]}),c.jsxs("div",{children:[c.jsx("h5",{className:"font-bold text-lg mb-4",children:e.footerQuickLinks}),c.jsx("ul",{className:"space-y-2",children:a.map(h=>c.jsx("li",{children:h.page==="join"?c.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"text-blue-200 hover:text-white transition-colors",children:h.label}):c.jsx("button",{onClick:()=>t(h.page),className:"text-blue-200 hover:text-white transition-colors",children:h.label})},h.page))})]}),c.jsxs("div",{children:[c.jsx("h5",{className:"font-bold text-lg mb-4",children:e.footerLegal}),c.jsx("ul",{className:"space-y-2",children:l.map(h=>c.jsx("li",{children:c.jsx("button",{onClick:()=>t(h.page),className:"text-blue-200 hover:text-white transition-colors",children:h.label})},h.page))})]})]}),c.jsxs("div",{className:"mt-12 border-t border-blue-800 pt-8 flex flex-col md:flex-row justify-between items-center",children:[c.jsxs("p",{className:"text-blue-300 text-sm",children:[" ",new Date().getFullYear()," ",n?(r==null?void 0:r.rights_en)||e.footerRights:(r==null?void 0:r.rights)||e.footerRights]}),c.jsxs("div",{className:"flex space-x-4 space-x-reverse mt-4 md:mt-0",children:[s.facebook!=="#"&&c.jsx("a",{href:s.facebook,target:"_blank",rel:"noopener noreferrer",className:"text-blue-300 hover:text-white transition-all p-2 bg-blue-800 rounded-full hover:scale-110","aria-label":"Facebook",children:c.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"})})}),s.instagram!=="#"&&c.jsx("a",{href:s.instagram,target:"_blank",rel:"noopener noreferrer",className:"text-blue-300 hover:text-white transition-all p-2 bg-blue-800 rounded-full hover:scale-110","aria-label":"Instagram",children:c.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})}),s.youtube!=="#"&&c.jsx("a",{href:s.youtube,target:"_blank",rel:"noopener noreferrer",className:"text-blue-300 hover:text-white transition-all p-2 bg-blue-800 rounded-full hover:scale-110","aria-label":"YouTube",children:c.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})})}),s.linkedin!=="#"&&c.jsx("a",{href:s.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-blue-300 hover:text-white transition-all p-2 bg-blue-800 rounded-full hover:scale-110","aria-label":"LinkedIn",children:c.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})]})]})})},u7=({initialView:t,onClose:e,onLogin:n,onSwitchToOnboarding:r,strings:i})=>{const[s,o]=N.useState(t),[a,l]=N.useState(""),[u,h]=N.useState(""),[p,m]=N.useState(!1),[g,y]=N.useState(""),w=async x=>{x.preventDefault(),y(""),await n(a,u)||y(i.errorInvalidCredentials||"Invalid email or password.")},T="https://docs.google.com/forms/d/e/1FAIpQLSdR8nxLM30CJgzGiBLyeY9Txcug_YfrRXa2xMVYOUe0ldSUZw/viewform?usp=sf_link";return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md relative animate-fade-in-up",children:[c.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors z-10",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsxs("div",{className:"p-8",children:[c.jsxs("div",{className:"flex border-b mb-6",children:[c.jsx("button",{onClick:()=>o("login"),className:`flex-1 py-2 text-center font-bold transition-colors ${s==="login"?"border-b-2 border-green-500 text-green-600":"text-gray-500 hover:text-gray-700"}`,children:i.login}),c.jsx("button",{onClick:()=>o("signup"),className:`flex-1 py-2 text-center font-bold transition-colors ${s==="signup"?"border-b-2 border-green-500 text-green-600":"text-gray-500 hover:text-gray-700"}`,children:i.signup})]}),s==="login"?c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-center text-blue-900 mb-6",children:i.loginWelcome}),c.jsxs("form",{onSubmit:w,className:"space-y-4",children:[c.jsx("div",{children:c.jsx("input",{type:"email",placeholder:i.email,value:a,onChange:x=>l(x.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none",required:!0})}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:p?"text":"password",placeholder:i.password,value:u,onChange:x=>h(x.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none pr-12 ltr:pr-12 rtl:pl-12",required:!0}),c.jsx("button",{type:"button",onClick:()=>m(!p),className:"absolute inset-y-0 ltr:right-0 rtl:left-0 flex items-center px-4 text-gray-400 hover:text-green-600 transition-colors",title:p?"  ":"  ",children:p?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l18 18"})}):c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),g&&c.jsx("p",{className:"text-red-500 text-sm text-center font-bold bg-red-50 p-2 rounded",children:g}),c.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white font-black py-3 rounded-lg hover:bg-green-600 transition-all active:scale-95 shadow-md",children:i.login})]})]}):c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-4",children:i.signupTitle}),c.jsx("p",{className:"text-gray-600 mb-6",children:i.signupDesc}),c.jsx("button",{onClick:r,className:"w-full bg-green-500 text-white font-black py-3 rounded-lg hover:bg-green-600 transition-all active:scale-95 shadow-md",children:i.signupNewStudent}),c.jsx("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:"w-full inline-block mt-3 bg-blue-900 text-white font-black py-3 rounded-lg hover:bg-blue-800 transition-all active:scale-95 shadow-md",children:i.signupJoinTeacher})]})]})]})})},c7=({currentStep:t,totalSteps:e})=>{const n=Array.from({length:e},(r,i)=>i+1);return c.jsx("div",{className:"flex items-center justify-center mb-6 px-4",children:n.map((r,i)=>c.jsxs(DS.Fragment,{children:[c.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold transition-colors duration-300 ${t>=r?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}`,children:r}),i<e-1&&c.jsx("div",{className:`flex-1 h-0.5 transition-colors duration-300 ${t>r?"bg-green-500":"bg-gray-200"}`})]},r))})},d7=({options:t,onSignupSuccess:e,onClose:n,strings:r,language:i="ar"})=>{var $t,O,Y,X,ge,ye,yn,ze;const[s,o]=N.useState(1),[a,l]=N.useState("+962"),[u,h]=N.useState({userType:"Student",subjects:[],serviceType:i==="en"&&(($t=t.serviceTypes_en)!=null&&$t.length)?t.serviceTypes_en[0]:(O=t.serviceTypes)==null?void 0:O[0],educationStage:i==="en"&&((Y=t.educationStages_en)!=null&&Y.length)?t.educationStages_en[0]:(X=t.educationStages)==null?void 0:X[0],curriculum:"",phone:""}),[p,m]=N.useState(!1),[g,y]=N.useState(""),[w,T]=N.useState(!1),x=[{code:"+962",flag:"",name:""},{code:"+966",flag:"",name:""},{code:"+971",flag:"",name:""},{code:"+965",flag:"",name:""},{code:"+974",flag:"",name:""},{code:"+973",flag:"",name:""},{code:"+20",flag:"",name:""},{code:"+970",flag:"",name:""}],v=_e=>{var ue,Ie,xt,Fe,Zt;switch(y(""),_e){case 4:if(!((ue=u.grade)!=null&&ue.trim()))return y(r.errorGradeRequired),!1;break;case 5:if(!u.curriculum)return y(i==="en"?"Please select at least one curriculum.":"     ."),!1;break;case 6:if(!u.subjects||u.subjects.length===0)return y(r.errorSubjectsRequired),!1;break;case 7:if(!((Ie=u.username)!=null&&Ie.trim()))return y(r.errorFullNameRequired),!1;if(!((xt=u.age)!=null&&xt.trim()))return y(r.errorAgeRequired),!1;if(!((Fe=u.phone)!=null&&Fe.trim()))return y(r.errorPhoneRequired),!1;const en=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!((Zt=u.email)!=null&&Zt.trim())||!en.test(u.email))return y(r.errorEmailInvalid),!1;if(!u.password||u.password.length<6)return y(r.errorPasswordInvalid),!1;break}return!0},_=()=>{v(s)&&o(_e=>_e+1)},b=()=>{y(""),o(_e=>_e-1)},S=(_e,ue)=>{y(""),h(Ie=>({...Ie,[_e]:ue}))},I=_e=>{y(""),h(ue=>{const Ie=ue.subjects||[],xt=Ie.includes(_e)?Ie.filter(Fe=>Fe!==_e):[...Ie,_e];return{...ue,subjects:xt}})},E=_e=>{y(""),h(ue=>{const Ie=ue.curriculum?ue.curriculum.split(", "):[];let xt;return Ie.includes(_e)?xt=Ie.filter(Fe=>Fe!==_e):xt=[...Ie,_e],{...ue,curriculum:xt.join(", ")}})},R=async _e=>{var Fe;if(_e.preventDefault(),y(""),!p){y(r.errorAgreeToTerms);return}if(!v(7))return;T(!0);const ue=`${a}${(Fe=u.phone)==null?void 0:Fe.replace(/^0+/,"")}`,Ie={id:Date.now().toString(),username:u.username||"",email:u.email||"",phone:ue,password:u.password||"",userType:u.userType||"Student",serviceType:u.serviceType||"",educationStage:u.educationStage||"",grade:u.grade||"",curriculum:u.curriculum||"",subjects:u.subjects||[],age:u.age||""},xt=await e(Ie);xt&&y(xt),T(!1)},F=8,M=i==="en"&&((ge=t.serviceTypes_en)!=null&&ge.length)?t.serviceTypes_en:t.serviceTypes,Q=i==="en"&&((ye=t.educationStages_en)!=null&&ye.length)?t.educationStages_en:t.educationStages,ne=i==="en"&&((yn=t.curriculums_en)!=null&&yn.length)?t.curriculums_en:t.curriculums,se=i==="en"&&((ze=t.subjects_en)!=null&&ze.length)?t.subjects_en:t.subjects,ae={[M[0]]:r.serviceType1Desc,[M[1]]:r.serviceType2Desc,[M[2]]:r.serviceType3Desc,[M[3]]:r.serviceType4Desc,[M[4]]:r.serviceType5Desc},Te={[Q[0]]:r.educationStage1Desc,[Q[1]]:r.educationStage2Desc,[Q[2]]:r.educationStage3Desc,[Q[3]]:r.educationStage4Desc,[Q[4]]:r.educationStage5Desc},Ee=()=>{var _e;switch(s){case 1:return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-center mb-2",children:r.onboardingStep1Title}),c.jsx("p",{className:"text-center text-gray-600 mb-6",children:r.onboardingStep1Desc}),c.jsx("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:["Student","Parent"].map(G=>c.jsx("button",{type:"button",onClick:()=>S("userType",G),className:`p-4 border rounded-lg w-full sm:w-40 text-center transition-all duration-200 ${u.userType===G?"bg-green-100 border-green-500 ring-2 ring-green-500":"bg-white hover:border-green-400"}`,children:r[`userType${G}`]},G))})]});case 2:return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-center mb-2",children:r.onboardingStep2Title}),c.jsx("p",{className:"text-center text-gray-600 mb-6",children:r.onboardingStep2Desc}),c.jsx("div",{className:"space-y-3",children:M.map(G=>c.jsxs("button",{type:"button",onClick:()=>S("serviceType",G),className:`w-full text-right p-3 border rounded-lg transition-all duration-200 ${u.serviceType===G?"bg-green-100 border-green-500 ring-2 ring-green-500":"bg-white hover:border-green-400"}`,children:[c.jsx("span",{className:"font-semibold text-blue-900",children:G}),c.jsx("p",{className:"text-sm text-gray-600",children:ae[G]})]},G))})]});case 3:return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-center mb-2",children:r.onboardingStep3Title}),c.jsx("p",{className:"text-center text-gray-600 mb-6",children:r.onboardingStep3Desc}),c.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto pr-2",children:Q.map(G=>c.jsxs("button",{type:"button",onClick:()=>S("educationStage",G),className:`w-full text-right p-3 border rounded-lg transition-all duration-200 ${u.educationStage===G?"bg-green-100 border-green-500 ring-2 ring-green-500":"bg-white hover:border-green-400"}`,children:[c.jsx("span",{className:"font-semibold text-blue-900",children:G}),c.jsx("p",{className:"text-sm text-gray-600",children:Te[G]})]},G))})]});case 4:const xt=i==="ar"?[" 1"," 2"," "," "," "," "," "," "," "," "," "," ","  ","   ()",""]:["KG1","KG2","1st Grade","2nd Grade","3rd Grade","4th Grade","5th Grade","6th Grade","7th Grade","8th Grade","9th Grade","10th Grade","11th Grade","12th Grade","College"];return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-center mb-2",children:r.onboardingStep4Title}),c.jsx("p",{className:"text-center text-gray-600 mb-6",children:r.onboardingStep4Desc}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-64 overflow-y-auto pr-2",children:xt.map(G=>c.jsx("button",{type:"button",onClick:()=>S("grade",G),className:`p-2 border rounded-lg text-sm font-medium transition-all duration-200 ${u.grade===G?"bg-green-100 border-green-500 ring-2 ring-green-500 text-green-800":"bg-white hover:border-green-400 text-gray-700"}`,children:G},G))})]});case 5:const Fe=u.curriculum?u.curriculum.split(", "):[];return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-center mb-2",children:r.onboardingStep5Title}),c.jsxs("p",{className:"text-center text-gray-600 mb-6",children:[r.onboardingStep5Desc," ",i==="ar"?"(    )":"(You can select more than one)"]}),c.jsx("div",{className:"space-y-3",children:ne.map(G=>c.jsxs("button",{type:"button",onClick:()=>E(G),className:`w-full text-right p-3 border rounded-lg transition-all duration-200 flex justify-between items-center ${Fe.includes(G)?"bg-green-100 border-green-500 ring-2 ring-green-500":"bg-white hover:border-green-400"}`,children:[c.jsx("span",{className:"font-semibold text-blue-900",children:G}),Fe.includes(G)&&c.jsx("span",{className:"text-green-600 font-bold",children:""})]},G))})]});case 6:const Zt=u.serviceType===t.serviceTypes[4]||u.serviceType===((_e=t.serviceTypes_en)==null?void 0:_e[4]),en=Zt?r.onboardingStep6Title_languages:r.onboardingStep6Title,ti=Zt?r.onboardingStep6Desc_languages:r.onboardingStep6Desc,tn=Zt?t.languages||[]:se;return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-center mb-2",children:en}),c.jsx("p",{className:"text-center text-gray-600 mb-4",children:ti}),c.jsx("div",{className:"flex flex-wrap gap-2 justify-center max-h-48 overflow-y-auto p-2 bg-gray-50 rounded-md",children:tn.map(G=>{var Sr;return c.jsx("button",{type:"button",onClick:()=>I(G),className:`px-4 py-2 border rounded-full text-sm transition-colors ${(Sr=u.subjects)!=null&&Sr.includes(G)?"bg-green-500 text-white border-green-500":"bg-white hover:border-green-400"}`,children:G},G)})})]});case 7:return c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-xl font-semibold text-center mb-2",children:r.onboardingStep7Title}),c.jsx("p",{className:"text-center text-gray-600 mb-4",children:r.onboardingStep7Desc}),c.jsx("input",{type:"text",placeholder:r.fullName,onChange:G=>S("username",G.target.value),value:u.username||"",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 outline-none",required:!0}),c.jsx("input",{type:"number",placeholder:r.age,onChange:G=>S("age",G.target.value),value:u.age||"",className:"w-full p-3 border border-gray-300 rounded-md text-gray-700 focus:ring-2 focus:ring-green-500 outline-none",required:!0,min:"1",max:"100"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("select",{value:a,onChange:G=>l(G.target.value),className:"p-3 border border-gray-300 rounded-md bg-white font-medium text-sm focus:ring-2 focus:ring-green-500 outline-none min-w-[100px]",children:x.map(G=>c.jsxs("option",{value:G.code,children:[G.flag," ",G.code]},G.code))}),c.jsx("input",{type:"tel",placeholder:r.phone,onChange:G=>S("phone",G.target.value),value:u.phone||"",className:"flex-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 outline-none",required:!0})]}),c.jsx("input",{type:"email",placeholder:r.email,onChange:G=>S("email",G.target.value),value:u.email||"",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 outline-none",required:!0}),c.jsx("input",{type:"password",placeholder:r.password,onChange:G=>S("password",G.target.value),value:u.password||"",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 outline-none",required:!0,minLength:6})]});case 8:return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-center mb-2",children:r.onboardingStep8Title}),c.jsx("p",{className:"text-center text-gray-600 mb-6",children:r.onboardingStep8Desc}),c.jsx("div",{className:"bg-blue-50 p-4 rounded-md text-center text-blue-800",children:c.jsx("p",{children:r.verificationMessage})}),c.jsx("div",{className:"mt-6",children:c.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse justify-center",children:[c.jsx("input",{type:"checkbox",checked:p,onChange:G=>m(G.target.checked),className:"h-4 w-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),c.jsx("span",{className:"text-sm text-gray-700",children:r.agreeToTerms})]})})]});default:return null}};return c.jsxs("div",{className:"bg-white rounded-lg shadow-2xl relative p-2 md:p-4",children:[c.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10","aria-label":"Close",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsxs("form",{onSubmit:R,className:"mt-8",children:[c.jsx(c7,{currentStep:s,totalSteps:F}),c.jsx("div",{className:"min-h-[350px] flex flex-col justify-center py-4 bg-gray-50 p-6 rounded-lg shadow-inner",children:Ee()}),g&&c.jsx("p",{className:"text-red-500 text-center text-sm mt-4 font-bold",children:g}),c.jsxs("div",{className:"flex justify-between mt-6",children:[s>1?c.jsx("button",{type:"button",onClick:b,className:"bg-gray-200 text-gray-800 py-2 px-6 rounded-md hover:bg-gray-300 transition-colors font-bold",children:r.back}):c.jsx("div",{}),s<F?c.jsx("button",{type:"button",onClick:_,className:"bg-green-500 text-white py-2 px-6 rounded-md hover:bg-green-600 transition-colors font-bold",children:r.next}):c.jsx("button",{type:"submit",disabled:!p||w,className:"bg-green-500 text-white py-2 px-6 rounded-md hover:bg-green-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed font-bold",children:w?`${r.generating}...`:r.finishSignup})]})]})]})},h7=({username:t,activeView:e,setActiveView:n,onLogout:r,strings:i})=>{const s=[{id:"profile",label:i.dashboardProfile},{id:"courses",label:i.myCourses},{id:"wallet",label:i.dashboardWallet},{id:"ai-assistant",label:i.dashboardAI}];return c.jsxs("aside",{className:"md:w-64 bg-white p-6 rounded-xl shadow-lg flex-shrink-0 w-full",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"w-24 h-24 rounded-full bg-green-500 mx-auto flex items-center justify-center text-white text-4xl font-bold",children:t.charAt(0).toUpperCase()}),c.jsxs("h3",{className:"font-bold text-xl mt-4 text-blue-900",children:[i.welcome,", ",t]})]}),c.jsx("nav",{className:"space-y-2",children:s.map(o=>c.jsx("button",{onClick:()=>n(o.id),className:`w-full text-right p-3 rounded-lg transition-colors ${e===o.id?"bg-blue-900 text-white":"hover:bg-gray-100 text-gray-700"}`,children:c.jsx("span",{className:"font-semibold",children:o.label})},o.id))}),c.jsx("div",{className:"mt-8 border-t pt-4",children:c.jsxs("button",{onClick:r,className:"w-full flex items-center space-x-3 space-x-reverse p-3 rounded-lg text-right transition-colors text-red-500 hover:bg-red-50",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{className:"font-semibold",children:i.logout})]})})]})},_S=({userProfile:t,onUpdate:e})=>{const[n,r]=N.useState(!1),[i,s]=N.useState(!1),[o,a]=N.useState({...t}),[l,u]=N.useState("");N.useEffect(()=>{a({...t})},[t]);const h=w=>{const{name:T,value:x}=w.target;a(v=>({...v,[T]:x}))},p=w=>{w.preventDefault(),l.trim()&&!o.subjects.includes(l.trim())&&(a(T=>({...T,subjects:[...T.subjects,l.trim()]})),u(""))},m=w=>{a(T=>({...T,subjects:T.subjects.filter(x=>x!==w)}))},g=async()=>{s(!0),await e(o)?r(!1):alert("    .   ."),s(!1)},y=()=>{a({...t}),r(!1)};return c.jsxs("div",{className:"animate-fade-in",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h1",{className:"text-3xl font-black text-blue-900",children:" "}),!n&&c.jsxs("button",{onClick:()=>r(!0),className:"bg-blue-900 text-white font-bold py-2 px-6 rounded-xl hover:bg-blue-800 transition-all flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"  "]})]}),c.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl border border-gray-100",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-400 mb-2 uppercase",children:" "}),n?c.jsx("input",{type:"text",name:"username",value:o.username,onChange:h,className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-green-500 font-bold"}):c.jsx("p",{className:"text-lg font-bold text-blue-900 mt-1",children:t.username})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-400 mb-2 uppercase",children:" "}),n?c.jsx("input",{type:"email",name:"email",value:o.email,onChange:h,className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-green-500 font-bold"}):c.jsx("p",{className:"text-lg font-bold text-blue-900 mt-1",children:t.email})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-400 mb-2 uppercase",children:""}),n?c.jsx("input",{type:"number",name:"age",value:o.age,onChange:h,className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-green-500 font-bold"}):c.jsx("p",{className:"text-lg font-bold text-blue-900 mt-1",children:t.age})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-400 mb-2 uppercase",children:" "}),n?c.jsx("input",{type:"text",name:"grade",value:o.grade,onChange:h,className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-green-500 font-bold",placeholder:":  "}):c.jsx("p",{className:"text-lg font-bold text-blue-900 mt-1",children:t.grade})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-400 mb-2 uppercase",children:" "}),c.jsx("p",{className:"text-lg font-bold text-blue-900 mt-1",children:t.userType})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-400 mb-2 uppercase",children:" "}),c.jsx("p",{className:"text-lg font-bold text-blue-900 mt-1",children:t.serviceType})]}),c.jsxs("div",{className:"md:col-span-2 mt-4 pt-6 border-t border-gray-100",children:[c.jsx("label",{className:"block text-xs font-black text-gray-400 mb-4 uppercase",children:"  "}),n&&c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx("input",{type:"text",value:l,onChange:w=>u(w.target.value),className:"flex-1 p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-green-500 font-bold",placeholder:"  ...",onKeyPress:w=>w.key==="Enter"&&p(w)}),c.jsx("button",{onClick:p,className:"bg-green-500 text-white px-6 rounded-xl font-bold hover:bg-green-600 transition-all",children:""})]}),c.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:(n?o.subjects:t.subjects).map(w=>c.jsxs("div",{className:"bg-green-50 text-green-700 text-sm font-black px-4 py-2 rounded-full border border-green-100 flex items-center gap-2",children:[w,n&&c.jsx("button",{onClick:()=>m(w),className:"hover:text-red-500 transition-colors",title:"",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]},w))})]})]}),n&&c.jsxs("div",{className:"mt-12 flex gap-4 pt-8 border-t border-gray-100",children:[c.jsx("button",{onClick:g,disabled:i,className:"bg-blue-900 text-white font-black py-3 px-10 rounded-xl shadow-lg hover:bg-blue-800 transition-all disabled:bg-gray-300 flex items-center gap-2",children:i?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):" "}),c.jsx("button",{onClick:y,disabled:i,className:"bg-gray-100 text-gray-500 font-black py-3 px-10 rounded-xl hover:bg-gray-200 transition-all",children:""})]})]})]})},f7=(t,e)=>{const{serviceType:n,educationStage:r,grade:i}=t;let s=[];n===""||n==="Foundation"?s.push(""," (3-5 )"):n===""||n==="Languages"?s.push("",""):n===""||n===" "||n==="Reinforcement"?s.push("",""):(n===""||n==="Follow-up")&&s.push("","");let o=e.filter(a=>s.some(u=>a.category===u||a.category_en===u));if(i){const a=o.filter(l=>l.targetGrades&&l.targetGrades.includes(i));a.length>0&&(o=a)}return o.length===0&&(o=e.filter(a=>r&&(a.level.includes(r.split(" ")[0])||a.level_en&&r.toLowerCase().includes(a.level_en.toLowerCase())))),o},p7=({userProfile:t,allCourses:e,onSelectCourse:n,currency:r,exchangeRate:i,strings:s})=>{const o=N.useMemo(()=>{if(!t.enrolledCourses||t.enrolledCourses.length===0)return[];const l=new Set(t.enrolledCourses);return e.filter(u=>l.has(u.id))},[t.enrolledCourses,e]),a=N.useMemo(()=>{const l=new Set(t.enrolledCourses||[]);let h=f7(t,e).filter(p=>!l.has(p.id));return h.length===0&&e.length>0&&(h=e.filter(p=>!l.has(p.id)).sort(()=>.5-Math.random()).slice(0,3)),h},[t,e]);return c.jsxs("div",{className:"animate-fade-in",children:[c.jsx("h1",{className:"text-3xl font-black text-blue-900 mb-8",children:s.myCourses}),c.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-100 mb-12",children:[c.jsxs("h2",{className:"text-xl font-bold text-blue-800 mb-6 flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-8 bg-green-500 rounded-full"}),s.enrolledCoursesTitle]}),o.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:o.map(l=>c.jsx(Kd,{course:l,onSelect:()=>n(l.id),currency:r,exchangeRate:i,strings:s},l.id))}):c.jsxs("div",{className:"text-center py-16 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[c.jsx("div",{className:"text-4xl mb-4 opacity-30",children:""}),c.jsx("p",{className:"text-gray-500 font-bold",children:s.noEnrolledCourses}),c.jsx("button",{onClick:()=>n(""),className:"mt-4 text-green-600 font-bold hover:underline",children:s.discoverMoreCourses})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-100",children:[c.jsxs("h2",{className:"text-xl font-bold text-blue-800 mb-2 flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-8 bg-blue-500 rounded-full"}),s.suggestedCoursesTitle]}),c.jsx("p",{className:"text-gray-500 text-sm mb-8 font-medium",children:t.serviceType?`    "${t.serviceType}"  "${t.grade}"   :`:s.suggestedCoursesDesc}),a.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:a.map(l=>c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-600 text-white text-[10px] font-black px-2 py-1 rounded-lg z-10 shadow-lg transform rotate-12 group-hover:rotate-0 transition-transform",children:"  "}),c.jsx(Kd,{course:l,onSelect:()=>n(l.id),currency:r,exchangeRate:i,strings:s})]},l.id))}):c.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700",children:s.noSuggestedCourses}),c.jsx("p",{className:"text-gray-500 mt-2",children:s.noSuggestedCoursesDesc})]})]})]})},m7=()=>c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:""}),c.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md",children:[c.jsxs("div",{className:"flex justify-between items-center bg-green-50 p-6 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:" "}),c.jsx("p",{className:"text-3xl font-bold text-green-600",children:"0.00 ."})]}),c.jsx("button",{className:"bg-green-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-600",children:" "})]}),c.jsxs("div",{className:"mt-8",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:" "}),c.jsx("div",{className:"mt-4 border-t pt-4",children:c.jsx("p",{className:"text-gray-500 text-center py-8",children:"   ."})})]})]})]}),g7=()=>c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:" "}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md min-h-[400px] flex flex-col",children:[c.jsx("div",{className:"flex-grow mb-4 p-4 bg-gray-50 rounded-md overflow-y-auto",children:c.jsxs("div",{className:"text-center text-gray-500 py-16",children:[c.jsx("p",{children:"!   ."}),c.jsx("p",{children:"     "})]})}),c.jsxs("div",{className:"flex",children:[c.jsx("input",{type:"text",placeholder:"   ...",className:"flex-1 p-3 border border-gray-300 rounded-l-md focus:ring-green-500 focus:border-green-500"}),c.jsx("button",{className:"bg-blue-900 text-white font-bold py-3 px-6 rounded-r-md hover:bg-blue-800",children:""})]})]})]}),y7=({userProfile:t,onLogout:e,onUpdateProfile:n,initialView:r="profile",onViewHandled:i,courses:s,onSelectCourse:o,currency:a,exchangeRate:l,strings:u,language:h})=>{const[p,m]=N.useState(r);N.useEffect(()=>{i&&i()},[i]);const g=()=>{switch(p){case"profile":return c.jsx(_S,{userProfile:t,onUpdate:n});case"courses":return c.jsx(p7,{userProfile:t,allCourses:s,onSelectCourse:o,currency:a,exchangeRate:l,strings:u});case"wallet":return c.jsx(m7,{});case"ai-assistant":return c.jsx(g7,{});default:return c.jsx(_S,{userProfile:t,onUpdate:n})}};return c.jsx("div",{className:"bg-gray-100 min-h-screen",children:c.jsx("div",{className:"container mx-auto px-6 py-12",children:c.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[c.jsx(h7,{username:t.username,activeView:p,setActiveView:m,onLogout:e,strings:u}),c.jsx("main",{className:"flex-1",children:g()})]})})})},v7=({activeView:t,setActiveView:e,onLogout:n,strings:r,isEnglishAdmin:i,isSuperAdmin:s,onSwitchMode:o})=>{let a=[{id:"whatsapp-courses",label:r.adminNavWhatsapp,icon:""},{id:"content",label:r.adminNavContent},{id:"heroImages",label:r.adminNavHero},{id:"onboarding",label:r.adminNavOnboarding},{id:"users",label:r.adminNavUsers},{id:"staff",label:r.adminNavStaff},{id:"payments",label:r.adminNavPayments},{id:"teachers",label:r.adminNavTeachers},{id:"courses",label:r.adminNavCourses},{id:"testimonials",label:r.adminNavTestimonials},{id:"blog",label:r.adminNavBlog}];return i&&(a=[{id:"content",label:"Content Management (English)"},{id:"heroImages",label:"Home Banner (English)"},{id:"onboarding",label:"Onboarding Steps (English)"},{id:"users",label:"User Management (English)"},{id:"teachers",label:"Teacher Management (English)"},{id:"courses",label:"Course Management (English)"},{id:"testimonials",label:"Testimonials (English)"},{id:"blog",label:"Blog Management (English)"}]),c.jsxs("aside",{className:"md:w-64 bg-white p-6 rounded-xl shadow-lg flex-shrink-0 w-full",children:[c.jsx("div",{className:"text-center mb-8",children:c.jsx("h3",{className:"font-bold text-xl mt-4 text-blue-900",children:i?"English Admin Panel":r.adminPanelTitle})}),c.jsx("nav",{className:"space-y-2",children:a.map(l=>c.jsxs("button",{onClick:()=>e(l.id),className:`w-full text-right p-3 rounded-lg transition-colors flex items-center justify-between ${t===l.id?"bg-blue-900 text-white":"hover:bg-gray-100 text-gray-700"}`,children:[c.jsx("span",{className:"font-semibold",children:l.label}),l.icon&&c.jsx("span",{children:l.icon})]},l.id))}),c.jsxs("div",{className:"mt-8 border-t pt-4 space-y-2",children:[s&&o&&c.jsxs("button",{onClick:o,className:"w-full flex items-center space-x-3 space-x-reverse p-3 rounded-lg text-right transition-colors bg-orange-50 text-orange-600 hover:bg-orange-100 mb-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),c.jsx("span",{className:"font-semibold text-sm",children:i?"Back to Super Admin":"Switch to English Admin"})]}),c.jsxs("button",{onClick:n,className:"w-full flex items-center space-x-3 space-x-reverse p-3 rounded-lg text-right transition-colors text-red-500 hover:bg-red-50",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{className:"font-semibold",children:r.logout})]})]})]})},x7=({content:t,onUpdate:e,isEnglishAdmin:n})=>{const[r,i]=N.useState("homepage"),[s,o]=N.useState(JSON.parse(JSON.stringify(t))),[a,l]=N.useState(null);N.useEffect(()=>{o(JSON.parse(JSON.stringify(t)))},[t,n]);const u=_=>{const{name:b,value:S}=_.target;o(I=>({...I,homepage:{...I.homepage,[b]:S}}))},h=_=>{const{name:b,value:S}=_.target;o(I=>({...I,[b]:S}))},p=_=>{const{name:b,value:S}=_.target;o(I=>({...I,footer:{...I.footer||{description:"",description_en:"",rights:"",rights_en:""},[b]:S}}))},m=_=>{const{name:b,value:S}=_.target;o(b==="whyJoTutor"?I=>({...I,about:{...I.about,[b]:S.split(`
`)}}):I=>({...I,about:{...I.about,[b]:S}}))},g=(_,b)=>{o(S=>({...S,[b]:_.target.value}))},y=(_,b,S)=>{o(I=>({...I,faq:I.faq.map(E=>E.id===_?{...E,[b]:S}:E)}))},w=()=>{o(_=>({..._,faq:[..._.faq,{id:Date.now().toString(),question:"",answer:"",question_en:"",answer_en:""}]}))},T=()=>{e(s),l({message:n?"Content saved successfully!":"   !",type:"success"}),setTimeout(()=>l(null),3e3)},x=()=>{var _,b;switch(r){case"homepage":return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"p-4 border rounded-xl bg-green-50/20",children:[c.jsx("h3",{className:"font-black mb-4 text-blue-900",children:"  "}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{id:"Teacher",type:"Count"},{id:"Acceptance",type:"Rate"},{id:"Student",type:"Count"},{id:"Satisfaction",type:"Rate"}].map((I,E)=>c.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[c.jsx("label",{className:"block text-[9px] font-black text-gray-400 uppercase",children:I.id}),c.jsx("input",{name:`stats${I.id}${I.type}${n?"_en":""}`,value:s.homepage[`stats${I.id}${I.type}${n?"_en":""}`]||"",onChange:u,className:"w-full p-2 border rounded mb-2 text-sm"}),c.jsx("input",{name:`stats${I.id}Label${n?"_en":""}`,value:s.homepage[`stats${I.id}Label${n?"_en":""}`]||"",onChange:u,className:"w-full p-2 border rounded text-xs"})]},E))})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("input",{name:"featuresTitle",value:s.homepage.featuresTitle||"",onChange:u,placeholder:" ",className:"w-full p-3 border rounded-xl font-bold"}),c.jsx("textarea",{name:"featuresSubtitle",value:s.homepage.featuresSubtitle||"",onChange:u,placeholder:" ",className:"w-full p-3 border rounded-xl text-sm",rows:1})]})]});case"settings":return c.jsxs("div",{className:"space-y-8 animate-fade-in",children:[c.jsxs("div",{className:"p-8 border-4 border-dashed border-blue-200 rounded-[2.5rem] bg-blue-50/30",children:[c.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-600 text-white rounded-2xl flex items-center justify-center text-xl shadow-lg",children:""}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-black text-blue-900 uppercase tracking-tighter",children:"  "}),c.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase",children:"Real-Time Gateway Session Controller"})]})]}),c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-blue-900 mb-2 uppercase tracking-widest",children:"Active Mastercard Session ID"}),c.jsx("input",{name:"mastercardSessionId",value:s.mastercardSessionId||"",onChange:h,className:"w-full p-5 bg-white border-2 border-blue-100 rounded-2xl outline-none focus:border-blue-600 font-mono text-blue-600 font-bold shadow-inner",placeholder:"Enter Session ID"}),c.jsx("p",{className:"mt-3 text-[10px] text-gray-400 font-bold leading-relaxed bg-white/50 p-3 rounded-lg border",children:':        .       "Session Expired".         .'})]})})]}),c.jsxs("div",{className:"p-8 border rounded-[2.5rem] bg-gray-50/50",children:[c.jsx("h3",{className:"text-lg font-black text-blue-900 mb-4 uppercase",children:" "}),c.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"        (Environment Variables)  ."})]})]});case"about":return c.jsxs("div",{className:"space-y-4",children:[c.jsx("input",{name:"aboutTitle",value:s.about.aboutTitle,onChange:m,className:"w-full p-2 border rounded",placeholder:" "}),c.jsx("textarea",{name:"vision",value:s.about.vision,onChange:m,className:"w-full p-2 border rounded",rows:3,placeholder:""})]});case"faq":return c.jsxs("div",{children:[s.faq.map(I=>c.jsxs("div",{className:"p-4 border rounded mb-4 bg-gray-50",children:[c.jsx("input",{value:n?I.question_en||"":I.question,onChange:E=>y(I.id,n?"question_en":"question",E.target.value),className:"w-full p-2 border rounded mb-2 font-bold"}),c.jsx("textarea",{value:n?I.answer_en||"":I.answer,onChange:E=>y(I.id,n?"answer_en":"answer",E.target.value),className:"w-full p-2 border rounded"})]},I.id)),c.jsx("button",{onClick:w,className:"bg-blue-500 text-white px-4 py-2 rounded",children:" "})]});case"footer":return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("textarea",{name:"description",value:((_=s.footer)==null?void 0:_.description)||"",onChange:p,className:"p-2 border rounded",rows:4,placeholder:"  ()"}),c.jsx("textarea",{name:"description_en",value:((b=s.footer)==null?void 0:b.description_en)||"",onChange:p,className:"p-2 border rounded",rows:4,placeholder:"Footer Desc (EN)"})]});case"privacy":case"terms":case"paymentRefund":const S=r==="privacy"?"privacy":r==="terms"?"terms":"paymentRefundPolicy";return c.jsx("textarea",{value:s[S],onChange:I=>g(I,S),rows:15,className:"w-full p-2 border rounded"});default:return null}},v=[{id:"homepage",label:n?"Homepage":""},{id:"settings",label:n?"Bank Settings":" "},{id:"footer",label:n?"Footer":""},{id:"about",label:n?"About":" "},{id:"faq",label:n?"FAQ":""},{id:"privacy",label:n?"Privacy":""}];return c.jsxs("div",{className:"animate-fade-in pb-20",children:[c.jsx("h1",{className:"text-3xl font-black text-blue-900 mb-6",children:n?"English Content":" "}),c.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] shadow-2xl border border-gray-100",children:[c.jsx("nav",{className:"flex gap-2 overflow-x-auto border-b pb-4 mb-8 no-scrollbar",children:v.map(_=>c.jsx("button",{onClick:()=>i(_.id),className:`px-6 py-3 rounded-2xl font-black text-xs transition-all whitespace-nowrap ${r===_.id?"bg-blue-900 text-white shadow-xl":"text-gray-400 hover:bg-gray-50"}`,children:_.label.toUpperCase()},_.id))}),c.jsx("div",{className:"min-h-[500px]",children:x()}),c.jsx("div",{className:"mt-12 pt-8 border-t bg-gray-50 -mx-8 -mb-8 p-8 rounded-b-[2.5rem]",children:c.jsx("button",{onClick:T,className:"bg-blue-900 text-white font-black py-4 px-16 rounded-2xl shadow-xl hover:bg-blue-800 transition-all",children:n?"Save Changes":" "})}),a&&c.jsx("div",{className:"fixed bottom-10 right-10 bg-green-600 text-white px-8 py-4 rounded-2xl shadow-2xl font-black z-[100] animate-bounce",children:a.message})]})]})},Ir=({value:t,onChange:e,placeholder:n,className:r})=>{const[i,s]=N.useState(!1),o=N.useRef(null),a=async l=>{var p,m;const u=(p=l.target.files)==null?void 0:p[0];if(!u)return;s(!0);const h=new FormData;h.append("image",u);try{const g="8651c8d21d91d90c780590fa34ee35aa",w=await(await fetch(`https://api.imgbb.com/1/upload?key=${g}`,{method:"POST",body:h})).json();w.success?e(w.data.url):alert("  : "+(((m=w.error)==null?void 0:m.message)||"  "))}catch(g){console.error("Upload error:",g),alert("    .     .")}finally{s(!1),o.current&&(o.current.value="")}};return c.jsxs("div",{className:`flex items-center space-x-2 space-x-reverse ${r||""}`,children:[c.jsx("div",{className:"flex-1 relative",children:c.jsx("input",{type:"text",value:t,onChange:l=>e(l.target.value),placeholder:n,className:"w-full p-2 border rounded text-left",dir:"ltr"})}),c.jsx("input",{type:"file",ref:o,onChange:a,accept:"image/*",className:"hidden"}),c.jsx("button",{type:"button",onClick:()=>{var l;return(l=o.current)==null?void 0:l.click()},disabled:i,className:"bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400 whitespace-nowrap text-sm font-bold flex items-center gap-2 transition-colors",title:" ",children:i?c.jsx(c.Fragment,{children:c.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),c.jsx("span",{className:"hidden sm:inline",children:""})]})})]})},w7=({course:t,onSave:e,onClose:n,categories:r,curriculums:i})=>{const[s,o]=N.useState("ar"),[a,l]=N.useState({});N.useEffect(()=>{l(t?{...t}:{id:Date.now().toString(),title:"",title_en:"",description:"",description_en:"",teacher:"",teacher_en:"",priceJod:0,priceUsd:0,priceSar:0,duration:"4 ",duration_en:"4 Weeks",level:"",level_en:"Beginner",imageUrl:"",imageUrl_en:"",category:"",category_en:"Foundation",curriculum:" ",curriculum_en:"International Curriculum",isFeatured:!1,sessionCount:8,totalHours:1.5,includedSubjects:" English ",includedSubjects_en:"Arabic, English, Math"})},[t]);const u=p=>{const{name:m,value:g,type:y}=p.target,w=y==="number";l(T=>({...T,[m]:w?Number(g):g}))},h=p=>{p.preventDefault(),e(a)};return c.jsx("div",{className:"fixed inset-0 bg-blue-900/70 backdrop-blur-md z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden flex flex-col animate-fade-in-up border-[6px] border-white",children:[c.jsxs("div",{className:"p-6 border-b flex justify-between items-center bg-gray-50/50",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-black text-blue-900",children:t?" ":"  "}),c.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest mt-1",children:"Multi-Currency & Bilingual Support"})]}),c.jsxs("div",{className:"flex bg-gray-200 p-1.5 rounded-2xl shadow-inner",children:[c.jsx("button",{type:"button",onClick:()=>o("ar"),className:`px-8 py-2.5 rounded-xl text-xs font-black transition-all duration-300 ${s==="ar"?"bg-white text-blue-900 shadow-lg":"text-gray-500 hover:text-gray-700"}`,children:" "}),c.jsx("button",{type:"button",onClick:()=>o("en"),className:`px-8 py-2.5 rounded-xl text-xs font-black transition-all duration-300 ${s==="en"?"bg-white text-blue-900 shadow-lg":"text-gray-500 hover:text-gray-700"}`,children:"English Mode"})]})]}),c.jsxs("form",{onSubmit:h,className:"flex-1 overflow-y-auto p-8 space-y-8 custom-scrollbar",children:[c.jsxs("div",{className:"bg-blue-50/40 p-8 rounded-[2rem] border border-blue-100 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[c.jsx("div",{className:"w-10 h-10 bg-blue-600 text-white rounded-xl flex items-center justify-center font-black shadow-lg",children:s==="ar"?"":"EN"}),c.jsxs("h3",{className:"text-lg font-black text-blue-900 uppercase",children:["  (",s==="ar"?"":"In English",")"]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s==="ar"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:""}),c.jsx("input",{name:"title",value:a.title||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:":   ",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:""}),c.jsx("input",{name:"teacher",value:a.teacher||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:" "})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:" ()"}),c.jsx("input",{name:"category",value:a.category||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:": "})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:""}),c.jsx("input",{name:"level",value:a.level||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:": "})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:""}),c.jsx("input",{name:"curriculum",value:a.curriculum||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:":  "})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:""}),c.jsx("input",{name:"duration",value:a.duration||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:": 4 "})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"  / "}),c.jsx("input",{name:"includedSubjects",value:a.includedSubjects||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:" English "})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:" "}),c.jsx("textarea",{name:"description",value:a.description||"",onChange:u,rows:3,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold shadow-sm"})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-[10px] font-black text-green-600 mb-2 uppercase tracking-widest",children:"  ()"}),c.jsx(Ir,{value:a.imageUrl||"",onChange:p=>l(m=>({...m,imageUrl:p})),placeholder:"   "})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"Course Title (EN)"}),c.jsx("input",{name:"title_en",value:a.title_en||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:"e.g. Comprehensive Foundation",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"Teacher Name (EN)"}),c.jsx("input",{name:"teacher_en",value:a.teacher_en||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:"Teacher Name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"Subject (Category EN)"}),c.jsx("input",{name:"category_en",value:a.category_en||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:"e.g. Foundation"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"Level (EN)"}),c.jsx("input",{name:"level_en",value:a.level_en||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:"e.g. Beginner"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"Curriculum (EN)"}),c.jsx("input",{name:"curriculum_en",value:a.curriculum_en||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:"e.g. International"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"Duration (EN)"}),c.jsx("input",{name:"duration_en",value:a.duration_en||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:"e.g. 4 Weeks"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"Included Languages / Subjects (EN)"}),c.jsx("input",{name:"includedSubjects_en",value:a.includedSubjects_en||"",onChange:u,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold",placeholder:"Arabic, English, Math"})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest",children:"Description (EN)"}),c.jsx("textarea",{name:"description_en",value:a.description_en||"",onChange:u,rows:3,className:"w-full p-4 bg-white border-2 border-blue-50 rounded-2xl outline-none focus:border-blue-500 font-bold shadow-sm"})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-600 mb-2 uppercase tracking-widest",children:"English Course Image (Independent)"}),c.jsx(Ir,{value:a.imageUrl_en||"",onChange:p=>l(m=>({...m,imageUrl_en:p})),placeholder:"Upload image for English version"})]})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[c.jsxs("div",{className:"bg-green-50/40 p-8 rounded-[2rem] border border-green-100",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-10 h-10 bg-green-500 text-white rounded-xl flex items-center justify-center font-black shadow-lg",children:""}),c.jsx("h3",{className:"text-lg font-black text-blue-900 uppercase",children:" "})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-1 uppercase",children:"  (JOD)"}),c.jsx("input",{name:"priceJod",type:"number",step:"0.01",value:a.priceJod||0,onChange:u,className:"w-full p-4 bg-white border-2 border-gray-100 rounded-2xl outline-none focus:border-green-500 font-black text-green-600"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-1 uppercase",children:"  (USD)"}),c.jsx("input",{name:"priceUsd",type:"number",step:"0.01",value:a.priceUsd||0,onChange:u,className:"w-full p-4 bg-white border-2 border-gray-100 rounded-2xl outline-none focus:border-blue-500 font-black text-blue-600"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-1 uppercase",children:"  (SAR)"}),c.jsx("input",{name:"priceSar",type:"number",step:"0.01",value:a.priceSar||0,onChange:u,className:"w-full p-4 bg-white border-2 border-gray-100 rounded-2xl outline-none focus:border-orange-500 font-black text-orange-600"})]})]})]}),c.jsxs("div",{className:"bg-gray-50/50 p-8 rounded-[2rem] border border-gray-100 shadow-inner",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-10 h-10 bg-blue-900 text-white rounded-xl flex items-center justify-center font-black shadow-lg",children:""}),c.jsx("h3",{className:"text-lg font-black text-blue-900 uppercase",children:" "})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-1 uppercase",children:" "}),c.jsx("input",{name:"sessionCount",type:"number",value:a.sessionCount||0,onChange:u,className:"w-full p-4 bg-white border-2 border-gray-100 rounded-2xl outline-none focus:border-blue-500 font-bold"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-1 uppercase",children:"/ "}),c.jsx("input",{name:"totalHours",type:"number",step:"0.1",value:a.totalHours||0,onChange:u,className:"w-full p-4 bg-white border-2 border-gray-100 rounded-2xl outline-none focus:border-blue-500 font-bold"})]}),c.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[c.jsx("input",{type:"checkbox",id:"isFeatured",checked:a.isFeatured||!1,onChange:p=>l(m=>({...m,isFeatured:p.target.checked})),className:"w-6 h-6 rounded-lg text-green-500 border-gray-300 focus:ring-green-500"}),c.jsx("label",{htmlFor:"isFeatured",className:"text-sm font-black text-blue-900 uppercase",children:"  (  )"})]})]})]})]}),c.jsxs("div",{className:"flex gap-4 pt-6",children:[c.jsx("button",{type:"submit",className:"flex-1 bg-blue-900 text-white font-black py-5 rounded-[1.5rem] shadow-2xl hover:bg-blue-800 transition-all active:scale-[0.97] text-lg",children:"   "}),c.jsx("button",{type:"button",onClick:n,className:"px-12 py-5 bg-gray-100 text-gray-400 font-black rounded-[1.5rem] hover:bg-gray-200 transition-all",children:""})]})]})]})})},_7=({courses:t,setCourses:e,courseCategories:n,curriculums:r,isEnglishAdmin:i})=>{const[s,o]=N.useState(!1),[a,l]=N.useState(null),u=p=>{l(p),o(!0)},h=p=>{e(m=>{const g=m.findIndex(y=>y.id===p.id);if(g>-1){const y=[...m];return y[g]=p,y}return[p,...m]}),o(!1)};return c.jsxs("div",{className:"animate-fade-in pb-20",children:[s&&c.jsx(w7,{course:a,onSave:h,onClose:()=>o(!1),categories:n,curriculums:r}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-10 gap-6 bg-white p-8 rounded-[2rem] shadow-xl border border-gray-50",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-4xl font-black text-blue-900 uppercase tracking-tighter",children:" "}),c.jsx("p",{className:"text-xs text-gray-400 font-bold mt-1 uppercase tracking-widest",children:"Localized Course Engine"})]}),c.jsx("button",{onClick:()=>u(null),className:"bg-green-500 text-white font-black py-4 px-10 rounded-2xl shadow-xl hover:bg-green-600 transition-all",children:"  "})]}),c.jsx("div",{className:"bg-white rounded-[2.5rem] shadow-2xl border border-gray-100 overflow-hidden",children:c.jsxs("table",{className:"w-full text-right border-collapse",children:[c.jsx("thead",{className:"bg-gray-50/50 border-b border-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-8 font-black text-gray-400 text-[10px] uppercase",children:" "}),c.jsx("th",{className:"p-8 font-black text-gray-400 text-[10px] uppercase text-center",children:" (JOD / USD / SAR)"}),c.jsx("th",{className:"p-8 font-black text-gray-400 text-[10px] uppercase text-center",children:""})]})}),c.jsx("tbody",{children:t.map(p=>c.jsxs("tr",{className:"border-b border-gray-50 hover:bg-blue-50/30 transition-all duration-300",children:[c.jsx("td",{className:"p-8",children:c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsx("div",{className:"w-16 h-16 rounded-2xl overflow-hidden shadow-md",children:c.jsx("img",{src:i&&p.imageUrl_en?p.imageUrl_en:p.imageUrl,className:"w-full h-full object-cover",alt:""})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-black text-blue-900",children:i&&p.title_en||p.title}),c.jsxs("div",{className:"text-[10px] text-gray-400 font-bold",children:[p.category," | ",p.level]})]})]})}),c.jsx("td",{className:"p-8 text-center",children:c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsxs("span",{className:"text-xs font-black text-green-600",children:[p.priceJod||0," JOD"]}),c.jsxs("span",{className:"text-[10px] font-bold text-blue-500",children:[p.priceUsd||0," USD"]}),c.jsxs("span",{className:"text-[10px] font-bold text-orange-500",children:[p.priceSar||0," SAR"]})]})}),c.jsx("td",{className:"p-8 text-center",children:c.jsx("button",{onClick:()=>u(p),className:"bg-blue-900 text-white font-black px-8 py-3 rounded-2xl hover:bg-blue-800 transition-all text-xs",children:""})})]},p.id))})]})})]})},T7=({teacher:t,onSave:e,onClose:n,isEnglishAdmin:r})=>{const[i,s]=N.useState({});N.useEffect(()=>{s(r?{name_en:(t==null?void 0:t.name_en)||"",level_en:(t==null?void 0:t.level_en)||"",bio_en:(t==null?void 0:t.bio_en)||"",specialties_en:(t==null?void 0:t.specialties_en)||[],qualifications_en:(t==null?void 0:t.qualifications_en)||[],avatarUrl:t==null?void 0:t.avatarUrl}:{name:(t==null?void 0:t.name)||"",avatarUrl:(t==null?void 0:t.avatarUrl)||"https://picsum.photos/seed/new/200/200",level:(t==null?void 0:t.level)||"",experience:(t==null?void 0:t.experience)||0,specialties:(t==null?void 0:t.specialties)||[],rating:(t==null?void 0:t.rating)||5,reviews:(t==null?void 0:t.reviews)||0,pricePerHour:(t==null?void 0:t.pricePerHour)||20,bio:(t==null?void 0:t.bio)||"",qualifications:(t==null?void 0:t.qualifications)||[]})},[t,r]);const o=u=>{const{name:h,value:p,type:m}=u.target,g=m==="number";s(y=>({...y,[h]:g?Number(p):p}))},a=(u,h)=>{const{value:p}=u.target;s(m=>({...m,[h]:p.split(",").map(g=>g.trim())}))},l=u=>{u.preventDefault();const h={...t||{id:Date.now().toString()},...i};e(h)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:c.jsxs("form",{onSubmit:l,className:"p-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:r?"Edit Teacher (English)":t?"  ":"  "}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"md:col-span-2 bg-gray-100 p-2 rounded mb-2",children:c.jsxs("p",{className:"text-xs text-gray-500",children:["Arabic Name: ",(t==null?void 0:t.name)||"Not set"]})}),c.jsx("input",{name:"name_en",value:i.name_en||"",onChange:o,placeholder:"Name (English)",className:"p-2 border rounded",required:!0}),c.jsx("input",{name:"level_en",value:i.level_en||"",onChange:o,placeholder:"Level (English) e.g., Primary",className:"p-2 border rounded"}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{name:"specialties_en",value:(i.specialties_en||[]).join(", "),onChange:u=>a(u,"specialties_en"),placeholder:"Specialties (comma separated) English",className:"w-full p-2 border rounded"})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{name:"qualifications_en",value:(i.qualifications_en||[]).join(", "),onChange:u=>a(u,"qualifications_en"),placeholder:"Qualifications (comma separated) English",className:"w-full p-2 border rounded"})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("textarea",{name:"bio_en",value:i.bio_en||"",onChange:o,placeholder:"Bio (English)",rows:4,className:"w-full p-2 border rounded"})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Image (Shared)"}),c.jsx(Ir,{value:i.avatarUrl||"",onChange:u=>s(h=>({...h,avatarUrl:u})),placeholder:"Image URL"})]})]}):c.jsxs(c.Fragment,{children:[c.jsx("input",{name:"name",value:i.name||"",onChange:o,placeholder:"",className:"p-2 border rounded",required:!0}),c.jsx("div",{children:c.jsx(Ir,{value:i.avatarUrl||"",onChange:u=>s(h=>({...h,avatarUrl:u})),placeholder:" "})}),c.jsx("input",{name:"level",value:i.level||"",onChange:o,placeholder:" (: , )",className:"p-2 border rounded"}),c.jsx("input",{name:"experience",type:"number",value:i.experience||0,onChange:o,placeholder:" ",className:"p-2 border rounded"}),c.jsx("input",{name:"pricePerHour",type:"number",value:i.pricePerHour||0,onChange:o,placeholder:" ",className:"p-2 border rounded"}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{name:"specialties",value:(i.specialties||[]).join(", "),onChange:u=>a(u,"specialties"),placeholder:" ( )",className:"w-full p-2 border rounded"})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{name:"qualifications",value:(i.qualifications||[]).join(", "),onChange:u=>a(u,"qualifications"),placeholder:" ( )",className:"w-full p-2 border rounded"})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("textarea",{name:"bio",value:i.bio||"",onChange:o,placeholder:" ",rows:4,className:"w-full p-2 border rounded"})})]})}),c.jsxs("div",{className:"flex justify-end mt-6 space-x-2 space-x-reverse",children:[c.jsx("button",{type:"button",onClick:n,className:"bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded hover:bg-gray-400",children:r?"Cancel":""}),c.jsx("button",{type:"submit",className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700",children:r?"Save":""})]})]})})})},I7=({teachers:t,setTeachers:e,isEnglishAdmin:n})=>{const[r,i]=N.useState(!1),[s,o]=N.useState(null),a=p=>{o(p),i(!0)},l=()=>{i(!1),o(null)},u=p=>{t.some(m=>m.id===p.id)?e(m=>m.map(g=>g.id===p.id?p:g)):e(m=>[p,...m]),l()},h=p=>{window.confirm("        ")&&e(m=>m.filter(g=>g.id!==p))};return c.jsxs("div",{children:[r&&c.jsx(T7,{teacher:s,onSave:u,onClose:l,isEnglishAdmin:n}),c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:n?"Manage Teachers (English)":" "}),c.jsx("button",{onClick:()=>a(null),className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700",children:n?"Add New Teacher":"  "})]}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full bg-white",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:n?"Name (EN/AR)":""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:n?"Level":""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:n?"Actions":""})]})}),c.jsx("tbody",{children:t.map(p=>c.jsxs("tr",{className:"border-b",children:[c.jsxs("td",{className:"py-3 px-4 flex items-center",children:[c.jsx("img",{src:p.avatarUrl,alt:p.name,className:"w-10 h-10 rounded-full ml-4 object-cover"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold",children:n&&p.name_en||p.name}),n&&c.jsx("div",{className:"text-xs text-gray-500",children:p.name})]})]}),c.jsx("td",{className:"py-3 px-4",children:n&&p.level_en||p.level}),c.jsxs("td",{className:"py-3 px-4 whitespace-nowrap",children:[c.jsx("button",{onClick:()=>a(p),className:"text-blue-500 hover:underline mr-4",children:n?"Edit":""}),!n&&c.jsx("button",{onClick:()=>h(p.id),className:"text-red-500 hover:underline",children:""})]})]},p.id))})]})})})]})},S7=({testimonial:t,onSave:e,onClose:n,isEnglishAdmin:r})=>{const[i,s]=N.useState({});N.useEffect(()=>{s(r?{name_en:(t==null?void 0:t.name_en)||"",role_en:(t==null?void 0:t.role_en)||"",quote_en:(t==null?void 0:t.quote_en)||"",avatarUrl:t==null?void 0:t.avatarUrl,name:t==null?void 0:t.name}:{name:(t==null?void 0:t.name)||"",role:(t==null?void 0:t.role)||"",avatarUrl:(t==null?void 0:t.avatarUrl)||"https://picsum.photos/seed/new_testimonial/100/100",quote:(t==null?void 0:t.quote)||""})},[t,r]);const o=l=>{const{name:u,value:h}=l.target;s(p=>({...p,[u]:h}))},a=l=>{l.preventDefault();const u={...t||{id:Date.now().toString()},...i};e(u)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:c.jsxs("form",{onSubmit:a,className:"p-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:r?"Edit Testimonial (English)":t?" ":"  "}),c.jsx("div",{className:"space-y-4",children:r?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-gray-100 p-2 rounded text-xs mb-2",children:[c.jsx("span",{className:"text-gray-500",children:"Arabic Name:"})," ",i.name||"Not set"]}),c.jsx("input",{name:"name_en",value:i.name_en||"",onChange:o,placeholder:"Name (English)",className:"w-full p-2 border rounded",required:!0}),c.jsx("input",{name:"role_en",value:i.role_en||"",onChange:o,placeholder:"Role (e.g. Parent) English",className:"w-full p-2 border rounded",required:!0}),c.jsx("textarea",{name:"quote_en",value:i.quote_en||"",onChange:o,placeholder:"Quote (English)",rows:4,className:"w-full p-2 border rounded",required:!0}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Photo (Shared)"}),c.jsx(Ir,{value:i.avatarUrl||"",onChange:l=>s(u=>({...u,avatarUrl:l})),placeholder:"Image URL"})]})]}):c.jsxs(c.Fragment,{children:[c.jsx("input",{name:"name",value:i.name||"",onChange:o,placeholder:"",className:"w-full p-2 border rounded",required:!0}),c.jsx("input",{name:"role",value:i.role||"",onChange:o,placeholder:" (:  )",className:"w-full p-2 border rounded",required:!0}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:" "}),c.jsx(Ir,{value:i.avatarUrl||"",onChange:l=>s(u=>({...u,avatarUrl:l})),placeholder:" "})]}),c.jsx("textarea",{name:"quote",value:i.quote||"",onChange:o,placeholder:"",rows:4,className:"w-full p-2 border rounded",required:!0})]})}),c.jsxs("div",{className:"flex justify-end mt-6 space-x-2 space-x-reverse",children:[c.jsx("button",{type:"button",onClick:n,className:"bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded hover:bg-gray-400",children:r?"Cancel":""}),c.jsx("button",{type:"submit",className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700",children:r?"Save":""})]})]})})})},b7=({testimonials:t,setTestimonials:e,isEnglishAdmin:n})=>{const[r,i]=N.useState(!1),[s,o]=N.useState(null),a=p=>{o(p),i(!0)},l=()=>{i(!1),o(null)},u=p=>{t.some(m=>m.id===p.id)?e(m=>m.map(g=>g.id===p.id?p:g)):e(m=>[p,...m]),l()},h=p=>{window.confirm("        ")&&e(m=>m.filter(g=>g.id!==p))};return c.jsxs("div",{children:[r&&c.jsx(S7,{testimonial:s,onSave:u,onClose:l,isEnglishAdmin:n}),c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:n?"Manage Testimonials (English)":"  "}),c.jsx("button",{onClick:()=>a(null),className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700",children:n?"Add New":"  "})]}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:c.jsx("div",{className:"space-y-4",children:t.map(p=>c.jsxs("div",{className:"flex items-start justify-between p-4 border rounded-md bg-gray-50",children:[c.jsxs("div",{className:"flex items-start space-x-4 space-x-reverse",children:[c.jsx("img",{src:p.avatarUrl,alt:p.name,className:"w-12 h-12 rounded-full object-cover"}),c.jsxs("div",{children:[c.jsxs("p",{className:"font-semibold text-blue-900",children:[n&&p.name_en||p.name," ",c.jsxs("span",{className:"text-sm text-gray-500",children:["(",n&&p.role_en||p.role,")"]})]}),c.jsxs("p",{className:"text-gray-700 italic mt-1",children:['"',n&&p.quote_en||p.quote,'"']})]})]}),c.jsxs("div",{className:"flex-shrink-0",children:[c.jsx("button",{onClick:()=>a(p),className:"text-blue-500 hover:underline mr-4 text-sm",children:n?"Edit":""}),!n&&c.jsx("button",{onClick:()=>h(p.id),className:"text-red-500 hover:underline text-sm",children:""})]})]},p.id))})})]})},E7=t=>{const e=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\/shorts\/)([^#\&\?]*).*/,n=t.match(e);return n&&n[2].length===11?n[2]:null},C7=({post:t,onSave:e,onClose:n,isEnglishAdmin:r})=>{const[i,s]=N.useState((t==null?void 0:t.type)||"article"),[o,a]=N.useState(t!=null&&t.youtubeVideoId?`https://www.youtube.com/watch?v=${t.youtubeVideoId}`:""),[l,u]=N.useState({});N.useEffect(()=>{u(r?{title_en:(t==null?void 0:t.title_en)||"",excerpt_en:(t==null?void 0:t.excerpt_en)||"",content_en:(t==null?void 0:t.content_en)||"",tags_en:(t==null?void 0:t.tags_en)||[],title:(t==null?void 0:t.title)||"",imageUrl:(t==null?void 0:t.imageUrl)||""}:{title:(t==null?void 0:t.title)||"",author:(t==null?void 0:t.author)||" JoTutor",excerpt:(t==null?void 0:t.excerpt)||"",content:(t==null?void 0:t.content)||"",imageUrl:(t==null?void 0:t.imageUrl)||"https://picsum.photos/seed/blog/800/400",tags:(t==null?void 0:t.tags)||[],youtubeVideoId:(t==null?void 0:t.youtubeVideoId)||""})},[t,r]);const h=g=>{const{name:y,value:w}=g.target;u(T=>({...T,[y]:w}))},p=g=>{const{value:y}=g.target,w=r?"tags_en":"tags";u(T=>({...T,[w]:y.split(",").map(x=>x.trim())}))},m=g=>{g.preventDefault();let y={...l};if(!r&&i==="short"){const T=E7(o);if(!T){alert("    .");return}y.youtubeVideoId=T,y.imageUrl=`https://i.ytimg.com/vi/${T}/hqdefault.jpg`,y.content=l.excerpt||""}const w={...t||{id:Date.now().toString()},date:(t==null?void 0:t.date)||new Date().toISOString(),type:i,...y};e(w)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:c.jsxs("form",{onSubmit:m,className:"p-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-right",children:r?"Edit Blog Post (English)":t?" ":"  "}),c.jsxs("div",{className:"space-y-4 text-right",dir:r?"ltr":"rtl",children:[!r&&c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),c.jsxs("select",{value:i,onChange:g=>s(g.target.value),className:"w-full p-2 border rounded bg-white",children:[c.jsx("option",{value:"article",children:""}),c.jsx("option",{value:"short",children:"  (Short)"})]})]}),r?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-gray-100 p-2 rounded text-xs mb-2 text-left",children:[c.jsx("span",{className:"text-gray-500 font-bold",children:"Arabic Title:"})," ",l.title||"Not set"]}),c.jsx("input",{name:"title_en",value:l.title_en||"",onChange:h,placeholder:"Title (English)",className:"w-full p-2 border rounded",required:!0}),c.jsx("textarea",{name:"excerpt_en",value:l.excerpt_en||"",onChange:h,placeholder:"Excerpt/Short Description (English)",rows:3,className:"w-full p-2 border rounded"}),i==="article"&&c.jsx("textarea",{name:"content_en",value:l.content_en||"",onChange:h,placeholder:"Full Content (HTML Supported) - English",rows:10,className:"w-full p-2 border rounded"}),c.jsx("input",{name:"tags_en",value:(l.tags_en||[]).join(", "),onChange:p,placeholder:"Tags (comma separated) English",className:"w-full p-2 border rounded"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Image (Shared)"}),c.jsx(Ir,{value:l.imageUrl||"",onChange:g=>u(y=>({...y,imageUrl:g})),placeholder:"Image URL"})]})]}):c.jsxs(c.Fragment,{children:[c.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:" "}),c.jsx("input",{name:"title",value:l.title||"",onChange:h,placeholder:"",className:"w-full p-2 border rounded",required:!0}),i==="short"&&c.jsxs(c.Fragment,{children:[c.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:" "}),c.jsx("input",{type:"url",value:o,onChange:g=>a(g.target.value),placeholder:"   (Short)",className:"w-full p-2 border rounded",required:!0})]}),i==="article"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:" "}),c.jsx(Ir,{value:l.imageUrl||"",onChange:g=>u(y=>({...y,imageUrl:g})),placeholder:" "})]}),c.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:" "}),c.jsx("textarea",{name:"excerpt",value:l.excerpt||"",onChange:h,placeholder:i==="short"?" ":"  ",rows:3,className:"w-full p-2 border rounded"}),i==="article"&&c.jsxs(c.Fragment,{children:[c.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"  "}),c.jsx("textarea",{name:"content",value:l.content||"",onChange:h,placeholder:"  ( HTML)",rows:10,className:"w-full p-2 border rounded"})]}),c.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:""}),c.jsx("input",{name:"tags",value:(l.tags||[]).join(", "),onChange:p,placeholder:" ( )",className:"w-full p-2 border rounded"})]})]}),c.jsxs("div",{className:"flex justify-end mt-6 space-x-2 space-x-reverse",children:[c.jsx("button",{type:"button",onClick:n,className:"bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded hover:bg-gray-400",children:r?"Cancel":""}),c.jsx("button",{type:"submit",className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700",children:r?"Save":" "})]})]})})})},N7=({posts:t,setPosts:e,isEnglishAdmin:n})=>{const[r,i]=N.useState(!1),[s,o]=N.useState(null),a=p=>{o(p),i(!0)},l=()=>{i(!1),o(null)},u=p=>{e(m=>m.find(y=>y.id===p.id)?m.map(y=>y.id===p.id?p:y):[p,...m]),l()},h=p=>{window.confirm("        ")&&e(m=>m.filter(g=>g.id!==p))};return c.jsxs("div",{className:"text-right",children:[r&&c.jsx(C7,{post:s,onSave:u,onClose:l,isEnglishAdmin:n}),c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:n?"Manage Blog (English)":"  "}),c.jsx("button",{onClick:()=>a(null),className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700",children:n?"Add New Post":"  "})]}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full bg-white text-right",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"py-3 px-4 font-semibold text-sm",children:n?"Title":""}),c.jsx("th",{className:"py-3 px-4 font-semibold text-sm",children:n?"Type":""}),c.jsx("th",{className:"py-3 px-4 font-semibold text-sm",children:n?"Date":""}),c.jsx("th",{className:"py-3 px-4 font-semibold text-sm text-center",children:n?"Actions":""})]})}),c.jsx("tbody",{children:t.map(p=>c.jsxs("tr",{className:"border-b",children:[c.jsx("td",{className:"py-3 px-4",children:c.jsx("span",{className:"font-medium",children:n&&p.title_en||p.title})}),c.jsx("td",{className:"py-3 px-4",children:c.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${p.type==="short"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:p.type==="short"?"":""})}),c.jsx("td",{className:"py-3 px-4 text-xs text-gray-500",children:new Date(p.date).toLocaleDateString()}),c.jsxs("td",{className:"py-3 px-4 whitespace-nowrap text-center",children:[c.jsx("button",{onClick:()=>a(p),className:"text-blue-500 hover:underline mx-2",children:n?"Edit":""}),!n&&c.jsx("button",{onClick:()=>h(p.id),className:"text-red-500 hover:underline mx-2",children:""})]})]},p.id))})]})})})]})},Yc=({title:t,items:e=[],setItems:n,isEnglishAdmin:r})=>{const[i,s]=N.useState(""),o=()=>{i.trim()&&!e.includes(i.trim())&&(n([...e,i.trim()]),s(""))},a=l=>{n(e.filter(u=>u!==l))};return c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border-r-4 border-green-500",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4",children:t}),c.jsxs("div",{className:"flex space-x-2 space-x-reverse mb-4",children:[c.jsx("input",{type:"text",value:i,onChange:l=>s(l.target.value),placeholder:r?`Add ${t}...`:` ${t.toLowerCase()}...`,className:"flex-1 p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 outline-none"}),c.jsx("button",{onClick:o,className:"bg-blue-900 text-white font-bold py-2 px-6 rounded-xl",children:""})]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:e.map((l,u)=>c.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-50 text-green-700 rounded-full border border-green-100",children:[c.jsx("span",{className:"text-sm font-bold",children:l}),c.jsx("button",{onClick:()=>a(l),className:"text-red-500 font-bold hover:text-red-700",children:""})]},u))})]})},A7=({options:t,onUpdate:e,isEnglishAdmin:n})=>{const[r,i]=N.useState(t),[s,o]=N.useState(null);N.useEffect(()=>{i(t)},[t]);const a=(u,h)=>{i(p=>({...p,[u]:h}))},l=()=>{e(r),o({message:n?"English lists updated!":"   !",type:"success"}),setTimeout(()=>o(null),3e3)};return c.jsxs("div",{className:"animate-fade-in",children:[c.jsx("h1",{className:"text-3xl font-black text-blue-900 mb-6",children:n?"Registration Steps (English)":"  ()"}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(Yc,{title:n?"Service Types":" ",items:n?r.serviceTypes_en||[]:r.serviceTypes,setItems:u=>a(n?"serviceTypes_en":"serviceTypes",u),isEnglishAdmin:n}),c.jsx(Yc,{title:n?"Education Stages":" ",items:n?r.educationStages_en||[]:r.educationStages,setItems:u=>a(n?"educationStages_en":"educationStages",u),isEnglishAdmin:n}),c.jsx(Yc,{title:n?"Curriculums":"",items:n?r.curriculums_en||[]:r.curriculums,setItems:u=>a(n?"curriculums_en":"curriculums",u),isEnglishAdmin:n}),c.jsx(Yc,{title:n?"Subjects":" ",items:n?r.subjects_en||[]:r.subjects,setItems:u=>a(n?"subjects_en":"subjects",u),isEnglishAdmin:n})]}),c.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-between items-center",children:[c.jsx("button",{onClick:l,className:"bg-green-600 text-white font-black py-4 px-12 rounded-2xl shadow-xl hover:bg-green-700 transition-all",children:" "}),s&&c.jsx("p",{className:"text-green-600 font-bold",children:s.message})]})]})},k7=({users:t,setUsers:e,onViewUser:n,isEnglishAdmin:r})=>{const[i,s]=N.useState(""),o=t.filter(l=>l.username.toLowerCase().includes(i.toLowerCase())||l.email.toLowerCase().includes(i.toLowerCase())),a=l=>{window.confirm("Are you sure you want to delete this user? This action cannot be undone.")&&e(u=>u.filter(h=>h.id!==l))};return c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-6 gap-4",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:r?"User Management":" "}),c.jsx("input",{type:"text",placeholder:r?"Search by name or email...":"    ...",value:i,onChange:l=>s(l.target.value),className:"p-2 border border-gray-300 rounded-md md:w-72"})]}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full bg-white",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:r?"Name":""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:r?"Email":" "}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:r?"Type":" "}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:r?"Actions":""})]})}),c.jsx("tbody",{children:o.map(l=>c.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[c.jsx("td",{className:"py-3 px-4 font-medium",children:l.username}),c.jsx("td",{className:"py-3 px-4 text-gray-600",children:l.email}),c.jsx("td",{className:"py-3 px-4 text-gray-600",children:l.userType}),c.jsxs("td",{className:"py-3 px-4 whitespace-nowrap",children:[c.jsx("button",{onClick:()=>n(l),className:"text-blue-500 hover:underline mr-4",children:r?"View":""}),!r&&c.jsx("button",{onClick:()=>a(l.id),className:"text-red-500 hover:underline",children:r?"Delete":""})]})]},l.id))})]})})})]})},R7=["Full Control","Manage Teachers","Manage Users","Manage Blog"],P7=({staffMember:t,onSave:e,onClose:n})=>{const[r,i]=N.useState({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",permissions:(t==null?void 0:t.permissions)||"Manage Blog"}),s=a=>{const{name:l,value:u}=a.target;i(h=>({...h,[l]:u}))},o=a=>{a.preventDefault();const l={id:(t==null?void 0:t.id)||Date.now().toString(),...r,permissions:r.permissions};e(l)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:c.jsxs("form",{onSubmit:o,className:"p-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:t?"  ":"  "}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("input",{name:"name",value:r.name,onChange:s,placeholder:"",className:"w-full p-2 border rounded",required:!0}),c.jsx("input",{name:"email",type:"email",value:r.email,onChange:s,placeholder:" ",className:"w-full p-2 border rounded",required:!0}),c.jsx("select",{name:"permissions",value:r.permissions,onChange:s,className:"w-full p-2 border rounded bg-white",children:R7.map(a=>c.jsx("option",{value:a,children:a},a))})]}),c.jsxs("div",{className:"flex justify-end mt-6 space-x-2 space-x-reverse",children:[c.jsx("button",{type:"button",onClick:n,className:"bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded hover:bg-gray-400",children:""}),c.jsx("button",{type:"submit",className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700",children:""})]})]})})})},D7=({staff:t,setStaff:e})=>{const[n,r]=N.useState(!1),[i,s]=N.useState(null),o=h=>{s(h),r(!0)},a=()=>{r(!1),s(null)},l=h=>{t.some(p=>p.id===h.id)?e(p=>p.map(m=>m.id===h.id?h:m)):e(p=>[h,...p]),a()},u=h=>{window.confirm("        ")&&e(p=>p.filter(m=>m.id!==h))};return c.jsxs("div",{children:[n&&c.jsx(P7,{staffMember:i,onSave:l,onClose:a}),c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:" "}),c.jsx("button",{onClick:()=>o(null),className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700",children:" "})]}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full bg-white",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:" "}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:""})]})}),c.jsx("tbody",{children:t.map(h=>c.jsxs("tr",{className:"border-b",children:[c.jsx("td",{className:"py-3 px-4",children:h.name}),c.jsx("td",{className:"py-3 px-4",children:h.email}),c.jsx("td",{className:"py-3 px-4",children:h.permissions}),c.jsxs("td",{className:"py-3 px-4 whitespace-nowrap",children:[c.jsx("button",{onClick:()=>o(h),className:"text-blue-500 hover:underline mr-4",children:""}),c.jsx("button",{onClick:()=>u(h.id),className:"text-red-500 hover:underline",children:""})]})]},h.id))})]})})})]})},M7=({payments:t})=>{const[e,n]=N.useState("All"),[r,i]=N.useState(null),s=N.useMemo(()=>{const o=[...t].sort((a,l)=>new Date(l.date).getTime()-new Date(a.date).getTime());return e==="All"?o:o.filter(a=>a.status===e)},[t,e]);return c.jsxs("div",{children:[r&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg p-6 relative animate-fade-in-up",children:[c.jsx("button",{onClick:()=>i(null),className:"absolute top-4 left-4 text-gray-400 hover:text-gray-600 transition-colors",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 border-b pb-4 text-center",children:"  "}),c.jsxs("div",{className:"space-y-3 text-right max-h-[60vh] overflow-y-auto pl-2",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between border-b border-gray-100 pb-2",children:[c.jsx("span",{className:"font-semibold text-gray-600",children:":"}),c.jsx("span",{className:`px-3 py-0.5 rounded-full text-sm font-bold w-fit ${r.status==="Success"?"bg-green-100 text-green-800":r.status==="Pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:r.status==="Success"?"":r.status==="Pending"?" ":""})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between border-b border-gray-100 pb-2",children:[c.jsx("span",{className:"font-semibold text-gray-600",children:":"}),c.jsxs("span",{className:"text-gray-800 font-bold text-lg",children:[r.amount," ",r.currency]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between border-b border-gray-100 pb-2",children:[c.jsx("span",{className:"font-semibold text-gray-600",children:" :"}),c.jsx("span",{className:"text-gray-800 dir-ltr text-right",children:new Date(r.date).toLocaleString("ar-JO")})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between border-b border-gray-100 pb-2",children:[c.jsx("span",{className:"font-semibold text-gray-600",children:" :"}),c.jsx("span",{className:"text-gray-800",children:r.userName})]}),c.jsxs("div",{className:"flex flex-col border-b border-gray-100 pb-2",children:[c.jsx("span",{className:"font-semibold text-gray-600 mb-1",children:" :"}),c.jsx("span",{className:"text-gray-800 font-medium",children:r.courseName})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between border-b border-gray-100 pb-2",children:[c.jsx("span",{className:"font-semibold text-gray-600",children:" :"}),c.jsx("span",{className:"text-gray-800",children:r.paymentMethod||" "})]}),c.jsxs("div",{className:"bg-gray-50 p-3 rounded-md mt-4 space-y-2",children:[c.jsx("h3",{className:"font-bold text-gray-700 text-sm mb-2 border-b pb-1",children:" "}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"  (Payment ID):"}),c.jsx("span",{className:"text-gray-800 font-mono text-xs break-all",children:r.id})]}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"  (User ID):"}),c.jsx("span",{className:"text-gray-800 font-mono text-xs break-all",children:r.userId})]}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"  (Course ID):"}),c.jsx("span",{className:"text-gray-800 font-mono text-xs break-all",children:r.courseId})]}),r.gatewayOrderId&&c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"   (Gateway Order ID):"}),c.jsx("span",{className:"text-gray-800 font-mono text-xs break-all",children:r.gatewayOrderId})]}),r.transactionId&&c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"  (Transaction ID):"}),c.jsx("span",{className:"text-gray-800 font-mono text-xs break-all",children:r.transactionId})]})]})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsx("button",{onClick:()=>i(null),className:"bg-blue-900 text-white px-8 py-2 rounded-lg hover:bg-blue-800 font-bold transition-colors shadow-md",children:""})})]})}),c.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-6 gap-4",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:" "}),c.jsx("div",{className:"flex space-x-2 space-x-reverse bg-gray-200 p-1 rounded-lg",children:["All","Success","Pending","Failed"].map(o=>c.jsx("button",{onClick:()=>n(o),className:`px-4 py-1.5 text-sm font-semibold rounded-md transition-colors ${e===o?"bg-white text-blue-900 shadow":"text-gray-600 hover:bg-gray-300"}`,children:o==="All"?"":o==="Success"?"":o==="Pending"?" ":""},o))})]}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:s.length===0?c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto mb-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("p",{className:"text-lg",children:"     ."}),e!=="All"&&c.jsx("p",{className:"text-sm",children:"  ."})]}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full bg-white text-sm",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:" "}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"  (Order ID)"}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:""})]})}),c.jsx("tbody",{children:s.map(o=>c.jsxs("tr",{className:"border-b hover:bg-gray-50 transition-colors",children:[c.jsx("td",{className:"py-3 px-4 font-medium text-gray-800",children:o.userName}),c.jsx("td",{className:"py-3 px-4 text-gray-600 max-w-xs truncate",title:o.courseName,children:o.courseName}),c.jsxs("td",{className:"py-3 px-4 font-bold text-blue-900",children:[o.amount," ",o.currency]}),c.jsx("td",{className:"py-3 px-4",children:o.paymentMethod?c.jsx("span",{className:`px-2 py-1 text-xs rounded border ${o.paymentMethod==="Credit Card"?"bg-purple-50 text-purple-700 border-purple-200":"bg-orange-50 text-orange-700 border-orange-200"}`,children:o.paymentMethod}):"-"}),c.jsx("td",{className:"py-3 px-4 font-mono text-xs text-gray-500 max-w-[100px] truncate",title:o.gatewayOrderId||o.id,children:o.gatewayOrderId||o.id}),c.jsx("td",{className:"py-3 px-4 text-gray-500 text-xs",children:new Date(o.date).toLocaleDateString()}),c.jsx("td",{className:"py-3 px-4",children:c.jsx("span",{className:`px-3 py-1 text-xs font-bold rounded-full ${o.status==="Success"?"bg-green-100 text-green-800":o.status==="Pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:o.status==="Success"?"":o.status==="Pending"?"":""})}),c.jsx("td",{className:"py-3 px-4",children:c.jsx("button",{onClick:()=>i(o),className:"text-blue-600 hover:text-blue-800 hover:bg-blue-50 px-3 py-1 rounded-md transition-colors text-xs font-bold",children:""})})]},o.id))})]})})})]})},rr=({label:t,value:e})=>c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-500",children:t}),Array.isArray(e)?c.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:e.map(n=>c.jsx("span",{className:"bg-green-100 text-green-800 text-sm font-medium px-3 py-1 rounded-full",children:n},n))}):c.jsx("p",{className:"text-lg font-semibold text-gray-800 mt-1",children:e||"-"})]}),L7=({user:t,onBack:e})=>c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center mb-6",children:[c.jsx("button",{onClick:e,className:"text-blue-600 hover:underline",children:"   "}),c.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mr-4",children:[" : ",t.username]})]}),c.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6",children:[c.jsx(rr,{label:" ",value:t.username}),c.jsx(rr,{label:" ",value:t.email}),c.jsx(rr,{label:" ",value:t.phone}),c.jsx(rr,{label:" ",value:t.userType}),c.jsx(rr,{label:"",value:t.age}),c.jsx(rr,{label:" ",value:t.serviceType}),c.jsx(rr,{label:" ",value:t.educationStage}),c.jsx(rr,{label:" ",value:t.grade}),c.jsx(rr,{label:"",value:t.curriculum}),c.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:c.jsx(rr,{label:"",value:t.subjects})})]})})]}),U7=({slide:t,onSave:e,onClose:n,isEnglishAdmin:r})=>{const[i,s]=N.useState({});N.useEffect(()=>{s(t?{...t}:{id:Date.now().toString(),title:"",description:"",imageUrl:"",title_en:"",description_en:"",imageUrl_en:""})},[t]);const o=l=>{const{name:u,value:h}=l.target;s(p=>({...p,[u]:h}))},a=l=>{l.preventDefault(),e(i)};return c.jsx("div",{className:"fixed inset-0 bg-blue-900/50 backdrop-blur-md z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden animate-fade-in-up",children:[c.jsxs("div",{className:"bg-gray-50 p-6 border-b flex justify-between items-center",children:[c.jsx("h2",{className:"text-xl font-black text-blue-900",children:r?"Edit Slide (English View)":t?"  ":"  "}),c.jsx("div",{className:"bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-[10px] font-black uppercase",children:r?"EN Mode":"AR Mode"})]}),c.jsxs("form",{onSubmit:a,className:"p-8 space-y-6",children:[r?c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-2 uppercase tracking-widest",children:"Slide Title (English)"}),c.jsx("input",{name:"title_en",value:i.title_en||"",onChange:o,placeholder:"Title (English)",className:"w-full p-4 border-2 border-gray-100 rounded-2xl outline-none focus:border-blue-500 font-bold",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-2 uppercase tracking-widest",children:"Description (English)"}),c.jsx("textarea",{name:"description_en",value:i.description_en||"",onChange:o,placeholder:"Description (English)",rows:3,className:"w-full p-4 border-2 border-gray-100 rounded-2xl outline-none focus:border-blue-500 font-bold",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-blue-600 mb-2 uppercase tracking-widest",children:"English Banner Image (Independent)"}),c.jsx(Ir,{value:i.imageUrl_en||"",onChange:l=>s(u=>({...u,imageUrl_en:l})),placeholder:"Upload English Version Image"}),c.jsx("p",{className:"text-[9px] text-gray-400 mt-2 font-bold",children:"        ."})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-2 uppercase tracking-widest",children:"  ()"}),c.jsx("input",{name:"title",value:i.title||"",onChange:o,placeholder:"",className:"w-full p-4 border-2 border-gray-100 rounded-2xl outline-none focus:border-green-500 font-bold",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-gray-400 mb-2 uppercase tracking-widest",children:" ()"}),c.jsx("textarea",{name:"description",value:i.description||"",onChange:o,placeholder:"",rows:3,className:"w-full p-4 border-2 border-gray-100 rounded-2xl outline-none focus:border-green-500 font-bold",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] font-black text-green-600 mb-2 uppercase tracking-widest",children:"   ()"}),c.jsx(Ir,{value:i.imageUrl||"",onChange:l=>s(u=>({...u,imageUrl:l})),placeholder:"   "})]})]}),c.jsxs("div",{className:"flex gap-4 pt-6 border-t",children:[c.jsx("button",{type:"submit",className:"flex-1 bg-blue-900 text-white font-black py-4 rounded-2xl shadow-lg hover:bg-blue-800 transition-all",children:r?"Save English Version":" "}),c.jsx("button",{type:"button",onClick:n,className:"px-8 py-4 bg-gray-100 text-gray-400 font-black rounded-2xl hover:bg-gray-200 transition-all",children:r?"Cancel":""})]})]})]})})},F7=({heroSlides:t,setHeroSlides:e,isEnglishAdmin:n})=>{const[r,i]=N.useState(!1),[s,o]=N.useState(null),a=h=>{o(h),i(!0)},l=h=>{e(p=>p.some(g=>g.id===h.id)?p.map(g=>g.id===h.id?h:g):[h,...p]),i(!1)},u=h=>{window.confirm("  ")&&e(p=>p.filter(m=>m.id!==h))};return c.jsxs("div",{className:"animate-fade-in",children:[r&&c.jsx(U7,{slide:s,onSave:l,onClose:()=>i(!1),isEnglishAdmin:n}),c.jsxs("div",{className:"flex justify-between items-center mb-10 bg-white p-8 rounded-3xl shadow-xl",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-black text-blue-900 uppercase",children:"  "}),c.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase tracking-widest",children:n?"Multi-Language Visuals":"   "})]}),c.jsx("button",{onClick:()=>a(null),className:"bg-green-500 text-white font-black py-4 px-10 rounded-2xl shadow-lg hover:bg-green-600 transition-all transform hover:-translate-y-1",children:"  "})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(h=>c.jsxs("div",{className:"bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-50 flex flex-col group",children:[c.jsxs("div",{className:"relative h-48 overflow-hidden",children:[c.jsx("img",{src:n&&h.imageUrl_en?h.imageUrl_en:h.imageUrl,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110",alt:""}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),c.jsxs("div",{className:"absolute bottom-4 right-4 text-white",children:[c.jsxs("p",{className:"text-[10px] font-black uppercase opacity-70",children:["Preview (",n?"EN":"AR",")"]}),c.jsx("h3",{className:"font-bold",children:n&&h.title_en||h.title})]}),n&&!h.imageUrl_en&&c.jsx("div",{className:"absolute top-4 left-4 bg-orange-500 text-white text-[8px] font-black px-2 py-1 rounded-full",children:"Arabic Default Image Used"})]}),c.jsxs("div",{className:"p-6 flex gap-3 mt-auto",children:[c.jsx("button",{onClick:()=>a(h),className:"flex-1 bg-blue-900 text-white font-black py-3 rounded-xl hover:bg-blue-800 transition-all text-xs",children:""}),!n&&c.jsx("button",{onClick:()=>u(h.id),className:"px-4 py-3 bg-red-50 text-red-500 font-black rounded-xl hover:bg-red-100 transition-all text-xs",children:""})]})]},h.id))})]})},O7=({payments:t,onActivate:e})=>{const n=N.useMemo(()=>t.filter(i=>i.status==="Pending").sort((i,s)=>new Date(s.date).getTime()-new Date(i.date).getTime()),[t]),r=(i,s)=>{window.confirm(`       ${s}
      .`)&&e(i)};return c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-6 gap-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"  "}),c.jsx("p",{className:"text-gray-500 mt-1",children:"         ()."})]}),c.jsxs("div",{className:"bg-blue-50 px-4 py-2 rounded-lg border border-blue-200 text-blue-800 font-semibold",children:["  : ",n.length]})]}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:n.length===0?c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto mb-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("p",{children:"    ."})]}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full bg-white",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:" "}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:" "}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:" "}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:""}),c.jsx("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:""})]})}),c.jsx("tbody",{children:n.map(i=>c.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[c.jsx("td",{className:"py-3 px-4 font-medium text-gray-800",children:i.userName}),c.jsx("td",{className:"py-3 px-4 text-gray-600",children:i.courseName}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:new Date(i.date).toLocaleString()}),c.jsxs("td",{className:"py-3 px-4 font-bold text-blue-900",children:[i.amount," ",i.currency]}),c.jsx("td",{className:"py-3 px-4",children:c.jsxs("button",{onClick:()=>r(i.id,i.userName),className:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded shadow-sm transition-colors text-sm flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})," "]})})]},i.id))})]})})})]})},j7=t=>{const[e,n]=N.useState("content"),[r,i]=N.useState(null),s=l=>{i(l)},o=()=>{i(null)},a=()=>{if(r)return c.jsx(L7,{user:r,onBack:o});switch(e){case"content":return c.jsx(x7,{content:t.content,onUpdate:t.setContent,isEnglishAdmin:t.isEnglishAdmin});case"onboarding":return c.jsx(A7,{options:t.onboardingOptions,onUpdate:t.setOnboardingOptions,isEnglishAdmin:t.isEnglishAdmin});case"users":return c.jsx(k7,{users:t.users,setUsers:t.setUsers,onViewUser:s,isEnglishAdmin:t.isEnglishAdmin});case"staff":return c.jsx(D7,{staff:t.staff,setStaff:t.setStaff});case"payments":return c.jsx(M7,{payments:t.payments});case"teachers":return c.jsx(I7,{teachers:t.teachers,setTeachers:t.setTeachers,isEnglishAdmin:t.isEnglishAdmin});case"courses":return c.jsx(_7,{courses:t.courses,setCourses:t.setCourses,courseCategories:t.onboardingOptions.serviceTypes,curriculums:t.onboardingOptions.curriculums,isEnglishAdmin:t.isEnglishAdmin});case"testimonials":return c.jsx(b7,{testimonials:t.testimonials,setTestimonials:t.setTestimonials,isEnglishAdmin:t.isEnglishAdmin});case"blog":return c.jsx(N7,{posts:t.blogPosts,setPosts:t.setBlogPosts,isEnglishAdmin:t.isEnglishAdmin});case"heroImages":return c.jsx(F7,{heroSlides:t.heroSlides,setHeroSlides:t.setHeroSlides,isEnglishAdmin:t.isEnglishAdmin});case"whatsapp-courses":return c.jsx(O7,{payments:t.payments,onActivate:t.onActivateCourse});default:return c.jsx("div",{children:"Welcome to the Admin Dashboard."})}};return c.jsx("div",{className:"bg-gray-100 min-h-screen",children:c.jsx("div",{className:"container mx-auto px-6 py-12",children:c.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[c.jsx(v7,{activeView:e,setActiveView:n,onLogout:t.onLogout,strings:t.strings,isEnglishAdmin:t.isEnglishAdmin,isSuperAdmin:t.isSuperAdmin,onSwitchMode:t.onToggleEnglishMode}),c.jsx("main",{className:"flex-1",children:a()})]})})})},$7=({teacher:t,strings:e})=>c.jsx("div",{className:"py-12 bg-gray-100",children:c.jsx("div",{className:"container mx-auto px-6",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl p-8 md:p-12",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"md:col-span-1 text-center",children:[c.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-full max-w-[300px] h-auto max-h-[400px] rounded-lg mx-auto object-contain border-4 border-green-400 shadow-lg"}),c.jsx("h1",{className:"text-3xl font-bold text-blue-900 mt-6",children:t.name}),c.jsxs("p",{className:"text-gray-600 mt-2",children:[t.level,"  ",t.experience," ",e.yearsExperience]}),c.jsxs("div",{className:"flex justify-center items-center mt-4",children:[c.jsx("span",{className:"text-yellow-400 text-2xl",children:""}),c.jsx("span",{className:"font-bold text-xl ml-2",children:t.rating}),c.jsxs("span",{className:"text-gray-500 text-lg ml-1",children:["(",t.reviews," )"]})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-2xl font-bold text-blue-900 border-b-2 border-green-200 pb-2 mb-4",children:" "}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.bio})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-2xl font-bold text-blue-900 border-b-2 border-green-200 pb-2 mb-4",children:""}),c.jsx("div",{className:"flex flex-wrap gap-3",children:t.specialties.map(n=>c.jsx("span",{className:"bg-green-100 text-green-800 text-md font-semibold px-4 py-1 rounded-full",children:n},n))})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-blue-900 border-b-2 border-green-200 pb-2 mb-4",children:" "}),c.jsx("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:t.qualifications.map((n,r)=>c.jsx("li",{children:n},r))})]})]})]})})})}),V7=({course:t,onBook:e,currency:n,strings:r})=>{if(!t)return c.jsx("div",{className:"py-20 text-center",children:"Course not found"});let i=0,s="";n==="USD"?(i=t.priceUsd??(t.price?t.price*1.41:0),s=r.usd||"$"):n==="SAR"?(i=t.priceSar??(t.price?t.price*5.3:0),s=r.sar||"."):(i=t.priceJod??t.price??0,s=r.jod||".");const a=(typeof i=="number"&&!isNaN(i)?i:0).toFixed(2);return c.jsx("div",{className:"py-12 bg-white",children:c.jsx("div",{className:"container mx-auto px-6",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[c.jsxs("div",{className:"lg:col-span-2",children:[c.jsx("img",{src:t.imageUrl||"https://via.placeholder.com/800x400?text=No+Image",alt:t.title,className:"w-full h-auto max-h-96 object-cover rounded-lg shadow-lg mb-8"}),c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900 mb-4",children:t.title}),c.jsxs("p",{className:"text-lg text-gray-500 mb-6",children:[r.by||""," ",t.includedSubjects||t.category]}),c.jsx("div",{className:"prose lg:prose-lg max-w-none text-gray-700",children:c.jsx("p",{children:t.description})})]}),c.jsx("div",{className:"lg:col-span-1",children:c.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg shadow-md sticky top-28",children:[c.jsxs("p",{className:"text-4xl font-extrabold text-green-500 mb-6",children:[s,a]}),c.jsx("button",{onClick:()=>e(t.id),className:"w-full bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors text-lg",children:r.bookCourse||" "}),c.jsxs("ul",{className:"mt-8 space-y-3 text-gray-700",children:[c.jsxs("li",{className:"flex justify-between",children:[c.jsxs("strong",{children:[r.courseTeacher||"",":"]})," ",c.jsx("span",{children:t.teacher})]}),c.jsxs("li",{className:"flex justify-between",children:[c.jsxs("strong",{children:[r.courseDuration||"",":"]})," ",c.jsx("span",{children:t.duration})]}),c.jsxs("li",{className:"flex justify-between",children:[c.jsxs("strong",{children:[r.courseLevel||"",":"]})," ",c.jsx("span",{children:t.level})]}),c.jsxs("li",{className:"flex justify-between",children:[c.jsxs("strong",{children:[r.subject||"",":"]})," ",c.jsx("span",{children:t.category})]}),t.curriculum&&c.jsxs("li",{className:"flex justify-between",children:[c.jsx("strong",{children:":"})," ",c.jsx("span",{children:t.curriculum})]}),t.sessionCount&&c.jsxs("li",{className:"flex justify-between",children:[c.jsxs("strong",{children:[r.sessions||"",":"]})," ",c.jsx("span",{children:t.sessionCount})]}),t.totalHours&&c.jsxs("li",{className:"flex justify-between",children:[c.jsxs("strong",{children:[r.hours||"",":"]})," ",c.jsx("span",{children:t.totalHours})]})]})]})})]})})})},B7=({course:t,onEnroll:e})=>{const[n,r]=N.useState(!1),[i,s]=N.useState(!1),[o,a]=N.useState(null),[l,u]=N.useState("visa"),[h,p]=N.useState(null),[m,g]=N.useState(""),[y,w]=N.useState(!1),[T,x]=N.useState(!1),v=N.useCallback(M=>{const Q=new Date().toLocaleTimeString();console.log(`[${Q}] ${M}`)},[]),_=()=>`JOT-${String(Math.floor(Math.random()*1e8)).padStart(8,"0")}`,b=(M,Q)=>{var ae;const ne=document.getElementById(M);if(!ne)return;const se=(ae=ne.contentWindow)==null?void 0:ae.document;se&&(se.open(),se.write(Q),se.close())},S=async()=>{const M=_(),Q=t.priceJod||t.price||1;try{r(!0),a(null),v(` Creating session: orderId=${M}, amount=${Q} JOD`);const ne=await fetch("/api/payment/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Q,currency:"JOD",orderId:M})}),se=await ne.json();if(!ne.ok)throw new Error(JSON.stringify(se));const{sessionId:ae}=se;if(v(` Session created: ${ae}`),!window.PaymentSession)throw new Error("PaymentSession library not loaded");v(" Configuring hosted payment fields..."),window.PaymentSession.configure({session:ae,fields:{card:{number:"#card-number",securityCode:"#security-code",expiryMonth:"#expiry-month",expiryYear:"#expiry-year",nameOnCard:"#cardholder-name"}},frameEmbeddingMitigation:["javascript"],callbacks:{initialized:function(Te){v(` Hosted fields initialized: ${JSON.stringify(Te)}`),w(!0),r(!1)},formSessionUpdate:function(Te){if(v(` Form session update: status=${Te.status}`),Te.status==="ok")v(" Card details tokenized"),E(M,ae,Q);else if(Te.status==="fields_in_error"){r(!1);const Ee=Object.keys(Te.errors||{}).join(", ");a(`   : ${Ee}`),v(` Card validation error: ${Ee}`)}else r(!1),a("  .    ."),v(" System error during tokenization")}},interaction:{displayControl:{formatCard:"EMBOSSED",invalidFieldCharacters:"REJECT"}}})}catch(ne){r(!1),v(` Error: ${ne.message}`),a(ne.message)}},I=()=>{y&&(r(!0),a(null),g("    ..."),v(" Submitting card for tokenization..."),window.PaymentSession.updateSessionFromForm("card"))},E=async(M,Q,ne)=>{var se,ae,Te,Ee,$t,O,Y,X,ge,ye,yn;try{g("   3DS...");const ze=`auth-${Date.now()}`;v(" Step 1: INITIATE_AUTHENTICATION (background device fingerprinting)...");const ue=await(await fetch("/api/payment/initiate-auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:M,transactionId:ze,sessionId:Q,currency:"JOD"})})).json();if(v(` InitAuth response: result=${ue.result}, redirectVersion=${(ae=(se=ue.authentication)==null?void 0:se.redirect)==null?void 0:ae.version}`),ue.result==="ERROR")throw new Error(`3DS Init failed: ${((Te=ue.error)==null?void 0:Te.explanation)||JSON.stringify(ue.error)}`);const Ie=($t=(Ee=ue.authentication)==null?void 0:Ee.redirect)==null?void 0:$t.html;Ie&&(v(" Injecting device fingerprinting into hidden iframe..."),b("hidden-3ds-frame",Ie),await new Promise(tn=>setTimeout(tn,3e3))),v(" Step 2: AUTHENTICATE_PAYER (OTP challenge)..."),g("    ...");const Fe=await(await fetch("/api/payment/authenticate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:M,transactionId:ze,sessionId:Q,amount:ne,currency:"JOD",browserDetails:{javaEnabled:((O=navigator.javaEnabled)==null?void 0:O.call(navigator))||!1,language:navigator.language,screenHeight:screen.height,screenWidth:screen.width,timeZone:new Date().getTimezoneOffset(),colorDepth:screen.colorDepth,returnUrl:window.location.origin+"/api/payment/3ds-callback"}})})).json();if(v(` Auth response: result=${Fe.result}, payerInteraction=${(Y=Fe.authentication)==null?void 0:Y.payerInteraction}`),Fe.result==="ERROR")throw new Error(`3DS Auth failed: ${((X=Fe.error)==null?void 0:X.explanation)||JSON.stringify(Fe.error)}`);const Zt=(ye=(ge=Fe.authentication)==null?void 0:ge.redirect)==null?void 0:ye.html;if(!Zt&&((yn=Fe.authentication)==null?void 0:yn.payerInteraction)==="NOT_REQUIRED"){v(" Frictionless auth - no OTP needed, proceeding to PAY..."),await R(M,Q,ne,ze);return}v(" OTP challenge required - opening popup window..."),x(!0);const en=window.open("","ThreeDS_Challenge","width=520,height=620,scrollbars=yes,resizable=yes,left=200,top=100");en?(en.document.open(),en.document.write(Zt),en.document.close()):(v(" Popup blocked, attempting iframe fallback..."),await new Promise(tn=>setTimeout(tn,200)),b("otp-3ds-frame",Zt)),await new Promise((tn,G)=>{const Sr=setTimeout(()=>{G(new Error("    "))},3e5),ts=br=>{if(br.data==="3ds_challenge_complete"){v(" 3DS challenge complete signal received!"),clearTimeout(Sr),window.removeEventListener("message",ts),x(!1);try{en==null||en.close()}catch{}tn()}};window.addEventListener("message",ts)}),v(" Confirming 3DS authentication status...");let ti=!1;for(let tn=1;tn<=12;tn++){await new Promise(G=>setTimeout(G,2500));try{const Sr=await(await fetch(`/api/payment/order-status/${M}`)).text(),ts=JSON.parse(Sr),br=ts.authenticationStatus;if(v(` Poll ${tn}: authStatus=${br}, orderStatus=${ts.status}`),br==="AUTHENTICATION_SUCCESSFUL"){ti=!0;break}else if(br==="AUTHENTICATION_UNSUCCESSFUL"||br==="AUTHENTICATION_FAILED")throw new Error("   .   .")}catch(G){if(G.message.includes(""))throw G;v(` Poll error (continuing): ${G.message}`)}}if(!ti)throw new Error("      ");await R(M,Q,ne,ze)}catch(ze){r(!1),x(!1),v(` Error in 3DS/Pay: ${ze.message}`),a(ze.message)}},R=async(M,Q,ne,se)=>{var ae;try{g("  ..."),v(" Calling PAY API...");const Ee=await(await fetch("/api/payment/pay",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:M,sessionId:Q,amount:ne,currency:"JOD",authTransactionId:se})})).json();if(v(` PAY Response: ${JSON.stringify(Ee)}`),Ee.success)v(" PAYMENT SUCCESSFUL!"),p({orderId:M,amount:ne,status:Ee.status,transactionId:Ee.transactionId}),e(t,"Success",{transactionId:Ee.transactionId,orderId:M});else throw new Error(` : ${Ee.gatewayCode||((ae=Ee.error)==null?void 0:ae.explanation)||JSON.stringify(Ee.error)}`)}catch(Te){v(` Payment error: ${Te.message}`),a(Te.message)}finally{r(!1),g("")}},F=()=>{l==="visa"&&(s(!0),S())};return h?c.jsx("div",{className:"py-12 bg-gray-50 min-h-screen animate-fade-in",children:c.jsx("div",{className:"container mx-auto px-4 max-w-lg",children:c.jsxs("div",{className:"bg-white p-12 rounded-[3rem] shadow-2xl text-center",children:[c.jsx("div",{className:"w-24 h-24 bg-green-50 rounded-full flex items-center justify-center mx-auto mb-6 text-4xl",children:""}),c.jsx("h2",{className:"text-3xl font-black text-green-600 mb-2",children:"  !"}),c.jsx("p",{className:"text-gray-500 mb-8",children:"     "}),c.jsxs("div",{className:"space-y-3 bg-gray-50 p-6 rounded-2xl text-sm text-right",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-400",children:""}),c.jsxs("span",{className:"font-black text-blue-900",children:[h.amount," JOD"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-400",children:" "}),c.jsx("span",{className:"font-black text-blue-900",children:h.orderId})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-400",children:" "}),c.jsx("span",{className:"font-black text-blue-900",children:h.transactionId})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-400",children:""}),c.jsx("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-black",children:" "})]})]}),c.jsx("button",{onClick:()=>window.location.href="/dashboard",className:"w-full py-5 rounded-2xl font-black text-white bg-blue-900 hover:bg-blue-800 shadow-xl transition-all mt-6",children:"  "})]})})}):c.jsxs("div",{className:"py-12 bg-gray-50 min-h-screen animate-fade-in",children:[c.jsx("iframe",{id:"hidden-3ds-frame",title:"3DS Device Fingerprint",style:{display:"none",width:0,height:0,border:"none"}}),T&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:c.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl overflow-hidden w-full max-w-md mx-4",children:[c.jsxs("div",{className:"bg-blue-900 px-6 py-4 flex items-center justify-between",children:[c.jsx("h3",{className:"text-white font-black text-sm uppercase tracking-wider",children:"   "}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),c.jsx("span",{className:"text-green-400 text-xs font-bold",children:"SECURE"})]})]}),c.jsx("iframe",{id:"otp-3ds-frame",title:"3DS OTP Challenge",style:{width:"100%",height:"450px",border:"none",display:"block"}})]})}),c.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h1",{className:"text-4xl font-black text-blue-900 mb-2 tracking-tighter uppercase",children:"  "}),c.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600 font-bold text-xs uppercase tracking-widest",children:[c.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-ping"}),"   "]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start",children:[c.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[c.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] shadow-xl border border-gray-100 relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-blue-50 rounded-bl-full opacity-50"}),c.jsx("h2",{className:"font-black text-blue-900 mb-6 text-sm uppercase tracking-widest border-b pb-4",children:" "}),c.jsxs("div",{className:"flex gap-4 mb-8 relative z-10",children:[c.jsx("img",{src:t.imageUrl,className:"w-16 h-16 rounded-2xl object-cover shadow-lg border-2 border-white",alt:""}),c.jsxs("div",{className:"flex flex-col justify-center",children:[c.jsx("h3",{className:"font-black text-blue-900 text-sm leading-tight line-clamp-2",children:t.title}),c.jsx("span",{className:"text-[10px] font-black text-green-600 mt-1 uppercase tracking-tighter",children:t.category})]})]}),c.jsxs("div",{className:"bg-blue-50/50 p-6 rounded-3xl border border-blue-100/50 text-center",children:[c.jsx("p",{className:"text-[10px] font-black text-blue-400 mb-1 uppercase",children:"  "}),c.jsxs("div",{className:"text-4xl font-black text-blue-900",children:[t.priceJod||t.price," ",c.jsx("small",{className:"text-xs font-bold",children:"JOD"})]})]})]}),c.jsxs("div",{className:"flex items-center justify-center gap-6 opacity-30 px-6 grayscale",children:[c.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/b/b7/MasterCard_Logo.svg",alt:"Mastercard",className:"h-6"}),c.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg",alt:"Visa",className:"h-6"})]})]}),c.jsx("div",{className:"lg:col-span-8",children:c.jsx("div",{className:"bg-white p-8 sm:p-12 rounded-[3rem] shadow-2xl border border-gray-100 min-h-[500px] flex flex-col",children:i?c.jsxs("div",{className:"animate-fade-in-up flex-1 flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("button",{onClick:()=>{s(!1),w(!1),a(null),g("")},className:"text-blue-600 font-black text-xs flex items-center gap-2 hover:bg-blue-50 px-4 py-2 rounded-full transition-all",children:" "}),c.jsxs("div",{className:"bg-gray-100 text-[9px] font-black text-gray-500 px-4 py-1.5 rounded-full border uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse"}),"Secure Payment"]})]}),c.jsxs("div",{className:"flex-1 space-y-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-500 mb-2 uppercase tracking-wider",children:"  "}),c.jsx("input",{type:"text",id:"cardholder-name",className:"w-full h-12 px-4 border-2 border-gray-200 rounded-xl text-sm focus:border-blue-500 focus:outline-none transition-colors bg-gray-50",readOnly:!0,placeholder:"Cardholder Name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-500 mb-2 uppercase tracking-wider",children:" "}),c.jsx("input",{type:"text",id:"card-number",className:"w-full h-12 px-4 border-2 border-gray-200 rounded-xl text-sm focus:border-blue-500 focus:outline-none transition-colors bg-gray-50",readOnly:!0,placeholder:"Card Number"})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-500 mb-2 uppercase tracking-wider",children:""}),c.jsx("input",{type:"text",id:"expiry-month",className:"w-full h-12 px-4 border-2 border-gray-200 rounded-xl text-sm focus:border-blue-500 focus:outline-none transition-colors bg-gray-50 text-center",readOnly:!0,placeholder:"MM"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-500 mb-2 uppercase tracking-wider",children:""}),c.jsx("input",{type:"text",id:"expiry-year",className:"w-full h-12 px-4 border-2 border-gray-200 rounded-xl text-sm focus:border-blue-500 focus:outline-none transition-colors bg-gray-50 text-center",readOnly:!0,placeholder:"YY"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-black text-gray-500 mb-2 uppercase tracking-wider",children:"CVV"}),c.jsx("input",{type:"text",id:"security-code",className:"w-full h-12 px-4 border-2 border-gray-200 rounded-xl text-sm focus:border-blue-500 focus:outline-none transition-colors bg-gray-50 text-center",readOnly:!0,placeholder:"CVV"})]})]}),m&&c.jsxs("div",{className:"bg-blue-50 text-blue-800 px-4 py-3 rounded-xl text-sm font-bold flex items-center gap-3",children:[c.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin flex-shrink-0"}),m]}),o&&c.jsxs("div",{className:"bg-red-50 text-red-700 px-4 py-3 rounded-xl text-sm font-bold",children:[" ",o,c.jsx("button",{onClick:()=>{a(null),r(!1),g("")},className:"block text-xs mt-1 underline",children:" "})]}),c.jsx("button",{onClick:I,disabled:n||!y,className:`w-full py-4 rounded-2xl font-black text-white shadow-xl transition-all text-lg flex items-center justify-center gap-3 mt-4 ${n||!y?"bg-gray-300 cursor-not-allowed":"bg-blue-900 hover:bg-blue-800 active:scale-95"}`,children:n?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-6 h-6 border-4 border-white border-t-transparent rounded-full animate-spin"}),m||" ..."]}):y?` ${t.priceJod||t.price} `:"   ..."})]})]}):c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center animate-fade-in py-6",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full max-w-md mb-12",children:[c.jsxs("button",{onClick:()=>u("visa"),className:`flex flex-col items-center gap-3 p-8 rounded-[2.5rem] border-2 transition-all ${l==="visa"?"border-blue-600 bg-blue-50/30":"border-gray-50 bg-gray-50/20"}`,children:[c.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-transform ${l==="visa"?"bg-blue-600 text-white shadow-xl scale-110":"bg-white text-gray-400 border shadow-sm"}`,children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),c.jsx("span",{className:`font-black text-[10px] uppercase tracking-widest ${l==="visa"?"text-blue-900":"text-gray-400"}`,children:" "})]}),c.jsxs("button",{onClick:()=>u("cliq"),className:`flex flex-col items-center gap-3 p-8 rounded-[2.5rem] border-2 transition-all ${l==="cliq"?"border-green-600 bg-green-50/30":"border-gray-50 bg-gray-50/20"}`,children:[c.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-transform ${l==="cliq"?"bg-green-600 text-white shadow-xl scale-110":"bg-white text-gray-400 border shadow-sm"}`,children:c.jsx("span",{className:"font-black text-xl italic",children:"Q"})}),c.jsx("span",{className:`font-black text-[10px] uppercase tracking-widest ${l==="cliq"?"text-green-900":"text-gray-400"}`,children:" CliQ"})]})]}),c.jsx("button",{onClick:F,disabled:n,className:"w-full max-w-sm py-5 rounded-2xl font-black text-white bg-blue-900 hover:bg-blue-800 shadow-[0_15px_30px_rgba(0,33,70,0.2)] transition-all transform active:scale-95 text-lg flex items-center justify-center gap-3",children:n?c.jsx("div",{className:"w-6 h-6 border-4 border-white border-t-transparent rounded-full animate-spin"}):"  "})]})})})]})]})]})},q7=({courses:t,onSelectCourse:e,currency:n,exchangeRate:r,strings:i,language:s})=>{const[o,a]=N.useState("all"),[l,u]=N.useState("all"),[h,p]=N.useState("all"),[m,g]=N.useState("all"),[y,w]=N.useState("default"),T=N.useMemo(()=>["all",...Array.from(new Set(t.map(S=>S.category)))],[t]),x=N.useMemo(()=>["all",...Array.from(new Set(t.map(S=>S.level)))],[t]),v=N.useMemo(()=>["all",...Array.from(new Set(t.map(S=>S.curriculum).filter(Boolean)))],[t]),_=N.useMemo(()=>{const S=new Set;return t.forEach(I=>{I.targetGrades&&Array.isArray(I.targetGrades)&&I.targetGrades.forEach(E=>S.add(E))}),["all",...Array.from(S)]},[t]),b=N.useMemo(()=>{let S=[...t];o!=="all"&&(S=S.filter(E=>E.category===o)),l!=="all"&&(S=S.filter(E=>E.level===l)),h!=="all"&&(S=S.filter(E=>E.curriculum===h)),m!=="all"&&(S=S.filter(E=>E.targetGrades&&E.targetGrades.includes(m)));const I=E=>{let R=0;return n==="USD"?R=E.priceUsd??(E.price?E.price*1.41:0):n==="SAR"?R=E.priceSar??(E.price?E.price*5.3:0):R=E.priceJod??E.price??0,typeof R=="number"&&!isNaN(R)?R:0};return y==="price-asc"?S.sort((E,R)=>I(E)-I(R)):y==="price-desc"&&S.sort((E,R)=>I(R)-I(E)),S},[t,o,l,h,m,y,n]);return c.jsx("div",{className:"py-20 bg-gray-100",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900",children:i.coursesTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:i.coursesSubtitle})]}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md mb-12 max-w-7xl mx-auto",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-5 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"category-filter",className:"block text-sm font-medium text-gray-700",children:i.category}),c.jsxs("select",{id:"category-filter",value:o,onChange:S=>a(S.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md",children:[c.jsx("option",{value:"all",children:i.allCategories}),T.filter(S=>S!=="all").map(S=>c.jsx("option",{value:S,children:S},S))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"level-filter",className:"block text-sm font-medium text-gray-700",children:i.level}),c.jsxs("select",{id:"level-filter",value:l,onChange:S=>u(S.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md",children:[c.jsx("option",{value:"all",children:i.allLevels}),x.filter(S=>S!=="all").map(S=>c.jsx("option",{value:S,children:S},S))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"curriculum-filter",className:"block text-sm font-medium text-gray-700",children:""}),c.jsxs("select",{id:"curriculum-filter",value:h,onChange:S=>p(S.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md",children:[c.jsx("option",{value:"all",children:" "}),v.filter(S=>S!=="all").map(S=>c.jsx("option",{value:S,children:S},S))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"grade-filter",className:"block text-sm font-medium text-gray-700",children:" "}),c.jsxs("select",{id:"grade-filter",value:m,onChange:S=>g(S.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md",children:[c.jsx("option",{value:"all",children:" "}),_.filter(S=>S!=="all").map(S=>c.jsx("option",{value:S,children:S},S))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"sort-by",className:"block text-sm font-medium text-gray-700",children:i.sortBy}),c.jsxs("select",{id:"sort-by",value:y,onChange:S=>w(S.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md",children:[c.jsx("option",{value:"default",children:i.sortDefault}),c.jsx("option",{value:"price-asc",children:i.sortPriceAsc}),c.jsx("option",{value:"price-desc",children:i.sortPriceDesc})]})]})]})}),b.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:b.map(S=>c.jsx(Kd,{course:S,onSelect:()=>e(S.id),currency:n,exchangeRate:r,strings:i},S.id))}):c.jsxs("div",{className:"text-center py-16",children:[c.jsx("h3",{className:"text-2xl font-semibold text-gray-700",children:i.noCoursesFound}),c.jsx("p",{className:"text-gray-500 mt-2",children:i.noCoursesFoundDesc})]})]})})},G7=({post:t,onSelect:e})=>c.jsxs("div",{onClick:e,className:"group relative rounded-lg overflow-hidden cursor-pointer",children:[c.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-300"}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"}),c.jsx("div",{className:"absolute bottom-0 left-0 p-4",children:c.jsx("h3",{className:"text-white font-bold",children:t.title})})]}),H7=({shorts:t,onSelectShort:e,strings:n,language:r})=>c.jsx("div",{className:"py-20 bg-gray-100",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900",children:n.videosTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"      ."})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:t.map(i=>c.jsx(G7,{post:i,onSelect:()=>e(i.id)},i.id))})]})}),z7=({post:t,onBack:e,strings:n,language:r})=>{const i=new Date(t.date),s=isNaN(i.getTime())?t.date:i.toLocaleDateString(r==="ar"?"ar-JO":"en-US",{year:"numeric",month:"long",day:"numeric"});return c.jsx("div",{className:"py-12 bg-gray-900 text-white min-h-screen flex flex-col items-center justify-center",children:c.jsxs("div",{className:"container mx-auto px-6 max-w-2xl",children:[c.jsxs("button",{onClick:e,className:"text-green-400 hover:underline mb-6",children:[" ",n.backToVideos]}),c.jsx("div",{className:"bg-black rounded-lg shadow-xl overflow-hidden",children:c.jsx("div",{className:"aspect-w-9 aspect-h-16",children:c.jsx("iframe",{src:`https://www.youtube.com/embed/${t.youtubeVideoId}`,title:t.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full"})})}),c.jsxs("div",{className:"mt-6 text-center",children:[c.jsx("h1",{className:"text-2xl font-bold mb-2",children:t.title}),c.jsxs("p",{className:"text-gray-400 mb-4",children:[n.by," ",t.author,"  ",s]}),c.jsx("p",{className:"text-gray-300",children:t.excerpt})]})]})})},W7=({post:t,onSelect:e,strings:n,language:r})=>{const i=new Date(t.date),s=isNaN(i.getTime())?t.date:i.toLocaleDateString(r==="ar"?"ar-JO":"en-US",{year:"numeric",month:"long",day:"numeric"});return c.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden transform hover:-translate-y-2 transition-transform duration-300",children:[c.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-56 object-cover"}),c.jsxs("div",{className:"p-6",children:[c.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:[n.by," ",t.author,"  ",s]}),c.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-3 h-14 overflow-hidden",children:t.title}),c.jsx("p",{className:"text-gray-600 mb-4 h-20 overflow-hidden",children:t.excerpt}),c.jsx("button",{onClick:e,className:"font-semibold text-green-600 hover:text-green-700",children:n.readMore})]})]})},K7=({posts:t,onSelectPost:e,strings:n,language:r})=>c.jsx("div",{className:"py-20 bg-gray-100",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900",children:n.blogTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"     ."})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map(i=>c.jsx(W7,{post:i,onSelect:()=>e(i.id),strings:n,language:r},i.id))})]})}),J7=({post:t,onBack:e,strings:n,language:r})=>{const i=new Date(t.date),s=isNaN(i.getTime())?t.date:i.toLocaleDateString(r==="ar"?"ar-JO":"en-US",{year:"numeric",month:"long",day:"numeric"});return c.jsx("div",{className:"py-12 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6 max-w-4xl",children:[c.jsxs("button",{onClick:e,className:"text-green-600 hover:underline mb-8",children:[" ",n.backToBlog]}),c.jsxs("article",{children:[c.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-auto max-h-96 object-cover rounded-lg shadow-lg mb-8"}),c.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-blue-900 mb-4",children:t.title}),c.jsxs("p",{className:"text-gray-500 mb-8",children:[n.by," ",t.author,"  ",s]}),c.jsx("div",{className:"prose lg:prose-xl max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:t.content}})]})]})})},Y7=({content:t,strings:e})=>c.jsxs("div",{className:"bg-white",children:[c.jsxs("section",{className:"relative h-72 bg-cover bg-center",style:{backgroundImage:`url(${t.heroImage})`},children:[c.jsx("div",{className:"absolute inset-0 bg-blue-900 bg-opacity-60"}),c.jsx("div",{className:"container mx-auto px-6 h-full flex items-center justify-center relative z-10",children:c.jsx("h1",{className:"text-5xl md:text-6xl font-extrabold text-white text-center",children:t.aboutTitle})})]}),c.jsx("section",{className:"py-20",children:c.jsx("div",{className:"container mx-auto px-6",children:c.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[c.jsxs("div",{className:"order-2 md:order-1",children:[c.jsx("h2",{className:"text-3xl font-bold text-blue-900 mb-4",children:t.visionTitle}),c.jsxs("p",{className:"text-xl text-gray-600 italic leading-relaxed",children:['"',t.vision,'"']})]}),c.jsx("div",{className:"order-1 md:order-2",children:c.jsx("img",{src:t.visionImage,alt:"Our Vision",className:"rounded-lg shadow-2xl w-full h-auto object-cover"})})]})})}),c.jsx("section",{className:"py-20 bg-gray-50",children:c.jsxs("div",{className:"container mx-auto px-6 max-w-4xl text-center",children:[c.jsx("h2",{className:"text-3xl font-bold text-blue-900 mb-4",children:t.missionTitle}),c.jsx("p",{className:"text-lg text-gray-700 leading-loose",children:t.mission})]})}),c.jsx("section",{className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6 max-w-4xl text-center",children:[c.jsx("h2",{className:"text-3xl font-bold text-blue-900 mb-4",children:t.teacherCommunityTitle}),c.jsx("p",{className:"text-lg text-gray-700 leading-loose",children:t.teacherCommunity})]})}),c.jsx("section",{className:"py-20 bg-gray-50",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsx("div",{className:"text-center mb-16",children:c.jsx("h2",{className:"text-4xl font-extrabold text-blue-900",children:t.whyJoTutorTitle})}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-6xl mx-auto",children:t.whyJoTutor.map((n,r)=>c.jsxs("div",{className:"bg-white p-6 rounded-xl flex items-start space-x-4 space-x-reverse transition-transform duration-300 hover:shadow-lg hover:-translate-y-1",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("div",{className:"flex items-center justify-center h-12 w-12 rounded-full bg-green-100 text-green-500",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})}),c.jsx("p",{className:"text-gray-700 text-base mt-1",children:n})]},r))})]})})]}),Q7=({content:t,strings:e})=>c.jsx("div",{className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900",children:e.contactTitle}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"  .          ."})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[c.jsxs("div",{className:"bg-gray-50 p-8 rounded-lg",children:[c.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6",children:e.contactInfo}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-start",children:c.jsxs("p",{className:"text-gray-700",children:[c.jsx("strong",{className:"font-semibold",children:"Email:"})," ",c.jsx("a",{href:`mailto:${t.email}`,className:"text-green-600 hover:underline",children:t.email})]})}),c.jsx("div",{className:"flex items-start",children:c.jsxs("p",{className:"text-gray-700",children:[c.jsx("strong",{className:"font-semibold",children:"Phone:"})," ",t.phone]})}),c.jsx("div",{className:"flex items-start",children:c.jsxs("p",{className:"text-gray-700",children:[c.jsx("strong",{className:"font-semibold",children:"Address:"})," ",t.address]})})]})]}),c.jsxs("div",{className:"bg-gray-50 p-8 rounded-lg",children:[c.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6",children:e.contactFormTitle}),c.jsxs("form",{onSubmit:n=>{n.preventDefault(),alert("Message sent!")},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:e.yourName}),c.jsx("input",{type:"text",id:"name",className:"mt-1 w-full p-3 border border-gray-300 rounded-md",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:e.yourEmail}),c.jsx("input",{type:"email",id:"email",className:"mt-1 w-full p-3 border border-gray-300 rounded-md",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700",children:e.yourMessage}),c.jsx("textarea",{id:"message",rows:5,className:"mt-1 w-full p-3 border border-gray-300 rounded-md",required:!0})]}),c.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white font-bold py-3 rounded-md hover:bg-green-600",children:e.sendMessage})]})]})]})]})}),X7=({item:t})=>{const[e,n]=N.useState(!1);return c.jsxs("div",{className:"border-b",children:[c.jsxs("button",{onClick:()=>n(!e),className:"w-full flex justify-between items-center text-right py-5 px-6",children:[c.jsx("span",{className:"font-semibold text-lg text-blue-900",children:t.question}),c.jsx("span",{className:`transform transition-transform duration-300 ${e?"rotate-180":""}`,children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e&&c.jsx("div",{className:"px-6 pb-5 text-gray-600",children:c.jsx("p",{children:t.answer})})]})},Z7=({faqs:t,strings:e})=>c.jsx("div",{className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6 max-w-4xl",children:[c.jsx("div",{className:"text-center mb-12",children:c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900",children:e.faqTitle})}),c.jsx("div",{className:"bg-gray-50 rounded-lg shadow-md overflow-hidden",children:t.map(n=>c.jsx(X7,{item:n},n.id))})]})}),eK=({content:t,strings:e})=>c.jsx("div",{className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6 max-w-4xl",children:[c.jsx("div",{className:"text-center mb-12",children:c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900",children:e.privacyTitle})}),c.jsx("div",{className:"prose lg:prose-xl mx-auto text-gray-700 leading-relaxed",children:c.jsx("p",{children:t})})]})}),tK=({content:t,strings:e})=>c.jsx("div",{className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6 max-w-4xl",children:[c.jsx("div",{className:"text-center mb-12",children:c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900",children:e.termsTitle})}),c.jsx("div",{className:"prose lg:prose-xl mx-auto text-gray-700 leading-relaxed",children:c.jsx("p",{children:t})})]})}),nK=({courses:t,onSelectCourse:e,strings:n,language:r,isOpen:i,setIsOpen:s})=>{const[o,a]=N.useState([]);N.useState(""),N.useState(!1);const[l,u]=N.useState(!1),h=N.useRef(null),p=()=>{var y;(y=h.current)==null||y.scrollIntoView({behavior:"smooth"})};N.useEffect(p,[o]);const m="  Mr.Pincel        .          .  !";N.useEffect(()=>{const y=setTimeout(()=>{i||u(!0)},2e3),w=setTimeout(()=>{u(!1)},9e3);return()=>{clearTimeout(y),clearTimeout(w)}},[i]),N.useEffect(()=>{i&&(u(!1),o.length===0&&a([{sender:"bot",text:m}]))},[i,o.length]);const g="https://i.ibb.co/sd7GkLLT/image-removebg-preview.png";return c.jsxs(c.Fragment,{children:[c.jsxs("div",{role:"tooltip",className:`fixed bottom-24 right-6 w-64 bg-blue-900 text-white p-3 rounded-lg shadow-lg z-50 transition-all duration-500 ease-in-out ${l?"opacity-100 translate-y-0":"opacity-0 translate-y-4 pointer-events-none"}`,children:[c.jsx("p",{className:"text-sm text-center font-medium",children:r==="ar"?":   Mr.Pincel":"Coming Soon: Mr.Pincel AI Assistant"}),c.jsx("div",{className:"absolute -bottom-2 right-6 w-0 h-0 border-l-8 border-l-transparent border-r-8 border-r-transparent border-t-8 border-t-blue-900"})]}),c.jsx("button",{onClick:()=>s(!i),className:`fixed bottom-6 right-6 bg-green-500 text-white rounded-full p-2 shadow-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-transform duration-300 z-50 border-2 border-white ${i?"rotate-90 scale-0":"rotate-0 scale-100"}`,"aria-label":"Open Chat",children:c.jsx("img",{src:g,alt:"Mr.Pincel",className:"w-14 h-14 object-contain"})}),c.jsxs("div",{className:`fixed bottom-24 right-6 w-full max-w-sm h-[70vh] max-h-[600px] bg-white rounded-xl shadow-2xl flex flex-col transition-all duration-300 origin-bottom-right z-50 ${i?"scale-100 opacity-100":"scale-95 opacity-0 pointer-events-none"}`,children:[c.jsxs("div",{className:"flex-shrink-0 bg-blue-900 text-white p-4 flex justify-between items-center rounded-t-xl",children:[c.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[c.jsx("div",{className:"bg-white rounded-full p-1",children:c.jsx("img",{src:g,alt:"Mr.Pincel",className:"w-8 h-8 object-contain"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-lg",children:n.chatbotTitle}),c.jsx("p",{className:"text-xs text-orange-400 font-bold",children:"Under Construction "})]})]}),c.jsx("button",{onClick:()=>s(!1),className:"p-1 rounded-full hover:bg-blue-800",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"flex-1 p-4 overflow-y-auto bg-gray-50 flex flex-col items-center justify-center text-center",children:[c.jsxs("div",{className:"bg-orange-50 border border-orange-200 p-6 rounded-xl shadow-inner max-w-[90%]",children:[c.jsx("div",{className:"text-4xl mb-4",children:""}),c.jsx("p",{className:"text-blue-900 font-bold text-lg mb-2",children:"Mr.Pincel  !"}),c.jsx("p",{className:"text-gray-600 leading-relaxed text-sm",children:m})]}),c.jsx("div",{ref:h})]}),c.jsx("div",{className:"flex-shrink-0 p-4 border-t bg-gray-100",children:c.jsxs("div",{className:"flex space-x-2 space-x-reverse opacity-50 cursor-not-allowed",children:[c.jsx("input",{disabled:!0,type:"text",placeholder:"  ...",className:"flex-1 p-2 border border-gray-300 rounded-lg bg-gray-200"}),c.jsx("button",{disabled:!0,className:"bg-gray-400 text-white font-bold px-4 rounded-lg",children:n.chatbotSend})]})})]})]})},rK=({onStartChat:t,onClose:e})=>{const n="https://i.ibb.co/sd7GkLLT/image-removebg-preview.png";return c.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-4 overflow-y-auto bg-blue-900/40 backdrop-blur-sm",children:[c.jsx("div",{className:"fixed inset-0 cursor-default",onClick:e}),c.jsxs("div",{className:"relative bg-white rounded-[2rem] sm:rounded-[3rem] shadow-[0_30px_70px_rgba(0,0,0,0.4)] w-full max-w-lg lg:max-w-xl p-8 sm:p-12 text-center transform transition-all animate-fade-in-up border-[4px] sm:border-[8px] border-green-500 my-20 sm:my-24",children:[c.jsx("button",{onClick:e,className:"absolute -top-3 -right-3 sm:-top-5 sm:-right-5 bg-white text-gray-400 hover:text-red-500 transition-all p-2 sm:p-3 rounded-full shadow-xl border-2 border-gray-100 z-50 group hover:rotate-90","aria-label":"",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}),c.jsx("div",{className:"absolute -top-16 sm:-top-24 left-1/2 transform -translate-x-1/2 z-20",children:c.jsxs("div",{className:"w-32 h-32 sm:w-44 sm:h-44 bg-white rounded-full border-[4px] sm:border-[8px] border-green-500 flex items-center justify-center shadow-2xl relative overflow-visible",children:[c.jsx("img",{src:n,alt:"Mr. Pincel",className:"w-24 h-24 sm:w-36 sm:h-36 object-contain animate-bounce-custom"}),c.jsx("div",{className:"absolute inset-0 bg-green-400/20 rounded-full animate-ping opacity-30"})]})}),c.jsxs("div",{className:"mt-12 sm:mt-16 relative z-10",children:[c.jsx("div",{className:"inline-block bg-green-100 text-green-700 px-5 py-1.5 rounded-full text-xs sm:text-sm font-black mb-5 uppercase tracking-widest shadow-sm",children:"    "}),c.jsx("h3",{className:"text-3xl sm:text-4xl font-black text-blue-900 mb-2 leading-tight",children:" ! "}),c.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-green-600 mb-8",children:["   ",c.jsx("span",{className:"text-blue-900 border-b-4 border-green-500 pb-1",children:"Mr.Pincel"})]}),c.jsx("div",{className:"bg-gray-50 rounded-2xl p-6 sm:p-8 mb-10 border border-gray-100 shadow-inner",children:c.jsx("p",{className:"text-gray-600 text-base sm:text-xl leading-relaxed font-medium",children:"   !        .        ."})}),c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsxs("button",{onClick:t,className:"w-full bg-green-500 hover:bg-green-600 text-white text-lg sm:text-2xl font-black py-4 sm:py-5 px-8 rounded-2xl shadow-[0_12px_24px_rgba(132,188,53,0.4)] hover:shadow-[0_18px_36px_rgba(132,188,53,0.5)] transition-all duration-300 transform hover:-translate-y-1.5 flex items-center justify-center gap-4 group",children:[c.jsx("span",{children:"   Mr.Pincel"}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 sm:h-8 sm:w-8 group-hover:translate-x-1 rtl:group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M13 10V3L4 14h7v7l9-11h-7z"})})]}),c.jsxs("button",{onClick:e,className:"w-full text-gray-400 hover:text-blue-900 font-bold text-sm sm:text-lg transition-colors py-3 flex items-center justify-center gap-2",children:["  ",c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]})]}),c.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden rounded-[2.5rem] pointer-events-none opacity-[0.03]",children:[c.jsx("div",{className:"absolute -top-10 -left-10 w-48 h-48 bg-green-500 rounded-full"}),c.jsx("div",{className:"absolute -bottom-10 -right-10 w-72 h-72 bg-blue-500 rounded-full"})]})]}),c.jsx("style",{dangerouslySetInnerHTML:{__html:`
                @keyframes bounce-custom {
                    0%, 100% { transform: translateY(0) scale(1); }
                    50% { transform: translateY(-15px) scale(1.05); }
                }
                .animate-bounce-custom {
                    animation: bounce-custom 2.5s infinite ease-in-out;
                }
                .animate-fade-in-up {
                    animation: fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
                }
                @keyframes fadeInUp {
                    from { opacity: 0; transform: translateY(40px) scale(0.95); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
            `}})]})},iK=({content:t,strings:e})=>c.jsx("div",{className:"py-20 bg-white",children:c.jsxs("div",{className:"container mx-auto px-6 max-w-4xl",children:[c.jsx("div",{className:"text-center mb-12",children:c.jsx("h1",{className:"text-4xl font-extrabold text-blue-900",children:e.paymentRefundTitle})}),c.jsx("div",{className:"prose lg:prose-xl mx-auto text-gray-700 leading-relaxed whitespace-pre-wrap",children:c.jsx("p",{children:t})})]})}),sK=()=>{const[t,e]=N.useState("home"),[n,r]=N.useState(null),[i,s]=N.useState(!1),[o,a]=N.useState(null),[l,u]=N.useState(!1),[h,p]=N.useState(!1),[m,g]=N.useState(!1),[y,w]=N.useState(!1),[T,x]=N.useState(!1),[v,_]=N.useState(!1),[b,S]=N.useState(!1),[I,E]=N.useState("ar"),[R,F]=N.useState(bp),[M,Q]=N.useState(!1),[ne,se]=N.useState("JOD"),[ae,Te]=N.useState([]),[Ee,$t]=N.useState([]),[O,Y]=N.useState([]),[X,ge]=N.useState(ai.teachers),[ye,yn]=N.useState(ai.courses),[ze,_e]=N.useState(ai.testimonials),[ue,Ie]=N.useState(ai.blogPosts),[xt,Fe]=N.useState(ai.heroSlides),[Zt,en]=N.useState(ai.siteContent),[ti,tn]=N.useState(ai.siteContent),[G,Sr]=N.useState(ai.onboardingOptions),[ts,br]=N.useState(!0),[Tx,$R]=N.useState(!0);N.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[t,n]);const hc=N.useCallback(()=>{const C=window.location.hash.replace("#/","");if(!C){e("home"),r(null);return}const z=C.split("/"),Z=z[0],De=z[1]||null,ns={course:"course-profile",teacher:"teacher-profile",article:"article",short:"short-player"}[Z]||Z;e(ns),r(De)},[]);N.useEffect(()=>(window.addEventListener("hashchange",hc),hc(),()=>window.removeEventListener("hashchange",hc)),[hc]);const ot=(C,z=null)=>{const De={"course-profile":"course","teacher-profile":"teacher",article:"article","short-player":"short"}[C]||C,Rt=z?`#/${De}/${z}`:`#/${De}`;C==="home"?window.location.hash="#/":window.location.hash=Rt},VR=()=>{se(C=>C==="JOD"?"USD":C==="USD"?"SAR":"JOD")},ao=N.useMemo(()=>I==="ar"?ye:ye.map(C=>({...C,title:C.title_en||C.title,description:C.description_en||C.description,teacher:C.teacher_en||C.teacher,level:C.level_en||C.level,category:C.category_en||C.category,curriculum:C.curriculum_en||C.curriculum,duration:C.duration_en||C.duration,includedSubjects:C.includedSubjects_en||C.includedSubjects})),[ye,I]),Qf=N.useMemo(()=>I==="ar"?X:X.map(C=>({...C,name:C.name_en||C.name,level:C.level_en||C.level,bio:C.bio_en||C.bio,specialties:C.specialties_en||C.specialties,qualifications:C.qualifications_en||C.qualifications})),[X,I]),fc=N.useMemo(()=>I==="ar"?ue:ue.map(C=>({...C,title:C.title_en||C.title,excerpt:C.excerpt_en||C.excerpt,content:C.content_en||C.content,tags:C.tags_en||C.tags,imageUrl:C.imageUrl_en||C.imageUrl})),[ue,I]),nn=N.useMemo(()=>I==="en"?ti:Zt,[I,Zt,ti]);N.useEffect(()=>{(async()=>{br(!0);const z=await OR();z.success&&(ge(z.data.teachers||[]),yn(z.data.courses||[]),_e(z.data.testimonials||[]),Ie(z.data.blog||[]),Fe(z.data.heroSlides||[]),z.data.config&&(z.data.config.siteContent&&en(z.data.config.siteContent),z.data.config.siteContentEn&&tn(z.data.config.siteContentEn),z.data.config.onboardingOptions&&Sr(z.data.config.onboardingOptions))),br(!1)})()},[]),N.useEffect(()=>a7(async z=>{var Z;if(z){s(!0);const De=((Z=z.email)==null?void 0:Z.toLowerCase())||"";if(De==="admin@jotutor.com"||De==="eng@jotutor.com"){u(!0),p(De==="admin@jotutor.com"),De==="eng@jotutor.com"&&(g(!0),E("en"),F(Ep));const Rt=await o7();Rt.success&&(Te(Rt.data.Users||[]),$t(Rt.data.Staff||[]),Y(Rt.data.Payments||[]))}else if(Ut){const Rt=await Ut.collection("users").doc(z.uid).get();Rt.exists&&a({...Rt.data(),id:z.uid})}}else s(!1),u(!1),a(null);$R(!1)}),[]);const BR=()=>{const C=I==="ar"?"en":"ar";E(C),F(C==="ar"?bp:Ep)},qR=async(C,z,Z)=>{if(!o){alert("   ."),w(!0);return}try{const De={id:(Z==null?void 0:Z.transactionId)||`TX-${Date.now()}`,date:new Date().toISOString(),userId:o.id,userName:o.username,courseId:C.id,courseName:C.title,amount:C.priceJod||C.price||0,currency:"JOD",status:z,paymentMethod:(Z==null?void 0:Z.paymentMethod)||"Credit Card",gatewayOrderId:(Z==null?void 0:Z.orderId)||`ORD-${Date.now()}`,transactionId:(Z==null?void 0:Z.transactionId)||`PAY-${Date.now()}`};if(z==="Success"){const Rt=o.enrolledCourses||[];if(!Rt.includes(C.id)){const ns={...o,enrolledCourses:[...Rt,C.id]};await Jc("Users",o.id,ns),a(ns)}}await Jc("Payments",De.id,De),Y(Rt=>[De,...Rt]),alert(z==="Success"?"      !    .":"     (CliQ).    ."),ot("dashboard")}catch(De){console.error("Enrollment error:",De),alert("      .    .")}},GR=N.useCallback(async C=>{Ie(z=>{const Z=typeof C=="function"?C(z):C;return setTimeout(()=>al("Blog",Z),0),Z})},[]),HR=N.useCallback(async C=>{yn(z=>{const Z=typeof C=="function"?C(z):C;return setTimeout(()=>al("Courses",Z),0),Z})},[]),zR=N.useCallback(async C=>{ge(z=>{const Z=typeof C=="function"?C(z):C;return setTimeout(()=>al("Teachers",Z),0),Z})},[]),WR=C=>{m?tn(z=>{const Z=typeof C=="function"?C(z):C;return am({siteContentEn:Z}).catch(De=>console.error("Error saving EN config:",De)),Z}):en(z=>{const Z=typeof C=="function"?C(z):C;return am({siteContent:Z}).catch(De=>console.error("Error saving AR config:",De)),Z})},KR=C=>{Sr(z=>{const Z=typeof C=="function"?C(z):C;return am({onboardingOptions:Z}).catch(De=>console.error("Error saving onboarding options:",De)),Z})},JR=async C=>{try{return await Jc("Users",C.id,C),a(C),!0}catch(z){return console.error(z),!1}},YR=()=>{if(ts||Tx)return c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-green-500"})});switch(t){case"home":return c.jsxs(c.Fragment,{children:[c.jsx(C2,{onSignupClick:()=>w(!0),heroSlides:xt,strings:R,language:I}),c.jsx(A2,{content:nn.homepage,strings:R}),c.jsx(k2,{content:nn.homepage,strings:R}),c.jsx(Pw,{content:nn.homepage,teachers:Qf,subjects:G.subjects,onSelectTeacher:C=>ot("teacher-profile",C),isHomePageVersion:!0,strings:R,language:I}),c.jsx(D2,{content:nn.homepage,courses:ao,onSelectCourse:C=>ot("course-profile",C),onNavigate:ot,currency:ne,exchangeRate:Wa,strings:R}),c.jsx(P2,{content:nn.homepage,testimonials:ze,strings:R}),c.jsx(u$,{content:nn.homepage,strings:R,language:I})]});case"admin-dashboard":return c.jsx(j7,{onLogout:()=>{Vt==null||Vt.signOut(),ot("home")},content:m?ti:Zt,setContent:WR,heroSlides:xt,setHeroSlides:C=>QR(C),onboardingOptions:G,setOnboardingOptions:KR,users:ae,setUsers:Te,staff:Ee,setStaff:$t,payments:O,setPayments:Y,teachers:X,setTeachers:zR,courses:ye,setCourses:HR,testimonials:ze,setTestimonials:C=>XR(C),blogPosts:ue,setBlogPosts:GR,subjects:G.subjects,strings:R,language:I,isEnglishAdmin:m,isSuperAdmin:h,onToggleEnglishMode:()=>{const C=!m;g(C),E(C?"en":"ar"),F(C?Ep:bp)},onActivateCourse:async C=>{const z=O.find(Z=>Z.id===C);if(z){const Z=Ut.collection("users").doc(z.userId),De=await Z.get();if(De.exists){const ns=De.data().enrolledCourses||[];ns.includes(z.courseId)||(await Z.update({enrolledCourses:[...ns,z.courseId]}),await Ut.collection("payments").doc(C).update({status:"Success"}),Y(ZR=>ZR.map(Xf=>Xf.id===C?{...Xf,status:"Success"}:Xf)),alert("    ."))}}}});case"teachers":return c.jsx(Pw,{content:nn.homepage,teachers:Qf,subjects:G.subjects,onSelectTeacher:C=>ot("teacher-profile",C),strings:R,language:I});case"courses":return c.jsx(q7,{courses:ao,onSelectCourse:C=>ot("course-profile",C),currency:ne,exchangeRate:Wa,strings:R,language:I});case"blog":return c.jsx(K7,{posts:fc.filter(C=>C.type==="article"),onSelectPost:C=>ot("article",C),strings:R,language:I});case"videos":return c.jsx(H7,{shorts:fc.filter(C=>C.type==="short"),onSelectShort:C=>ot("short-player",C),strings:R,language:I});case"teacher-profile":return c.jsx($7,{teacher:Qf.find(C=>C.id===n),strings:R,language:I});case"course-profile":return c.jsx(V7,{course:ao.find(C=>C.id===n),onBook:C=>ot("payment",C),currency:ne,exchangeRate:Wa,strings:R,language:I});case"payment":return c.jsx(B7,{course:ao.find(C=>C.id===n),siteContent:nn,onEnroll:qR,currency:ne,exchangeRate:Wa,strings:R,language:I});case"dashboard":return o?c.jsx(y7,{userProfile:o,onLogout:()=>{Vt==null||Vt.signOut(),ot("home")},onUpdateProfile:JR,courses:ao,onSelectCourse:C=>ot("course-profile",C),currency:ne,exchangeRate:Wa,strings:R,language:I}):c.jsx("div",{className:"py-20 text-center",children:"   ."});case"about":return c.jsx(Y7,{content:nn.about,strings:R});case"contact":return c.jsx(Q7,{content:nn.contact,strings:R});case"faq":return c.jsx(Z7,{faqs:nn.faq,strings:R});case"terms":return c.jsx(tK,{content:nn.terms,strings:R});case"privacy":return c.jsx(eK,{content:nn.privacy,strings:R});case"payment-refund":return c.jsx(iK,{content:nn.paymentRefundPolicy||"",strings:R});case"article":{const C=fc.find(z=>z.id===n);return C?c.jsx(J7,{post:C,onBack:()=>ot("blog"),strings:R,language:I}):c.jsx("div",{className:"py-20 text-center",children:"  ."})}case"short-player":{const C=fc.find(z=>z.id===n);return C?c.jsx(z7,{post:C,onBack:()=>ot("videos"),strings:R,language:I}):c.jsx("div",{className:"py-20 text-center",children:"  ."})}default:return c.jsx("div",{className:"py-20 text-center",children:"   ."})}},QR=N.useCallback(async C=>{Fe(z=>{const Z=typeof C=="function"?C(z):C;return setTimeout(()=>al("HeroSlides",Z),0),Z})},[]),XR=N.useCallback(async C=>{_e(z=>{const Z=typeof C=="function"?C(z):C;return setTimeout(()=>al("Testimonials",Z),0),Z})},[]);return c.jsxs("div",{className:I==="ar"?"rtl":"ltr",children:[v&&t==="home"&&c.jsx(rK,{onStartChat:()=>_(!1),onClose:()=>_(!1)}),c.jsx(E2,{onNavigate:ot,onLoginClick:()=>w(!0),onSignupClick:()=>x(!0),isLoggedIn:i,isAdmin:l,username:(o==null?void 0:o.username)||"Admin",onLogout:()=>Vt==null?void 0:Vt.signOut(),currency:ne,onCurrencyChange:VR,language:I,onLanguageChange:()=>S(!0),isTranslating:M,strings:R}),c.jsx("main",{className:"min-h-[70vh]",children:YR()}),c.jsx(l7,{onNavigate:ot,strings:R}),y&&c.jsx(u7,{initialView:"login",onClose:()=>w(!1),onLogin:async(C,z)=>{try{return await(Vt==null?void 0:Vt.signInWithEmailAndPassword(C,z)),w(!1),!0}catch{return!1}},onSwitchToOnboarding:()=>{w(!1),x(!0)},strings:R}),T&&c.jsx("div",{className:"fixed inset-0 z-[150] bg-blue-900/60 backdrop-blur-md flex items-center justify-center p-4 overflow-y-auto",children:c.jsx("div",{className:"w-full max-w-4xl",children:c.jsx(d7,{options:G,onSignupSuccess:async C=>{try{const{user:z}=await Vt.createUserWithEmailAndPassword(C.email,C.password);return await Jc("Users",z.uid,{...C,id:z.uid,enrolledCourses:[]}),x(!1),ot("dashboard"),null}catch(z){return z.message}},onClose:()=>x(!1),strings:R,language:I})})}),b&&c.jsxs("div",{className:"fixed inset-0 z-[110] flex items-center justify-center px-4",children:[c.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>S(!1)}),c.jsxs("div",{className:"relative bg-white rounded-xl p-6 w-full max-w-md",children:[c.jsx("h3",{className:"text-xl font-bold mb-4",children:R.langConfirmTitle}),c.jsx("p",{className:"mb-6",children:R.langConfirmMessage}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("button",{onClick:()=>{BR(),S(!1)},className:"bg-green-500 text-white p-3 rounded-lg font-bold",children:R.langConfirmYes}),c.jsx("button",{onClick:()=>S(!1),className:"bg-gray-100 p-3 rounded-lg font-bold",children:R.langConfirmNo})]})]})]}),c.jsx(nK,{courses:ao,onSelectCourse:C=>ot("course-profile",C),strings:R,language:I,isOpen:!1,setIsOpen:()=>{}})]})},jR=document.getElementById("root");if(!jR)throw new Error("Could not find root element to mount to");const oK=lm.createRoot(jR);oK.render(c.jsx(DS.StrictMode,{children:c.jsx(sK,{})}));
